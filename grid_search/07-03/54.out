# ["--attributes=3", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=128", "--learning_rate=0.0005", "--hidden_size=256", "--temp_update=0.97", "--temperature=1"]
Creating train_ds and val_ds...

Creating test_ds...
{"loss": 0.7022484540939331, "acc": 0.5147850513458252, "length": 3.466254711151123, "mode": "train", "epoch": 1}
{"loss": 0.6978559494018555, "acc": 0.5187049508094788, "length": 1.0, "mode": "test", "epoch": 1}
{"loss": 0.6912656426429749, "acc": 0.5224344730377197, "length": 3.135291576385498, "mode": "train", "epoch": 2}
{"loss": 0.6966760158538818, "acc": 0.5025179982185364, "length": 1.0, "mode": "test", "epoch": 2}
{"loss": 0.6872785687446594, "acc": 0.5404767394065857, "length": 2.5897135734558105, "mode": "train", "epoch": 3}
{"loss": 0.6798983812332153, "acc": 0.5903455018997192, "length": 1.3992805480957031, "mode": "test", "epoch": 3}
{"loss": 0.6673362851142883, "acc": 0.6028095483779907, "length": 2.3364062309265137, "mode": "train", "epoch": 4}
{"loss": 0.6345691680908203, "acc": 0.7105756402015686, "length": 1.9820144176483154, "mode": "test", "epoch": 4}
{"loss": 0.6127889156341553, "acc": 0.7117722034454346, "length": 2.24654483795166, "mode": "train", "epoch": 5}
{"loss": 0.5984925627708435, "acc": 0.7099500894546509, "length": 2.1654677391052246, "mode": "test", "epoch": 5}
{"loss": 0.573733925819397, "acc": 0.7122164368629456, "length": 2.2378499507904053, "mode": "train", "epoch": 6}
{"loss": 0.5715227127075195, "acc": 0.7147583961486816, "length": 2.0719423294067383, "mode": "test", "epoch": 6}
{"loss": 0.5453962087631226, "acc": 0.7365891933441162, "length": 2.3929636478424072, "mode": "train", "epoch": 7}
{"loss": 0.5429887771606445, "acc": 0.7374281883239746, "length": 2.611510753631592, "mode": "test", "epoch": 7}
{"loss": 0.5171878337860107, "acc": 0.7547553181648254, "length": 2.854339838027954, "mode": "train", "epoch": 8}
{"loss": 0.4969351291656494, "acc": 0.7689618468284607, "length": 3.3453238010406494, "mode": "test", "epoch": 8}
{"loss": 0.4779382646083832, "acc": 0.7836812734603882, "length": 3.3222198486328125, "mode": "train", "epoch": 9}
{"loss": 0.4478650987148285, "acc": 0.8002695441246033, "length": 3.410071849822998, "mode": "test", "epoch": 9}
{"loss": 0.44563111662864685, "acc": 0.7969661355018616, "length": 3.480072259902954, "mode": "train", "epoch": 10}
{"loss": 0.414598286151886, "acc": 0.8042908906936646, "length": 3.535971164703369, "mode": "test", "epoch": 10}
{"loss": 0.4124049246311188, "acc": 0.8235521912574768, "length": 3.48431396484375, "mode": "train", "epoch": 11}
{"loss": 0.39111870527267456, "acc": 0.8215673565864563, "length": 3.4244604110717773, "mode": "test", "epoch": 11}
{"loss": 0.38252872228622437, "acc": 0.8359860777854919, "length": 3.4705135822296143, "mode": "train", "epoch": 12}
{"loss": 0.37968534231185913, "acc": 0.8308470249176025, "length": 3.474820137023926, "mode": "test", "epoch": 12}
{"loss": 0.36188188195228577, "acc": 0.845811128616333, "length": 3.5630686283111572, "mode": "train", "epoch": 13}
{"loss": 0.3696269690990448, "acc": 0.8360077738761902, "length": 3.679856061935425, "mode": "test", "epoch": 13}
{"loss": 0.34968745708465576, "acc": 0.8526028394699097, "length": 3.7127397060394287, "mode": "train", "epoch": 14}
{"loss": 0.3561442494392395, "acc": 0.837072491645813, "length": 3.816546678543091, "mode": "test", "epoch": 14}
{"loss": 0.3407560884952545, "acc": 0.8543917536735535, "length": 3.794081449508667, "mode": "train", "epoch": 15}
{"loss": 0.3384190797805786, "acc": 0.8495157361030579, "length": 3.737410068511963, "mode": "test", "epoch": 15}
{"loss": 0.32776081562042236, "acc": 0.8634073734283447, "length": 3.735919713973999, "mode": "train", "epoch": 16}
{"loss": 0.3157001733779907, "acc": 0.8608186841011047, "length": 3.888489246368408, "mode": "test", "epoch": 16}
{"loss": 0.31407052278518677, "acc": 0.8680371046066284, "length": 3.8388094902038574, "mode": "train", "epoch": 17}
{"loss": 0.30633431673049927, "acc": 0.8672518134117126, "length": 3.9064748287200928, "mode": "test", "epoch": 17}
{"loss": 0.3081413507461548, "acc": 0.8726682066917419, "length": 3.8557474613189697, "mode": "train", "epoch": 18}
{"loss": 0.30305296182632446, "acc": 0.8784891366958618, "length": 3.899280548095703, "mode": "test", "epoch": 18}
{"loss": 0.3028751611709595, "acc": 0.8766052722930908, "length": 3.8729498386383057, "mode": "train", "epoch": 19}
{"loss": 0.2891926169395447, "acc": 0.8780474662780762, "length": 3.942445993423462, "mode": "test", "epoch": 19}
{"loss": 0.29628467559814453, "acc": 0.8775907158851624, "length": 3.8924968242645264, "mode": "train", "epoch": 20}
{"loss": 0.297630250453949, "acc": 0.8810188174247742, "length": 3.967625856399536, "mode": "test", "epoch": 20}
{"loss": 0.28734222054481506, "acc": 0.8863327503204346, "length": 3.922785520553589, "mode": "train", "epoch": 21}
{"loss": 0.2781677544116974, "acc": 0.8888490200042725, "length": 4.0, "mode": "test", "epoch": 21}
{"loss": 0.27677249908447266, "acc": 0.8894046545028687, "length": 3.9525530338287354, "mode": "train", "epoch": 22}
{"loss": 0.27372419834136963, "acc": 0.8940646648406982, "length": 4.0, "mode": "test", "epoch": 22}
{"loss": 0.27446842193603516, "acc": 0.8956976532936096, "length": 3.9428186416625977, "mode": "train", "epoch": 23}
{"loss": 0.2711946666240692, "acc": 0.889388382434845, "length": 4.0, "mode": "test", "epoch": 23}
{"loss": 0.2663854956626892, "acc": 0.8936207294464111, "length": 3.9668562412261963, "mode": "train", "epoch": 24}
{"loss": 0.2667873203754425, "acc": 0.8888488411903381, "length": 4.0, "mode": "test", "epoch": 24}
{"loss": 0.2601092457771301, "acc": 0.9019776582717896, "length": 3.9791178703308105, "mode": "train", "epoch": 25}
{"loss": 0.2559906244277954, "acc": 0.9028777480125427, "length": 4.0, "mode": "test", "epoch": 25}
{"loss": 0.25440269708633423, "acc": 0.8967183232307434, "length": 3.997544765472412, "mode": "train", "epoch": 26}
{"loss": 0.24911338090896606, "acc": 0.8933453559875488, "length": 4.0, "mode": "test", "epoch": 26}
{"loss": 0.2528456151485443, "acc": 0.9023407697677612, "length": 3.9921586513519287, "mode": "train", "epoch": 27}
{"loss": 0.2473415583372116, "acc": 0.8987410068511963, "length": 4.0, "mode": "test", "epoch": 27}
{"loss": 0.24520987272262573, "acc": 0.8997498154640198, "length": 3.991215229034424, "mode": "train", "epoch": 28}
{"loss": 0.23979654908180237, "acc": 0.9023380279541016, "length": 4.0, "mode": "test", "epoch": 28}
{"loss": 0.23862001299858093, "acc": 0.9071231484413147, "length": 3.9893083572387695, "mode": "train", "epoch": 29}
{"loss": 0.2243184745311737, "acc": 0.9030576348304749, "length": 4.0, "mode": "test", "epoch": 29}
{"loss": 0.234223410487175, "acc": 0.9063327312469482, "length": 3.997835397720337, "mode": "train", "epoch": 30}
{"loss": 0.2307572066783905, "acc": 0.9016185998916626, "length": 4.0, "mode": "test", "epoch": 30}
{"loss": 0.2413976937532425, "acc": 0.9044204950332642, "length": 3.9961395263671875, "mode": "train", "epoch": 31}
{"loss": 0.22824826836585999, "acc": 0.9019785523414612, "length": 4.0, "mode": "test", "epoch": 31}
{"loss": 0.22995597124099731, "acc": 0.9111678004264832, "length": 3.9967451095581055, "mode": "train", "epoch": 32}
{"loss": 0.21757255494594574, "acc": 0.9037770628929138, "length": 4.0, "mode": "test", "epoch": 32}
{"loss": 0.22905294597148895, "acc": 0.9087647199630737, "length": 3.9896841049194336, "mode": "train", "epoch": 33}
{"loss": 0.22118023037910461, "acc": 0.8985612988471985, "length": 4.0, "mode": "test", "epoch": 33}
{"loss": 0.22128471732139587, "acc": 0.9119795560836792, "length": 3.9973626136779785, "mode": "train", "epoch": 34}
{"loss": 0.23348402976989746, "acc": 0.8987409472465515, "length": 4.0, "mode": "test", "epoch": 34}
{"loss": 0.21397309005260468, "acc": 0.9133297801017761, "length": 3.9973607063293457, "mode": "train", "epoch": 35}
{"loss": 0.2132488191127777, "acc": 0.9068344235420227, "length": 4.0, "mode": "test", "epoch": 35}
{"loss": 0.21405957639217377, "acc": 0.9153497219085693, "length": 3.9964218139648438, "mode": "train", "epoch": 36}
{"loss": 0.2138652205467224, "acc": 0.9016188383102417, "length": 4.0, "mode": "test", "epoch": 36}
{"loss": 0.21232537925243378, "acc": 0.9136841893196106, "length": 3.999276876449585, "mode": "train", "epoch": 37}
{"loss": 0.21140454709529877, "acc": 0.9100719690322876, "length": 4.0, "mode": "test", "epoch": 37}
{"loss": 0.2005351334810257, "acc": 0.924073338508606, "length": 3.9984419345855713, "mode": "train", "epoch": 38}
{"loss": 0.21356914937496185, "acc": 0.9077339172363281, "length": 4.0, "mode": "test", "epoch": 38}
{"loss": 0.2053728699684143, "acc": 0.9181908965110779, "length": 3.9992213249206543, "mode": "train", "epoch": 39}
{"loss": 0.19662445783615112, "acc": 0.9194243550300598, "length": 4.0, "mode": "test", "epoch": 39}
{"loss": 0.2117822915315628, "acc": 0.9201220870018005, "length": 3.999455690383911, "mode": "train", "epoch": 40}
{"loss": 0.21448829770088196, "acc": 0.9111511707305908, "length": 4.0, "mode": "test", "epoch": 40}
{"loss": 0.20720525085926056, "acc": 0.9189344644546509, "length": 3.998225212097168, "mode": "train", "epoch": 41}
{"loss": 0.2110028713941574, "acc": 0.9091726541519165, "length": 4.0, "mode": "test", "epoch": 41}
{"loss": 0.19869235157966614, "acc": 0.9219838380813599, "length": 3.9967310428619385, "mode": "train", "epoch": 42}
{"loss": 0.1980057805776596, "acc": 0.9136690497398376, "length": 4.0, "mode": "test", "epoch": 42}
{"loss": 0.19689641892910004, "acc": 0.926781952381134, "length": 3.9969635009765625, "mode": "train", "epoch": 43}
{"loss": 0.18521621823310852, "acc": 0.9188849925994873, "length": 4.0, "mode": "test", "epoch": 43}
{"loss": 0.20026786625385284, "acc": 0.9224112629890442, "length": 3.999863862991333, "mode": "train", "epoch": 44}
{"loss": 0.1898033320903778, "acc": 0.9224819540977478, "length": 4.0, "mode": "test", "epoch": 44}
{"loss": 0.1974307894706726, "acc": 0.9268868565559387, "length": 3.9973602294921875, "mode": "train", "epoch": 45}
{"loss": 0.19530877470970154, "acc": 0.9183452725410461, "length": 4.0, "mode": "test", "epoch": 45}
{"loss": 0.18941058218479156, "acc": 0.9254176616668701, "length": 3.999924898147583, "mode": "train", "epoch": 46}
{"loss": 0.1890670508146286, "acc": 0.9237409830093384, "length": 4.0, "mode": "test", "epoch": 46}
{"loss": 0.1918822079896927, "acc": 0.9251192808151245, "length": 3.999976634979248, "mode": "train", "epoch": 47}
{"loss": 0.20273558795452118, "acc": 0.9093526005744934, "length": 4.0, "mode": "test", "epoch": 47}
{"loss": 0.1888091266155243, "acc": 0.9266749024391174, "length": 3.997514486312866, "mode": "train", "epoch": 48}
{"loss": 0.18397894501686096, "acc": 0.9242807030677795, "length": 4.0, "mode": "test", "epoch": 48}
{"loss": 0.18504785001277924, "acc": 0.9287815093994141, "length": 3.9998018741607666, "mode": "train", "epoch": 49}
{"loss": 0.18694299459457397, "acc": 0.9241006970405579, "length": 4.0, "mode": "test", "epoch": 49}
{"loss": 0.1933315247297287, "acc": 0.9268531203269958, "length": 3.9996519088745117, "mode": "train", "epoch": 50}
{"loss": 0.19446858763694763, "acc": 0.9239209890365601, "length": 4.0, "mode": "test", "epoch": 50}
{"loss": 0.18577125668525696, "acc": 0.9301643371582031, "length": 3.9998931884765625, "mode": "train", "epoch": 51}
{"loss": 0.1824437826871872, "acc": 0.927338182926178, "length": 4.0, "mode": "test", "epoch": 51}
{"loss": 0.1781012862920761, "acc": 0.9291462302207947, "length": 3.9999821186065674, "mode": "train", "epoch": 52}
{"loss": 0.18652889132499695, "acc": 0.9255397319793701, "length": 4.0, "mode": "test", "epoch": 52}
{"loss": 0.18812499940395355, "acc": 0.9299625754356384, "length": 3.9993672370910645, "mode": "train", "epoch": 53}
{"loss": 0.18719515204429626, "acc": 0.9206833839416504, "length": 4.0, "mode": "test", "epoch": 53}
{"loss": 0.1813162863254547, "acc": 0.9287233352661133, "length": 3.99993634223938, "mode": "train", "epoch": 54}
{"loss": 0.17424188554286957, "acc": 0.931654691696167, "length": 4.0, "mode": "test", "epoch": 54}
{"loss": 0.1764839142560959, "acc": 0.939420759677887, "length": 3.9999501705169678, "mode": "train", "epoch": 55}
{"loss": 0.17356780171394348, "acc": 0.9280575513839722, "length": 4.0, "mode": "test", "epoch": 55}
{"loss": 0.17200857400894165, "acc": 0.9359917044639587, "length": 3.997974395751953, "mode": "train", "epoch": 56}
{"loss": 0.17082111537456512, "acc": 0.9300359487533569, "length": 4.0, "mode": "test", "epoch": 56}
{"loss": 0.1721263974905014, "acc": 0.9341303110122681, "length": 3.999898672103882, "mode": "train", "epoch": 57}
{"loss": 0.17372803390026093, "acc": 0.9316545724868774, "length": 4.0, "mode": "test", "epoch": 57}
{"loss": 0.17282067239284515, "acc": 0.9357513785362244, "length": 3.999870777130127, "mode": "train", "epoch": 58}
{"loss": 0.1832284778356552, "acc": 0.9300360083580017, "length": 4.0, "mode": "test", "epoch": 58}
{"loss": 0.16563780605793, "acc": 0.9390450716018677, "length": 3.9994287490844727, "mode": "train", "epoch": 59}
{"loss": 0.17396971583366394, "acc": 0.9321942329406738, "length": 4.0, "mode": "test", "epoch": 59}
{"loss": 0.15949523448944092, "acc": 0.9383959174156189, "length": 3.9998626708984375, "mode": "train", "epoch": 60}
{"loss": 0.175202414393425, "acc": 0.928597092628479, "length": 4.0, "mode": "test", "epoch": 60}
test accuracy: 0.7987880110740662
