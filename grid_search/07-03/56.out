# ["--attributes=3", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=128", "--learning_rate=0.0005", "--hidden_size=256", "--temp_update=0.97", "--temperature=2"]
Creating train_ds and val_ds...

Creating test_ds...
{"loss": 0.7034212350845337, "acc": 0.5257043838500977, "length": 3.5191614627838135, "mode": "train", "epoch": 1}
{"loss": 0.6912822127342224, "acc": 0.518750011920929, "length": 1.0, "mode": "test", "epoch": 1}
{"loss": 0.6909224390983582, "acc": 0.5462918281555176, "length": 3.368201971054077, "mode": "train", "epoch": 2}
{"loss": 0.6965678930282593, "acc": 0.49062496423721313, "length": 1.0, "mode": "test", "epoch": 2}
{"loss": 0.6871683597564697, "acc": 0.5525586009025574, "length": 3.1535282135009766, "mode": "train", "epoch": 3}
{"loss": 0.6925224661827087, "acc": 0.4993055760860443, "length": 1.0, "mode": "test", "epoch": 3}
{"loss": 0.6777880787849426, "acc": 0.5702337622642517, "length": 2.9792356491088867, "mode": "train", "epoch": 4}
{"loss": 0.6655471324920654, "acc": 0.5985053181648254, "length": 1.7881944179534912, "mode": "test", "epoch": 4}
{"loss": 0.6533026099205017, "acc": 0.6404096484184265, "length": 3.1117324829101562, "mode": "train", "epoch": 5}
{"loss": 0.5911494493484497, "acc": 0.7135024666786194, "length": 3.6145832538604736, "mode": "test", "epoch": 5}
{"loss": 0.5917789936065674, "acc": 0.727064847946167, "length": 3.584237575531006, "mode": "train", "epoch": 6}
{"loss": 0.5211102962493896, "acc": 0.7505208849906921, "length": 4.0, "mode": "test", "epoch": 6}
{"loss": 0.5200642943382263, "acc": 0.7546249628067017, "length": 3.855731248855591, "mode": "train", "epoch": 7}
{"loss": 0.49190038442611694, "acc": 0.741319477558136, "length": 4.0, "mode": "test", "epoch": 7}
{"loss": 0.48478415608406067, "acc": 0.7721641063690186, "length": 3.9393932819366455, "mode": "train", "epoch": 8}
{"loss": 0.5068621039390564, "acc": 0.7680554986000061, "length": 4.0, "mode": "test", "epoch": 8}
{"loss": 0.4715898633003235, "acc": 0.795878529548645, "length": 3.9454874992370605, "mode": "train", "epoch": 9}
{"loss": 0.4546026587486267, "acc": 0.7876735925674438, "length": 4.0, "mode": "test", "epoch": 9}
{"loss": 0.43501025438308716, "acc": 0.8078708052635193, "length": 3.9370853900909424, "mode": "train", "epoch": 10}
{"loss": 0.41671621799468994, "acc": 0.8199653029441833, "length": 4.0, "mode": "test", "epoch": 10}
{"loss": 0.4057837426662445, "acc": 0.8381757736206055, "length": 3.939359426498413, "mode": "train", "epoch": 11}
{"loss": 0.38536882400512695, "acc": 0.8315972685813904, "length": 4.0, "mode": "test", "epoch": 11}
{"loss": 0.3730033040046692, "acc": 0.8475757241249084, "length": 3.939746379852295, "mode": "train", "epoch": 12}
{"loss": 0.37231001257896423, "acc": 0.8388888835906982, "length": 4.0, "mode": "test", "epoch": 12}
{"loss": 0.3476359248161316, "acc": 0.8530698418617249, "length": 3.958348512649536, "mode": "train", "epoch": 13}
{"loss": 0.36346960067749023, "acc": 0.8454861044883728, "length": 4.0, "mode": "test", "epoch": 13}
{"loss": 0.3243633210659027, "acc": 0.8558269143104553, "length": 3.9677271842956543, "mode": "train", "epoch": 14}
{"loss": 0.3671412467956543, "acc": 0.8513888120651245, "length": 4.0, "mode": "test", "epoch": 14}
{"loss": 0.3079296946525574, "acc": 0.8656421303749084, "length": 3.9741904735565186, "mode": "train", "epoch": 15}
{"loss": 0.35441479086875916, "acc": 0.8548612594604492, "length": 4.0, "mode": "test", "epoch": 15}
{"loss": 0.29692167043685913, "acc": 0.873703122138977, "length": 3.978764772415161, "mode": "train", "epoch": 16}
{"loss": 0.3445625901222229, "acc": 0.8623266220092773, "length": 4.0, "mode": "test", "epoch": 16}
{"loss": 0.28256455063819885, "acc": 0.8839554786682129, "length": 3.984398603439331, "mode": "train", "epoch": 17}
{"loss": 0.34757745265960693, "acc": 0.8621528148651123, "length": 4.0, "mode": "test", "epoch": 17}
{"loss": 0.267808735370636, "acc": 0.8858084678649902, "length": 3.9901440143585205, "mode": "train", "epoch": 18}
{"loss": 0.3246222138404846, "acc": 0.8628472685813904, "length": 4.0, "mode": "test", "epoch": 18}
{"loss": 0.25155216455459595, "acc": 0.8909915089607239, "length": 3.9886302947998047, "mode": "train", "epoch": 19}
{"loss": 0.31592950224876404, "acc": 0.8694444894790649, "length": 4.0, "mode": "test", "epoch": 19}
{"loss": 0.24048246443271637, "acc": 0.8959579467773438, "length": 3.993285894393921, "mode": "train", "epoch": 20}
{"loss": 0.28461822867393494, "acc": 0.8895832896232605, "length": 4.0, "mode": "test", "epoch": 20}
{"loss": 0.22528500854969025, "acc": 0.90606290102005, "length": 3.994231939315796, "mode": "train", "epoch": 21}
{"loss": 0.26014572381973267, "acc": 0.894618034362793, "length": 4.0, "mode": "test", "epoch": 21}
{"loss": 0.21902889013290405, "acc": 0.9076380729675293, "length": 3.995734691619873, "mode": "train", "epoch": 22}
{"loss": 0.261872261762619, "acc": 0.90625, "length": 4.0, "mode": "test", "epoch": 22}
{"loss": 0.20170706510543823, "acc": 0.9195424914360046, "length": 3.994119882583618, "mode": "train", "epoch": 23}
{"loss": 0.2531694173812866, "acc": 0.9010416865348816, "length": 4.0, "mode": "test", "epoch": 23}
{"loss": 0.18925811350345612, "acc": 0.9225834608078003, "length": 3.996253252029419, "mode": "train", "epoch": 24}
{"loss": 0.21910586953163147, "acc": 0.921875, "length": 4.0, "mode": "test", "epoch": 24}
{"loss": 0.17087844014167786, "acc": 0.9327037334442139, "length": 3.997103452682495, "mode": "train", "epoch": 25}
{"loss": 0.21263353526592255, "acc": 0.9217013120651245, "length": 4.0, "mode": "test", "epoch": 25}
{"loss": 0.1642223447561264, "acc": 0.9350196719169617, "length": 3.996946334838867, "mode": "train", "epoch": 26}
{"loss": 0.18925926089286804, "acc": 0.9289931058883667, "length": 4.0, "mode": "test", "epoch": 26}
{"loss": 0.15198689699172974, "acc": 0.9440913796424866, "length": 3.9981935024261475, "mode": "train", "epoch": 27}
{"loss": 0.20225386321544647, "acc": 0.9276041388511658, "length": 4.0, "mode": "test", "epoch": 27}
{"loss": 0.1519172638654709, "acc": 0.9416894912719727, "length": 3.998079538345337, "mode": "train", "epoch": 28}
{"loss": 0.18304406106472015, "acc": 0.9333333969116211, "length": 4.0, "mode": "test", "epoch": 28}
{"loss": 0.14262259006500244, "acc": 0.9462226629257202, "length": 3.9986073970794678, "mode": "train", "epoch": 29}
{"loss": 0.18641817569732666, "acc": 0.9395833611488342, "length": 4.0, "mode": "test", "epoch": 29}
{"loss": 0.13761822879314423, "acc": 0.9478483200073242, "length": 3.9985196590423584, "mode": "train", "epoch": 30}
{"loss": 0.154453307390213, "acc": 0.9425346851348877, "length": 4.0, "mode": "test", "epoch": 30}
{"loss": 0.1314420998096466, "acc": 0.9455628991127014, "length": 3.9987502098083496, "mode": "train", "epoch": 31}
{"loss": 0.15217189490795135, "acc": 0.953125, "length": 4.0, "mode": "test", "epoch": 31}
{"loss": 0.12181854993104935, "acc": 0.9533899426460266, "length": 3.9992077350616455, "mode": "train", "epoch": 32}
{"loss": 0.13836656510829926, "acc": 0.9538193941116333, "length": 4.0, "mode": "test", "epoch": 32}
{"loss": 0.12415537238121033, "acc": 0.9532974362373352, "length": 3.999631404876709, "mode": "train", "epoch": 33}
{"loss": 0.14368635416030884, "acc": 0.9609375, "length": 4.0, "mode": "test", "epoch": 33}
{"loss": 0.11878994852304459, "acc": 0.9571139812469482, "length": 3.999648332595825, "mode": "train", "epoch": 34}
{"loss": 0.11584772914648056, "acc": 0.9652776718139648, "length": 4.0, "mode": "test", "epoch": 34}
{"loss": 0.1123235896229744, "acc": 0.9596765637397766, "length": 3.999647617340088, "mode": "train", "epoch": 35}
{"loss": 0.12166871875524521, "acc": 0.9651041030883789, "length": 4.0, "mode": "test", "epoch": 35}
{"loss": 0.10827041417360306, "acc": 0.9621777534484863, "length": 3.9996695518493652, "mode": "train", "epoch": 36}
{"loss": 0.135728120803833, "acc": 0.9602431058883667, "length": 4.0, "mode": "test", "epoch": 36}
{"loss": 0.10139479488134384, "acc": 0.9657703042030334, "length": 3.9998950958251953, "mode": "train", "epoch": 37}
{"loss": 0.11403708159923553, "acc": 0.9637153148651123, "length": 4.0, "mode": "test", "epoch": 37}
{"loss": 0.10340939462184906, "acc": 0.9607284665107727, "length": 3.999929428100586, "mode": "train", "epoch": 38}
{"loss": 0.12268556654453278, "acc": 0.9630207419395447, "length": 4.0, "mode": "test", "epoch": 38}
{"loss": 0.10088451951742172, "acc": 0.9658873677253723, "length": 3.9999122619628906, "mode": "train", "epoch": 39}
{"loss": 0.11597879230976105, "acc": 0.9664930701255798, "length": 4.0, "mode": "test", "epoch": 39}
{"loss": 0.10442494601011276, "acc": 0.9623532295227051, "length": 3.999962091445923, "mode": "train", "epoch": 40}
{"loss": 0.11551956832408905, "acc": 0.9638888835906982, "length": 4.0, "mode": "test", "epoch": 40}
{"loss": 0.09771040081977844, "acc": 0.9642619490623474, "length": 3.9998979568481445, "mode": "train", "epoch": 41}
{"loss": 0.1277041882276535, "acc": 0.9614583253860474, "length": 4.0, "mode": "test", "epoch": 41}
{"loss": 0.0879242792725563, "acc": 0.9696024656295776, "length": 3.999894618988037, "mode": "train", "epoch": 42}
{"loss": 0.10698062181472778, "acc": 0.9654514789581299, "length": 4.0, "mode": "test", "epoch": 42}
{"loss": 0.09934680163860321, "acc": 0.9640355110168457, "length": 3.999953031539917, "mode": "train", "epoch": 43}
{"loss": 0.11112695187330246, "acc": 0.9637153148651123, "length": 4.0, "mode": "test", "epoch": 43}
{"loss": 0.09448302537202835, "acc": 0.9658907055854797, "length": 3.9999446868896484, "mode": "train", "epoch": 44}
{"loss": 0.10129193961620331, "acc": 0.9654514789581299, "length": 4.0, "mode": "test", "epoch": 44}
{"loss": 0.09561128914356232, "acc": 0.9660610556602478, "length": 3.999927043914795, "mode": "train", "epoch": 45}
{"loss": 0.10297989845275879, "acc": 0.9684027433395386, "length": 4.0, "mode": "test", "epoch": 45}
{"loss": 0.08721546083688736, "acc": 0.9632825255393982, "length": 3.999974489212036, "mode": "train", "epoch": 46}
{"loss": 0.10888441652059555, "acc": 0.9649306535720825, "length": 4.0, "mode": "test", "epoch": 46}
{"loss": 0.09368806332349777, "acc": 0.9680394530296326, "length": 3.9999985694885254, "mode": "train", "epoch": 47}
{"loss": 0.12092556059360504, "acc": 0.9638891220092773, "length": 4.0, "mode": "test", "epoch": 47}
{"loss": 0.08341650664806366, "acc": 0.9704750776290894, "length": 3.9999868869781494, "mode": "train", "epoch": 48}
{"loss": 0.09100428223609924, "acc": 0.9713541865348816, "length": 4.0, "mode": "test", "epoch": 48}
{"loss": 0.0768541544675827, "acc": 0.9725056290626526, "length": 3.9999966621398926, "mode": "train", "epoch": 49}
{"loss": 0.09029416739940643, "acc": 0.9661458134651184, "length": 4.0, "mode": "test", "epoch": 49}
{"loss": 0.07596244663000107, "acc": 0.9708235859870911, "length": 3.99999737739563, "mode": "train", "epoch": 50}
{"loss": 0.09931613504886627, "acc": 0.9649306535720825, "length": 4.0, "mode": "test", "epoch": 50}
{"loss": 0.08073003590106964, "acc": 0.9713451862335205, "length": 3.9999914169311523, "mode": "train", "epoch": 51}
{"loss": 0.11317937076091766, "acc": 0.9663195013999939, "length": 4.0, "mode": "test", "epoch": 51}
{"loss": 0.07693958282470703, "acc": 0.9720417261123657, "length": 3.99999737739563, "mode": "train", "epoch": 52}
{"loss": 0.08878558874130249, "acc": 0.9675347208976746, "length": 4.0, "mode": "test", "epoch": 52}
{"loss": 0.07576455920934677, "acc": 0.971925675868988, "length": 3.9999935626983643, "mode": "train", "epoch": 53}
{"loss": 0.08500680327415466, "acc": 0.9704861044883728, "length": 4.0, "mode": "test", "epoch": 53}
{"loss": 0.07225292921066284, "acc": 0.9722147583961487, "length": 3.999979019165039, "mode": "train", "epoch": 54}
{"loss": 0.12633389234542847, "acc": 0.9607638120651245, "length": 4.0, "mode": "test", "epoch": 54}
{"loss": 0.07267303764820099, "acc": 0.9751726984977722, "length": 3.9999589920043945, "mode": "train", "epoch": 55}
{"loss": 0.08253836631774902, "acc": 0.9678819179534912, "length": 4.0, "mode": "test", "epoch": 55}
{"loss": 0.07591447979211807, "acc": 0.9688514471054077, "length": 3.999997615814209, "mode": "train", "epoch": 56}
{"loss": 0.09415142238140106, "acc": 0.9715278148651123, "length": 4.0, "mode": "test", "epoch": 56}
{"loss": 0.07627638429403305, "acc": 0.9735499024391174, "length": 3.9999985694885254, "mode": "train", "epoch": 57}
{"loss": 0.13242632150650024, "acc": 0.9722222089767456, "length": 4.0, "mode": "test", "epoch": 57}
{"loss": 0.07259669899940491, "acc": 0.9749420881271362, "length": 4.0, "mode": "train", "epoch": 58}
{"loss": 0.10981249064207077, "acc": 0.9659721851348877, "length": 4.0, "mode": "test", "epoch": 58}
{"loss": 0.06752752512693405, "acc": 0.9735496640205383, "length": 3.999992847442627, "mode": "train", "epoch": 59}
{"loss": 0.08632340282201767, "acc": 0.9741320013999939, "length": 4.0, "mode": "test", "epoch": 59}
{"loss": 0.06961949914693832, "acc": 0.9764502644538879, "length": 3.9999988079071045, "mode": "train", "epoch": 60}
{"loss": 0.08267095685005188, "acc": 0.9708333611488342, "length": 4.0, "mode": "test", "epoch": 60}
test accuracy: 0.8234482407569885
