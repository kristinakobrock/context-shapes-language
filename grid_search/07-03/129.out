# ["--attributes=3", "--values=16", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=128", "--learning_rate=0.0005", "--hidden_size=256", "--temp_update=0.99", "--temperature=1"]
Creating train_ds and val_ds...

Creating test_ds...
{"loss": 0.7021308541297913, "acc": 0.5115630030632019, "length": 3.4941563606262207, "mode": "train", "epoch": 1}
{"loss": 0.695948600769043, "acc": 0.5176156759262085, "length": 1.0, "mode": "test", "epoch": 1}
{"loss": 0.6918184757232666, "acc": 0.5278794169425964, "length": 3.115950584411621, "mode": "train", "epoch": 2}
{"loss": 0.6944289207458496, "acc": 0.5128114223480225, "length": 1.0, "mode": "test", "epoch": 2}
{"loss": 0.6868996024131775, "acc": 0.5501218438148499, "length": 2.1888461112976074, "mode": "train", "epoch": 3}
{"loss": 0.6942653059959412, "acc": 0.5083630084991455, "length": 1.0, "mode": "test", "epoch": 3}
{"loss": 0.6692912578582764, "acc": 0.5923388600349426, "length": 2.0256803035736084, "mode": "train", "epoch": 4}
{"loss": 0.6529078483581543, "acc": 0.6264716386795044, "length": 1.7046263217926025, "mode": "test", "epoch": 4}
{"loss": 0.6317672729492188, "acc": 0.6636438965797424, "length": 2.351975440979004, "mode": "train", "epoch": 5}
{"loss": 0.6019298434257507, "acc": 0.7238540649414062, "length": 2.323843479156494, "mode": "test", "epoch": 5}
{"loss": 0.595214307308197, "acc": 0.6961963176727295, "length": 2.628223180770874, "mode": "train", "epoch": 6}
{"loss": 0.5613915920257568, "acc": 0.7390022277832031, "length": 2.6227757930755615, "mode": "test", "epoch": 6}
{"loss": 0.5649545788764954, "acc": 0.7334237694740295, "length": 2.6440441608428955, "mode": "train", "epoch": 7}
{"loss": 0.530482828617096, "acc": 0.7583597302436829, "length": 2.8612098693847656, "mode": "test", "epoch": 7}
{"loss": 0.521775484085083, "acc": 0.7640279531478882, "length": 2.886636972427368, "mode": "train", "epoch": 8}
{"loss": 0.5007122755050659, "acc": 0.75829017162323, "length": 3.0391459465026855, "mode": "test", "epoch": 8}
{"loss": 0.4877244830131531, "acc": 0.766927182674408, "length": 3.115603446960449, "mode": "train", "epoch": 9}
{"loss": 0.4865663945674896, "acc": 0.7669536471366882, "length": 3.2313168048858643, "mode": "test", "epoch": 9}
{"loss": 0.4674493670463562, "acc": 0.7797017693519592, "length": 3.1911373138427734, "mode": "train", "epoch": 10}
{"loss": 0.47664499282836914, "acc": 0.7897351384162903, "length": 3.071174383163452, "mode": "test", "epoch": 10}
{"loss": 0.44493547081947327, "acc": 0.8063122630119324, "length": 3.1551599502563477, "mode": "train", "epoch": 11}
{"loss": 0.4655655026435852, "acc": 0.7962106466293335, "length": 3.081850528717041, "mode": "test", "epoch": 11}
{"loss": 0.42421266436576843, "acc": 0.819450318813324, "length": 3.215593099594116, "mode": "train", "epoch": 12}
{"loss": 0.44317325949668884, "acc": 0.8102198839187622, "length": 3.3096084594726562, "mode": "test", "epoch": 12}
{"loss": 0.3994382619857788, "acc": 0.8365501165390015, "length": 3.324331760406494, "mode": "train", "epoch": 13}
{"loss": 0.42637014389038086, "acc": 0.807427704334259, "length": 3.334519624710083, "mode": "test", "epoch": 13}
{"loss": 0.3817845284938812, "acc": 0.8439022898674011, "length": 3.3072316646575928, "mode": "train", "epoch": 14}
{"loss": 0.4102872610092163, "acc": 0.8148740530014038, "length": 3.2918150424957275, "mode": "test", "epoch": 14}
{"loss": 0.3708952069282532, "acc": 0.8478257656097412, "length": 3.326524257659912, "mode": "train", "epoch": 15}
{"loss": 0.40179356932640076, "acc": 0.8247634768486023, "length": 3.27046275138855, "mode": "test", "epoch": 15}
{"loss": 0.35198718309402466, "acc": 0.8551372289657593, "length": 3.2761309146881104, "mode": "train", "epoch": 16}
{"loss": 0.37531375885009766, "acc": 0.8355299234390259, "length": 3.3096084594726562, "mode": "test", "epoch": 16}
{"loss": 0.34206992387771606, "acc": 0.8565587997436523, "length": 3.3619353771209717, "mode": "train", "epoch": 17}
{"loss": 0.372795432806015, "acc": 0.8367167711257935, "length": 3.3914589881896973, "mode": "test", "epoch": 17}
{"loss": 0.333707720041275, "acc": 0.8624650239944458, "length": 3.393695831298828, "mode": "train", "epoch": 18}
{"loss": 0.3534846007823944, "acc": 0.8440743684768677, "length": 3.4377224445343018, "mode": "test", "epoch": 18}
{"loss": 0.31957054138183594, "acc": 0.8662496209144592, "length": 3.4204907417297363, "mode": "train", "epoch": 19}
{"loss": 0.3458369970321655, "acc": 0.8454336524009705, "length": 3.487544536590576, "mode": "test", "epoch": 19}
{"loss": 0.3042551279067993, "acc": 0.8732356429100037, "length": 3.4583802223205566, "mode": "train", "epoch": 20}
{"loss": 0.33017945289611816, "acc": 0.8557527661323547, "length": 3.6085410118103027, "mode": "test", "epoch": 20}
{"loss": 0.2878434658050537, "acc": 0.8820184469223022, "length": 3.5184218883514404, "mode": "train", "epoch": 21}
{"loss": 0.29564857482910156, "acc": 0.8785544633865356, "length": 3.4412810802459717, "mode": "test", "epoch": 21}
{"loss": 0.272952675819397, "acc": 0.8901195526123047, "length": 3.542825698852539, "mode": "train", "epoch": 22}
{"loss": 0.2812243103981018, "acc": 0.8802003264427185, "length": 3.5587189197540283, "mode": "test", "epoch": 22}
{"loss": 0.26373720169067383, "acc": 0.8946632146835327, "length": 3.562007427215576, "mode": "train", "epoch": 23}
{"loss": 0.25832101702690125, "acc": 0.8927735686302185, "length": 3.505338191986084, "mode": "test", "epoch": 23}
{"loss": 0.24795880913734436, "acc": 0.8982767462730408, "length": 3.5587363243103027, "mode": "train", "epoch": 24}
{"loss": 0.2569056749343872, "acc": 0.8862918019294739, "length": 3.516014337539673, "mode": "test", "epoch": 24}
{"loss": 0.24483658373355865, "acc": 0.9010840654373169, "length": 3.582706928253174, "mode": "train", "epoch": 25}
{"loss": 0.24735412001609802, "acc": 0.8967733979225159, "length": 3.498220682144165, "mode": "test", "epoch": 25}
{"loss": 0.23384858667850494, "acc": 0.9066941142082214, "length": 3.546408176422119, "mode": "train", "epoch": 26}
{"loss": 0.24085502326488495, "acc": 0.9006657600402832, "length": 3.505338191986084, "mode": "test", "epoch": 26}
{"loss": 0.2271263152360916, "acc": 0.9073255062103271, "length": 3.622628927230835, "mode": "train", "epoch": 27}
{"loss": 0.2392531931400299, "acc": 0.8981295228004456, "length": 3.5195729732513428, "mode": "test", "epoch": 27}
{"loss": 0.21956665813922882, "acc": 0.9092925786972046, "length": 3.5880870819091797, "mode": "train", "epoch": 28}
{"loss": 0.23505344986915588, "acc": 0.8993667364120483, "length": 3.5551600456237793, "mode": "test", "epoch": 28}
{"loss": 0.2178732454776764, "acc": 0.9132117629051208, "length": 3.5787978172302246, "mode": "train", "epoch": 29}
{"loss": 0.22412726283073425, "acc": 0.908197283744812, "length": 3.5444839000701904, "mode": "test", "epoch": 29}
{"loss": 0.2130960077047348, "acc": 0.912727952003479, "length": 3.6302783489227295, "mode": "train", "epoch": 30}
{"loss": 0.21870189905166626, "acc": 0.9064769744873047, "length": 3.5480427742004395, "mode": "test", "epoch": 30}
{"loss": 0.2049047201871872, "acc": 0.9150892496109009, "length": 3.5984649658203125, "mode": "train", "epoch": 31}
{"loss": 0.25255557894706726, "acc": 0.9010938405990601, "length": 3.576512336730957, "mode": "test", "epoch": 31}
{"loss": 0.20084792375564575, "acc": 0.9164510369300842, "length": 3.596251964569092, "mode": "train", "epoch": 32}
{"loss": 0.22053878009319305, "acc": 0.9050322771072388, "length": 3.5409252643585205, "mode": "test", "epoch": 32}
{"loss": 0.1956830769777298, "acc": 0.9191792607307434, "length": 3.618335723876953, "mode": "train", "epoch": 33}
{"loss": 0.25147390365600586, "acc": 0.9078757166862488, "length": 3.565836191177368, "mode": "test", "epoch": 33}
{"loss": 0.1940152943134308, "acc": 0.9227268695831299, "length": 3.6164298057556152, "mode": "train", "epoch": 34}
{"loss": 0.21949630975723267, "acc": 0.9089580774307251, "length": 3.576512336730957, "mode": "test", "epoch": 34}
{"loss": 0.19503551721572876, "acc": 0.9213969111442566, "length": 3.639549970626831, "mode": "train", "epoch": 35}
{"loss": 0.22121810913085938, "acc": 0.9106091260910034, "length": 3.601423501968384, "mode": "test", "epoch": 35}
{"loss": 0.1923457682132721, "acc": 0.9226521849632263, "length": 3.6438686847686768, "mode": "train", "epoch": 36}
{"loss": 0.24341188371181488, "acc": 0.9006451368331909, "length": 3.576512336730957, "mode": "test", "epoch": 36}
{"loss": 0.1956438422203064, "acc": 0.9231698513031006, "length": 3.6030845642089844, "mode": "train", "epoch": 37}
{"loss": 0.21015894412994385, "acc": 0.9147931933403015, "length": 3.580071210861206, "mode": "test", "epoch": 37}
{"loss": 0.18639224767684937, "acc": 0.9239593744277954, "length": 3.6627845764160156, "mode": "train", "epoch": 38}
{"loss": 0.223335862159729, "acc": 0.9118032455444336, "length": 3.6049821376800537, "mode": "test", "epoch": 38}
{"loss": 0.1798306107521057, "acc": 0.9250561594963074, "length": 3.6513845920562744, "mode": "train", "epoch": 39}
{"loss": 0.2237330973148346, "acc": 0.9108725190162659, "length": 3.6085410118103027, "mode": "test", "epoch": 39}
{"loss": 0.18708451092243195, "acc": 0.9242735505104065, "length": 3.6101062297821045, "mode": "train", "epoch": 40}
{"loss": 0.21243026852607727, "acc": 0.9126518368721008, "length": 3.590747356414795, "mode": "test", "epoch": 40}
{"loss": 0.18633565306663513, "acc": 0.9287284016609192, "length": 3.6358120441436768, "mode": "train", "epoch": 41}
{"loss": 0.20270249247550964, "acc": 0.9201310276985168, "length": 3.587188720703125, "mode": "test", "epoch": 41}
{"loss": 0.17522576451301575, "acc": 0.9312294721603394, "length": 3.676595687866211, "mode": "train", "epoch": 42}
{"loss": 0.21066653728485107, "acc": 0.9159460067749023, "length": 3.6120996475219727, "mode": "test", "epoch": 42}
{"loss": 0.17538008093833923, "acc": 0.9294984340667725, "length": 3.6411643028259277, "mode": "train", "epoch": 43}
{"loss": 0.21761229634284973, "acc": 0.9104809165000916, "length": 3.6049821376800537, "mode": "test", "epoch": 43}
{"loss": 0.17570753395557404, "acc": 0.9295676946640015, "length": 3.6529812812805176, "mode": "train", "epoch": 44}
{"loss": 0.19385024905204773, "acc": 0.920558512210846, "length": 3.647686719894409, "mode": "test", "epoch": 44}
{"loss": 0.17126820981502533, "acc": 0.9281488656997681, "length": 3.6862151622772217, "mode": "train", "epoch": 45}
{"loss": 0.2067660689353943, "acc": 0.9160588383674622, "length": 3.651245594024658, "mode": "test", "epoch": 45}
{"loss": 0.17734183371067047, "acc": 0.9285902976989746, "length": 3.7033467292785645, "mode": "train", "epoch": 46}
{"loss": 0.1851913183927536, "acc": 0.9235366582870483, "length": 3.658363103866577, "mode": "test", "epoch": 46}
{"loss": 0.1703428477048874, "acc": 0.9309309124946594, "length": 3.6934397220611572, "mode": "train", "epoch": 47}
{"loss": 0.25501343607902527, "acc": 0.9154056906700134, "length": 3.7117438316345215, "mode": "test", "epoch": 47}
{"loss": 0.1688460260629654, "acc": 0.9321265816688538, "length": 3.7088935375213623, "mode": "train", "epoch": 48}
{"loss": 0.21543043851852417, "acc": 0.9198864698410034, "length": 3.6085410118103027, "mode": "test", "epoch": 48}
{"loss": 0.1716688573360443, "acc": 0.933702290058136, "length": 3.667116165161133, "mode": "train", "epoch": 49}
{"loss": 0.21009878814220428, "acc": 0.9181822538375854, "length": 3.6405694484710693, "mode": "test", "epoch": 49}
{"loss": 0.1750052124261856, "acc": 0.9322579503059387, "length": 3.6802353858947754, "mode": "train", "epoch": 50}
{"loss": 0.20057043433189392, "acc": 0.917208731174469, "length": 3.669039249420166, "mode": "test", "epoch": 50}
{"loss": 0.16681037843227386, "acc": 0.9320433735847473, "length": 3.692769765853882, "mode": "train", "epoch": 51}
{"loss": 0.19843584299087524, "acc": 0.9211013317108154, "length": 3.6868326663970947, "mode": "test", "epoch": 51}
{"loss": 0.16622304916381836, "acc": 0.9338409900665283, "length": 3.701620101928711, "mode": "train", "epoch": 52}
{"loss": 0.2792761027812958, "acc": 0.9083507657051086, "length": 3.7010676860809326, "mode": "test", "epoch": 52}
{"loss": 0.16678445041179657, "acc": 0.934425413608551, "length": 3.7187790870666504, "mode": "train", "epoch": 53}
{"loss": 0.20660337805747986, "acc": 0.913266122341156, "length": 3.672597885131836, "mode": "test", "epoch": 53}
{"loss": 0.16555598378181458, "acc": 0.9309536814689636, "length": 3.7050106525421143, "mode": "train", "epoch": 54}
{"loss": 0.22176246345043182, "acc": 0.9138246774673462, "length": 3.6975088119506836, "mode": "test", "epoch": 54}
{"loss": 0.16742941737174988, "acc": 0.9324647188186646, "length": 3.7006728649139404, "mode": "train", "epoch": 55}
{"loss": 0.20984642207622528, "acc": 0.9186331033706665, "length": 3.654804229736328, "mode": "test", "epoch": 55}
{"loss": 0.16780176758766174, "acc": 0.9349302649497986, "length": 3.7061104774475098, "mode": "train", "epoch": 56}
{"loss": 0.22540777921676636, "acc": 0.9133816361427307, "length": 3.740213632583618, "mode": "test", "epoch": 56}
{"loss": 0.16157229244709015, "acc": 0.9339263439178467, "length": 3.742560625076294, "mode": "train", "epoch": 57}
{"loss": 0.1969282478094101, "acc": 0.9159219264984131, "length": 3.7224199771881104, "mode": "test", "epoch": 57}
{"loss": 0.16221383213996887, "acc": 0.9323065280914307, "length": 3.7141363620758057, "mode": "train", "epoch": 58}
{"loss": 0.19415733218193054, "acc": 0.9133186936378479, "length": 3.6868326663970947, "mode": "test", "epoch": 58}
{"loss": 0.16874344646930695, "acc": 0.9315845966339111, "length": 3.727128267288208, "mode": "train", "epoch": 59}
{"loss": 0.24779562652111053, "acc": 0.9007071852684021, "length": 3.733096122741699, "mode": "test", "epoch": 59}
{"loss": 0.16728979349136353, "acc": 0.9295729398727417, "length": 3.758784055709839, "mode": "train", "epoch": 60}
{"loss": 0.21087734401226044, "acc": 0.9189985394477844, "length": 3.733096122741699, "mode": "test", "epoch": 60}
test accuracy: 0.7827306985855103
