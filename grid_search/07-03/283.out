# ["--attributes=5", "--values=16", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=128", "--learning_rate=0.001", "--hidden_size=256", "--temp_update=0.97", "--temperature=1.5"]
Creating train_ds and val_ds...

Creating test_ds...
{"loss": 0.7049286961555481, "acc": 0.5229970216751099, "length": 3.3147599697113037, "mode": "train", "epoch": 1}
{"loss": 0.690515398979187, "acc": 0.5275362133979797, "length": 1.0, "mode": "test", "epoch": 1}
{"loss": 0.6927586197853088, "acc": 0.534925103187561, "length": 1.8377455472946167, "mode": "train", "epoch": 2}
{"loss": 0.6909665465354919, "acc": 0.532065212726593, "length": 1.0, "mode": "test", "epoch": 2}
{"loss": 0.6728798747062683, "acc": 0.5890440940856934, "length": 1.7321592569351196, "mode": "train", "epoch": 3}
{"loss": 0.6412292718887329, "acc": 0.6099269986152649, "length": 1.7173912525177002, "mode": "test", "epoch": 3}
{"loss": 0.618269145488739, "acc": 0.6674274206161499, "length": 2.140423536300659, "mode": "train", "epoch": 4}
{"loss": 0.5793444514274597, "acc": 0.6950705051422119, "length": 2.4021739959716797, "mode": "test", "epoch": 4}
{"loss": 0.5643839240074158, "acc": 0.7070059180259705, "length": 2.4000275135040283, "mode": "train", "epoch": 5}
{"loss": 0.5348308086395264, "acc": 0.7353770732879639, "length": 2.5217392444610596, "mode": "test", "epoch": 5}
{"loss": 0.5087661743164062, "acc": 0.749525785446167, "length": 2.5637190341949463, "mode": "train", "epoch": 6}
{"loss": 0.48834168910980225, "acc": 0.7754135727882385, "length": 2.92391300201416, "mode": "test", "epoch": 6}
{"loss": 0.46189847588539124, "acc": 0.8010854721069336, "length": 2.8275744915008545, "mode": "train", "epoch": 7}
{"loss": 0.45228633284568787, "acc": 0.7880378365516663, "length": 2.9456522464752197, "mode": "test", "epoch": 7}
{"loss": 0.4392819404602051, "acc": 0.8075773119926453, "length": 2.775205135345459, "mode": "train", "epoch": 8}
{"loss": 0.43472135066986084, "acc": 0.7938756942749023, "length": 2.9347825050354004, "mode": "test", "epoch": 8}
{"loss": 0.4200047552585602, "acc": 0.817565381526947, "length": 2.788731575012207, "mode": "train", "epoch": 9}
{"loss": 0.4310142397880554, "acc": 0.7980998754501343, "length": 2.8152174949645996, "mode": "test", "epoch": 9}
{"loss": 0.4098202586174011, "acc": 0.8220068216323853, "length": 2.669973373413086, "mode": "train", "epoch": 10}
{"loss": 0.4229973256587982, "acc": 0.80815589427948, "length": 3.0, "mode": "test", "epoch": 10}
{"loss": 0.39488810300827026, "acc": 0.827597439289093, "length": 2.7717955112457275, "mode": "train", "epoch": 11}
{"loss": 0.4151884913444519, "acc": 0.8183002471923828, "length": 2.92391300201416, "mode": "test", "epoch": 11}
{"loss": 0.38543832302093506, "acc": 0.8321921229362488, "length": 2.671372413635254, "mode": "train", "epoch": 12}
{"loss": 0.4098156690597534, "acc": 0.8162236213684082, "length": 2.9891304969787598, "mode": "test", "epoch": 12}
{"loss": 0.3735518753528595, "acc": 0.8364611268043518, "length": 2.804933786392212, "mode": "train", "epoch": 13}
{"loss": 0.3925754725933075, "acc": 0.8146676421165466, "length": 2.95652174949646, "mode": "test", "epoch": 13}
{"loss": 0.37483733892440796, "acc": 0.8366326093673706, "length": 2.7675769329071045, "mode": "train", "epoch": 14}
{"loss": 0.3941522538661957, "acc": 0.8221144080162048, "length": 2.9347825050354004, "mode": "test", "epoch": 14}
{"loss": 0.36514952778816223, "acc": 0.8402328491210938, "length": 2.7808382511138916, "mode": "train", "epoch": 15}
{"loss": 0.4020286798477173, "acc": 0.820866584777832, "length": 2.7282607555389404, "mode": "test", "epoch": 15}
{"loss": 0.35907456278800964, "acc": 0.840126097202301, "length": 2.7677829265594482, "mode": "train", "epoch": 16}
{"loss": 0.3821067214012146, "acc": 0.8213706016540527, "length": 2.88043475151062, "mode": "test", "epoch": 16}
{"loss": 0.35473504662513733, "acc": 0.8427298665046692, "length": 2.841773271560669, "mode": "train", "epoch": 17}
{"loss": 0.39354294538497925, "acc": 0.8220549821853638, "length": 2.8043477535247803, "mode": "test", "epoch": 17}
{"loss": 0.35220062732696533, "acc": 0.8438088297843933, "length": 2.772387981414795, "mode": "train", "epoch": 18}
{"loss": 0.38613542914390564, "acc": 0.8225086331367493, "length": 2.92391300201416, "mode": "test", "epoch": 18}
{"loss": 0.3529828190803528, "acc": 0.8469119668006897, "length": 2.8360683917999268, "mode": "train", "epoch": 19}
{"loss": 0.3844318091869354, "acc": 0.8218534588813782, "length": 3.0217392444610596, "mode": "test", "epoch": 19}
{"loss": 0.341577410697937, "acc": 0.8513756394386292, "length": 2.9468581676483154, "mode": "train", "epoch": 20}
{"loss": 0.38431382179260254, "acc": 0.8315073847770691, "length": 2.92391300201416, "mode": "test", "epoch": 20}
{"loss": 0.33736640214920044, "acc": 0.8554004430770874, "length": 2.963219404220581, "mode": "train", "epoch": 21}
{"loss": 0.37716323137283325, "acc": 0.8355742692947388, "length": 2.8840579986572266, "mode": "test", "epoch": 21}
{"loss": 0.3267226815223694, "acc": 0.8576942086219788, "length": 3.015371084213257, "mode": "train", "epoch": 22}
{"loss": 0.37488171458244324, "acc": 0.827246904373169, "length": 3.155797004699707, "mode": "test", "epoch": 22}
{"loss": 0.32177066802978516, "acc": 0.8612973690032959, "length": 3.087897777557373, "mode": "train", "epoch": 23}
{"loss": 0.37397000193595886, "acc": 0.8440324068069458, "length": 3.3514492511749268, "mode": "test", "epoch": 23}
{"loss": 0.31419458985328674, "acc": 0.8662105202674866, "length": 3.2818033695220947, "mode": "train", "epoch": 24}
{"loss": 0.36004745960235596, "acc": 0.853412926197052, "length": 3.4710144996643066, "mode": "test", "epoch": 24}
{"loss": 0.29318520426750183, "acc": 0.8758062720298767, "length": 3.521430730819702, "mode": "train", "epoch": 25}
{"loss": 0.3440106511116028, "acc": 0.8593263626098633, "length": 3.7717392444610596, "mode": "test", "epoch": 25}
{"loss": 0.27890342473983765, "acc": 0.8789133429527283, "length": 3.696923017501831, "mode": "train", "epoch": 26}
{"loss": 0.32735246419906616, "acc": 0.8653094172477722, "length": 3.9347825050354004, "mode": "test", "epoch": 26}
{"loss": 0.2709451913833618, "acc": 0.8851578235626221, "length": 3.8594961166381836, "mode": "train", "epoch": 27}
{"loss": 0.3064241409301758, "acc": 0.8625848293304443, "length": 3.9891304969787598, "mode": "test", "epoch": 27}
{"loss": 0.2634661793708801, "acc": 0.8874532580375671, "length": 3.92850923538208, "mode": "train", "epoch": 28}
{"loss": 0.30527013540267944, "acc": 0.8768115639686584, "length": 4.0, "mode": "test", "epoch": 28}
{"loss": 0.25766608119010925, "acc": 0.8953763842582703, "length": 3.9672160148620605, "mode": "train", "epoch": 29}
{"loss": 0.2947055697441101, "acc": 0.8878622651100159, "length": 4.0, "mode": "test", "epoch": 29}
{"loss": 0.2404215782880783, "acc": 0.9039455056190491, "length": 3.9890329837799072, "mode": "train", "epoch": 30}
{"loss": 0.27507084608078003, "acc": 0.8876811861991882, "length": 4.0, "mode": "test", "epoch": 30}
{"loss": 0.23437418043613434, "acc": 0.906726598739624, "length": 3.995678424835205, "mode": "train", "epoch": 31}
{"loss": 0.28132325410842896, "acc": 0.8884057402610779, "length": 4.0, "mode": "test", "epoch": 31}
{"loss": 0.23385901749134064, "acc": 0.9097527265548706, "length": 3.996187686920166, "mode": "train", "epoch": 32}
{"loss": 0.25403982400894165, "acc": 0.8972825407981873, "length": 4.0, "mode": "test", "epoch": 32}
{"loss": 0.22310882806777954, "acc": 0.914100706577301, "length": 3.996053695678711, "mode": "train", "epoch": 33}
{"loss": 0.2732107639312744, "acc": 0.8929347991943359, "length": 4.0, "mode": "test", "epoch": 33}
{"loss": 0.21424052119255066, "acc": 0.9221020340919495, "length": 3.995234489440918, "mode": "train", "epoch": 34}
{"loss": 0.24720774590969086, "acc": 0.9016304612159729, "length": 4.0, "mode": "test", "epoch": 34}
{"loss": 0.20602065324783325, "acc": 0.9244738817214966, "length": 3.997171640396118, "mode": "train", "epoch": 35}
{"loss": 0.2379404604434967, "acc": 0.9086955189704895, "length": 4.0, "mode": "test", "epoch": 35}
{"loss": 0.19497951865196228, "acc": 0.9275336265563965, "length": 3.9996557235717773, "mode": "train", "epoch": 36}
{"loss": 0.2551657259464264, "acc": 0.902536153793335, "length": 4.0, "mode": "test", "epoch": 36}
{"loss": 0.20211130380630493, "acc": 0.9237380623817444, "length": 3.994377851486206, "mode": "train", "epoch": 37}
{"loss": 0.2599937617778778, "acc": 0.9061594605445862, "length": 4.0, "mode": "test", "epoch": 37}
{"loss": 0.1933533400297165, "acc": 0.9309817552566528, "length": 3.9982478618621826, "mode": "train", "epoch": 38}
{"loss": 0.23995175957679749, "acc": 0.9128623604774475, "length": 4.0, "mode": "test", "epoch": 38}
{"loss": 0.18083907663822174, "acc": 0.9303872585296631, "length": 3.999722480773926, "mode": "train", "epoch": 39}
{"loss": 0.23027876019477844, "acc": 0.9132245779037476, "length": 4.0, "mode": "test", "epoch": 39}
{"loss": 0.17953090369701385, "acc": 0.9365403056144714, "length": 3.9990928173065186, "mode": "train", "epoch": 40}
{"loss": 0.23478470742702484, "acc": 0.9103260636329651, "length": 4.0, "mode": "test", "epoch": 40}
{"loss": 0.19224287569522858, "acc": 0.9299699068069458, "length": 3.999873161315918, "mode": "train", "epoch": 41}
{"loss": 0.2655559182167053, "acc": 0.8985507488250732, "length": 4.0, "mode": "test", "epoch": 41}
{"loss": 0.17848287522792816, "acc": 0.9322266578674316, "length": 3.9974827766418457, "mode": "train", "epoch": 42}
{"loss": 0.21274469792842865, "acc": 0.9114130139350891, "length": 4.0, "mode": "test", "epoch": 42}
{"loss": 0.1659066528081894, "acc": 0.9376779794692993, "length": 3.9999217987060547, "mode": "train", "epoch": 43}
{"loss": 0.22221115231513977, "acc": 0.915217399597168, "length": 4.0, "mode": "test", "epoch": 43}
{"loss": 0.1627708226442337, "acc": 0.9377948045730591, "length": 3.999736785888672, "mode": "train", "epoch": 44}
{"loss": 0.22412365674972534, "acc": 0.917210042476654, "length": 4.0, "mode": "test", "epoch": 44}
{"loss": 0.1597592830657959, "acc": 0.9376357793807983, "length": 3.9970011711120605, "mode": "train", "epoch": 45}
{"loss": 0.2299772948026657, "acc": 0.914130449295044, "length": 4.0, "mode": "test", "epoch": 45}
{"loss": 0.14872968196868896, "acc": 0.9431300759315491, "length": 3.99967360496521, "mode": "train", "epoch": 46}
{"loss": 0.2258041352033615, "acc": 0.9164855480194092, "length": 4.0, "mode": "test", "epoch": 46}
{"loss": 0.15218687057495117, "acc": 0.946793794631958, "length": 3.99761962890625, "mode": "train", "epoch": 47}
{"loss": 0.21255704760551453, "acc": 0.9197463393211365, "length": 4.0, "mode": "test", "epoch": 47}
{"loss": 0.15035374462604523, "acc": 0.9443520903587341, "length": 3.9999074935913086, "mode": "train", "epoch": 48}
{"loss": 0.2053951919078827, "acc": 0.9186593890190125, "length": 4.0, "mode": "test", "epoch": 48}
{"loss": 0.1492076963186264, "acc": 0.9459332227706909, "length": 3.999971628189087, "mode": "train", "epoch": 49}
{"loss": 0.19505152106285095, "acc": 0.9340579509735107, "length": 4.0, "mode": "test", "epoch": 49}
{"loss": 0.15389108657836914, "acc": 0.943868100643158, "length": 3.9999241828918457, "mode": "train", "epoch": 50}
{"loss": 0.22722426056861877, "acc": 0.9114129543304443, "length": 4.0, "mode": "test", "epoch": 50}
{"loss": 0.16079793870449066, "acc": 0.9414952993392944, "length": 3.999753713607788, "mode": "train", "epoch": 51}
{"loss": 0.18213383853435516, "acc": 0.9355071783065796, "length": 4.0, "mode": "test", "epoch": 51}
{"loss": 0.14552266895771027, "acc": 0.948464035987854, "length": 3.999643325805664, "mode": "train", "epoch": 52}
{"loss": 0.18575714528560638, "acc": 0.9277173280715942, "length": 4.0, "mode": "test", "epoch": 52}
{"loss": 0.1412709653377533, "acc": 0.9461766481399536, "length": 3.999990463256836, "mode": "train", "epoch": 53}
{"loss": 0.18750892579555511, "acc": 0.9297102689743042, "length": 4.0, "mode": "test", "epoch": 53}
{"loss": 0.13552212715148926, "acc": 0.9511476755142212, "length": 3.999877452850342, "mode": "train", "epoch": 54}
{"loss": 0.187489315867424, "acc": 0.9313406348228455, "length": 4.0, "mode": "test", "epoch": 54}
{"loss": 0.13421830534934998, "acc": 0.9469656348228455, "length": 3.9999914169311523, "mode": "train", "epoch": 55}
{"loss": 0.19433777034282684, "acc": 0.9322464466094971, "length": 4.0, "mode": "test", "epoch": 55}
{"loss": 0.1260739266872406, "acc": 0.9574442505836487, "length": 3.9973373413085938, "mode": "train", "epoch": 56}
{"loss": 0.18619446456432343, "acc": 0.9217391610145569, "length": 4.0, "mode": "test", "epoch": 56}
{"loss": 0.12645044922828674, "acc": 0.9528499245643616, "length": 3.9999544620513916, "mode": "train", "epoch": 57}
{"loss": 0.201841801404953, "acc": 0.9284419417381287, "length": 4.0, "mode": "test", "epoch": 57}
{"loss": 0.1293281763792038, "acc": 0.9544841647148132, "length": 3.998689889907837, "mode": "train", "epoch": 58}
{"loss": 0.19028240442276, "acc": 0.9365940690040588, "length": 4.0, "mode": "test", "epoch": 58}
{"loss": 0.10696972906589508, "acc": 0.9614672660827637, "length": 3.999972105026245, "mode": "train", "epoch": 59}
{"loss": 0.17800584435462952, "acc": 0.9340579509735107, "length": 4.0, "mode": "test", "epoch": 59}
{"loss": 0.10128934681415558, "acc": 0.9620121121406555, "length": 3.9999489784240723, "mode": "train", "epoch": 60}
{"loss": 0.1855752170085907, "acc": 0.9402172565460205, "length": 4.0, "mode": "test", "epoch": 60}
test accuracy: 0.7638235688209534
