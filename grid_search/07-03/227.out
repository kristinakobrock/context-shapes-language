# ["--attributes=5", "--values=16", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.0005", "--hidden_size=256", "--temp_update=0.99", "--temperature=2"]
Creating train_ds and val_ds...

Creating test_ds...
{"loss": 0.6969742774963379, "acc": 0.5268025994300842, "length": 3.155604362487793, "mode": "train", "epoch": 1}
{"loss": 0.6876317262649536, "acc": 0.5625899434089661, "length": 1.0, "mode": "test", "epoch": 1}
{"loss": 0.6503403186798096, "acc": 0.6087719202041626, "length": 2.2652151584625244, "mode": "train", "epoch": 2}
{"loss": 0.5895245671272278, "acc": 0.7008011341094971, "length": 2.5755395889282227, "mode": "test", "epoch": 2}
{"loss": 0.5308266878128052, "acc": 0.754127562046051, "length": 2.8763720989227295, "mode": "train", "epoch": 3}
{"loss": 0.4800821840763092, "acc": 0.7859043478965759, "length": 3.0179855823516846, "mode": "test", "epoch": 3}
{"loss": 0.43198361992836, "acc": 0.8103406429290771, "length": 3.146127223968506, "mode": "train", "epoch": 4}
{"loss": 0.4425438940525055, "acc": 0.8160394430160522, "length": 3.147481918334961, "mode": "test", "epoch": 4}
{"loss": 0.39186978340148926, "acc": 0.8302518129348755, "length": 3.1342968940734863, "mode": "train", "epoch": 5}
{"loss": 0.43606600165367126, "acc": 0.8186028599739075, "length": 3.4712231159210205, "mode": "test", "epoch": 5}
{"loss": 0.36493974924087524, "acc": 0.8444814085960388, "length": 3.2328920364379883, "mode": "train", "epoch": 6}
{"loss": 0.4241626262664795, "acc": 0.8276222944259644, "length": 3.273381233215332, "mode": "test", "epoch": 6}
{"loss": 0.3454388380050659, "acc": 0.8541392087936401, "length": 3.2813148498535156, "mode": "train", "epoch": 7}
{"loss": 0.38985675573349, "acc": 0.840131938457489, "length": 3.4028778076171875, "mode": "test", "epoch": 7}
{"loss": 0.3277941942214966, "acc": 0.8613322973251343, "length": 3.3185853958129883, "mode": "train", "epoch": 8}
{"loss": 0.3908662497997284, "acc": 0.8470262289047241, "length": 3.4856114387512207, "mode": "test", "epoch": 8}
{"loss": 0.32856664061546326, "acc": 0.8643946051597595, "length": 3.3400678634643555, "mode": "train", "epoch": 9}
{"loss": 0.3780096769332886, "acc": 0.8457642197608948, "length": 3.5, "mode": "test", "epoch": 9}
{"loss": 0.30607399344444275, "acc": 0.8703495860099792, "length": 3.4543468952178955, "mode": "train", "epoch": 10}
{"loss": 0.37985140085220337, "acc": 0.843825101852417, "length": 3.4820144176483154, "mode": "test", "epoch": 10}
{"loss": 0.2958047091960907, "acc": 0.875029444694519, "length": 3.4671618938446045, "mode": "train", "epoch": 11}
{"loss": 0.3908021152019501, "acc": 0.8493025302886963, "length": 3.6870503425598145, "mode": "test", "epoch": 11}
{"loss": 0.28734251856803894, "acc": 0.8779226541519165, "length": 3.541938543319702, "mode": "train", "epoch": 12}
{"loss": 0.38558703660964966, "acc": 0.8525629639625549, "length": 3.758992910385132, "mode": "test", "epoch": 12}
{"loss": 0.2734202742576599, "acc": 0.8843258619308472, "length": 3.592764139175415, "mode": "train", "epoch": 13}
{"loss": 0.373763769865036, "acc": 0.8543277978897095, "length": 3.7661869525909424, "mode": "test", "epoch": 13}
{"loss": 0.2681540846824646, "acc": 0.8894511461257935, "length": 3.61972713470459, "mode": "train", "epoch": 14}
{"loss": 0.33534860610961914, "acc": 0.8637692928314209, "length": 3.8021583557128906, "mode": "test", "epoch": 14}
{"loss": 0.25167566537857056, "acc": 0.8975155353546143, "length": 3.6477086544036865, "mode": "train", "epoch": 15}
{"loss": 0.3091713488101959, "acc": 0.8692206740379333, "length": 3.888489246368408, "mode": "test", "epoch": 15}
{"loss": 0.238540917634964, "acc": 0.9012941122055054, "length": 3.6596200466156006, "mode": "train", "epoch": 16}
{"loss": 0.3196641504764557, "acc": 0.8734411597251892, "length": 3.816546678543091, "mode": "test", "epoch": 16}
{"loss": 0.22444215416908264, "acc": 0.9080066084861755, "length": 3.671419382095337, "mode": "train", "epoch": 17}
{"loss": 0.33917930722236633, "acc": 0.877144992351532, "length": 3.8453238010406494, "mode": "test", "epoch": 17}
{"loss": 0.21271200478076935, "acc": 0.9160419702529907, "length": 3.643592357635498, "mode": "train", "epoch": 18}
{"loss": 0.30529457330703735, "acc": 0.8754138946533203, "length": 3.7553956508636475, "mode": "test", "epoch": 18}
{"loss": 0.2020946592092514, "acc": 0.9180161952972412, "length": 3.6833434104919434, "mode": "train", "epoch": 19}
{"loss": 0.2760827839374542, "acc": 0.8919867277145386, "length": 3.615108013153076, "mode": "test", "epoch": 19}
{"loss": 0.19014301896095276, "acc": 0.9253483414649963, "length": 3.7502849102020264, "mode": "train", "epoch": 20}
{"loss": 0.25378406047821045, "acc": 0.8966307640075684, "length": 3.7769784927368164, "mode": "test", "epoch": 20}
{"loss": 0.18849514424800873, "acc": 0.9267024397850037, "length": 3.768036365509033, "mode": "train", "epoch": 21}
{"loss": 0.2687109112739563, "acc": 0.9059802889823914, "length": 3.748201370239258, "mode": "test", "epoch": 21}
{"loss": 0.18130344152450562, "acc": 0.9301021099090576, "length": 3.7931361198425293, "mode": "train", "epoch": 22}
{"loss": 0.22193367779254913, "acc": 0.914630651473999, "length": 3.83093523979187, "mode": "test", "epoch": 22}
{"loss": 0.158338263630867, "acc": 0.9393066763877869, "length": 3.8279855251312256, "mode": "train", "epoch": 23}
{"loss": 0.23608486354351044, "acc": 0.9121152758598328, "length": 3.83093523979187, "mode": "test", "epoch": 23}
{"loss": 0.1592886745929718, "acc": 0.9376944303512573, "length": 3.8335204124450684, "mode": "train", "epoch": 24}
{"loss": 0.2042650729417801, "acc": 0.9232995510101318, "length": 3.8453238010406494, "mode": "test", "epoch": 24}
{"loss": 0.14932015538215637, "acc": 0.9443257451057434, "length": 3.8599870204925537, "mode": "train", "epoch": 25}
{"loss": 0.20577576756477356, "acc": 0.9194321036338806, "length": 3.841726541519165, "mode": "test", "epoch": 25}
{"loss": 0.14614862203598022, "acc": 0.9438668489456177, "length": 3.8557000160217285, "mode": "train", "epoch": 26}
{"loss": 0.2119903415441513, "acc": 0.9242523908615112, "length": 3.9136691093444824, "mode": "test", "epoch": 26}
{"loss": 0.14148662984371185, "acc": 0.9471114873886108, "length": 3.8842740058898926, "mode": "train", "epoch": 27}
{"loss": 0.20044809579849243, "acc": 0.9322986006736755, "length": 3.8812949657440186, "mode": "test", "epoch": 27}
{"loss": 0.1336756944656372, "acc": 0.9482733011245728, "length": 3.894408941268921, "mode": "train", "epoch": 28}
{"loss": 0.18502923846244812, "acc": 0.9326045513153076, "length": 3.953237295150757, "mode": "test", "epoch": 28}
{"loss": 0.12594708800315857, "acc": 0.9542754292488098, "length": 3.8997416496276855, "mode": "train", "epoch": 29}
{"loss": 0.1871003955602646, "acc": 0.9347964525222778, "length": 3.931654691696167, "mode": "test", "epoch": 29}
{"loss": 0.1314803659915924, "acc": 0.9498805403709412, "length": 3.9184629917144775, "mode": "train", "epoch": 30}
{"loss": 0.17054764926433563, "acc": 0.9406136870384216, "length": 3.9244604110717773, "mode": "test", "epoch": 30}
{"loss": 0.12032493948936462, "acc": 0.9554479122161865, "length": 3.9149699211120605, "mode": "train", "epoch": 31}
{"loss": 0.17629189789295197, "acc": 0.9373145699501038, "length": 3.956834554672241, "mode": "test", "epoch": 31}
{"loss": 0.11691493541002274, "acc": 0.9573055505752563, "length": 3.920301675796509, "mode": "train", "epoch": 32}
{"loss": 0.1831638514995575, "acc": 0.9316996932029724, "length": 3.9460432529449463, "mode": "test", "epoch": 32}
{"loss": 0.11221390217542648, "acc": 0.9594990015029907, "length": 3.92828631401062, "mode": "train", "epoch": 33}
{"loss": 0.16850753128528595, "acc": 0.9425809383392334, "length": 3.989208698272705, "mode": "test", "epoch": 33}
{"loss": 0.105266273021698, "acc": 0.9614943861961365, "length": 3.9567408561706543, "mode": "train", "epoch": 34}
{"loss": 0.16922880709171295, "acc": 0.9386690258979797, "length": 4.0, "mode": "test", "epoch": 34}
{"loss": 0.10852045565843582, "acc": 0.9572669267654419, "length": 3.9685540199279785, "mode": "train", "epoch": 35}
{"loss": 0.17359356582164764, "acc": 0.9431656002998352, "length": 4.0, "mode": "test", "epoch": 35}
{"loss": 0.10669071227312088, "acc": 0.9616135358810425, "length": 3.9673805236816406, "mode": "train", "epoch": 36}
{"loss": 0.17297682166099548, "acc": 0.9327337741851807, "length": 4.0, "mode": "test", "epoch": 36}
{"loss": 0.1082325354218483, "acc": 0.9596357941627502, "length": 3.971007823944092, "mode": "train", "epoch": 37}
{"loss": 0.1803155243396759, "acc": 0.9381295442581177, "length": 4.0, "mode": "test", "epoch": 37}
{"loss": 0.10200399905443192, "acc": 0.9596825838088989, "length": 3.9718780517578125, "mode": "train", "epoch": 38}
{"loss": 0.1863020658493042, "acc": 0.9375900030136108, "length": 4.0, "mode": "test", "epoch": 38}
{"loss": 0.1045217365026474, "acc": 0.9628846049308777, "length": 3.976532459259033, "mode": "train", "epoch": 39}
{"loss": 0.1734105497598648, "acc": 0.944604218006134, "length": 4.0, "mode": "test", "epoch": 39}
{"loss": 0.0966847836971283, "acc": 0.9655822515487671, "length": 3.9782817363739014, "mode": "train", "epoch": 40}
{"loss": 0.16467049717903137, "acc": 0.9465827345848083, "length": 4.0, "mode": "test", "epoch": 40}
{"loss": 0.09157180786132812, "acc": 0.9660376906394958, "length": 3.980167865753174, "mode": "train", "epoch": 41}
{"loss": 0.1454852968454361, "acc": 0.9526978731155396, "length": 4.0, "mode": "test", "epoch": 41}
{"loss": 0.08854498714208603, "acc": 0.9689401388168335, "length": 3.9833455085754395, "mode": "train", "epoch": 42}
{"loss": 0.13465701043605804, "acc": 0.957014262676239, "length": 4.0, "mode": "test", "epoch": 42}
{"loss": 0.08904679119586945, "acc": 0.9670658111572266, "length": 3.9855051040649414, "mode": "train", "epoch": 43}
{"loss": 0.13975729048252106, "acc": 0.951438844203949, "length": 4.0, "mode": "test", "epoch": 43}
{"loss": 0.08587338030338287, "acc": 0.9680433869361877, "length": 3.989474058151245, "mode": "train", "epoch": 44}
{"loss": 0.16041292250156403, "acc": 0.9494604468345642, "length": 4.0, "mode": "test", "epoch": 44}
{"loss": 0.08931615203619003, "acc": 0.9673143625259399, "length": 3.9921040534973145, "mode": "train", "epoch": 45}
{"loss": 0.16868890821933746, "acc": 0.9429857134819031, "length": 4.0, "mode": "test", "epoch": 45}
{"loss": 0.084933340549469, "acc": 0.9687834978103638, "length": 3.9925196170806885, "mode": "train", "epoch": 46}
{"loss": 0.14995639026165009, "acc": 0.946043074131012, "length": 4.0, "mode": "test", "epoch": 46}
{"loss": 0.07099796831607819, "acc": 0.9765494465827942, "length": 3.993161916732788, "mode": "train", "epoch": 47}
{"loss": 0.14258591830730438, "acc": 0.9550359845161438, "length": 4.0, "mode": "test", "epoch": 47}
{"loss": 0.07701928913593292, "acc": 0.9717007875442505, "length": 3.9942574501037598, "mode": "train", "epoch": 48}
{"loss": 0.14885640144348145, "acc": 0.949640154838562, "length": 4.0, "mode": "test", "epoch": 48}
{"loss": 0.07255575805902481, "acc": 0.9729032516479492, "length": 3.9947004318237305, "mode": "train", "epoch": 49}
{"loss": 0.1587424874305725, "acc": 0.9494604468345642, "length": 4.0, "mode": "test", "epoch": 49}
{"loss": 0.06805870682001114, "acc": 0.9758397340774536, "length": 3.995797872543335, "mode": "train", "epoch": 50}
{"loss": 0.14557354152202606, "acc": 0.9375900030136108, "length": 4.0, "mode": "test", "epoch": 50}
{"loss": 0.06419956684112549, "acc": 0.9779978394508362, "length": 3.9964756965637207, "mode": "train", "epoch": 51}
{"loss": 0.16520445048809052, "acc": 0.9460431933403015, "length": 4.0, "mode": "test", "epoch": 51}
{"loss": 0.05989878624677658, "acc": 0.9792285561561584, "length": 3.9977939128875732, "mode": "train", "epoch": 52}
{"loss": 0.12250903993844986, "acc": 0.9597120881080627, "length": 4.0, "mode": "test", "epoch": 52}
{"loss": 0.05158902704715729, "acc": 0.9828388690948486, "length": 3.9976160526275635, "mode": "train", "epoch": 53}
{"loss": 0.12426699697971344, "acc": 0.9618706107139587, "length": 4.0, "mode": "test", "epoch": 53}
{"loss": 0.04533780738711357, "acc": 0.9866620302200317, "length": 3.9970407485961914, "mode": "train", "epoch": 54}
{"loss": 0.13928952813148499, "acc": 0.9546762108802795, "length": 4.0, "mode": "test", "epoch": 54}
{"loss": 0.04130787402391434, "acc": 0.986432671546936, "length": 3.997532844543457, "mode": "train", "epoch": 55}
{"loss": 0.11985712498426437, "acc": 0.966187059879303, "length": 4.0, "mode": "test", "epoch": 55}
{"loss": 0.045320648699998856, "acc": 0.9853677153587341, "length": 3.9984190464019775, "mode": "train", "epoch": 56}
{"loss": 0.10861048102378845, "acc": 0.9665465950965881, "length": 4.0, "mode": "test", "epoch": 56}
{"loss": 0.04332949221134186, "acc": 0.9852575063705444, "length": 3.9967706203460693, "mode": "train", "epoch": 57}
{"loss": 0.11484935879707336, "acc": 0.9679855108261108, "length": 4.0, "mode": "test", "epoch": 57}
{"loss": 0.03376232460141182, "acc": 0.9906437397003174, "length": 3.998034954071045, "mode": "train", "epoch": 58}
{"loss": 0.11830738931894302, "acc": 0.9674462080001831, "length": 4.0, "mode": "test", "epoch": 58}
{"loss": 0.03517866134643555, "acc": 0.9897673726081848, "length": 3.995969533920288, "mode": "train", "epoch": 59}
{"loss": 0.10710003226995468, "acc": 0.9726619720458984, "length": 4.0, "mode": "test", "epoch": 59}
{"loss": 0.030460121110081673, "acc": 0.9919591546058655, "length": 3.997981548309326, "mode": "train", "epoch": 60}
{"loss": 0.13142205774784088, "acc": 0.9642086029052734, "length": 4.0, "mode": "test", "epoch": 60}
test accuracy: 0.8971211910247803
