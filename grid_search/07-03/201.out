# ["--attributes=5", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=128", "--learning_rate=0.0005", "--hidden_size=256", "--temp_update=0.99", "--temperature=1"]
Creating train_ds and val_ds...

Creating test_ds...
{"loss": 0.7032530307769775, "acc": 0.5010289549827576, "length": 3.441861629486084, "mode": "train", "epoch": 1}
{"loss": 0.6912724375724792, "acc": 0.5189003348350525, "length": 1.0, "mode": "test", "epoch": 1}
{"loss": 0.6955721974372864, "acc": 0.5159570574760437, "length": 3.0725009441375732, "mode": "train", "epoch": 2}
{"loss": 0.6937314867973328, "acc": 0.5013746619224548, "length": 1.0, "mode": "test", "epoch": 2}
{"loss": 0.6875988245010376, "acc": 0.5401245355606079, "length": 2.2740097045898438, "mode": "train", "epoch": 3}
{"loss": 0.6903650164604187, "acc": 0.5323023796081543, "length": 1.0, "mode": "test", "epoch": 3}
{"loss": 0.6768732666969299, "acc": 0.5845461487770081, "length": 2.184767723083496, "mode": "train", "epoch": 4}
{"loss": 0.6425001621246338, "acc": 0.6689527034759521, "length": 2.1134021282196045, "mode": "test", "epoch": 4}
{"loss": 0.6399617195129395, "acc": 0.6852790713310242, "length": 2.697038412094116, "mode": "train", "epoch": 5}
{"loss": 0.5797545313835144, "acc": 0.7533571124076843, "length": 3.175257682800293, "mode": "test", "epoch": 5}
{"loss": 0.5731992721557617, "acc": 0.7478564381599426, "length": 3.0073390007019043, "mode": "train", "epoch": 6}
{"loss": 0.5106594562530518, "acc": 0.7718518376350403, "length": 3.2886598110198975, "mode": "test", "epoch": 6}
{"loss": 0.5103050470352173, "acc": 0.7717949151992798, "length": 3.162370204925537, "mode": "train", "epoch": 7}
{"loss": 0.4577474594116211, "acc": 0.8035960793495178, "length": 3.3848798274993896, "mode": "test", "epoch": 7}
{"loss": 0.4757812023162842, "acc": 0.7923956513404846, "length": 3.2611401081085205, "mode": "train", "epoch": 8}
{"loss": 0.42791038751602173, "acc": 0.8165377378463745, "length": 3.450171709060669, "mode": "test", "epoch": 8}
{"loss": 0.4508996307849884, "acc": 0.806876003742218, "length": 3.3398122787475586, "mode": "train", "epoch": 9}
{"loss": 0.3995550274848938, "acc": 0.8322518467903137, "length": 3.494845390319824, "mode": "test", "epoch": 9}
{"loss": 0.42651814222335815, "acc": 0.8185062408447266, "length": 3.4163224697113037, "mode": "train", "epoch": 10}
{"loss": 0.3883307874202728, "acc": 0.8353772163391113, "length": 3.5189003944396973, "mode": "test", "epoch": 10}
{"loss": 0.4099408686161041, "acc": 0.8223811388015747, "length": 3.477487087249756, "mode": "train", "epoch": 11}
{"loss": 0.37721920013427734, "acc": 0.8201618790626526, "length": 3.525773286819458, "mode": "test", "epoch": 11}
{"loss": 0.3921850323677063, "acc": 0.8346762657165527, "length": 3.4592247009277344, "mode": "train", "epoch": 12}
{"loss": 0.3675728440284729, "acc": 0.8378109931945801, "length": 3.546391725540161, "mode": "test", "epoch": 12}
{"loss": 0.3726843595504761, "acc": 0.8441542983055115, "length": 3.4787814617156982, "mode": "train", "epoch": 13}
{"loss": 0.3535880744457245, "acc": 0.8430418372154236, "length": 3.546391725540161, "mode": "test", "epoch": 13}
{"loss": 0.3535175919532776, "acc": 0.8547372817993164, "length": 3.4449832439422607, "mode": "train", "epoch": 14}
{"loss": 0.3419342637062073, "acc": 0.8491888642311096, "length": 3.529209613800049, "mode": "test", "epoch": 14}
{"loss": 0.3345906436443329, "acc": 0.8660405874252319, "length": 3.465373992919922, "mode": "train", "epoch": 15}
{"loss": 0.3236914873123169, "acc": 0.863937258720398, "length": 3.649484634399414, "mode": "test", "epoch": 15}
{"loss": 0.3177609443664551, "acc": 0.8767014145851135, "length": 3.5511972904205322, "mode": "train", "epoch": 16}
{"loss": 0.3201734721660614, "acc": 0.8608783483505249, "length": 3.7594501972198486, "mode": "test", "epoch": 16}
{"loss": 0.2994520366191864, "acc": 0.8824776411056519, "length": 3.6032261848449707, "mode": "train", "epoch": 17}
{"loss": 0.29368123412132263, "acc": 0.8855114579200745, "length": 3.6597938537597656, "mode": "test", "epoch": 17}
{"loss": 0.28722068667411804, "acc": 0.8936301469802856, "length": 3.584594249725342, "mode": "train", "epoch": 18}
{"loss": 0.29059863090515137, "acc": 0.8789967894554138, "length": 3.7147765159606934, "mode": "test", "epoch": 18}
{"loss": 0.275238960981369, "acc": 0.8953578472137451, "length": 3.616830587387085, "mode": "train", "epoch": 19}
{"loss": 0.2828224003314972, "acc": 0.8830975294113159, "length": 3.8109965324401855, "mode": "test", "epoch": 19}
{"loss": 0.26597627997398376, "acc": 0.8976497054100037, "length": 3.6427500247955322, "mode": "train", "epoch": 20}
{"loss": 0.26619774103164673, "acc": 0.8900149464607239, "length": 3.749140977859497, "mode": "test", "epoch": 20}
{"loss": 0.2588893175125122, "acc": 0.9017751812934875, "length": 3.69966983795166, "mode": "train", "epoch": 21}
{"loss": 0.2605741024017334, "acc": 0.8939937949180603, "length": 3.77319598197937, "mode": "test", "epoch": 21}
{"loss": 0.25328388810157776, "acc": 0.9017271995544434, "length": 3.7062065601348877, "mode": "train", "epoch": 22}
{"loss": 0.2612135708332062, "acc": 0.8922479748725891, "length": 3.8625428676605225, "mode": "test", "epoch": 22}
{"loss": 0.24143238365650177, "acc": 0.9098784923553467, "length": 3.7737042903900146, "mode": "train", "epoch": 23}
{"loss": 0.25059080123901367, "acc": 0.8993270397186279, "length": 3.824742317199707, "mode": "test", "epoch": 23}
{"loss": 0.23488323390483856, "acc": 0.9112561345100403, "length": 3.790626049041748, "mode": "train", "epoch": 24}
{"loss": 0.2413444221019745, "acc": 0.9036145806312561, "length": 3.8831615447998047, "mode": "test", "epoch": 24}
{"loss": 0.23012657463550568, "acc": 0.9138801097869873, "length": 3.8505358695983887, "mode": "train", "epoch": 25}
{"loss": 0.24302898347377777, "acc": 0.9048818349838257, "length": 3.9415807723999023, "mode": "test", "epoch": 25}
{"loss": 0.2278074026107788, "acc": 0.9115411043167114, "length": 3.8879804611206055, "mode": "train", "epoch": 26}
{"loss": 0.22930273413658142, "acc": 0.9068989157676697, "length": 3.9587628841400146, "mode": "test", "epoch": 26}
{"loss": 0.21929946541786194, "acc": 0.9144729375839233, "length": 3.8962275981903076, "mode": "train", "epoch": 27}
{"loss": 0.22268635034561157, "acc": 0.9088815450668335, "length": 3.931271553039551, "mode": "test", "epoch": 27}
{"loss": 0.21230930089950562, "acc": 0.9181573987007141, "length": 3.912111282348633, "mode": "train", "epoch": 28}
{"loss": 0.22673062980175018, "acc": 0.9016708135604858, "length": 3.9381444454193115, "mode": "test", "epoch": 28}
{"loss": 0.21366821229457855, "acc": 0.9178568720817566, "length": 3.8991196155548096, "mode": "train", "epoch": 29}
{"loss": 0.22902171313762665, "acc": 0.9077562689781189, "length": 3.9106528759002686, "mode": "test", "epoch": 29}
{"loss": 0.21160461008548737, "acc": 0.9175803661346436, "length": 3.8706209659576416, "mode": "train", "epoch": 30}
{"loss": 0.2288079708814621, "acc": 0.9124454855918884, "length": 3.903779983520508, "mode": "test", "epoch": 30}
{"loss": 0.2140091508626938, "acc": 0.9160029292106628, "length": 3.875420570373535, "mode": "train", "epoch": 31}
{"loss": 0.21558165550231934, "acc": 0.9118515849113464, "length": 3.9587628841400146, "mode": "test", "epoch": 31}
{"loss": 0.20594967901706696, "acc": 0.9189207553863525, "length": 3.9054205417633057, "mode": "train", "epoch": 32}
{"loss": 0.21095973253250122, "acc": 0.9187799096107483, "length": 3.92096209526062, "mode": "test", "epoch": 32}
{"loss": 0.2014056295156479, "acc": 0.9226287603378296, "length": 3.892948865890503, "mode": "train", "epoch": 33}
{"loss": 0.21593394875526428, "acc": 0.9170864820480347, "length": 3.92439866065979, "mode": "test", "epoch": 33}
{"loss": 0.19818507134914398, "acc": 0.9227334260940552, "length": 3.9094839096069336, "mode": "train", "epoch": 34}
{"loss": 0.20380215346813202, "acc": 0.9191683530807495, "length": 3.948453664779663, "mode": "test", "epoch": 34}
{"loss": 0.1970730423927307, "acc": 0.9226359128952026, "length": 3.918084144592285, "mode": "train", "epoch": 35}
{"loss": 0.2104872465133667, "acc": 0.9225618243217468, "length": 3.931271553039551, "mode": "test", "epoch": 35}
{"loss": 0.19170397520065308, "acc": 0.9273807406425476, "length": 3.906646490097046, "mode": "train", "epoch": 36}
{"loss": 0.2021004557609558, "acc": 0.9197260737419128, "length": 3.92096209526062, "mode": "test", "epoch": 36}
{"loss": 0.1863560974597931, "acc": 0.9280766248703003, "length": 3.902682304382324, "mode": "train", "epoch": 37}
{"loss": 0.20702555775642395, "acc": 0.9203312993049622, "length": 3.9381444454193115, "mode": "test", "epoch": 37}
{"loss": 0.18356244266033173, "acc": 0.9293472170829773, "length": 3.930903911590576, "mode": "train", "epoch": 38}
{"loss": 0.19393561780452728, "acc": 0.9222800135612488, "length": 3.945017099380493, "mode": "test", "epoch": 38}
{"loss": 0.18230552971363068, "acc": 0.9315652847290039, "length": 3.93589186668396, "mode": "train", "epoch": 39}
{"loss": 0.19226984679698944, "acc": 0.924967348575592, "length": 3.945017099380493, "mode": "test", "epoch": 39}
{"loss": 0.18249185383319855, "acc": 0.9306829571723938, "length": 3.9281253814697266, "mode": "train", "epoch": 40}
{"loss": 0.1911090612411499, "acc": 0.9268534779548645, "length": 3.948453664779663, "mode": "test", "epoch": 40}
{"loss": 0.18243961036205292, "acc": 0.9288769960403442, "length": 3.939589023590088, "mode": "train", "epoch": 41}
{"loss": 0.1843166947364807, "acc": 0.9272775650024414, "length": 3.951889991760254, "mode": "test", "epoch": 41}
{"loss": 0.1758783906698227, "acc": 0.9333247542381287, "length": 3.923133134841919, "mode": "train", "epoch": 42}
{"loss": 0.1831570565700531, "acc": 0.928900957107544, "length": 3.945017099380493, "mode": "test", "epoch": 42}
{"loss": 0.16962915658950806, "acc": 0.9361798167228699, "length": 3.9297690391540527, "mode": "train", "epoch": 43}
{"loss": 0.1715184450149536, "acc": 0.9358721971511841, "length": 3.945017099380493, "mode": "test", "epoch": 43}
{"loss": 0.16685253381729126, "acc": 0.9354047775268555, "length": 3.9219818115234375, "mode": "train", "epoch": 44}
{"loss": 0.1691141575574875, "acc": 0.9379673004150391, "length": 3.9415807723999023, "mode": "test", "epoch": 44}
{"loss": 0.16623349487781525, "acc": 0.9385303854942322, "length": 3.9113965034484863, "mode": "train", "epoch": 45}
{"loss": 0.16431879997253418, "acc": 0.9390175938606262, "length": 3.9415807723999023, "mode": "test", "epoch": 45}
{"loss": 0.15916524827480316, "acc": 0.9403578639030457, "length": 3.9063870906829834, "mode": "train", "epoch": 46}
{"loss": 0.16842472553253174, "acc": 0.9425531029701233, "length": 3.9415807723999023, "mode": "test", "epoch": 46}
{"loss": 0.15729209780693054, "acc": 0.9418070316314697, "length": 3.9132728576660156, "mode": "train", "epoch": 47}
{"loss": 0.17472299933433533, "acc": 0.9391872882843018, "length": 3.945017099380493, "mode": "test", "epoch": 47}
{"loss": 0.154705211520195, "acc": 0.9461150169372559, "length": 3.9217984676361084, "mode": "train", "epoch": 48}
{"loss": 0.18741831183433533, "acc": 0.9309355616569519, "length": 3.9415807723999023, "mode": "test", "epoch": 48}
{"loss": 0.1609886884689331, "acc": 0.943600058555603, "length": 3.9082627296447754, "mode": "train", "epoch": 49}
{"loss": 0.17045174539089203, "acc": 0.9420908689498901, "length": 3.9347078800201416, "mode": "test", "epoch": 49}
{"loss": 0.1507885903120041, "acc": 0.946621298789978, "length": 3.931154251098633, "mode": "train", "epoch": 50}
{"loss": 0.16807419061660767, "acc": 0.9383456707000732, "length": 3.9347078800201416, "mode": "test", "epoch": 50}
{"loss": 0.15569856762886047, "acc": 0.9468629360198975, "length": 3.919011354446411, "mode": "train", "epoch": 51}
{"loss": 0.16113317012786865, "acc": 0.9424734115600586, "length": 3.945017099380493, "mode": "test", "epoch": 51}
{"loss": 0.14725947380065918, "acc": 0.9482519030570984, "length": 3.936617851257324, "mode": "train", "epoch": 52}
{"loss": 0.16098251938819885, "acc": 0.9495247602462769, "length": 3.951889991760254, "mode": "test", "epoch": 52}
{"loss": 0.15014898777008057, "acc": 0.9473785161972046, "length": 3.947535991668701, "mode": "train", "epoch": 53}
{"loss": 0.16605114936828613, "acc": 0.9426976442337036, "length": 3.948453664779663, "mode": "test", "epoch": 53}
{"loss": 0.151018425822258, "acc": 0.9471796154975891, "length": 3.904493570327759, "mode": "train", "epoch": 54}
{"loss": 0.16345077753067017, "acc": 0.9420711398124695, "length": 3.92439866065979, "mode": "test", "epoch": 54}
{"loss": 0.1416381448507309, "acc": 0.950199544429779, "length": 3.9014179706573486, "mode": "train", "epoch": 55}
{"loss": 0.1741958111524582, "acc": 0.9414398074150085, "length": 3.9072165489196777, "mode": "test", "epoch": 55}
{"loss": 0.1501213163137436, "acc": 0.9482144713401794, "length": 3.8852550983428955, "mode": "train", "epoch": 56}
{"loss": 0.16954104602336884, "acc": 0.9438105225563049, "length": 3.948453664779663, "mode": "test", "epoch": 56}
{"loss": 0.14076292514801025, "acc": 0.9511093497276306, "length": 3.922569990158081, "mode": "train", "epoch": 57}
{"loss": 0.16003891825675964, "acc": 0.945767879486084, "length": 3.92096209526062, "mode": "test", "epoch": 57}
{"loss": 0.13895346224308014, "acc": 0.9518455862998962, "length": 3.898834705352783, "mode": "train", "epoch": 58}
{"loss": 0.18303702771663666, "acc": 0.9399228692054749, "length": 3.9140894412994385, "mode": "test", "epoch": 58}
{"loss": 0.14268076419830322, "acc": 0.9493631720542908, "length": 3.907623767852783, "mode": "train", "epoch": 59}
{"loss": 0.16444949805736542, "acc": 0.9427123069763184, "length": 3.931271553039551, "mode": "test", "epoch": 59}
{"loss": 0.1383085697889328, "acc": 0.9495752453804016, "length": 3.9078357219696045, "mode": "train", "epoch": 60}
{"loss": 0.19004571437835693, "acc": 0.9353147149085999, "length": 3.927834987640381, "mode": "test", "epoch": 60}
test accuracy: 0.8392717838287354
