# ["--attributes=3", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=128", "--learning_rate=0.001", "--hidden_size=256", "--temp_update=0.99", "--temperature=2"]
Creating train_ds and val_ds...

Creating test_ds...
{"loss": 0.7153379917144775, "acc": 0.5012320876121521, "length": 3.3983078002929688, "mode": "train", "epoch": 1}
{"loss": 0.6954011917114258, "acc": 0.5098976492881775, "length": 1.0, "mode": "test", "epoch": 1}
{"loss": 0.7003563642501831, "acc": 0.5163959264755249, "length": 1.9821857213974, "mode": "train", "epoch": 2}
{"loss": 0.6916427612304688, "acc": 0.5319112539291382, "length": 1.0, "mode": "test", "epoch": 2}
{"loss": 0.6937767267227173, "acc": 0.5162641406059265, "length": 1.1007905006408691, "mode": "train", "epoch": 3}
{"loss": 0.693044126033783, "acc": 0.5226961970329285, "length": 1.0, "mode": "test", "epoch": 3}
{"loss": 0.6926833391189575, "acc": 0.5237448811531067, "length": 1.06174898147583, "mode": "train", "epoch": 4}
{"loss": 0.6919991374015808, "acc": 0.5387372970581055, "length": 1.0, "mode": "test", "epoch": 4}
{"loss": 0.6859294176101685, "acc": 0.5453245043754578, "length": 1.2136428356170654, "mode": "train", "epoch": 5}
{"loss": 0.679207980632782, "acc": 0.5475441217422485, "length": 1.2218430042266846, "mode": "test", "epoch": 5}
{"loss": 0.6452395915985107, "acc": 0.6355681419372559, "length": 2.1904382705688477, "mode": "train", "epoch": 6}
{"loss": 0.6173442602157593, "acc": 0.6927488446235657, "length": 2.5665528774261475, "mode": "test", "epoch": 6}
{"loss": 0.5725085735321045, "acc": 0.7200272083282471, "length": 2.6105523109436035, "mode": "train", "epoch": 7}
{"loss": 0.5746314525604248, "acc": 0.7387219667434692, "length": 2.8839590549468994, "mode": "test", "epoch": 7}
{"loss": 0.5219603776931763, "acc": 0.7596509456634521, "length": 2.792710304260254, "mode": "train", "epoch": 8}
{"loss": 0.5369158983230591, "acc": 0.7780367732048035, "length": 3.1706485748291016, "mode": "test", "epoch": 8}
{"loss": 0.4903416931629181, "acc": 0.7778618931770325, "length": 3.080742835998535, "mode": "train", "epoch": 9}
{"loss": 0.521331250667572, "acc": 0.7935335040092468, "length": 3.1911263465881348, "mode": "test", "epoch": 9}
{"loss": 0.4728293716907501, "acc": 0.7946563959121704, "length": 3.175145387649536, "mode": "train", "epoch": 10}
{"loss": 0.4946306645870209, "acc": 0.7954996824264526, "length": 3.3856654167175293, "mode": "test", "epoch": 10}
{"loss": 0.44921258091926575, "acc": 0.8103026747703552, "length": 3.2903270721435547, "mode": "train", "epoch": 11}
{"loss": 0.4595707356929779, "acc": 0.7972510457038879, "length": 3.4061434268951416, "mode": "test", "epoch": 11}
{"loss": 0.4084106385707855, "acc": 0.8273153305053711, "length": 3.346965789794922, "mode": "train", "epoch": 12}
{"loss": 0.4374947249889374, "acc": 0.8153391480445862, "length": 3.6109213829040527, "mode": "test", "epoch": 12}
{"loss": 0.36764174699783325, "acc": 0.8487568497657776, "length": 3.517906904220581, "mode": "train", "epoch": 13}
{"loss": 0.4314016103744507, "acc": 0.8255187273025513, "length": 3.5904436111450195, "mode": "test", "epoch": 13}
{"loss": 0.3400268852710724, "acc": 0.8586962819099426, "length": 3.5202929973602295, "mode": "train", "epoch": 14}
{"loss": 0.4420587718486786, "acc": 0.8243371844291687, "length": 3.6928327083587646, "mode": "test", "epoch": 14}
{"loss": 0.3215775191783905, "acc": 0.8680135011672974, "length": 3.532944679260254, "mode": "train", "epoch": 15}
{"loss": 0.4150291383266449, "acc": 0.8267069458961487, "length": 3.7952218055725098, "mode": "test", "epoch": 15}
{"loss": 0.3027409315109253, "acc": 0.876982569694519, "length": 3.6337971687316895, "mode": "train", "epoch": 16}
{"loss": 0.3892124891281128, "acc": 0.8380962014198303, "length": 3.8054606914520264, "mode": "test", "epoch": 16}
{"loss": 0.2931874692440033, "acc": 0.8794777393341064, "length": 3.639068603515625, "mode": "train", "epoch": 17}
{"loss": 0.38061004877090454, "acc": 0.8515852093696594, "length": 3.8361775875091553, "mode": "test", "epoch": 17}
{"loss": 0.2795878052711487, "acc": 0.8836624026298523, "length": 3.7047762870788574, "mode": "train", "epoch": 18}
{"loss": 0.36072826385498047, "acc": 0.8656744360923767, "length": 3.8054606914520264, "mode": "test", "epoch": 18}
{"loss": 0.2694515585899353, "acc": 0.888220489025116, "length": 3.7280702590942383, "mode": "train", "epoch": 19}
{"loss": 0.3322421908378601, "acc": 0.8681991100311279, "length": 3.8361775875091553, "mode": "test", "epoch": 19}
{"loss": 0.26119694113731384, "acc": 0.897788941860199, "length": 3.7428081035614014, "mode": "train", "epoch": 20}
{"loss": 0.33901938796043396, "acc": 0.8633293509483337, "length": 3.8839590549468994, "mode": "test", "epoch": 20}
{"loss": 0.24323055148124695, "acc": 0.9036770462989807, "length": 3.774991750717163, "mode": "train", "epoch": 21}
{"loss": 0.3132866322994232, "acc": 0.8837217688560486, "length": 3.843003511428833, "mode": "test", "epoch": 21}
{"loss": 0.2312713861465454, "acc": 0.91238933801651, "length": 3.781930446624756, "mode": "train", "epoch": 22}
{"loss": 0.30230578780174255, "acc": 0.8895761370658875, "length": 3.8805460929870605, "mode": "test", "epoch": 22}
{"loss": 0.22350919246673584, "acc": 0.9139634370803833, "length": 3.839994430541992, "mode": "train", "epoch": 23}
{"loss": 0.3032277226448059, "acc": 0.8953198194503784, "length": 3.819112539291382, "mode": "test", "epoch": 23}
{"loss": 0.215002179145813, "acc": 0.9208534955978394, "length": 3.804425001144409, "mode": "train", "epoch": 24}
{"loss": 0.28131043910980225, "acc": 0.896483838558197, "length": 3.839590549468994, "mode": "test", "epoch": 24}
{"loss": 0.2025313675403595, "acc": 0.9274170398712158, "length": 3.853867292404175, "mode": "train", "epoch": 25}
{"loss": 0.2746691405773163, "acc": 0.8993834257125854, "length": 3.8600683212280273, "mode": "test", "epoch": 25}
{"loss": 0.2007611244916916, "acc": 0.9251807928085327, "length": 3.871321678161621, "mode": "train", "epoch": 26}
{"loss": 0.25066742300987244, "acc": 0.9134638905525208, "length": 3.921501636505127, "mode": "test", "epoch": 26}
{"loss": 0.18545468151569366, "acc": 0.9322643280029297, "length": 3.908686399459839, "mode": "train", "epoch": 27}
{"loss": 0.2546980082988739, "acc": 0.9134408235549927, "length": 3.945392608642578, "mode": "test", "epoch": 27}
{"loss": 0.17708517611026764, "acc": 0.9333754181861877, "length": 3.9193170070648193, "mode": "train", "epoch": 28}
{"loss": 0.2634773850440979, "acc": 0.9137042164802551, "length": 3.9590444564819336, "mode": "test", "epoch": 28}
{"loss": 0.17392177879810333, "acc": 0.9363518357276917, "length": 3.923853635787964, "mode": "train", "epoch": 29}
{"loss": 0.23218002915382385, "acc": 0.9127961993217468, "length": 3.96928334236145, "mode": "test", "epoch": 29}
{"loss": 0.1618085354566574, "acc": 0.9422553181648254, "length": 3.943969964981079, "mode": "train", "epoch": 30}
{"loss": 0.2268385887145996, "acc": 0.9233375787734985, "length": 3.979522228240967, "mode": "test", "epoch": 30}
{"loss": 0.14821378886699677, "acc": 0.9439696073532104, "length": 3.9453020095825195, "mode": "train", "epoch": 31}
{"loss": 0.20748114585876465, "acc": 0.9289289116859436, "length": 3.979522228240967, "mode": "test", "epoch": 31}
{"loss": 0.14137953519821167, "acc": 0.9492748379707336, "length": 3.95479416847229, "mode": "train", "epoch": 32}
{"loss": 0.20697328448295593, "acc": 0.9373133778572083, "length": 3.996587038040161, "mode": "test", "epoch": 32}
{"loss": 0.13908249139785767, "acc": 0.9513251185417175, "length": 3.9737470149993896, "mode": "train", "epoch": 33}
{"loss": 0.20302067697048187, "acc": 0.9319113492965698, "length": 4.0, "mode": "test", "epoch": 33}
{"loss": 0.1226983293890953, "acc": 0.9574954509735107, "length": 3.9791462421417236, "mode": "train", "epoch": 34}
{"loss": 0.21729037165641785, "acc": 0.9279864430427551, "length": 4.0, "mode": "test", "epoch": 34}
{"loss": 0.1178966835141182, "acc": 0.9585061073303223, "length": 3.9844844341278076, "mode": "train", "epoch": 35}
{"loss": 0.19704453647136688, "acc": 0.9433447122573853, "length": 4.0, "mode": "test", "epoch": 35}
{"loss": 0.10897266864776611, "acc": 0.9618081450462341, "length": 3.9877166748046875, "mode": "train", "epoch": 36}
{"loss": 0.19672565162181854, "acc": 0.9438565969467163, "length": 4.0, "mode": "test", "epoch": 36}
{"loss": 0.09873546659946442, "acc": 0.9672163724899292, "length": 3.990267276763916, "mode": "train", "epoch": 37}
{"loss": 0.20203129947185516, "acc": 0.9382252097129822, "length": 4.0, "mode": "test", "epoch": 37}
{"loss": 0.0963885709643364, "acc": 0.9653821587562561, "length": 3.9938385486602783, "mode": "train", "epoch": 38}
{"loss": 0.18281924724578857, "acc": 0.9378840327262878, "length": 4.0, "mode": "test", "epoch": 38}
{"loss": 0.09069259464740753, "acc": 0.9648135900497437, "length": 3.9936156272888184, "mode": "train", "epoch": 39}
{"loss": 0.21483437716960907, "acc": 0.939761221408844, "length": 4.0, "mode": "test", "epoch": 39}
{"loss": 0.09527833759784698, "acc": 0.9649680256843567, "length": 3.9957616329193115, "mode": "train", "epoch": 40}
{"loss": 0.1715906262397766, "acc": 0.9472696781158447, "length": 4.0, "mode": "test", "epoch": 40}
{"loss": 0.08630616217851639, "acc": 0.9680732488632202, "length": 3.9957122802734375, "mode": "train", "epoch": 41}
{"loss": 0.16802296042442322, "acc": 0.9479522109031677, "length": 4.0, "mode": "test", "epoch": 41}
{"loss": 0.07170336693525314, "acc": 0.9760523438453674, "length": 3.9960410594940186, "mode": "train", "epoch": 42}
{"loss": 0.1470954716205597, "acc": 0.9494879841804504, "length": 4.0, "mode": "test", "epoch": 42}
{"loss": 0.06885507702827454, "acc": 0.9761883616447449, "length": 3.996445417404175, "mode": "train", "epoch": 43}
{"loss": 0.14699767529964447, "acc": 0.9529009461402893, "length": 4.0, "mode": "test", "epoch": 43}
{"loss": 0.06147536635398865, "acc": 0.97865229845047, "length": 3.9970011711120605, "mode": "train", "epoch": 44}
{"loss": 0.1309426873922348, "acc": 0.9569966793060303, "length": 4.0, "mode": "test", "epoch": 44}
{"loss": 0.05022397264838219, "acc": 0.9824634194374084, "length": 3.996694564819336, "mode": "train", "epoch": 45}
{"loss": 0.1263643503189087, "acc": 0.9634811878204346, "length": 4.0, "mode": "test", "epoch": 45}
{"loss": 0.05197959765791893, "acc": 0.9810156226158142, "length": 3.9964637756347656, "mode": "train", "epoch": 46}
{"loss": 0.11675234884023666, "acc": 0.9680887460708618, "length": 4.0, "mode": "test", "epoch": 46}
{"loss": 0.04431581124663353, "acc": 0.9857832193374634, "length": 3.9969677925109863, "mode": "train", "epoch": 47}
{"loss": 0.11159750074148178, "acc": 0.9631399512290955, "length": 4.0, "mode": "test", "epoch": 47}
{"loss": 0.03841852396726608, "acc": 0.9879105091094971, "length": 3.9962217807769775, "mode": "train", "epoch": 48}
{"loss": 0.08772274851799011, "acc": 0.9800339937210083, "length": 4.0, "mode": "test", "epoch": 48}
{"loss": 0.03728081285953522, "acc": 0.9891006946563721, "length": 3.9976398944854736, "mode": "train", "epoch": 49}
{"loss": 0.08702409267425537, "acc": 0.9773038029670715, "length": 4.0, "mode": "test", "epoch": 49}
{"loss": 0.04080533608794212, "acc": 0.9858028292655945, "length": 3.9979870319366455, "mode": "train", "epoch": 50}
{"loss": 0.09929700940847397, "acc": 0.9728670716285706, "length": 4.0, "mode": "test", "epoch": 50}
{"loss": 0.03404293954372406, "acc": 0.9894011616706848, "length": 3.9980640411376953, "mode": "train", "epoch": 51}
{"loss": 0.11183356493711472, "acc": 0.96621173620224, "length": 4.0, "mode": "test", "epoch": 51}
{"loss": 0.03247016295790672, "acc": 0.9906461834907532, "length": 3.9983069896698, "mode": "train", "epoch": 52}
{"loss": 0.09158290922641754, "acc": 0.9749146699905396, "length": 4.0, "mode": "test", "epoch": 52}
{"loss": 0.03247293829917908, "acc": 0.990336537361145, "length": 3.9990038871765137, "mode": "train", "epoch": 53}
{"loss": 0.07536942511796951, "acc": 0.9726962447166443, "length": 4.0, "mode": "test", "epoch": 53}
{"loss": 0.03274103254079819, "acc": 0.9897626042366028, "length": 3.9989473819732666, "mode": "train", "epoch": 54}
{"loss": 0.07970870286226273, "acc": 0.9779863357543945, "length": 4.0, "mode": "test", "epoch": 54}
{"loss": 0.03496675193309784, "acc": 0.9886947274208069, "length": 3.999427080154419, "mode": "train", "epoch": 55}
{"loss": 0.09667222946882248, "acc": 0.9737200736999512, "length": 4.0, "mode": "test", "epoch": 55}
{"loss": 0.023757237941026688, "acc": 0.9945051074028015, "length": 3.9993157386779785, "mode": "train", "epoch": 56}
{"loss": 0.07537620514631271, "acc": 0.979692816734314, "length": 4.0, "mode": "test", "epoch": 56}
{"loss": 0.02060915343463421, "acc": 0.9955796599388123, "length": 3.9990479946136475, "mode": "train", "epoch": 57}
{"loss": 0.09144130349159241, "acc": 0.9779863953590393, "length": 4.0, "mode": "test", "epoch": 57}
{"loss": 0.02037261426448822, "acc": 0.9926849007606506, "length": 3.999445915222168, "mode": "train", "epoch": 58}
{"loss": 0.06596968322992325, "acc": 0.9791809916496277, "length": 4.0, "mode": "test", "epoch": 58}
{"loss": 0.016307154670357704, "acc": 0.9969620704650879, "length": 3.9993674755096436, "mode": "train", "epoch": 59}
{"loss": 0.06381341069936752, "acc": 0.9868602752685547, "length": 4.0, "mode": "test", "epoch": 59}
{"loss": 0.01202929113060236, "acc": 0.998037576675415, "length": 3.9991509914398193, "mode": "train", "epoch": 60}
{"loss": 0.07086681574583054, "acc": 0.9786689281463623, "length": 4.0, "mode": "test", "epoch": 60}
test accuracy: 0.7977777123451233
