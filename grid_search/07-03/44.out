# ["--attributes=3", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=64", "--learning_rate=0.001", "--hidden_size=256", "--temp_update=0.97", "--temperature=2"]
Creating train_ds and val_ds...

Creating test_ds...
{"loss": 0.7155223488807678, "acc": 0.5186735391616821, "length": 2.5153720378875732, "mode": "train", "epoch": 1}
{"loss": 0.6847429275512695, "acc": 0.5371376872062683, "length": 1.0, "mode": "test", "epoch": 1}
{"loss": 0.6935276985168457, "acc": 0.5077304840087891, "length": 1.032733678817749, "mode": "train", "epoch": 2}
{"loss": 0.6834598779678345, "acc": 0.5376811623573303, "length": 1.0, "mode": "test", "epoch": 2}
{"loss": 0.6902446746826172, "acc": 0.5352787375450134, "length": 1.0089917182922363, "mode": "train", "epoch": 3}
{"loss": 0.683741569519043, "acc": 0.5320652723312378, "length": 1.0, "mode": "test", "epoch": 3}
{"loss": 0.6901915073394775, "acc": 0.5271192789077759, "length": 1.0066075325012207, "mode": "train", "epoch": 4}
{"loss": 0.6823316812515259, "acc": 0.5556159615516663, "length": 1.0, "mode": "test", "epoch": 4}
{"loss": 0.6901804208755493, "acc": 0.5347961783409119, "length": 1.0059701204299927, "mode": "train", "epoch": 5}
{"loss": 0.6829785704612732, "acc": 0.5565217733383179, "length": 1.0, "mode": "test", "epoch": 5}
{"loss": 0.6873624324798584, "acc": 0.5372743606567383, "length": 1.0292327404022217, "mode": "train", "epoch": 6}
{"loss": 0.6825803518295288, "acc": 0.5592390894889832, "length": 1.0, "mode": "test", "epoch": 6}
{"loss": 0.6262070536613464, "acc": 0.6600664258003235, "length": 1.9788230657577515, "mode": "train", "epoch": 7}
{"loss": 0.5875424742698669, "acc": 0.7133033275604248, "length": 2.3731884956359863, "mode": "test", "epoch": 7}
{"loss": 0.5744260549545288, "acc": 0.706400990486145, "length": 2.2839279174804688, "mode": "train", "epoch": 8}
{"loss": 0.5805794596672058, "acc": 0.7236282825469971, "length": 2.17391300201416, "mode": "test", "epoch": 8}
{"loss": 0.5608702898025513, "acc": 0.7131311297416687, "length": 2.095196008682251, "mode": "train", "epoch": 9}
{"loss": 0.5580310821533203, "acc": 0.7154557704925537, "length": 2.0652174949645996, "mode": "test", "epoch": 9}
{"loss": 0.5499503016471863, "acc": 0.7112408876419067, "length": 2.0481226444244385, "mode": "train", "epoch": 10}
{"loss": 0.5635597705841064, "acc": 0.7180383801460266, "length": 2.1086957454681396, "mode": "test", "epoch": 10}
{"loss": 0.5287094116210938, "acc": 0.7222285866737366, "length": 2.380826473236084, "mode": "train", "epoch": 11}
{"loss": 0.520523726940155, "acc": 0.7218478322029114, "length": 2.5, "mode": "test", "epoch": 11}
{"loss": 0.5005630254745483, "acc": 0.7451816201210022, "length": 2.785684585571289, "mode": "train", "epoch": 12}
{"loss": 0.5091203451156616, "acc": 0.7386074066162109, "length": 2.92391300201416, "mode": "test", "epoch": 12}
{"loss": 0.48172199726104736, "acc": 0.7672868967056274, "length": 3.003713607788086, "mode": "train", "epoch": 13}
{"loss": 0.5246960520744324, "acc": 0.7453544735908508, "length": 2.7826087474823, "mode": "test", "epoch": 13}
{"loss": 0.4644445478916168, "acc": 0.7717612385749817, "length": 3.0146689414978027, "mode": "train", "epoch": 14}
{"loss": 0.48308950662612915, "acc": 0.7721444964408875, "length": 2.82608699798584, "mode": "test", "epoch": 14}
{"loss": 0.4386914372444153, "acc": 0.7902093529701233, "length": 3.133646249771118, "mode": "train", "epoch": 15}
{"loss": 0.45501062273979187, "acc": 0.7961333394050598, "length": 2.9347825050354004, "mode": "test", "epoch": 15}
{"loss": 0.40656429529190063, "acc": 0.8161829710006714, "length": 3.3211240768432617, "mode": "train", "epoch": 16}
{"loss": 0.4283830225467682, "acc": 0.8034329414367676, "length": 3.45652174949646, "mode": "test", "epoch": 16}
{"loss": 0.369030624628067, "acc": 0.8349218368530273, "length": 3.4040307998657227, "mode": "train", "epoch": 17}
{"loss": 0.36685436964035034, "acc": 0.8326014280319214, "length": 3.45652174949646, "mode": "test", "epoch": 17}
{"loss": 0.33413416147232056, "acc": 0.8526145219802856, "length": 3.4278311729431152, "mode": "train", "epoch": 18}
{"loss": 0.33805593848228455, "acc": 0.8588880896568298, "length": 3.32608699798584, "mode": "test", "epoch": 18}
{"loss": 0.28555241227149963, "acc": 0.8857672214508057, "length": 3.423708915710449, "mode": "train", "epoch": 19}
{"loss": 0.3017098903656006, "acc": 0.8673585057258606, "length": 3.4456522464752197, "mode": "test", "epoch": 19}
{"loss": 0.2649971842765808, "acc": 0.8945198655128479, "length": 3.4294064044952393, "mode": "train", "epoch": 20}
{"loss": 0.3014511466026306, "acc": 0.8748164772987366, "length": 3.42391300201416, "mode": "test", "epoch": 20}
{"loss": 0.2601330280303955, "acc": 0.8966853022575378, "length": 3.4271605014801025, "mode": "train", "epoch": 21}
{"loss": 0.2991950213909149, "acc": 0.8833582997322083, "length": 3.32608699798584, "mode": "test", "epoch": 21}
{"loss": 0.24248646199703217, "acc": 0.905226469039917, "length": 3.4682164192199707, "mode": "train", "epoch": 22}
{"loss": 0.3000813126564026, "acc": 0.8756464123725891, "length": 3.4673912525177, "mode": "test", "epoch": 22}
{"loss": 0.23853132128715515, "acc": 0.9050484299659729, "length": 3.4697892665863037, "mode": "train", "epoch": 23}
{"loss": 0.2932421863079071, "acc": 0.8788377046585083, "length": 3.5471014976501465, "mode": "test", "epoch": 23}
{"loss": 0.23994837701320648, "acc": 0.9060044288635254, "length": 3.4744625091552734, "mode": "train", "epoch": 24}
{"loss": 0.29216763377189636, "acc": 0.890910804271698, "length": 3.3478260040283203, "mode": "test", "epoch": 24}
{"loss": 0.23484401404857635, "acc": 0.9065543413162231, "length": 3.5348548889160156, "mode": "train", "epoch": 25}
{"loss": 0.2850506603717804, "acc": 0.8797463178634644, "length": 3.45652174949646, "mode": "test", "epoch": 25}
{"loss": 0.22946617007255554, "acc": 0.9089835286140442, "length": 3.491488218307495, "mode": "train", "epoch": 26}
{"loss": 0.25956857204437256, "acc": 0.8940829038619995, "length": 3.4673912525177, "mode": "test", "epoch": 26}
{"loss": 0.21876005828380585, "acc": 0.9124760031700134, "length": 3.525942802429199, "mode": "train", "epoch": 27}
{"loss": 0.2517843246459961, "acc": 0.9013309478759766, "length": 3.4673912525177, "mode": "test", "epoch": 27}
{"loss": 0.2103102058172226, "acc": 0.916891872882843, "length": 3.528502941131592, "mode": "train", "epoch": 28}
{"loss": 0.2332986444234848, "acc": 0.9096733331680298, "length": 3.449275255203247, "mode": "test", "epoch": 28}
{"loss": 0.20691710710525513, "acc": 0.9182820916175842, "length": 3.51359224319458, "mode": "train", "epoch": 29}
{"loss": 0.24251993000507355, "acc": 0.9062455296516418, "length": 3.4456522464752197, "mode": "test", "epoch": 29}
{"loss": 0.20199257135391235, "acc": 0.9176929593086243, "length": 3.5401980876922607, "mode": "train", "epoch": 30}
{"loss": 0.2408706694841385, "acc": 0.9053148031234741, "length": 3.449275255203247, "mode": "test", "epoch": 30}
{"loss": 0.20214250683784485, "acc": 0.9178673624992371, "length": 3.5306661128997803, "mode": "train", "epoch": 31}
{"loss": 0.251293808221817, "acc": 0.9128261208534241, "length": 3.5217392444610596, "mode": "test", "epoch": 31}
{"loss": 0.1913851499557495, "acc": 0.9206717610359192, "length": 3.5469768047332764, "mode": "train", "epoch": 32}
{"loss": 0.2420402318239212, "acc": 0.9062511324882507, "length": 3.5108695030212402, "mode": "test", "epoch": 32}
{"loss": 0.1820341944694519, "acc": 0.9304781556129456, "length": 3.4918320178985596, "mode": "train", "epoch": 33}
{"loss": 0.23627237975597382, "acc": 0.9094792008399963, "length": 3.449275255203247, "mode": "test", "epoch": 33}
{"loss": 0.1792454719543457, "acc": 0.9302917718887329, "length": 3.5204622745513916, "mode": "train", "epoch": 34}
{"loss": 0.2155790627002716, "acc": 0.9210218191146851, "length": 3.431159496307373, "mode": "test", "epoch": 34}
{"loss": 0.16784809529781342, "acc": 0.9371888041496277, "length": 3.5348758697509766, "mode": "train", "epoch": 35}
{"loss": 0.20662449300289154, "acc": 0.9219831228256226, "length": 3.492753505706787, "mode": "test", "epoch": 35}
{"loss": 0.14736977219581604, "acc": 0.9485126733779907, "length": 3.681513786315918, "mode": "train", "epoch": 36}
{"loss": 0.2247331589460373, "acc": 0.9269134402275085, "length": 3.7173912525177, "mode": "test", "epoch": 36}
{"loss": 0.14844515919685364, "acc": 0.9459006786346436, "length": 3.725635528564453, "mode": "train", "epoch": 37}
{"loss": 0.19106388092041016, "acc": 0.9246371984481812, "length": 3.7826087474823, "mode": "test", "epoch": 37}
{"loss": 0.13079611957073212, "acc": 0.9543464183807373, "length": 3.801070213317871, "mode": "train", "epoch": 38}
{"loss": 0.18302515149116516, "acc": 0.9399768114089966, "length": 3.8297102451324463, "mode": "test", "epoch": 38}
{"loss": 0.12513835728168488, "acc": 0.955583393573761, "length": 3.8330602645874023, "mode": "train", "epoch": 39}
{"loss": 0.18518424034118652, "acc": 0.9329195022583008, "length": 3.7789855003356934, "mode": "test", "epoch": 39}
{"loss": 0.12068921327590942, "acc": 0.9553919434547424, "length": 3.845445394515991, "mode": "train", "epoch": 40}
{"loss": 0.1738707274198532, "acc": 0.9394701719284058, "length": 3.938405752182007, "mode": "test", "epoch": 40}
{"loss": 0.11945757269859314, "acc": 0.9555835127830505, "length": 3.9089462757110596, "mode": "train", "epoch": 41}
{"loss": 0.2631824016571045, "acc": 0.9294468760490417, "length": 3.9456522464752197, "mode": "test", "epoch": 41}
{"loss": 0.12429707497358322, "acc": 0.9549943208694458, "length": 3.9131996631622314, "mode": "train", "epoch": 42}
{"loss": 0.19112803041934967, "acc": 0.9433706402778625, "length": 3.9275362491607666, "mode": "test", "epoch": 42}
{"loss": 0.12418939918279648, "acc": 0.953605592250824, "length": 3.922390937805176, "mode": "train", "epoch": 43}
{"loss": 0.20108509063720703, "acc": 0.9340013265609741, "length": 3.949275255203247, "mode": "test", "epoch": 43}
{"loss": 0.1325438916683197, "acc": 0.9527040719985962, "length": 3.941725969314575, "mode": "train", "epoch": 44}
{"loss": 0.24637547135353088, "acc": 0.935886561870575, "length": 3.974637746810913, "mode": "test", "epoch": 44}
{"loss": 0.127584308385849, "acc": 0.9567065834999084, "length": 3.9501330852508545, "mode": "train", "epoch": 45}
{"loss": 0.16922160983085632, "acc": 0.9344090819358826, "length": 3.992753505706787, "mode": "test", "epoch": 45}
{"loss": 0.13237948715686798, "acc": 0.9531837105751038, "length": 3.979471206665039, "mode": "train", "epoch": 46}
{"loss": 0.18866141140460968, "acc": 0.9396739602088928, "length": 4.0, "mode": "test", "epoch": 46}
{"loss": 0.11902480572462082, "acc": 0.9551502466201782, "length": 3.9780759811401367, "mode": "train", "epoch": 47}
{"loss": 0.1642656773328781, "acc": 0.9367555379867554, "length": 3.9963767528533936, "mode": "test", "epoch": 47}
{"loss": 0.11780638247728348, "acc": 0.9589941501617432, "length": 3.9811267852783203, "mode": "train", "epoch": 48}
{"loss": 0.1431775838136673, "acc": 0.9494564533233643, "length": 4.0, "mode": "test", "epoch": 48}
{"loss": 0.10186027735471725, "acc": 0.9630106091499329, "length": 3.983643054962158, "mode": "train", "epoch": 49}
{"loss": 0.15013642609119415, "acc": 0.948369562625885, "length": 4.0, "mode": "test", "epoch": 49}
{"loss": 0.10434845089912415, "acc": 0.9608153104782104, "length": 3.9899919033050537, "mode": "train", "epoch": 50}
{"loss": 0.1513819545507431, "acc": 0.9501811861991882, "length": 4.0, "mode": "test", "epoch": 50}
{"loss": 0.10932738333940506, "acc": 0.9588431715965271, "length": 3.9921345710754395, "mode": "train", "epoch": 51}
{"loss": 0.14970509707927704, "acc": 0.9534420967102051, "length": 4.0, "mode": "test", "epoch": 51}
{"loss": 0.10099790245294571, "acc": 0.9614657759666443, "length": 3.995530128479004, "mode": "train", "epoch": 52}
{"loss": 0.1573929637670517, "acc": 0.9436594843864441, "length": 4.0, "mode": "test", "epoch": 52}
{"loss": 0.10166248679161072, "acc": 0.9612122774124146, "length": 3.9960777759552, "mode": "train", "epoch": 53}
{"loss": 0.15350845456123352, "acc": 0.948369562625885, "length": 4.0, "mode": "test", "epoch": 53}
{"loss": 0.099345862865448, "acc": 0.9631689786911011, "length": 3.994309186935425, "mode": "train", "epoch": 54}
{"loss": 0.1552702635526657, "acc": 0.945652186870575, "length": 4.0, "mode": "test", "epoch": 54}
{"loss": 0.09825526922941208, "acc": 0.9627923965454102, "length": 3.997030258178711, "mode": "train", "epoch": 55}
{"loss": 0.13464026153087616, "acc": 0.9521738886833191, "length": 4.0, "mode": "test", "epoch": 55}
{"loss": 0.09745872020721436, "acc": 0.9635649919509888, "length": 3.993906259536743, "mode": "train", "epoch": 56}
{"loss": 0.12213436514139175, "acc": 0.9572464227676392, "length": 4.0, "mode": "test", "epoch": 56}
{"loss": 0.09888041019439697, "acc": 0.961703896522522, "length": 3.9980545043945312, "mode": "train", "epoch": 57}
{"loss": 0.1714344024658203, "acc": 0.9355072975158691, "length": 4.0, "mode": "test", "epoch": 57}
{"loss": 0.10443411767482758, "acc": 0.958489179611206, "length": 3.998462677001953, "mode": "train", "epoch": 58}
{"loss": 0.1576702892780304, "acc": 0.9489131569862366, "length": 4.0, "mode": "test", "epoch": 58}
{"loss": 0.09916465729475021, "acc": 0.9640088081359863, "length": 3.998939037322998, "mode": "train", "epoch": 59}
{"loss": 0.1652204841375351, "acc": 0.9505434036254883, "length": 4.0, "mode": "test", "epoch": 59}
{"loss": 0.09572698920965195, "acc": 0.9614715576171875, "length": 3.9973840713500977, "mode": "train", "epoch": 60}
{"loss": 0.16566063463687897, "acc": 0.9467393159866333, "length": 4.0, "mode": "test", "epoch": 60}
test accuracy: 0.9066177606582642
