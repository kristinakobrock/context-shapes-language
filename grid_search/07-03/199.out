# ["--attributes=5", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=128", "--learning_rate=0.0005", "--hidden_size=256", "--temp_update=0.97", "--temperature=1.5"]
Creating train_ds and val_ds...

Creating test_ds...
{"loss": 0.7007401585578918, "acc": 0.514829695224762, "length": 3.5074410438537598, "mode": "train", "epoch": 1}
{"loss": 0.6879024505615234, "acc": 0.5282686352729797, "length": 1.0, "mode": "test", "epoch": 1}
{"loss": 0.6934215426445007, "acc": 0.5250211954116821, "length": 3.154796600341797, "mode": "train", "epoch": 2}
{"loss": 0.6898662447929382, "acc": 0.528445303440094, "length": 1.0, "mode": "test", "epoch": 2}
{"loss": 0.6878649592399597, "acc": 0.5427578091621399, "length": 2.5522024631500244, "mode": "train", "epoch": 3}
{"loss": 0.6895790100097656, "acc": 0.524558424949646, "length": 1.0, "mode": "test", "epoch": 3}
{"loss": 0.6789014339447021, "acc": 0.5701290965080261, "length": 2.535409927368164, "mode": "train", "epoch": 4}
{"loss": 0.6578428149223328, "acc": 0.6357755661010742, "length": 1.8162543773651123, "mode": "test", "epoch": 4}
{"loss": 0.6511034965515137, "acc": 0.6496574878692627, "length": 2.8120508193969727, "mode": "train", "epoch": 5}
{"loss": 0.5991755723953247, "acc": 0.7511420249938965, "length": 2.752650260925293, "mode": "test", "epoch": 5}
{"loss": 0.5880205035209656, "acc": 0.7304630279541016, "length": 3.0444891452789307, "mode": "train", "epoch": 6}
{"loss": 0.5327779054641724, "acc": 0.7973915338516235, "length": 2.9964663982391357, "mode": "test", "epoch": 6}
{"loss": 0.510791003704071, "acc": 0.7967005372047424, "length": 3.1515164375305176, "mode": "train", "epoch": 7}
{"loss": 0.46519070863723755, "acc": 0.8075729608535767, "length": 3.2226147651672363, "mode": "test", "epoch": 7}
{"loss": 0.4311610758304596, "acc": 0.8316926956176758, "length": 3.394697666168213, "mode": "train", "epoch": 8}
{"loss": 0.4304546117782593, "acc": 0.8234208822250366, "length": 3.4452297687530518, "mode": "test", "epoch": 8}
{"loss": 0.3773365616798401, "acc": 0.8415941596031189, "length": 3.510063648223877, "mode": "train", "epoch": 9}
{"loss": 0.4153441786766052, "acc": 0.818032443523407, "length": 3.4699647426605225, "mode": "test", "epoch": 9}
{"loss": 0.3504173457622528, "acc": 0.848720133304596, "length": 3.4922244548797607, "mode": "train", "epoch": 10}
{"loss": 0.40290185809135437, "acc": 0.8131772875785828, "length": 3.565371036529541, "mode": "test", "epoch": 10}
{"loss": 0.3393732011318207, "acc": 0.8527176380157471, "length": 3.5624873638153076, "mode": "train", "epoch": 11}
{"loss": 0.3774559497833252, "acc": 0.8442730903625488, "length": 3.636042356491089, "mode": "test", "epoch": 11}
{"loss": 0.32044482231140137, "acc": 0.8630613088607788, "length": 3.6403770446777344, "mode": "train", "epoch": 12}
{"loss": 0.357313871383667, "acc": 0.8560985326766968, "length": 3.8021202087402344, "mode": "test", "epoch": 12}
{"loss": 0.31747955083847046, "acc": 0.8615665435791016, "length": 3.7400360107421875, "mode": "train", "epoch": 13}
{"loss": 0.3418353497982025, "acc": 0.8655070662498474, "length": 3.8621907234191895, "mode": "test", "epoch": 13}
{"loss": 0.3041232228279114, "acc": 0.868893027305603, "length": 3.828955888748169, "mode": "train", "epoch": 14}
{"loss": 0.3305453360080719, "acc": 0.8667723536491394, "length": 3.840989351272583, "mode": "test", "epoch": 14}
{"loss": 0.29545655846595764, "acc": 0.8707461357116699, "length": 3.8127715587615967, "mode": "train", "epoch": 15}
{"loss": 0.33163580298423767, "acc": 0.8619059324264526, "length": 3.826855182647705, "mode": "test", "epoch": 15}
{"loss": 0.2888011634349823, "acc": 0.8754744529724121, "length": 3.8339123725891113, "mode": "train", "epoch": 16}
{"loss": 0.32202571630477905, "acc": 0.8746502995491028, "length": 3.8480565547943115, "mode": "test", "epoch": 16}
{"loss": 0.27975913882255554, "acc": 0.876847505569458, "length": 3.8555939197540283, "mode": "train", "epoch": 17}
{"loss": 0.3172250986099243, "acc": 0.877677857875824, "length": 3.869257926940918, "mode": "test", "epoch": 17}
{"loss": 0.2784792184829712, "acc": 0.8793128132820129, "length": 3.8647608757019043, "mode": "train", "epoch": 18}
{"loss": 0.31532496213912964, "acc": 0.8715894222259521, "length": 3.8763251304626465, "mode": "test", "epoch": 18}
{"loss": 0.2668902277946472, "acc": 0.8839318752288818, "length": 3.8770816326141357, "mode": "train", "epoch": 19}
{"loss": 0.2946009635925293, "acc": 0.8839866518974304, "length": 3.901060104370117, "mode": "test", "epoch": 19}
{"loss": 0.2542964816093445, "acc": 0.8920961618423462, "length": 3.890943765640259, "mode": "train", "epoch": 20}
{"loss": 0.2882252633571625, "acc": 0.8927925825119019, "length": 3.939929246902466, "mode": "test", "epoch": 20}
{"loss": 0.246306911110878, "acc": 0.8948068618774414, "length": 3.9089291095733643, "mode": "train", "epoch": 21}
{"loss": 0.2845478057861328, "acc": 0.8805498480796814, "length": 3.9469964504241943, "mode": "test", "epoch": 21}
{"loss": 0.2334102839231491, "acc": 0.9029977917671204, "length": 3.9160988330841064, "mode": "train", "epoch": 22}
{"loss": 0.2704073190689087, "acc": 0.8951088786125183, "length": 3.9646642208099365, "mode": "test", "epoch": 22}
{"loss": 0.22565069794654846, "acc": 0.9066547155380249, "length": 3.9409971237182617, "mode": "train", "epoch": 23}
{"loss": 0.26018601655960083, "acc": 0.9022581577301025, "length": 3.9929327964782715, "mode": "test", "epoch": 23}
{"loss": 0.21937409043312073, "acc": 0.9103083610534668, "length": 3.95353102684021, "mode": "train", "epoch": 24}
{"loss": 0.2572709023952484, "acc": 0.9120141267776489, "length": 4.0, "mode": "test", "epoch": 24}
{"loss": 0.21320264041423798, "acc": 0.9120697379112244, "length": 3.9623289108276367, "mode": "train", "epoch": 25}
{"loss": 0.2620820701122284, "acc": 0.9081271290779114, "length": 4.0, "mode": "test", "epoch": 25}
{"loss": 0.20757074654102325, "acc": 0.921248197555542, "length": 3.9727137088775635, "mode": "train", "epoch": 26}
{"loss": 0.2679084539413452, "acc": 0.9194345474243164, "length": 4.0, "mode": "test", "epoch": 26}
{"loss": 0.19878938794136047, "acc": 0.9188104867935181, "length": 3.970980405807495, "mode": "train", "epoch": 27}
{"loss": 0.2631884515285492, "acc": 0.9054771661758423, "length": 4.0, "mode": "test", "epoch": 27}
{"loss": 0.19372116029262543, "acc": 0.9184539318084717, "length": 3.973400592803955, "mode": "train", "epoch": 28}
{"loss": 0.23689770698547363, "acc": 0.9174911379814148, "length": 4.0, "mode": "test", "epoch": 28}
{"loss": 0.18911132216453552, "acc": 0.9237261414527893, "length": 3.9901342391967773, "mode": "train", "epoch": 29}
{"loss": 0.23028156161308289, "acc": 0.9091873168945312, "length": 4.0, "mode": "test", "epoch": 29}
{"loss": 0.18567036092281342, "acc": 0.9254040122032166, "length": 3.988671064376831, "mode": "train", "epoch": 30}
{"loss": 0.23269431293010712, "acc": 0.9148409962654114, "length": 4.0, "mode": "test", "epoch": 30}
{"loss": 0.18154209852218628, "acc": 0.9283065795898438, "length": 3.9922618865966797, "mode": "train", "epoch": 31}
{"loss": 0.21766123175621033, "acc": 0.9212014675140381, "length": 4.0, "mode": "test", "epoch": 31}
{"loss": 0.17827971279621124, "acc": 0.9293611645698547, "length": 3.993807315826416, "mode": "train", "epoch": 32}
{"loss": 0.23235735297203064, "acc": 0.909363865852356, "length": 4.0, "mode": "test", "epoch": 32}
{"loss": 0.17372876405715942, "acc": 0.9288337230682373, "length": 3.9941225051879883, "mode": "train", "epoch": 33}
{"loss": 0.20235833525657654, "acc": 0.9236747026443481, "length": 4.0, "mode": "test", "epoch": 33}
{"loss": 0.17834356427192688, "acc": 0.9253435730934143, "length": 3.9941751956939697, "mode": "train", "epoch": 34}
{"loss": 0.2124072015285492, "acc": 0.9166077375411987, "length": 4.0, "mode": "test", "epoch": 34}
{"loss": 0.17120692133903503, "acc": 0.9334376454353333, "length": 3.9932870864868164, "mode": "train", "epoch": 35}
{"loss": 0.2181667983531952, "acc": 0.9204946160316467, "length": 4.0, "mode": "test", "epoch": 35}
{"loss": 0.17560268938541412, "acc": 0.9272319674491882, "length": 3.9969518184661865, "mode": "train", "epoch": 36}
{"loss": 0.2079104781150818, "acc": 0.9224382042884827, "length": 4.0, "mode": "test", "epoch": 36}
{"loss": 0.16941127181053162, "acc": 0.9324662685394287, "length": 3.995494842529297, "mode": "train", "epoch": 37}
{"loss": 0.2113034725189209, "acc": 0.9261482954025269, "length": 4.0, "mode": "test", "epoch": 37}
{"loss": 0.17496582865715027, "acc": 0.932532787322998, "length": 3.9962430000305176, "mode": "train", "epoch": 38}
{"loss": 0.2287009060382843, "acc": 0.9189046621322632, "length": 4.0, "mode": "test", "epoch": 38}
{"loss": 0.16842731833457947, "acc": 0.9327549934387207, "length": 3.998875379562378, "mode": "train", "epoch": 39}
{"loss": 0.20269469916820526, "acc": 0.9279149770736694, "length": 4.0, "mode": "test", "epoch": 39}
{"loss": 0.17340870201587677, "acc": 0.9348207116127014, "length": 3.99815034866333, "mode": "train", "epoch": 40}
{"loss": 0.20933577418327332, "acc": 0.927738606929779, "length": 4.0, "mode": "test", "epoch": 40}
{"loss": 0.16420571506023407, "acc": 0.9368089437484741, "length": 3.9979159832000732, "mode": "train", "epoch": 41}
{"loss": 0.19722256064414978, "acc": 0.9240282773971558, "length": 4.0, "mode": "test", "epoch": 41}
{"loss": 0.1615152359008789, "acc": 0.9384673833847046, "length": 3.9938266277313232, "mode": "train", "epoch": 42}
{"loss": 0.20604535937309265, "acc": 0.922791600227356, "length": 4.0, "mode": "test", "epoch": 42}
{"loss": 0.15780115127563477, "acc": 0.9410380125045776, "length": 3.992521286010742, "mode": "train", "epoch": 43}
{"loss": 0.21265357732772827, "acc": 0.9164311289787292, "length": 4.0, "mode": "test", "epoch": 43}
{"loss": 0.1564057469367981, "acc": 0.9362809062004089, "length": 3.997623920440674, "mode": "train", "epoch": 44}
{"loss": 0.20917271077632904, "acc": 0.9222614765167236, "length": 4.0, "mode": "test", "epoch": 44}
{"loss": 0.15718822181224823, "acc": 0.936873197555542, "length": 3.997438430786133, "mode": "train", "epoch": 45}
{"loss": 0.19099532067775726, "acc": 0.934628963470459, "length": 4.0, "mode": "test", "epoch": 45}
{"loss": 0.15828882157802582, "acc": 0.935577929019928, "length": 3.998441696166992, "mode": "train", "epoch": 46}
{"loss": 0.19209007918834686, "acc": 0.9298588633537292, "length": 4.0, "mode": "test", "epoch": 46}
{"loss": 0.1483665257692337, "acc": 0.9419814348220825, "length": 3.9976084232330322, "mode": "train", "epoch": 47}
{"loss": 0.20739039778709412, "acc": 0.9210246205329895, "length": 4.0, "mode": "test", "epoch": 47}
{"loss": 0.14785951375961304, "acc": 0.9414938688278198, "length": 3.999447822570801, "mode": "train", "epoch": 48}
{"loss": 0.20460554957389832, "acc": 0.9192580580711365, "length": 4.0, "mode": "test", "epoch": 48}
{"loss": 0.1416534036397934, "acc": 0.9460010528564453, "length": 3.9986205101013184, "mode": "train", "epoch": 49}
{"loss": 0.1961977481842041, "acc": 0.9296820163726807, "length": 4.0, "mode": "test", "epoch": 49}
{"loss": 0.13874739408493042, "acc": 0.9404290914535522, "length": 3.999405860900879, "mode": "train", "epoch": 50}
{"loss": 0.19709905982017517, "acc": 0.9254416823387146, "length": 4.0, "mode": "test", "epoch": 50}
{"loss": 0.14177004992961884, "acc": 0.9442073702812195, "length": 3.999666690826416, "mode": "train", "epoch": 51}
{"loss": 0.20577482879161835, "acc": 0.9291518926620483, "length": 4.0, "mode": "test", "epoch": 51}
{"loss": 0.13531962037086487, "acc": 0.9469174146652222, "length": 3.9993531703948975, "mode": "train", "epoch": 52}
{"loss": 0.17824912071228027, "acc": 0.9266783595085144, "length": 4.0, "mode": "test", "epoch": 52}
{"loss": 0.13321521878242493, "acc": 0.9501128792762756, "length": 3.999645709991455, "mode": "train", "epoch": 53}
{"loss": 0.1945544183254242, "acc": 0.9300353527069092, "length": 4.0, "mode": "test", "epoch": 53}
{"loss": 0.13430415093898773, "acc": 0.9446844458580017, "length": 3.9998300075531006, "mode": "train", "epoch": 54}
{"loss": 0.1881471574306488, "acc": 0.9386926889419556, "length": 4.0, "mode": "test", "epoch": 54}
{"loss": 0.13170482218265533, "acc": 0.9449710249900818, "length": 3.999488592147827, "mode": "train", "epoch": 55}
{"loss": 0.1801198422908783, "acc": 0.9374557733535767, "length": 4.0, "mode": "test", "epoch": 55}
{"loss": 0.12205031514167786, "acc": 0.9556688070297241, "length": 3.9977335929870605, "mode": "train", "epoch": 56}
{"loss": 0.16869930922985077, "acc": 0.9355122447013855, "length": 4.0, "mode": "test", "epoch": 56}
{"loss": 0.1259482502937317, "acc": 0.951706051826477, "length": 3.999706506729126, "mode": "train", "epoch": 57}
{"loss": 0.1620176136493683, "acc": 0.9372790455818176, "length": 4.0, "mode": "test", "epoch": 57}
{"loss": 0.1218271553516388, "acc": 0.9504103660583496, "length": 3.9998621940612793, "mode": "train", "epoch": 58}
{"loss": 0.17024055123329163, "acc": 0.9295052289962769, "length": 4.0, "mode": "test", "epoch": 58}
{"loss": 0.11279121786355972, "acc": 0.9558323621749878, "length": 3.998680353164673, "mode": "train", "epoch": 59}
{"loss": 0.17046760022640228, "acc": 0.9386926889419556, "length": 4.0, "mode": "test", "epoch": 59}
{"loss": 0.1184404194355011, "acc": 0.9544430375099182, "length": 3.99818754196167, "mode": "train", "epoch": 60}
{"loss": 0.16761618852615356, "acc": 0.9319788217544556, "length": 4.0, "mode": "test", "epoch": 60}
test accuracy: 0.8138710260391235
