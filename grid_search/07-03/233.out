# ["--attributes=5", "--values=16", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.99", "--temperature=2"]
Creating train_ds and val_ds...

Creating test_ds...
{"loss": 0.6955061554908752, "acc": 0.5134432911872864, "length": 3.1052229404449463, "mode": "train", "epoch": 1}
{"loss": 0.6965842843055725, "acc": 0.4913427531719208, "length": 1.0, "mode": "test", "epoch": 1}
{"loss": 0.6436084508895874, "acc": 0.6305506825447083, "length": 3.1165611743927, "mode": "train", "epoch": 2}
{"loss": 0.5639615058898926, "acc": 0.7425986528396606, "length": 3.851590156555176, "mode": "test", "epoch": 2}
{"loss": 0.500953733921051, "acc": 0.7701975703239441, "length": 3.780675172805786, "mode": "train", "epoch": 3}
{"loss": 0.522446870803833, "acc": 0.7795052528381348, "length": 4.0, "mode": "test", "epoch": 3}
{"loss": 0.4252765476703644, "acc": 0.808675229549408, "length": 3.8961572647094727, "mode": "train", "epoch": 4}
{"loss": 0.4761178195476532, "acc": 0.8058303594589233, "length": 4.0, "mode": "test", "epoch": 4}
{"loss": 0.38945043087005615, "acc": 0.8294753432273865, "length": 3.9469563961029053, "mode": "train", "epoch": 5}
{"loss": 0.48337438702583313, "acc": 0.8100706338882446, "length": 4.0, "mode": "test", "epoch": 5}
{"loss": 0.3629887104034424, "acc": 0.8421576023101807, "length": 3.9632716178894043, "mode": "train", "epoch": 6}
{"loss": 0.4665031433105469, "acc": 0.8242049217224121, "length": 4.0, "mode": "test", "epoch": 6}
{"loss": 0.3305453658103943, "acc": 0.8589170575141907, "length": 3.9773361682891846, "mode": "train", "epoch": 7}
{"loss": 0.4071749150753021, "acc": 0.8378093242645264, "length": 4.0, "mode": "test", "epoch": 7}
{"loss": 0.29950520396232605, "acc": 0.8652719259262085, "length": 3.982952833175659, "mode": "train", "epoch": 8}
{"loss": 0.3866223394870758, "acc": 0.8390459418296814, "length": 4.0, "mode": "test", "epoch": 8}
{"loss": 0.2734176516532898, "acc": 0.8826296329498291, "length": 3.9885642528533936, "mode": "train", "epoch": 9}
{"loss": 0.40396395325660706, "acc": 0.8507067561149597, "length": 4.0, "mode": "test", "epoch": 9}
{"loss": 0.2494669109582901, "acc": 0.8980609774589539, "length": 3.9907548427581787, "mode": "train", "epoch": 10}
{"loss": 0.358100950717926, "acc": 0.8609539270401001, "length": 4.0, "mode": "test", "epoch": 10}
{"loss": 0.2357897013425827, "acc": 0.905815601348877, "length": 3.9927525520324707, "mode": "train", "epoch": 11}
{"loss": 0.3771757185459137, "acc": 0.8565370440483093, "length": 4.0, "mode": "test", "epoch": 11}
{"loss": 0.22632737457752228, "acc": 0.9158177971839905, "length": 3.993112087249756, "mode": "train", "epoch": 12}
{"loss": 0.315138578414917, "acc": 0.8895760774612427, "length": 4.0, "mode": "test", "epoch": 12}
{"loss": 0.20039542019367218, "acc": 0.9252989292144775, "length": 3.9942500591278076, "mode": "train", "epoch": 13}
{"loss": 0.2938557267189026, "acc": 0.9001765251159668, "length": 4.0, "mode": "test", "epoch": 13}
{"loss": 0.18552199006080627, "acc": 0.9338192939758301, "length": 3.9952890872955322, "mode": "train", "epoch": 14}
{"loss": 0.2823701798915863, "acc": 0.906183660030365, "length": 4.0, "mode": "test", "epoch": 14}
{"loss": 0.17049375176429749, "acc": 0.9358954429626465, "length": 3.995600461959839, "mode": "train", "epoch": 15}
{"loss": 0.2849789261817932, "acc": 0.9007067680358887, "length": 4.0, "mode": "test", "epoch": 15}
{"loss": 0.16806408762931824, "acc": 0.9358516335487366, "length": 3.996096611022949, "mode": "train", "epoch": 16}
{"loss": 0.2692646086215973, "acc": 0.90159010887146, "length": 4.0, "mode": "test", "epoch": 16}
{"loss": 0.1576499044895172, "acc": 0.9408776164054871, "length": 3.996851921081543, "mode": "train", "epoch": 17}
{"loss": 0.24632342159748077, "acc": 0.9181979894638062, "length": 4.0, "mode": "test", "epoch": 17}
{"loss": 0.14060455560684204, "acc": 0.949137270450592, "length": 3.9968087673187256, "mode": "train", "epoch": 18}
{"loss": 0.24746568500995636, "acc": 0.9155478477478027, "length": 4.0, "mode": "test", "epoch": 18}
{"loss": 0.1302928328514099, "acc": 0.9531600475311279, "length": 3.997361898422241, "mode": "train", "epoch": 19}
{"loss": 0.26274728775024414, "acc": 0.9125441908836365, "length": 4.0, "mode": "test", "epoch": 19}
{"loss": 0.13176104426383972, "acc": 0.9497984051704407, "length": 3.997206926345825, "mode": "train", "epoch": 20}
{"loss": 0.23807485401630402, "acc": 0.9127210378646851, "length": 4.0, "mode": "test", "epoch": 20}
{"loss": 0.12270649522542953, "acc": 0.954897403717041, "length": 3.9981229305267334, "mode": "train", "epoch": 21}
{"loss": 0.23755498230457306, "acc": 0.9136044383049011, "length": 4.0, "mode": "test", "epoch": 21}
{"loss": 0.10971177369356155, "acc": 0.9610371589660645, "length": 3.99825119972229, "mode": "train", "epoch": 22}
{"loss": 0.23895712196826935, "acc": 0.9243817329406738, "length": 4.0, "mode": "test", "epoch": 22}
{"loss": 0.10154946893453598, "acc": 0.9655860662460327, "length": 3.9984676837921143, "mode": "train", "epoch": 23}
{"loss": 0.20093943178653717, "acc": 0.9318021535873413, "length": 4.0, "mode": "test", "epoch": 23}
{"loss": 0.10195253044366837, "acc": 0.962880551815033, "length": 3.99857497215271, "mode": "train", "epoch": 24}
{"loss": 0.19669008255004883, "acc": 0.9348056316375732, "length": 4.0, "mode": "test", "epoch": 24}
{"loss": 0.09622729569673538, "acc": 0.9666449427604675, "length": 3.9983997344970703, "mode": "train", "epoch": 25}
{"loss": 0.2097793072462082, "acc": 0.9268550872802734, "length": 4.0, "mode": "test", "epoch": 25}
{"loss": 0.10652637481689453, "acc": 0.9577478170394897, "length": 3.998622417449951, "mode": "train", "epoch": 26}
{"loss": 0.18435154855251312, "acc": 0.9339221119880676, "length": 4.0, "mode": "test", "epoch": 26}
{"loss": 0.08802542090415955, "acc": 0.9690788984298706, "length": 3.998703718185425, "mode": "train", "epoch": 27}
{"loss": 0.16905832290649414, "acc": 0.9379860162734985, "length": 4.0, "mode": "test", "epoch": 27}
{"loss": 0.07675977796316147, "acc": 0.9748087525367737, "length": 3.9988932609558105, "mode": "train", "epoch": 28}
{"loss": 0.1614949107170105, "acc": 0.945229709148407, "length": 4.0, "mode": "test", "epoch": 28}
{"loss": 0.06747220456600189, "acc": 0.9774636626243591, "length": 3.9989733695983887, "mode": "train", "epoch": 29}
{"loss": 0.18528418242931366, "acc": 0.9355124831199646, "length": 4.0, "mode": "test", "epoch": 29}
{"loss": 0.06552665680646896, "acc": 0.9792914390563965, "length": 3.998959541320801, "mode": "train", "epoch": 30}
{"loss": 0.1864950805902481, "acc": 0.9363957643508911, "length": 4.0, "mode": "test", "epoch": 30}
{"loss": 0.07279110699892044, "acc": 0.974467396736145, "length": 3.9992921352386475, "mode": "train", "epoch": 31}
{"loss": 0.15058496594429016, "acc": 0.9489399790763855, "length": 4.0, "mode": "test", "epoch": 31}
{"loss": 0.06927285343408585, "acc": 0.9778977632522583, "length": 3.999454975128174, "mode": "train", "epoch": 32}
{"loss": 0.19373749196529388, "acc": 0.9434629082679749, "length": 4.0, "mode": "test", "epoch": 32}
{"loss": 0.060720182955265045, "acc": 0.9802858829498291, "length": 3.998852491378784, "mode": "train", "epoch": 33}
{"loss": 0.15490397810935974, "acc": 0.9533568620681763, "length": 4.0, "mode": "test", "epoch": 33}
{"loss": 0.05735037848353386, "acc": 0.9799615144729614, "length": 3.9994001388549805, "mode": "train", "epoch": 34}
{"loss": 0.16496789455413818, "acc": 0.9492933750152588, "length": 4.0, "mode": "test", "epoch": 34}
{"loss": 0.05805324763059616, "acc": 0.9790191650390625, "length": 3.9993646144866943, "mode": "train", "epoch": 35}
{"loss": 0.16103488206863403, "acc": 0.952296793460846, "length": 4.0, "mode": "test", "epoch": 35}
{"loss": 0.057732440531253815, "acc": 0.9802652597427368, "length": 3.999605894088745, "mode": "train", "epoch": 36}
{"loss": 0.16176196932792664, "acc": 0.9531803131103516, "length": 4.0, "mode": "test", "epoch": 36}
{"loss": 0.049156639724969864, "acc": 0.9834417700767517, "length": 3.9993791580200195, "mode": "train", "epoch": 37}
{"loss": 0.11704082041978836, "acc": 0.9568905234336853, "length": 4.0, "mode": "test", "epoch": 37}
{"loss": 0.04465152695775032, "acc": 0.9865196347236633, "length": 3.9995338916778564, "mode": "train", "epoch": 38}
{"loss": 0.14363738894462585, "acc": 0.9584804773330688, "length": 4.0, "mode": "test", "epoch": 38}
{"loss": 0.0397680327296257, "acc": 0.9878767132759094, "length": 3.9995534420013428, "mode": "train", "epoch": 39}
{"loss": 0.1354040503501892, "acc": 0.9583039283752441, "length": 4.0, "mode": "test", "epoch": 39}
{"loss": 0.04118586331605911, "acc": 0.9880025386810303, "length": 3.999741792678833, "mode": "train", "epoch": 40}
{"loss": 0.13754288852214813, "acc": 0.9597172141075134, "length": 4.0, "mode": "test", "epoch": 40}
{"loss": 0.03830112889409065, "acc": 0.9891796112060547, "length": 3.999612808227539, "mode": "train", "epoch": 41}
{"loss": 0.14247724413871765, "acc": 0.9570671319961548, "length": 4.0, "mode": "test", "epoch": 41}
{"loss": 0.03663685545325279, "acc": 0.9892425537109375, "length": 3.9997658729553223, "mode": "train", "epoch": 42}
{"loss": 0.13161757588386536, "acc": 0.9680212736129761, "length": 4.0, "mode": "test", "epoch": 42}
{"loss": 0.051603853702545166, "acc": 0.9837543964385986, "length": 3.9998013973236084, "mode": "train", "epoch": 43}
{"loss": 0.17970842123031616, "acc": 0.9505300521850586, "length": 4.0, "mode": "test", "epoch": 43}
{"loss": 0.05764495208859444, "acc": 0.9803257584571838, "length": 3.99967622756958, "mode": "train", "epoch": 44}
{"loss": 0.17671816051006317, "acc": 0.9621907472610474, "length": 4.0, "mode": "test", "epoch": 44}
{"loss": 0.04156462103128433, "acc": 0.9889487028121948, "length": 3.9997916221618652, "mode": "train", "epoch": 45}
{"loss": 0.11916899681091309, "acc": 0.9634275436401367, "length": 4.0, "mode": "test", "epoch": 45}
{"loss": 0.037274423986673355, "acc": 0.9882405996322632, "length": 3.9997847080230713, "mode": "train", "epoch": 46}
{"loss": 0.12463857233524323, "acc": 0.9689046144485474, "length": 4.0, "mode": "test", "epoch": 46}
{"loss": 0.036329276859760284, "acc": 0.9889529943466187, "length": 3.9998650550842285, "mode": "train", "epoch": 47}
{"loss": 0.10895514488220215, "acc": 0.971731424331665, "length": 4.0, "mode": "test", "epoch": 47}
{"loss": 0.04182844236493111, "acc": 0.9851706624031067, "length": 3.9998056888580322, "mode": "train", "epoch": 48}
{"loss": 0.11849069595336914, "acc": 0.9667842388153076, "length": 4.0, "mode": "test", "epoch": 48}
{"loss": 0.04480253532528877, "acc": 0.9855301976203918, "length": 3.9998722076416016, "mode": "train", "epoch": 49}
{"loss": 0.16580666601657867, "acc": 0.9542403221130371, "length": 4.0, "mode": "test", "epoch": 49}
{"loss": 0.0407341867685318, "acc": 0.9869488477706909, "length": 3.999906301498413, "mode": "train", "epoch": 50}
{"loss": 0.12158343940973282, "acc": 0.9678446054458618, "length": 4.0, "mode": "test", "epoch": 50}
{"loss": 0.04149143025279045, "acc": 0.9883067607879639, "length": 3.999919891357422, "mode": "train", "epoch": 51}
{"loss": 0.11099440604448318, "acc": 0.9699646830558777, "length": 4.0, "mode": "test", "epoch": 51}
{"loss": 0.02852189540863037, "acc": 0.9922030568122864, "length": 3.9999184608459473, "mode": "train", "epoch": 52}
{"loss": 0.11660383641719818, "acc": 0.9727916121482849, "length": 4.0, "mode": "test", "epoch": 52}
{"loss": 0.031089866533875465, "acc": 0.9918491244316101, "length": 3.9999232292175293, "mode": "train", "epoch": 53}
{"loss": 0.13173167407512665, "acc": 0.9681978821754456, "length": 4.0, "mode": "test", "epoch": 53}
{"loss": 0.026828039437532425, "acc": 0.9911996126174927, "length": 3.9999337196350098, "mode": "train", "epoch": 54}
{"loss": 0.12083423137664795, "acc": 0.9720848202705383, "length": 4.0, "mode": "test", "epoch": 54}
{"loss": 0.031115463003516197, "acc": 0.9914910793304443, "length": 3.9998865127563477, "mode": "train", "epoch": 55}
{"loss": 0.11701120436191559, "acc": 0.9719082117080688, "length": 4.0, "mode": "test", "epoch": 55}
{"loss": 0.025065327063202858, "acc": 0.994149923324585, "length": 3.999887228012085, "mode": "train", "epoch": 56}
{"loss": 0.12712199985980988, "acc": 0.9669613242149353, "length": 4.0, "mode": "test", "epoch": 56}
{"loss": 0.03154820576310158, "acc": 0.9903111457824707, "length": 3.9999020099639893, "mode": "train", "epoch": 57}
{"loss": 0.12243897467851639, "acc": 0.9704945683479309, "length": 4.0, "mode": "test", "epoch": 57}
{"loss": 0.029276294633746147, "acc": 0.9920282363891602, "length": 3.999964475631714, "mode": "train", "epoch": 58}
{"loss": 0.12271831184625626, "acc": 0.9710245728492737, "length": 4.0, "mode": "test", "epoch": 58}
{"loss": 0.023682428523898125, "acc": 0.9935044050216675, "length": 3.9999706745147705, "mode": "train", "epoch": 59}
{"loss": 0.1193070039153099, "acc": 0.9674912095069885, "length": 4.0, "mode": "test", "epoch": 59}
{"loss": 0.028987105935811996, "acc": 0.9925599694252014, "length": 3.9999618530273438, "mode": "train", "epoch": 60}
{"loss": 0.15682847797870636, "acc": 0.9666077494621277, "length": 4.0, "mode": "test", "epoch": 60}
test accuracy: 0.8301613926887512
