# ["--attributes=3", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=128", "--learning_rate=0.0005", "--hidden_size=256", "--temp_update=0.99", "--temperature=1.5"]
Creating train_ds and val_ds...

Creating test_ds...
{"loss": 0.7068029046058655, "acc": 0.5057730078697205, "length": 3.444939136505127, "mode": "train", "epoch": 1}
{"loss": 0.6999015808105469, "acc": 0.5170139074325562, "length": 1.0, "mode": "test", "epoch": 1}
{"loss": 0.6953098773956299, "acc": 0.53130042552948, "length": 3.0108933448791504, "mode": "train", "epoch": 2}
{"loss": 0.6943816542625427, "acc": 0.4854166805744171, "length": 1.0, "mode": "test", "epoch": 2}
{"loss": 0.6894275546073914, "acc": 0.5332807302474976, "length": 2.1548361778259277, "mode": "train", "epoch": 3}
{"loss": 0.694499671459198, "acc": 0.504687488079071, "length": 1.0, "mode": "test", "epoch": 3}
{"loss": 0.683803379535675, "acc": 0.56118243932724, "length": 2.297928810119629, "mode": "train", "epoch": 4}
{"loss": 0.6892412900924683, "acc": 0.5060913562774658, "length": 1.15625, "mode": "test", "epoch": 4}
{"loss": 0.6630133986473083, "acc": 0.6220830082893372, "length": 2.8335323333740234, "mode": "train", "epoch": 5}
{"loss": 0.6423932313919067, "acc": 0.666834831237793, "length": 2.4548611640930176, "mode": "test", "epoch": 5}
{"loss": 0.618773877620697, "acc": 0.7162823677062988, "length": 2.896331787109375, "mode": "train", "epoch": 6}
{"loss": 0.5884494781494141, "acc": 0.7386868596076965, "length": 2.9861111640930176, "mode": "test", "epoch": 6}
{"loss": 0.5487440824508667, "acc": 0.7733355164527893, "length": 3.0737435817718506, "mode": "train", "epoch": 7}
{"loss": 0.5354535579681396, "acc": 0.7859604954719543, "length": 3.1354167461395264, "mode": "test", "epoch": 7}
{"loss": 0.48368775844573975, "acc": 0.8057971596717834, "length": 3.189807176589966, "mode": "train", "epoch": 8}
{"loss": 0.499786376953125, "acc": 0.8038899898529053, "length": 3.315972328186035, "mode": "test", "epoch": 8}
{"loss": 0.4405271112918854, "acc": 0.8189391493797302, "length": 3.3561952114105225, "mode": "train", "epoch": 9}
{"loss": 0.4630868136882782, "acc": 0.7938272953033447, "length": 3.378472328186035, "mode": "test", "epoch": 9}
{"loss": 0.405895859003067, "acc": 0.828062891960144, "length": 3.4235503673553467, "mode": "train", "epoch": 10}
{"loss": 0.46254581212997437, "acc": 0.8035793900489807, "length": 3.538194417953491, "mode": "test", "epoch": 10}
{"loss": 0.3857129216194153, "acc": 0.8406917452812195, "length": 3.5490074157714844, "mode": "train", "epoch": 11}
{"loss": 0.44303590059280396, "acc": 0.8158297538757324, "length": 3.6041667461395264, "mode": "test", "epoch": 11}
{"loss": 0.3653530776500702, "acc": 0.8465942144393921, "length": 3.6070728302001953, "mode": "train", "epoch": 12}
{"loss": 0.42637643218040466, "acc": 0.811380922794342, "length": 3.694444417953491, "mode": "test", "epoch": 12}
{"loss": 0.353916198015213, "acc": 0.8501480221748352, "length": 3.6397337913513184, "mode": "train", "epoch": 13}
{"loss": 0.41752171516418457, "acc": 0.827005922794342, "length": 3.7083332538604736, "mode": "test", "epoch": 13}
{"loss": 0.3462356626987457, "acc": 0.8541572690010071, "length": 3.6779003143310547, "mode": "train", "epoch": 14}
{"loss": 0.4213181436061859, "acc": 0.8240994215011597, "length": 3.6875, "mode": "test", "epoch": 14}
{"loss": 0.32633814215660095, "acc": 0.8635464906692505, "length": 3.676058292388916, "mode": "train", "epoch": 15}
{"loss": 0.3750172555446625, "acc": 0.8368096351623535, "length": 3.753472328186035, "mode": "test", "epoch": 15}
{"loss": 0.31391897797584534, "acc": 0.8670291900634766, "length": 3.745563268661499, "mode": "train", "epoch": 16}
{"loss": 0.35631483793258667, "acc": 0.8476725816726685, "length": 3.8020832538604736, "mode": "test", "epoch": 16}
{"loss": 0.3014615774154663, "acc": 0.8704040050506592, "length": 3.784531354904175, "mode": "train", "epoch": 17}
{"loss": 0.3465547561645508, "acc": 0.8604084849357605, "length": 3.805555582046509, "mode": "test", "epoch": 17}
{"loss": 0.28950321674346924, "acc": 0.8773809671401978, "length": 3.8088622093200684, "mode": "train", "epoch": 18}
{"loss": 0.3531690537929535, "acc": 0.8603407144546509, "length": 3.836805582046509, "mode": "test", "epoch": 18}
{"loss": 0.27542567253112793, "acc": 0.8831824064254761, "length": 3.8374128341674805, "mode": "train", "epoch": 19}
{"loss": 0.32506537437438965, "acc": 0.8725898265838623, "length": 3.8611111640930176, "mode": "test", "epoch": 19}
{"loss": 0.2602470815181732, "acc": 0.8895261287689209, "length": 3.8583507537841797, "mode": "train", "epoch": 20}
{"loss": 0.2964538335800171, "acc": 0.8779094219207764, "length": 3.909722328186035, "mode": "test", "epoch": 20}
{"loss": 0.23774513602256775, "acc": 0.902760922908783, "length": 3.9005024433135986, "mode": "train", "epoch": 21}
{"loss": 0.27884408831596375, "acc": 0.89776611328125, "length": 3.9791667461395264, "mode": "test", "epoch": 21}
{"loss": 0.22082781791687012, "acc": 0.912573516368866, "length": 3.922546863555908, "mode": "train", "epoch": 22}
{"loss": 0.26295432448387146, "acc": 0.8989827632904053, "length": 3.972222328186035, "mode": "test", "epoch": 22}
{"loss": 0.2129785418510437, "acc": 0.9114343523979187, "length": 3.9232699871063232, "mode": "train", "epoch": 23}
{"loss": 0.2564306855201721, "acc": 0.9019098281860352, "length": 4.0, "mode": "test", "epoch": 23}
{"loss": 0.2031709998846054, "acc": 0.9181650280952454, "length": 3.955280303955078, "mode": "train", "epoch": 24}
{"loss": 0.26843589544296265, "acc": 0.9052082896232605, "length": 4.0, "mode": "test", "epoch": 24}
{"loss": 0.1963798552751541, "acc": 0.9197523593902588, "length": 3.976166248321533, "mode": "train", "epoch": 25}
{"loss": 0.23161667585372925, "acc": 0.9128472208976746, "length": 4.0, "mode": "test", "epoch": 25}
{"loss": 0.18736785650253296, "acc": 0.9276434183120728, "length": 3.985513210296631, "mode": "train", "epoch": 26}
{"loss": 0.22906091809272766, "acc": 0.9071180820465088, "length": 4.0, "mode": "test", "epoch": 26}
{"loss": 0.17900963127613068, "acc": 0.9321624040603638, "length": 3.9867401123046875, "mode": "train", "epoch": 27}
{"loss": 0.22385933995246887, "acc": 0.9119791388511658, "length": 4.0, "mode": "test", "epoch": 27}
{"loss": 0.17206667363643646, "acc": 0.9333379864692688, "length": 3.989722490310669, "mode": "train", "epoch": 28}
{"loss": 0.22409015893936157, "acc": 0.9189236164093018, "length": 4.0, "mode": "test", "epoch": 28}
{"loss": 0.16742292046546936, "acc": 0.9371105432510376, "length": 3.991938352584839, "mode": "train", "epoch": 29}
{"loss": 0.21220234036445618, "acc": 0.9190971851348877, "length": 4.0, "mode": "test", "epoch": 29}
{"loss": 0.16785402595996857, "acc": 0.9367582201957703, "length": 3.9943621158599854, "mode": "train", "epoch": 30}
{"loss": 0.21489378809928894, "acc": 0.9248266220092773, "length": 4.0, "mode": "test", "epoch": 30}
{"loss": 0.1696205884218216, "acc": 0.9386166930198669, "length": 3.99459171295166, "mode": "train", "epoch": 31}
{"loss": 0.23598705232143402, "acc": 0.9194445013999939, "length": 4.0, "mode": "test", "epoch": 31}
{"loss": 0.16246946156024933, "acc": 0.9367635846138, "length": 3.9942758083343506, "mode": "train", "epoch": 32}
{"loss": 0.211687833070755, "acc": 0.9265624284744263, "length": 4.0, "mode": "test", "epoch": 32}
{"loss": 0.15906202793121338, "acc": 0.9403080940246582, "length": 3.9933242797851562, "mode": "train", "epoch": 33}
{"loss": 0.20755057036876678, "acc": 0.9206597208976746, "length": 4.0, "mode": "test", "epoch": 33}
{"loss": 0.1518363207578659, "acc": 0.9438401460647583, "length": 3.9946792125701904, "mode": "train", "epoch": 34}
{"loss": 0.19054946303367615, "acc": 0.9361111521720886, "length": 4.0, "mode": "test", "epoch": 34}
{"loss": 0.15208226442337036, "acc": 0.9457715153694153, "length": 3.994128465652466, "mode": "train", "epoch": 35}
{"loss": 0.21244244277477264, "acc": 0.9300346374511719, "length": 4.0, "mode": "test", "epoch": 35}
{"loss": 0.14870789647102356, "acc": 0.9426141381263733, "length": 3.9967541694641113, "mode": "train", "epoch": 36}
{"loss": 0.19376115500926971, "acc": 0.9331597089767456, "length": 4.0, "mode": "test", "epoch": 36}
{"loss": 0.1415902078151703, "acc": 0.9451233744621277, "length": 3.9974355697631836, "mode": "train", "epoch": 37}
{"loss": 0.1801348179578781, "acc": 0.9347221851348877, "length": 4.0, "mode": "test", "epoch": 37}
{"loss": 0.13777858018875122, "acc": 0.9496887922286987, "length": 3.9972379207611084, "mode": "train", "epoch": 38}
{"loss": 0.1815255582332611, "acc": 0.9381943941116333, "length": 4.0, "mode": "test", "epoch": 38}
{"loss": 0.13070344924926758, "acc": 0.9500910639762878, "length": 3.9972426891326904, "mode": "train", "epoch": 39}
{"loss": 0.14957933127880096, "acc": 0.9486110210418701, "length": 4.0, "mode": "test", "epoch": 39}
{"loss": 0.11966104060411453, "acc": 0.9556263089179993, "length": 3.997846841812134, "mode": "train", "epoch": 40}
{"loss": 0.1611630916595459, "acc": 0.9473958611488342, "length": 4.0, "mode": "test", "epoch": 40}
{"loss": 0.11548930406570435, "acc": 0.9558342695236206, "length": 3.9979066848754883, "mode": "train", "epoch": 41}
{"loss": 0.1412029266357422, "acc": 0.9480903148651123, "length": 4.0, "mode": "test", "epoch": 41}
{"loss": 0.11264368146657944, "acc": 0.9582086205482483, "length": 3.9989500045776367, "mode": "train", "epoch": 42}
{"loss": 0.13457632064819336, "acc": 0.9508679509162903, "length": 4.0, "mode": "test", "epoch": 42}
{"loss": 0.10529706627130508, "acc": 0.9603517651557922, "length": 3.998979330062866, "mode": "train", "epoch": 43}
{"loss": 0.16214045882225037, "acc": 0.9465277791023254, "length": 4.0, "mode": "test", "epoch": 43}
{"loss": 0.09549511969089508, "acc": 0.964783787727356, "length": 3.9979567527770996, "mode": "train", "epoch": 44}
{"loss": 0.14732424914836884, "acc": 0.9510416388511658, "length": 4.0, "mode": "test", "epoch": 44}
{"loss": 0.10278664529323578, "acc": 0.9653522968292236, "length": 3.9994261264801025, "mode": "train", "epoch": 45}
{"loss": 0.15144002437591553, "acc": 0.9477429986000061, "length": 4.0, "mode": "test", "epoch": 45}
{"loss": 0.09626075625419617, "acc": 0.962044358253479, "length": 3.9991872310638428, "mode": "train", "epoch": 46}
{"loss": 0.13828009366989136, "acc": 0.9532986879348755, "length": 4.0, "mode": "test", "epoch": 46}
{"loss": 0.09485790133476257, "acc": 0.9641270637512207, "length": 3.9990999698638916, "mode": "train", "epoch": 47}
{"loss": 0.1331481784582138, "acc": 0.9562499523162842, "length": 4.0, "mode": "test", "epoch": 47}
{"loss": 0.0833570584654808, "acc": 0.9689556956291199, "length": 3.9996166229248047, "mode": "train", "epoch": 48}
{"loss": 0.13038134574890137, "acc": 0.9522569179534912, "length": 4.0, "mode": "test", "epoch": 48}
{"loss": 0.08045247942209244, "acc": 0.9709616303443909, "length": 3.998734474182129, "mode": "train", "epoch": 49}
{"loss": 0.13259375095367432, "acc": 0.9593750834465027, "length": 4.0, "mode": "test", "epoch": 49}
{"loss": 0.07366904616355896, "acc": 0.9754080772399902, "length": 3.9983224868774414, "mode": "train", "epoch": 50}
{"loss": 0.12808763980865479, "acc": 0.9559028148651123, "length": 4.0, "mode": "test", "epoch": 50}
{"loss": 0.0787457674741745, "acc": 0.9680723547935486, "length": 3.999099016189575, "mode": "train", "epoch": 51}
{"loss": 0.1173175573348999, "acc": 0.9663195013999939, "length": 4.0, "mode": "test", "epoch": 51}
{"loss": 0.0720570981502533, "acc": 0.9724932312965393, "length": 3.9996302127838135, "mode": "train", "epoch": 52}
{"loss": 0.12547357380390167, "acc": 0.9607638120651245, "length": 4.0, "mode": "test", "epoch": 52}
{"loss": 0.06668248772621155, "acc": 0.9756969809532166, "length": 3.9968838691711426, "mode": "train", "epoch": 53}
{"loss": 0.13109461963176727, "acc": 0.9560763835906982, "length": 4.0, "mode": "test", "epoch": 53}
{"loss": 0.0653488039970398, "acc": 0.9761420488357544, "length": 3.9993863105773926, "mode": "train", "epoch": 54}
{"loss": 0.1169293224811554, "acc": 0.9626736044883728, "length": 4.0, "mode": "test", "epoch": 54}
{"loss": 0.06053154170513153, "acc": 0.9779481291770935, "length": 3.999689817428589, "mode": "train", "epoch": 55}
{"loss": 0.14674468338489532, "acc": 0.9583333134651184, "length": 4.0, "mode": "test", "epoch": 55}
{"loss": 0.0632343739271164, "acc": 0.9798919558525085, "length": 3.9989402294158936, "mode": "train", "epoch": 56}
{"loss": 0.12378448247909546, "acc": 0.9626737236976624, "length": 4.0, "mode": "test", "epoch": 56}
{"loss": 0.057997141033411026, "acc": 0.9791655540466309, "length": 3.9997305870056152, "mode": "train", "epoch": 57}
{"loss": 0.14026670157909393, "acc": 0.9624999165534973, "length": 4.0, "mode": "test", "epoch": 57}
{"loss": 0.051752638071775436, "acc": 0.9809123277664185, "length": 3.9998860359191895, "mode": "train", "epoch": 58}
{"loss": 0.1232665404677391, "acc": 0.964756965637207, "length": 4.0, "mode": "test", "epoch": 58}
{"loss": 0.05403175950050354, "acc": 0.9811997413635254, "length": 3.9997830390930176, "mode": "train", "epoch": 59}
{"loss": 0.14566734433174133, "acc": 0.9633679986000061, "length": 4.0, "mode": "test", "epoch": 59}
{"loss": 0.05434221029281616, "acc": 0.980544924736023, "length": 3.999485969543457, "mode": "train", "epoch": 60}
{"loss": 0.11089249700307846, "acc": 0.9671875834465027, "length": 4.0, "mode": "test", "epoch": 60}
test accuracy: 0.867758572101593
