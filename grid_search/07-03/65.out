# ["--attributes=3", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=128", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.99", "--temperature=2"]
Creating train_ds and val_ds...

Creating test_ds...
{"loss": 0.6923616528511047, "acc": 0.5349835157394409, "length": 3.5611212253570557, "mode": "train", "epoch": 1}
{"loss": 0.6812486052513123, "acc": 0.5663398504257202, "length": 2.2336769104003906, "mode": "test", "epoch": 1}
{"loss": 0.6897839903831482, "acc": 0.5365645289421082, "length": 3.489227294921875, "mode": "train", "epoch": 2}
{"loss": 0.6793911457061768, "acc": 0.6082439422607422, "length": 2.0, "mode": "test", "epoch": 2}
{"loss": 0.6845212578773499, "acc": 0.5471149682998657, "length": 3.427100658416748, "mode": "train", "epoch": 3}
{"loss": 0.6629401445388794, "acc": 0.6085721850395203, "length": 2.776632308959961, "mode": "test", "epoch": 3}
{"loss": 0.6725435853004456, "acc": 0.5852440595626831, "length": 3.4299380779266357, "mode": "train", "epoch": 4}
{"loss": 0.6383242607116699, "acc": 0.676065981388092, "length": 3.8178694248199463, "mode": "test", "epoch": 4}
{"loss": 0.6387390494346619, "acc": 0.6644736528396606, "length": 3.6535513401031494, "mode": "train", "epoch": 5}
{"loss": 0.5986090898513794, "acc": 0.7153699994087219, "length": 3.969072103500366, "mode": "test", "epoch": 5}
{"loss": 0.5836101770401001, "acc": 0.7100574374198914, "length": 3.8139119148254395, "mode": "train", "epoch": 6}
{"loss": 0.5931297540664673, "acc": 0.7082474231719971, "length": 4.0, "mode": "test", "epoch": 6}
{"loss": 0.5544672012329102, "acc": 0.71449214220047, "length": 3.888195037841797, "mode": "train", "epoch": 7}
{"loss": 0.5795065760612488, "acc": 0.709793746471405, "length": 4.0, "mode": "test", "epoch": 7}
{"loss": 0.5253715515136719, "acc": 0.736223042011261, "length": 3.8858888149261475, "mode": "train", "epoch": 8}
{"loss": 0.5436283946037292, "acc": 0.765807569026947, "length": 4.0, "mode": "test", "epoch": 8}
{"loss": 0.4909264147281647, "acc": 0.7647408843040466, "length": 3.9077579975128174, "mode": "train", "epoch": 9}
{"loss": 0.5241775512695312, "acc": 0.7848798036575317, "length": 4.0, "mode": "test", "epoch": 9}
{"loss": 0.4459928870201111, "acc": 0.7981908917427063, "length": 3.925593376159668, "mode": "train", "epoch": 10}
{"loss": 0.5074223875999451, "acc": 0.8053264617919922, "length": 4.0, "mode": "test", "epoch": 10}
{"loss": 0.41379228234291077, "acc": 0.8107734322547913, "length": 3.9457740783691406, "mode": "train", "epoch": 11}
{"loss": 0.47840040922164917, "acc": 0.8223367929458618, "length": 4.0, "mode": "test", "epoch": 11}
{"loss": 0.37807950377464294, "acc": 0.8402889966964722, "length": 3.9630720615386963, "mode": "train", "epoch": 12}
{"loss": 0.4342077672481537, "acc": 0.8324743509292603, "length": 4.0, "mode": "test", "epoch": 12}
{"loss": 0.34551316499710083, "acc": 0.8613089919090271, "length": 3.967851161956787, "mode": "train", "epoch": 13}
{"loss": 0.4289189279079437, "acc": 0.8381442427635193, "length": 4.0, "mode": "test", "epoch": 13}
{"loss": 0.3199211359024048, "acc": 0.8715206384658813, "length": 3.9758431911468506, "mode": "train", "epoch": 14}
{"loss": 0.4225095212459564, "acc": 0.8410652279853821, "length": 4.0, "mode": "test", "epoch": 14}
{"loss": 0.2968688905239105, "acc": 0.8799931406974792, "length": 3.97501277923584, "mode": "train", "epoch": 15}
{"loss": 0.4059545397758484, "acc": 0.861168384552002, "length": 4.0, "mode": "test", "epoch": 15}
{"loss": 0.2762901484966278, "acc": 0.8901842832565308, "length": 3.977811813354492, "mode": "train", "epoch": 16}
{"loss": 0.39353689551353455, "acc": 0.8577318787574768, "length": 4.0, "mode": "test", "epoch": 16}
{"loss": 0.2578546404838562, "acc": 0.8920781016349792, "length": 3.9821712970733643, "mode": "train", "epoch": 17}
{"loss": 0.4020342230796814, "acc": 0.8527491092681885, "length": 4.0, "mode": "test", "epoch": 17}
{"loss": 0.24349530041217804, "acc": 0.9003425240516663, "length": 3.983916997909546, "mode": "train", "epoch": 18}
{"loss": 0.3762941360473633, "acc": 0.8644328713417053, "length": 4.0, "mode": "test", "epoch": 18}
{"loss": 0.23268157243728638, "acc": 0.9062662124633789, "length": 3.986660957336426, "mode": "train", "epoch": 19}
{"loss": 0.37992045283317566, "acc": 0.8604812026023865, "length": 4.0, "mode": "test", "epoch": 19}
{"loss": 0.2210332304239273, "acc": 0.9121244549751282, "length": 3.9900169372558594, "mode": "train", "epoch": 20}
{"loss": 0.38014447689056396, "acc": 0.8695876598358154, "length": 4.0, "mode": "test", "epoch": 20}
{"loss": 0.2167644053697586, "acc": 0.9112458229064941, "length": 3.991513252258301, "mode": "train", "epoch": 21}
{"loss": 0.3837362229824066, "acc": 0.8637456893920898, "length": 4.0, "mode": "test", "epoch": 21}
{"loss": 0.2129506915807724, "acc": 0.9153010845184326, "length": 3.990828275680542, "mode": "train", "epoch": 22}
{"loss": 0.36115288734436035, "acc": 0.8664947152137756, "length": 4.0, "mode": "test", "epoch": 22}
{"loss": 0.20338627696037292, "acc": 0.9203678965568542, "length": 3.993396759033203, "mode": "train", "epoch": 23}
{"loss": 0.36871957778930664, "acc": 0.8639174699783325, "length": 4.0, "mode": "test", "epoch": 23}
{"loss": 0.19800956547260284, "acc": 0.924384593963623, "length": 3.9943156242370605, "mode": "train", "epoch": 24}
{"loss": 0.3673250079154968, "acc": 0.86546391248703, "length": 4.0, "mode": "test", "epoch": 24}
{"loss": 0.19563260674476624, "acc": 0.9231055378913879, "length": 3.993776798248291, "mode": "train", "epoch": 25}
{"loss": 0.3508152365684509, "acc": 0.875429630279541, "length": 4.0, "mode": "test", "epoch": 25}
{"loss": 0.19228874146938324, "acc": 0.9263471961021423, "length": 3.9950003623962402, "mode": "train", "epoch": 26}
{"loss": 0.3631565570831299, "acc": 0.8702748417854309, "length": 4.0, "mode": "test", "epoch": 26}
{"loss": 0.19229771196842194, "acc": 0.9243090152740479, "length": 3.9951372146606445, "mode": "train", "epoch": 27}
{"loss": 0.3429943919181824, "acc": 0.8792096972465515, "length": 4.0, "mode": "test", "epoch": 27}
{"loss": 0.18401548266410828, "acc": 0.9302045702934265, "length": 3.9954445362091064, "mode": "train", "epoch": 28}
{"loss": 0.347897469997406, "acc": 0.8762887716293335, "length": 4.0, "mode": "test", "epoch": 28}
{"loss": 0.18079254031181335, "acc": 0.9338817596435547, "length": 3.9966533184051514, "mode": "train", "epoch": 29}
{"loss": 0.351267546415329, "acc": 0.875429630279541, "length": 4.0, "mode": "test", "epoch": 29}
{"loss": 0.17885936796665192, "acc": 0.9332209825515747, "length": 3.996917486190796, "mode": "train", "epoch": 30}
{"loss": 0.3220181465148926, "acc": 0.8841925263404846, "length": 4.0, "mode": "test", "epoch": 30}
{"loss": 0.17826904356479645, "acc": 0.9331910610198975, "length": 3.9968185424804688, "mode": "train", "epoch": 31}
{"loss": 0.33685851097106934, "acc": 0.8814433813095093, "length": 4.0, "mode": "test", "epoch": 31}
{"loss": 0.17193762958049774, "acc": 0.9370434880256653, "length": 3.99680233001709, "mode": "train", "epoch": 32}
{"loss": 0.331753134727478, "acc": 0.875257670879364, "length": 4.0, "mode": "test", "epoch": 32}
{"loss": 0.16881121695041656, "acc": 0.938622772693634, "length": 3.996988296508789, "mode": "train", "epoch": 33}
{"loss": 0.330888569355011, "acc": 0.8776631355285645, "length": 4.0, "mode": "test", "epoch": 33}
{"loss": 0.16713616251945496, "acc": 0.9375367760658264, "length": 3.997548818588257, "mode": "train", "epoch": 34}
{"loss": 0.31534111499786377, "acc": 0.8714776635169983, "length": 4.0, "mode": "test", "epoch": 34}
{"loss": 0.17103102803230286, "acc": 0.9357576370239258, "length": 3.9978489875793457, "mode": "train", "epoch": 35}
{"loss": 0.2977447509765625, "acc": 0.8871132731437683, "length": 4.0, "mode": "test", "epoch": 35}
{"loss": 0.16629299521446228, "acc": 0.93831866979599, "length": 3.9984142780303955, "mode": "train", "epoch": 36}
{"loss": 0.33493417501449585, "acc": 0.8953607678413391, "length": 4.0, "mode": "test", "epoch": 36}
{"loss": 0.15932409465312958, "acc": 0.9400426745414734, "length": 3.998183488845825, "mode": "train", "epoch": 37}
{"loss": 0.26873064041137695, "acc": 0.9008590579032898, "length": 4.0, "mode": "test", "epoch": 37}
{"loss": 0.16016514599323273, "acc": 0.9414767622947693, "length": 3.998400926589966, "mode": "train", "epoch": 38}
{"loss": 0.27565082907676697, "acc": 0.901889979839325, "length": 4.0, "mode": "test", "epoch": 38}
{"loss": 0.16164329648017883, "acc": 0.9389650821685791, "length": 3.9987528324127197, "mode": "train", "epoch": 39}
{"loss": 0.29271644353866577, "acc": 0.8974227905273438, "length": 4.0, "mode": "test", "epoch": 39}
{"loss": 0.15994587540626526, "acc": 0.9383882284164429, "length": 3.9986796379089355, "mode": "train", "epoch": 40}
{"loss": 0.2567240595817566, "acc": 0.9030929803848267, "length": 4.0, "mode": "test", "epoch": 40}
{"loss": 0.15357446670532227, "acc": 0.9419652819633484, "length": 3.998833179473877, "mode": "train", "epoch": 41}
{"loss": 0.27912354469299316, "acc": 0.9056700468063354, "length": 4.0, "mode": "test", "epoch": 41}
{"loss": 0.1470014750957489, "acc": 0.9442643523216248, "length": 3.9989731311798096, "mode": "train", "epoch": 42}
{"loss": 0.26036641001701355, "acc": 0.909278392791748, "length": 4.0, "mode": "test", "epoch": 42}
{"loss": 0.15343008935451508, "acc": 0.9402955770492554, "length": 3.9988176822662354, "mode": "train", "epoch": 43}
{"loss": 0.24616488814353943, "acc": 0.9178693294525146, "length": 4.0, "mode": "test", "epoch": 43}
{"loss": 0.14424529671669006, "acc": 0.9455341696739197, "length": 3.9990427494049072, "mode": "train", "epoch": 44}
{"loss": 0.24778088927268982, "acc": 0.914604902267456, "length": 4.0, "mode": "test", "epoch": 44}
{"loss": 0.14403660595417023, "acc": 0.9489855766296387, "length": 3.9990551471710205, "mode": "train", "epoch": 45}
{"loss": 0.24310597777366638, "acc": 0.9173539876937866, "length": 4.0, "mode": "test", "epoch": 45}
{"loss": 0.14060719311237335, "acc": 0.9472062587738037, "length": 3.99908709526062, "mode": "train", "epoch": 46}
{"loss": 0.23206016421318054, "acc": 0.926632285118103, "length": 4.0, "mode": "test", "epoch": 46}
{"loss": 0.13560856878757477, "acc": 0.9492222666740417, "length": 3.9991767406463623, "mode": "train", "epoch": 47}
{"loss": 0.22921358048915863, "acc": 0.9207903146743774, "length": 4.0, "mode": "test", "epoch": 47}
{"loss": 0.12685540318489075, "acc": 0.9536532163619995, "length": 3.9991512298583984, "mode": "train", "epoch": 48}
{"loss": 0.21678414940834045, "acc": 0.9240549802780151, "length": 4.0, "mode": "test", "epoch": 48}
{"loss": 0.12930063903331757, "acc": 0.9515207409858704, "length": 3.999051809310913, "mode": "train", "epoch": 49}
{"loss": 0.19946560263633728, "acc": 0.9221649765968323, "length": 4.0, "mode": "test", "epoch": 49}
{"loss": 0.12203006446361542, "acc": 0.954079270362854, "length": 3.997988700866699, "mode": "train", "epoch": 50}
{"loss": 0.2194717973470688, "acc": 0.92680424451828, "length": 4.0, "mode": "test", "epoch": 50}
{"loss": 0.12691247463226318, "acc": 0.9531965851783752, "length": 3.999285936355591, "mode": "train", "epoch": 51}
{"loss": 0.2046259343624115, "acc": 0.9249143004417419, "length": 4.0, "mode": "test", "epoch": 51}
{"loss": 0.12308963388204575, "acc": 0.9502666592597961, "length": 3.999373435974121, "mode": "train", "epoch": 52}
{"loss": 0.22015516459941864, "acc": 0.9257730841636658, "length": 4.0, "mode": "test", "epoch": 52}
{"loss": 0.11817923188209534, "acc": 0.955788791179657, "length": 3.9994137287139893, "mode": "train", "epoch": 53}
{"loss": 0.21099738776683807, "acc": 0.9293813705444336, "length": 4.0, "mode": "test", "epoch": 53}
{"loss": 0.11934205889701843, "acc": 0.9542908668518066, "length": 3.999180793762207, "mode": "train", "epoch": 54}
{"loss": 0.19506794214248657, "acc": 0.9256014227867126, "length": 4.0, "mode": "test", "epoch": 54}
{"loss": 0.11864766478538513, "acc": 0.9542967081069946, "length": 3.999315023422241, "mode": "train", "epoch": 55}
{"loss": 0.18463972210884094, "acc": 0.9314432740211487, "length": 4.0, "mode": "test", "epoch": 55}
{"loss": 0.1137399971485138, "acc": 0.9564865827560425, "length": 3.999561071395874, "mode": "train", "epoch": 56}
{"loss": 0.19703611731529236, "acc": 0.9278350472450256, "length": 4.0, "mode": "test", "epoch": 56}
{"loss": 0.11282100528478622, "acc": 0.9578673243522644, "length": 3.9995696544647217, "mode": "train", "epoch": 57}
{"loss": 0.19012713432312012, "acc": 0.9300686120986938, "length": 4.0, "mode": "test", "epoch": 57}
{"loss": 0.10844352096319199, "acc": 0.9576995968818665, "length": 3.999699592590332, "mode": "train", "epoch": 58}
{"loss": 0.19154569506645203, "acc": 0.9285224080085754, "length": 4.0, "mode": "test", "epoch": 58}
{"loss": 0.10597887635231018, "acc": 0.9639052748680115, "length": 3.9995017051696777, "mode": "train", "epoch": 59}
{"loss": 0.16719138622283936, "acc": 0.9355670213699341, "length": 4.0, "mode": "test", "epoch": 59}
{"loss": 0.10628314316272736, "acc": 0.9616061449050903, "length": 3.9993157386779785, "mode": "train", "epoch": 60}
{"loss": 0.1871984452009201, "acc": 0.9238831996917725, "length": 4.0, "mode": "test", "epoch": 60}
test accuracy: 0.7353571653366089
