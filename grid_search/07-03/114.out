# ["--attributes=3", "--values=16", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=64", "--learning_rate=0.001", "--hidden_size=256", "--temp_update=0.97", "--temperature=1"]
Creating train_ds and val_ds...

Creating test_ds...
{"loss": 0.7024146914482117, "acc": 0.5179141163825989, "length": 2.6268081665039062, "mode": "train", "epoch": 1}
{"loss": 0.6954501867294312, "acc": 0.48416367173194885, "length": 1.0, "mode": "test", "epoch": 1}
{"loss": 0.6611565351486206, "acc": 0.5804177522659302, "length": 1.685127854347229, "mode": "train", "epoch": 2}
{"loss": 0.6098012328147888, "acc": 0.6919060945510864, "length": 2.014234781265259, "mode": "test", "epoch": 2}
{"loss": 0.590516984462738, "acc": 0.6797534823417664, "length": 2.091921329498291, "mode": "train", "epoch": 3}
{"loss": 0.5674089789390564, "acc": 0.7286383509635925, "length": 2.4733095169067383, "mode": "test", "epoch": 3}
{"loss": 0.5497481822967529, "acc": 0.7282313108444214, "length": 2.4291200637817383, "mode": "train", "epoch": 4}
{"loss": 0.5216264128684998, "acc": 0.7388327121734619, "length": 2.7081849575042725, "mode": "test", "epoch": 4}
{"loss": 0.49934858083724976, "acc": 0.7527809143066406, "length": 2.521656036376953, "mode": "train", "epoch": 5}
{"loss": 0.5025033354759216, "acc": 0.7750077843666077, "length": 2.5266904830932617, "mode": "test", "epoch": 5}
{"loss": 0.4921707212924957, "acc": 0.7774800062179565, "length": 2.4702041149139404, "mode": "train", "epoch": 6}
{"loss": 0.48944830894470215, "acc": 0.7866291999816895, "length": 2.4519572257995605, "mode": "test", "epoch": 6}
{"loss": 0.47327834367752075, "acc": 0.7789610624313354, "length": 2.559276819229126, "mode": "train", "epoch": 7}
{"loss": 0.4786813259124756, "acc": 0.7793244123458862, "length": 2.4412810802459717, "mode": "test", "epoch": 7}
{"loss": 0.4462452232837677, "acc": 0.7923300266265869, "length": 2.6761629581451416, "mode": "train", "epoch": 8}
{"loss": 0.46600595116615295, "acc": 0.7782227993011475, "length": 2.654804229736328, "mode": "test", "epoch": 8}
{"loss": 0.42774778604507446, "acc": 0.801555335521698, "length": 2.9438273906707764, "mode": "train", "epoch": 9}
{"loss": 0.443996399641037, "acc": 0.8062734007835388, "length": 3.2099645137786865, "mode": "test", "epoch": 9}
{"loss": 0.3968783915042877, "acc": 0.8259674310684204, "length": 3.1221842765808105, "mode": "train", "epoch": 10}
{"loss": 0.4100242555141449, "acc": 0.814353346824646, "length": 3.2099645137786865, "mode": "test", "epoch": 10}
{"loss": 0.3662291467189789, "acc": 0.8430309891700745, "length": 3.3083600997924805, "mode": "train", "epoch": 11}
{"loss": 0.3657843768596649, "acc": 0.8350527882575989, "length": 3.423487663269043, "mode": "test", "epoch": 11}
{"loss": 0.34119099378585815, "acc": 0.8583787679672241, "length": 3.433077573776245, "mode": "train", "epoch": 12}
{"loss": 0.35632792115211487, "acc": 0.8367793560028076, "length": 3.177935838699341, "mode": "test", "epoch": 12}
{"loss": 0.3191858232021332, "acc": 0.8627707362174988, "length": 3.413808822631836, "mode": "train", "epoch": 13}
{"loss": 0.31995877623558044, "acc": 0.8714670538902283, "length": 3.412811279296875, "mode": "test", "epoch": 13}
{"loss": 0.29828763008117676, "acc": 0.8816011548042297, "length": 3.4229307174682617, "mode": "train", "epoch": 14}
{"loss": 0.31389138102531433, "acc": 0.8776573538780212, "length": 3.2775800228118896, "mode": "test", "epoch": 14}
{"loss": 0.3047545552253723, "acc": 0.8802589774131775, "length": 3.43235182762146, "mode": "train", "epoch": 15}
{"loss": 0.30137747526168823, "acc": 0.8802682757377625, "length": 3.1850533485412598, "mode": "test", "epoch": 15}
{"loss": 0.28508126735687256, "acc": 0.8864786028862, "length": 3.3017945289611816, "mode": "train", "epoch": 16}
{"loss": 0.3036719262599945, "acc": 0.8764923810958862, "length": 3.348754405975342, "mode": "test", "epoch": 16}
{"loss": 0.2896602749824524, "acc": 0.886624276638031, "length": 3.2991464138031006, "mode": "train", "epoch": 17}
{"loss": 0.27499446272850037, "acc": 0.8944176435470581, "length": 3.2277579307556152, "mode": "test", "epoch": 17}
{"loss": 0.2708410322666168, "acc": 0.8906695246696472, "length": 3.304386615753174, "mode": "train", "epoch": 18}
{"loss": 0.2824133038520813, "acc": 0.8823938369750977, "length": 3.3024911880493164, "mode": "test", "epoch": 18}
{"loss": 0.253164678812027, "acc": 0.8949072957038879, "length": 3.298635482788086, "mode": "train", "epoch": 19}
{"loss": 0.29402485489845276, "acc": 0.8923572301864624, "length": 3.2277579307556152, "mode": "test", "epoch": 19}
{"loss": 0.2586990296840668, "acc": 0.8985758423805237, "length": 3.2579493522644043, "mode": "train", "epoch": 20}
{"loss": 0.26484790444374084, "acc": 0.892602264881134, "length": 3.327402114868164, "mode": "test", "epoch": 20}
{"loss": 0.2575247883796692, "acc": 0.8982927799224854, "length": 3.3743057250976562, "mode": "train", "epoch": 21}
{"loss": 0.27852684259414673, "acc": 0.8946853280067444, "length": 3.416370153427124, "mode": "test", "epoch": 21}
{"loss": 0.25143808126449585, "acc": 0.900672435760498, "length": 3.4209067821502686, "mode": "train", "epoch": 22}
{"loss": 0.25267496705055237, "acc": 0.9045315384864807, "length": 3.323843479156494, "mode": "test", "epoch": 22}
{"loss": 0.24425238370895386, "acc": 0.9034729599952698, "length": 3.374239444732666, "mode": "train", "epoch": 23}
{"loss": 0.2798108756542206, "acc": 0.8912234902381897, "length": 3.4804270267486572, "mode": "test", "epoch": 23}
{"loss": 0.22668473422527313, "acc": 0.9111321568489075, "length": 3.470930576324463, "mode": "train", "epoch": 24}
{"loss": 0.26529017090797424, "acc": 0.9108858704566956, "length": 3.654804229736328, "mode": "test", "epoch": 24}
{"loss": 0.22606691718101501, "acc": 0.9134066104888916, "length": 3.641483783721924, "mode": "train", "epoch": 25}
{"loss": 0.27557501196861267, "acc": 0.895782470703125, "length": 3.6120996475219727, "mode": "test", "epoch": 25}
{"loss": 0.22757235169410706, "acc": 0.9095883369445801, "length": 3.6876473426818848, "mode": "train", "epoch": 26}
{"loss": 0.24297121167182922, "acc": 0.9159681797027588, "length": 3.6192171573638916, "mode": "test", "epoch": 26}
{"loss": 0.21380867063999176, "acc": 0.918222188949585, "length": 3.713815212249756, "mode": "train", "epoch": 27}
{"loss": 0.2503030300140381, "acc": 0.9133234620094299, "length": 3.8007116317749023, "mode": "test", "epoch": 27}
{"loss": 0.20400525629520416, "acc": 0.9165413975715637, "length": 3.8559980392456055, "mode": "train", "epoch": 28}
{"loss": 0.2648836672306061, "acc": 0.9057055711746216, "length": 3.8718860149383545, "mode": "test", "epoch": 28}
{"loss": 0.19181042909622192, "acc": 0.9289997220039368, "length": 3.8458220958709717, "mode": "train", "epoch": 29}
{"loss": 0.20093245804309845, "acc": 0.9241687059402466, "length": 3.9715301990509033, "mode": "test", "epoch": 29}
{"loss": 0.18619123101234436, "acc": 0.9312691688537598, "length": 3.9207656383514404, "mode": "train", "epoch": 30}
{"loss": 0.20145928859710693, "acc": 0.9286478161811829, "length": 4.0, "mode": "test", "epoch": 30}
{"loss": 0.19049039483070374, "acc": 0.9309762716293335, "length": 3.9917993545532227, "mode": "train", "epoch": 31}
{"loss": 0.19603367149829865, "acc": 0.9286478161811829, "length": 4.0, "mode": "test", "epoch": 31}
{"loss": 0.17309622466564178, "acc": 0.9303200840950012, "length": 3.9925525188446045, "mode": "train", "epoch": 32}
{"loss": 0.1802935153245926, "acc": 0.9316725730895996, "length": 4.0, "mode": "test", "epoch": 32}
{"loss": 0.1561528742313385, "acc": 0.9396808743476868, "length": 3.9932539463043213, "mode": "train", "epoch": 33}
{"loss": 0.1663924902677536, "acc": 0.9325623512268066, "length": 4.0, "mode": "test", "epoch": 33}
{"loss": 0.137502521276474, "acc": 0.9466133117675781, "length": 3.993633985519409, "mode": "train", "epoch": 34}
{"loss": 0.14581674337387085, "acc": 0.9373667240142822, "length": 4.0, "mode": "test", "epoch": 34}
{"loss": 0.1184721440076828, "acc": 0.9538588523864746, "length": 3.9931764602661133, "mode": "train", "epoch": 35}
{"loss": 0.1790839284658432, "acc": 0.9313168525695801, "length": 4.0, "mode": "test", "epoch": 35}
{"loss": 0.11899406462907791, "acc": 0.9552505612373352, "length": 3.992265462875366, "mode": "train", "epoch": 36}
{"loss": 0.17497727274894714, "acc": 0.9316725730895996, "length": 4.0, "mode": "test", "epoch": 36}
{"loss": 0.13816924393177032, "acc": 0.9517683386802673, "length": 3.993133783340454, "mode": "train", "epoch": 37}
{"loss": 0.2152673304080963, "acc": 0.9275800585746765, "length": 4.0, "mode": "test", "epoch": 37}
{"loss": 0.14373748004436493, "acc": 0.9391109943389893, "length": 3.997992753982544, "mode": "train", "epoch": 38}
{"loss": 0.1841748058795929, "acc": 0.927402138710022, "length": 4.0, "mode": "test", "epoch": 38}
{"loss": 0.1364833116531372, "acc": 0.9457396864891052, "length": 3.9952878952026367, "mode": "train", "epoch": 39}
{"loss": 0.1794394701719284, "acc": 0.9345195889472961, "length": 4.0, "mode": "test", "epoch": 39}
{"loss": 0.13993752002716064, "acc": 0.95061194896698, "length": 3.996774911880493, "mode": "train", "epoch": 40}
{"loss": 0.20406265556812286, "acc": 0.928469717502594, "length": 4.0, "mode": "test", "epoch": 40}
{"loss": 0.1263103485107422, "acc": 0.9560503959655762, "length": 3.99753999710083, "mode": "train", "epoch": 41}
{"loss": 0.1756972074508667, "acc": 0.9359431862831116, "length": 4.0, "mode": "test", "epoch": 41}
{"loss": 0.1054561510682106, "acc": 0.958204984664917, "length": 3.995837926864624, "mode": "train", "epoch": 42}
{"loss": 0.13947565853595734, "acc": 0.9457293152809143, "length": 4.0, "mode": "test", "epoch": 42}
{"loss": 0.10016117990016937, "acc": 0.961283802986145, "length": 3.9976603984832764, "mode": "train", "epoch": 43}
{"loss": 0.15022270381450653, "acc": 0.944305956363678, "length": 4.0, "mode": "test", "epoch": 43}
{"loss": 0.09663201123476028, "acc": 0.9601585865020752, "length": 3.9975626468658447, "mode": "train", "epoch": 44}
{"loss": 0.11431243270635605, "acc": 0.9612098932266235, "length": 4.0, "mode": "test", "epoch": 44}
{"loss": 0.10191791504621506, "acc": 0.9623851776123047, "length": 3.9992454051971436, "mode": "train", "epoch": 45}
{"loss": 0.1363847255706787, "acc": 0.956583559513092, "length": 4.0, "mode": "test", "epoch": 45}
{"loss": 0.11110445857048035, "acc": 0.9599761366844177, "length": 3.998159885406494, "mode": "train", "epoch": 46}
{"loss": 0.12822583317756653, "acc": 0.956583559513092, "length": 4.0, "mode": "test", "epoch": 46}
{"loss": 0.10444680601358414, "acc": 0.9664762616157532, "length": 3.9984357357025146, "mode": "train", "epoch": 47}
{"loss": 0.15132395923137665, "acc": 0.9499999284744263, "length": 4.0, "mode": "test", "epoch": 47}
{"loss": 0.08999653905630112, "acc": 0.9652981162071228, "length": 3.996382713317871, "mode": "train", "epoch": 48}
{"loss": 0.15799690783023834, "acc": 0.9530247449874878, "length": 4.0, "mode": "test", "epoch": 48}
{"loss": 0.09060939401388168, "acc": 0.9654557108879089, "length": 3.9960618019104004, "mode": "train", "epoch": 49}
{"loss": 0.14572222530841827, "acc": 0.9540925621986389, "length": 4.0, "mode": "test", "epoch": 49}
{"loss": 0.09138157218694687, "acc": 0.9708489775657654, "length": 3.997553825378418, "mode": "train", "epoch": 50}
{"loss": 0.11411161720752716, "acc": 0.9603202939033508, "length": 4.0, "mode": "test", "epoch": 50}
{"loss": 0.10187555849552155, "acc": 0.9633874893188477, "length": 3.998562812805176, "mode": "train", "epoch": 51}
{"loss": 0.166298970580101, "acc": 0.9371886253356934, "length": 4.0, "mode": "test", "epoch": 51}
{"loss": 0.12102428823709488, "acc": 0.952961802482605, "length": 3.994865655899048, "mode": "train", "epoch": 52}
{"loss": 0.12780983746051788, "acc": 0.9485764503479004, "length": 4.0, "mode": "test", "epoch": 52}
{"loss": 0.09828484803438187, "acc": 0.9651736617088318, "length": 3.997056007385254, "mode": "train", "epoch": 53}
{"loss": 0.16799066960811615, "acc": 0.9521352052688599, "length": 4.0, "mode": "test", "epoch": 53}
{"loss": 0.07893772423267365, "acc": 0.9710542559623718, "length": 3.9980194568634033, "mode": "train", "epoch": 54}
{"loss": 0.1407993733882904, "acc": 0.9526689648628235, "length": 4.0, "mode": "test", "epoch": 54}
{"loss": 0.0764116570353508, "acc": 0.9731095433235168, "length": 3.999436140060425, "mode": "train", "epoch": 55}
{"loss": 0.14256976544857025, "acc": 0.9569394588470459, "length": 4.0, "mode": "test", "epoch": 55}
{"loss": 0.07339665293693542, "acc": 0.9750233292579651, "length": 3.9997241497039795, "mode": "train", "epoch": 56}
{"loss": 0.14219112694263458, "acc": 0.9574732780456543, "length": 4.0, "mode": "test", "epoch": 56}
{"loss": 0.15040433406829834, "acc": 0.9513110518455505, "length": 3.995551586151123, "mode": "train", "epoch": 57}
{"loss": 0.26854225993156433, "acc": 0.9154805541038513, "length": 4.0, "mode": "test", "epoch": 57}
{"loss": 0.2085382640361786, "acc": 0.9288471341133118, "length": 3.9947848320007324, "mode": "train", "epoch": 58}
{"loss": 0.2112145721912384, "acc": 0.9266904592514038, "length": 4.0, "mode": "test", "epoch": 58}
{"loss": 0.1702975332736969, "acc": 0.941231369972229, "length": 3.9959707260131836, "mode": "train", "epoch": 59}
{"loss": 0.24267664551734924, "acc": 0.9330959916114807, "length": 4.0, "mode": "test", "epoch": 59}
{"loss": 0.12006324529647827, "acc": 0.9548153877258301, "length": 3.9993622303009033, "mode": "train", "epoch": 60}
{"loss": 0.1894088089466095, "acc": 0.9425268173217773, "length": 4.0, "mode": "test", "epoch": 60}
test accuracy: 0.8760937452316284
