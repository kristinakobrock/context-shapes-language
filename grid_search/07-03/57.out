# ["--attributes=3", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=128", "--learning_rate=0.0005", "--hidden_size=256", "--temp_update=0.99", "--temperature=1"]
Creating train_ds and val_ds...

Creating test_ds...
{"loss": 0.7000759243965149, "acc": 0.5176818370819092, "length": 3.4968667030334473, "mode": "train", "epoch": 1}
{"loss": 0.6924602389335632, "acc": 0.5083038806915283, "length": 1.0, "mode": "test", "epoch": 1}
{"loss": 0.6907952427864075, "acc": 0.5196089744567871, "length": 3.1079680919647217, "mode": "train", "epoch": 2}
{"loss": 0.6942981481552124, "acc": 0.47084805369377136, "length": 1.0, "mode": "test", "epoch": 2}
{"loss": 0.6869580745697021, "acc": 0.5383520126342773, "length": 2.6117265224456787, "mode": "train", "epoch": 3}
{"loss": 0.6893833875656128, "acc": 0.5161066651344299, "length": 1.0424028635025024, "mode": "test", "epoch": 3}
{"loss": 0.6666602492332458, "acc": 0.6014651656150818, "length": 2.8221120834350586, "mode": "train", "epoch": 4}
{"loss": 0.6331856846809387, "acc": 0.6785497665405273, "length": 3.547703266143799, "mode": "test", "epoch": 4}
{"loss": 0.6217750906944275, "acc": 0.7024893760681152, "length": 3.380512237548828, "mode": "train", "epoch": 5}
{"loss": 0.5631805658340454, "acc": 0.723325788974762, "length": 3.9929327964782715, "mode": "test", "epoch": 5}
{"loss": 0.5388155579566956, "acc": 0.7685239911079407, "length": 3.871316909790039, "mode": "train", "epoch": 6}
{"loss": 0.5031200647354126, "acc": 0.7650176286697388, "length": 4.0, "mode": "test", "epoch": 6}
{"loss": 0.47341418266296387, "acc": 0.7834263443946838, "length": 3.9624814987182617, "mode": "train", "epoch": 7}
{"loss": 0.49067795276641846, "acc": 0.7634276151657104, "length": 4.0, "mode": "test", "epoch": 7}
{"loss": 0.4566378891468048, "acc": 0.7817060947418213, "length": 3.978743076324463, "mode": "train", "epoch": 8}
{"loss": 0.4840248227119446, "acc": 0.7954064011573792, "length": 4.0, "mode": "test", "epoch": 8}
{"loss": 0.4465455412864685, "acc": 0.7934225797653198, "length": 3.9862279891967773, "mode": "train", "epoch": 9}
{"loss": 0.4805065095424652, "acc": 0.7943462133407593, "length": 4.0, "mode": "test", "epoch": 9}
{"loss": 0.4309307634830475, "acc": 0.8039112687110901, "length": 3.9874982833862305, "mode": "train", "epoch": 10}
{"loss": 0.45450517535209656, "acc": 0.7878091335296631, "length": 4.0, "mode": "test", "epoch": 10}
{"loss": 0.4129125773906708, "acc": 0.813377320766449, "length": 3.9908499717712402, "mode": "train", "epoch": 11}
{"loss": 0.4375092387199402, "acc": 0.8121908903121948, "length": 4.0, "mode": "test", "epoch": 11}
{"loss": 0.3993934988975525, "acc": 0.8199408054351807, "length": 3.9867539405822754, "mode": "train", "epoch": 12}
{"loss": 0.4312903881072998, "acc": 0.8137809038162231, "length": 4.0, "mode": "test", "epoch": 12}
{"loss": 0.38203296065330505, "acc": 0.8275470733642578, "length": 3.992347240447998, "mode": "train", "epoch": 13}
{"loss": 0.4142265319824219, "acc": 0.8174912929534912, "length": 4.0, "mode": "test", "epoch": 13}
{"loss": 0.370185911655426, "acc": 0.8275253772735596, "length": 3.994419813156128, "mode": "train", "epoch": 14}
{"loss": 0.42044851183891296, "acc": 0.808127224445343, "length": 4.0, "mode": "test", "epoch": 14}
{"loss": 0.35992833971977234, "acc": 0.8358330130577087, "length": 3.9929018020629883, "mode": "train", "epoch": 15}
{"loss": 0.4050852060317993, "acc": 0.8227914571762085, "length": 4.0, "mode": "test", "epoch": 15}
{"loss": 0.3464968502521515, "acc": 0.84987872838974, "length": 3.9962105751037598, "mode": "train", "epoch": 16}
{"loss": 0.3834519386291504, "acc": 0.8325087428092957, "length": 4.0, "mode": "test", "epoch": 16}
{"loss": 0.3354783356189728, "acc": 0.8522847890853882, "length": 3.9947752952575684, "mode": "train", "epoch": 17}
{"loss": 0.37445780634880066, "acc": 0.8372791409492493, "length": 4.0, "mode": "test", "epoch": 17}
{"loss": 0.3247755467891693, "acc": 0.861280620098114, "length": 3.993187665939331, "mode": "train", "epoch": 18}
{"loss": 0.3611738085746765, "acc": 0.8432862758636475, "length": 4.0, "mode": "test", "epoch": 18}
{"loss": 0.31094348430633545, "acc": 0.8678151369094849, "length": 3.9922375679016113, "mode": "train", "epoch": 19}
{"loss": 0.344832181930542, "acc": 0.8558304309844971, "length": 4.0, "mode": "test", "epoch": 19}
{"loss": 0.2987750470638275, "acc": 0.867665708065033, "length": 3.9926035404205322, "mode": "train", "epoch": 20}
{"loss": 0.3402707278728485, "acc": 0.8586573600769043, "length": 4.0, "mode": "test", "epoch": 20}
{"loss": 0.29173994064331055, "acc": 0.8732468485832214, "length": 3.994394540786743, "mode": "train", "epoch": 21}
{"loss": 0.3330082893371582, "acc": 0.8618373870849609, "length": 4.0, "mode": "test", "epoch": 21}
{"loss": 0.28904837369918823, "acc": 0.8760064840316772, "length": 3.996096134185791, "mode": "train", "epoch": 22}
{"loss": 0.32535460591316223, "acc": 0.8650176525115967, "length": 4.0, "mode": "test", "epoch": 22}
{"loss": 0.27879780530929565, "acc": 0.8777359127998352, "length": 3.9967575073242188, "mode": "train", "epoch": 23}
{"loss": 0.32323288917541504, "acc": 0.8586573600769043, "length": 4.0, "mode": "test", "epoch": 23}
{"loss": 0.28072795271873474, "acc": 0.8741112351417542, "length": 3.995734214782715, "mode": "train", "epoch": 24}
{"loss": 0.3183935880661011, "acc": 0.8713781237602234, "length": 4.0, "mode": "test", "epoch": 24}
{"loss": 0.2723183035850525, "acc": 0.8766948580741882, "length": 3.9982550144195557, "mode": "train", "epoch": 25}
{"loss": 0.2975063920021057, "acc": 0.8750883340835571, "length": 4.0, "mode": "test", "epoch": 25}
{"loss": 0.26571327447891235, "acc": 0.8844451904296875, "length": 3.997060537338257, "mode": "train", "epoch": 26}
{"loss": 0.29772114753723145, "acc": 0.8738516569137573, "length": 4.0, "mode": "test", "epoch": 26}
{"loss": 0.269514799118042, "acc": 0.8820244669914246, "length": 3.9980878829956055, "mode": "train", "epoch": 27}
{"loss": 0.2933046519756317, "acc": 0.8743817210197449, "length": 4.0, "mode": "test", "epoch": 27}
{"loss": 0.25276923179626465, "acc": 0.8904695510864258, "length": 3.9988622665405273, "mode": "train", "epoch": 28}
{"loss": 0.28597527742385864, "acc": 0.8807421326637268, "length": 4.0, "mode": "test", "epoch": 28}
{"loss": 0.25197818875312805, "acc": 0.8940553069114685, "length": 3.998457431793213, "mode": "train", "epoch": 29}
{"loss": 0.2718236446380615, "acc": 0.8878092169761658, "length": 4.0, "mode": "test", "epoch": 29}
{"loss": 0.24698810279369354, "acc": 0.8924554586410522, "length": 3.9979326725006104, "mode": "train", "epoch": 30}
{"loss": 0.2768229842185974, "acc": 0.8825089335441589, "length": 4.0, "mode": "test", "epoch": 30}
{"loss": 0.2424093633890152, "acc": 0.8977344632148743, "length": 3.9990947246551514, "mode": "train", "epoch": 31}
{"loss": 0.2762008309364319, "acc": 0.8851591348648071, "length": 4.0, "mode": "test", "epoch": 31}
{"loss": 0.2445501983165741, "acc": 0.8950231075286865, "length": 3.9991707801818848, "mode": "train", "epoch": 32}
{"loss": 0.2731402814388275, "acc": 0.8893992304801941, "length": 4.0, "mode": "test", "epoch": 32}
{"loss": 0.2430540770292282, "acc": 0.8951539993286133, "length": 3.9995806217193604, "mode": "train", "epoch": 33}
{"loss": 0.27404525876045227, "acc": 0.8943463563919067, "length": 4.0, "mode": "test", "epoch": 33}
{"loss": 0.2423122674226761, "acc": 0.8950361609458923, "length": 3.999758720397949, "mode": "train", "epoch": 34}
{"loss": 0.25743567943573, "acc": 0.8941695690155029, "length": 4.0, "mode": "test", "epoch": 34}
{"loss": 0.2283262312412262, "acc": 0.9033617973327637, "length": 3.9998576641082764, "mode": "train", "epoch": 35}
{"loss": 0.26398319005966187, "acc": 0.8839224576950073, "length": 4.0, "mode": "test", "epoch": 35}
{"loss": 0.23664645850658417, "acc": 0.8956254720687866, "length": 3.9997336864471436, "mode": "train", "epoch": 36}
{"loss": 0.250977486371994, "acc": 0.8929327726364136, "length": 4.0, "mode": "test", "epoch": 36}
{"loss": 0.22230561077594757, "acc": 0.9050685167312622, "length": 3.9997050762176514, "mode": "train", "epoch": 37}
{"loss": 0.243697389960289, "acc": 0.8966430425643921, "length": 4.0, "mode": "test", "epoch": 37}
{"loss": 0.22091349959373474, "acc": 0.9049561023712158, "length": 3.999828815460205, "mode": "train", "epoch": 38}
{"loss": 0.24915605783462524, "acc": 0.8946996927261353, "length": 4.0, "mode": "test", "epoch": 38}
{"loss": 0.2176004946231842, "acc": 0.9028908610343933, "length": 3.999861001968384, "mode": "train", "epoch": 39}
{"loss": 0.24730828404426575, "acc": 0.8906360268592834, "length": 4.0, "mode": "test", "epoch": 39}
{"loss": 0.20927640795707703, "acc": 0.9058989882469177, "length": 3.999687433242798, "mode": "train", "epoch": 40}
{"loss": 0.23853331804275513, "acc": 0.8945230841636658, "length": 4.0, "mode": "test", "epoch": 40}
{"loss": 0.2087724506855011, "acc": 0.9062549471855164, "length": 3.9998133182525635, "mode": "train", "epoch": 41}
{"loss": 0.2502560615539551, "acc": 0.8966429829597473, "length": 4.0, "mode": "test", "epoch": 41}
{"loss": 0.21120934188365936, "acc": 0.907791018486023, "length": 3.9998509883880615, "mode": "train", "epoch": 42}
{"loss": 0.2518564760684967, "acc": 0.903003454208374, "length": 4.0, "mode": "test", "epoch": 42}
{"loss": 0.20075646042823792, "acc": 0.9110956192016602, "length": 3.9998362064361572, "mode": "train", "epoch": 43}
{"loss": 0.24489431083202362, "acc": 0.8975264430046082, "length": 4.0, "mode": "test", "epoch": 43}
{"loss": 0.20071521401405334, "acc": 0.9132741093635559, "length": 3.9994800090789795, "mode": "train", "epoch": 44}
{"loss": 0.23668405413627625, "acc": 0.9056537747383118, "length": 4.0, "mode": "test", "epoch": 44}
{"loss": 0.19645458459854126, "acc": 0.9106842279434204, "length": 3.999959945678711, "mode": "train", "epoch": 45}
{"loss": 0.22973525524139404, "acc": 0.9031801819801331, "length": 4.0, "mode": "test", "epoch": 45}
{"loss": 0.19455678761005402, "acc": 0.9142662882804871, "length": 3.9992246627807617, "mode": "train", "epoch": 46}
{"loss": 0.2311284989118576, "acc": 0.9028269648551941, "length": 4.0, "mode": "test", "epoch": 46}
{"loss": 0.19010965526103973, "acc": 0.9159970879554749, "length": 3.9999184608459473, "mode": "train", "epoch": 47}
{"loss": 0.2102373093366623, "acc": 0.9084804654121399, "length": 4.0, "mode": "test", "epoch": 47}
{"loss": 0.19002319872379303, "acc": 0.917820930480957, "length": 3.9997169971466064, "mode": "train", "epoch": 48}
{"loss": 0.23387086391448975, "acc": 0.9017667770385742, "length": 4.0, "mode": "test", "epoch": 48}
{"loss": 0.19490201771259308, "acc": 0.9164076447486877, "length": 3.999817371368408, "mode": "train", "epoch": 49}
{"loss": 0.20053055882453918, "acc": 0.9123674035072327, "length": 4.0, "mode": "test", "epoch": 49}
{"loss": 0.18389518558979034, "acc": 0.9182249307632446, "length": 3.9986250400543213, "mode": "train", "epoch": 50}
{"loss": 0.20401132106781006, "acc": 0.9113073945045471, "length": 4.0, "mode": "test", "epoch": 50}
{"loss": 0.17794190347194672, "acc": 0.9220177531242371, "length": 3.999934196472168, "mode": "train", "epoch": 51}
{"loss": 0.19438567757606506, "acc": 0.9121907949447632, "length": 4.0, "mode": "test", "epoch": 51}
{"loss": 0.17578187584877014, "acc": 0.922408938407898, "length": 3.999051094055176, "mode": "train", "epoch": 52}
{"loss": 0.22883695363998413, "acc": 0.9072439074516296, "length": 4.0, "mode": "test", "epoch": 52}
{"loss": 0.1708347052335739, "acc": 0.9236122369766235, "length": 3.999955654144287, "mode": "train", "epoch": 53}
{"loss": 0.2041129767894745, "acc": 0.9053003787994385, "length": 4.0, "mode": "test", "epoch": 53}
{"loss": 0.16686369478702545, "acc": 0.9269713163375854, "length": 3.9996719360351562, "mode": "train", "epoch": 54}
{"loss": 0.1875782459974289, "acc": 0.9197879433631897, "length": 4.0, "mode": "test", "epoch": 54}
{"loss": 0.1601303666830063, "acc": 0.9331729412078857, "length": 3.9998505115509033, "mode": "train", "epoch": 55}
{"loss": 0.1786617487668991, "acc": 0.9146642088890076, "length": 4.0, "mode": "test", "epoch": 55}
{"loss": 0.16333284974098206, "acc": 0.9256612062454224, "length": 3.998748779296875, "mode": "train", "epoch": 56}
{"loss": 0.18176433444023132, "acc": 0.9160779714584351, "length": 4.0, "mode": "test", "epoch": 56}
{"loss": 0.16883043944835663, "acc": 0.9261496663093567, "length": 3.999919891357422, "mode": "train", "epoch": 57}
{"loss": 0.19138115644454956, "acc": 0.9234981536865234, "length": 4.0, "mode": "test", "epoch": 57}
{"loss": 0.1610177606344223, "acc": 0.9265046119689941, "length": 3.9998984336853027, "mode": "train", "epoch": 58}
{"loss": 0.19635605812072754, "acc": 0.913780927658081, "length": 4.0, "mode": "test", "epoch": 58}
{"loss": 0.15900646150112152, "acc": 0.9306958913803101, "length": 3.99997878074646, "mode": "train", "epoch": 59}
{"loss": 0.18332606554031372, "acc": 0.9199645519256592, "length": 4.0, "mode": "test", "epoch": 59}
{"loss": 0.14609327912330627, "acc": 0.9348862767219543, "length": 3.9998910427093506, "mode": "train", "epoch": 60}
{"loss": 0.17862862348556519, "acc": 0.9309188723564148, "length": 4.0, "mode": "test", "epoch": 60}
test accuracy: 0.8353226184844971
