# ["--attributes=5", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.97", "--temperature=2"]
Creating train_ds and val_ds...

Creating test_ds...
{"loss": 0.6957405805587769, "acc": 0.5189405679702759, "length": 3.0383477210998535, "mode": "train", "epoch": 1}
{"loss": 0.6937939524650574, "acc": 0.49878475069999695, "length": 1.0, "mode": "test", "epoch": 1}
{"loss": 0.6537807583808899, "acc": 0.6311380863189697, "length": 2.7447314262390137, "mode": "train", "epoch": 2}
{"loss": 0.5770096182823181, "acc": 0.6879231929779053, "length": 3.4270832538604736, "mode": "test", "epoch": 2}
{"loss": 0.5301761031150818, "acc": 0.7361037135124207, "length": 3.3687312602996826, "mode": "train", "epoch": 3}
{"loss": 0.4861951470375061, "acc": 0.7742241621017456, "length": 3.663194417953491, "mode": "test", "epoch": 3}
{"loss": 0.4166448414325714, "acc": 0.818352997303009, "length": 3.6182806491851807, "mode": "train", "epoch": 4}
{"loss": 0.41400355100631714, "acc": 0.8168999552726746, "length": 3.875, "mode": "test", "epoch": 4}
{"loss": 0.36133795976638794, "acc": 0.8478142023086548, "length": 3.703361988067627, "mode": "train", "epoch": 5}
{"loss": 0.4166781008243561, "acc": 0.8124783039093018, "length": 3.899305582046509, "mode": "test", "epoch": 5}
{"loss": 0.32586538791656494, "acc": 0.8643285036087036, "length": 3.760141372680664, "mode": "train", "epoch": 6}
{"loss": 0.3975101709365845, "acc": 0.8390787839889526, "length": 3.9895832538604736, "mode": "test", "epoch": 6}
{"loss": 0.30384501814842224, "acc": 0.8784142136573792, "length": 3.8092784881591797, "mode": "train", "epoch": 7}
{"loss": 0.440219908952713, "acc": 0.8344292640686035, "length": 3.993055582046509, "mode": "test", "epoch": 7}
{"loss": 0.2846793830394745, "acc": 0.8843345642089844, "length": 3.844172954559326, "mode": "train", "epoch": 8}
{"loss": 0.39355969429016113, "acc": 0.8493706583976746, "length": 3.975694417953491, "mode": "test", "epoch": 8}
{"loss": 0.25762924551963806, "acc": 0.8963430523872375, "length": 3.86716890335083, "mode": "train", "epoch": 9}
{"loss": 0.35873398184776306, "acc": 0.8637858033180237, "length": 3.9583332538604736, "mode": "test", "epoch": 9}
{"loss": 0.23956739902496338, "acc": 0.9048032164573669, "length": 3.8559179306030273, "mode": "train", "epoch": 10}
{"loss": 0.38712844252586365, "acc": 0.8658745288848877, "length": 3.975694417953491, "mode": "test", "epoch": 10}
{"loss": 0.22965584695339203, "acc": 0.9133409857749939, "length": 3.87746000289917, "mode": "train", "epoch": 11}
{"loss": 0.3538917899131775, "acc": 0.8752821683883667, "length": 3.90625, "mode": "test", "epoch": 11}
{"loss": 0.21133902668952942, "acc": 0.920677125453949, "length": 3.8565549850463867, "mode": "train", "epoch": 12}
{"loss": 0.3456786870956421, "acc": 0.8759603500366211, "length": 3.934027671813965, "mode": "test", "epoch": 12}
{"loss": 0.19765475392341614, "acc": 0.9271377325057983, "length": 3.8666374683380127, "mode": "train", "epoch": 13}
{"loss": 0.3294113576412201, "acc": 0.8921496272087097, "length": 3.9548611640930176, "mode": "test", "epoch": 13}
{"loss": 0.18050912022590637, "acc": 0.9313035011291504, "length": 3.9168901443481445, "mode": "train", "epoch": 14}
{"loss": 0.29272907972335815, "acc": 0.9043402075767517, "length": 4.0, "mode": "test", "epoch": 14}
{"loss": 0.16462646424770355, "acc": 0.9368381500244141, "length": 3.9489238262176514, "mode": "train", "epoch": 15}
{"loss": 0.35114943981170654, "acc": 0.8692708015441895, "length": 4.0, "mode": "test", "epoch": 15}
{"loss": 0.1640610694885254, "acc": 0.9375820159912109, "length": 3.968923807144165, "mode": "train", "epoch": 16}
{"loss": 0.2806708514690399, "acc": 0.9123263955116272, "length": 4.0, "mode": "test", "epoch": 16}
{"loss": 0.14281660318374634, "acc": 0.9503703713417053, "length": 3.968985080718994, "mode": "train", "epoch": 17}
{"loss": 0.25339120626449585, "acc": 0.9151042103767395, "length": 4.0, "mode": "test", "epoch": 17}
{"loss": 0.13232965767383575, "acc": 0.9524332284927368, "length": 3.9695889949798584, "mode": "train", "epoch": 18}
{"loss": 0.2296360284090042, "acc": 0.9282986521720886, "length": 4.0, "mode": "test", "epoch": 18}
{"loss": 0.12579642236232758, "acc": 0.9519996643066406, "length": 3.9751808643341064, "mode": "train", "epoch": 19}
{"loss": 0.26776981353759766, "acc": 0.9133681058883667, "length": 4.0, "mode": "test", "epoch": 19}
{"loss": 0.12423890829086304, "acc": 0.9523168206214905, "length": 3.967879295349121, "mode": "train", "epoch": 20}
{"loss": 0.24650178849697113, "acc": 0.9201388955116272, "length": 4.0, "mode": "test", "epoch": 20}
{"loss": 0.11505622416734695, "acc": 0.9586234092712402, "length": 3.969669818878174, "mode": "train", "epoch": 21}
{"loss": 0.26047283411026, "acc": 0.9194445013999939, "length": 4.0, "mode": "test", "epoch": 21}
{"loss": 0.11344359815120697, "acc": 0.9600827097892761, "length": 3.9545328617095947, "mode": "train", "epoch": 22}
{"loss": 0.23737160861492157, "acc": 0.9363281726837158, "length": 3.9895832538604736, "mode": "test", "epoch": 22}
{"loss": 0.11020764708518982, "acc": 0.9610419869422913, "length": 3.968050718307495, "mode": "train", "epoch": 23}
{"loss": 0.23781831562519073, "acc": 0.9307292103767395, "length": 4.0, "mode": "test", "epoch": 23}
{"loss": 0.10732310265302658, "acc": 0.9608793258666992, "length": 3.9629690647125244, "mode": "train", "epoch": 24}
{"loss": 0.19252726435661316, "acc": 0.9225801825523376, "length": 3.965277671813965, "mode": "test", "epoch": 24}
{"loss": 0.1012737825512886, "acc": 0.9638797640800476, "length": 3.9549455642700195, "mode": "train", "epoch": 25}
{"loss": 0.20806194841861725, "acc": 0.9346625208854675, "length": 3.9895832538604736, "mode": "test", "epoch": 25}
{"loss": 0.09738115966320038, "acc": 0.9646198153495789, "length": 3.9656152725219727, "mode": "train", "epoch": 26}
{"loss": 0.1851375699043274, "acc": 0.9415364861488342, "length": 3.9826388359069824, "mode": "test", "epoch": 26}
{"loss": 0.09476049989461899, "acc": 0.9646398425102234, "length": 3.9603965282440186, "mode": "train", "epoch": 27}
{"loss": 0.19399093091487885, "acc": 0.9430446624755859, "length": 3.993055582046509, "mode": "test", "epoch": 27}
{"loss": 0.0915331244468689, "acc": 0.9665350317955017, "length": 3.967883348464966, "mode": "train", "epoch": 28}
{"loss": 0.17780239880084991, "acc": 0.9406411647796631, "length": 3.993055582046509, "mode": "test", "epoch": 28}
{"loss": 0.08598002791404724, "acc": 0.9695212841033936, "length": 3.9678080081939697, "mode": "train", "epoch": 29}
{"loss": 0.149837464094162, "acc": 0.9515244960784912, "length": 3.993055582046509, "mode": "test", "epoch": 29}
{"loss": 0.08058708906173706, "acc": 0.9707437753677368, "length": 3.976027011871338, "mode": "train", "epoch": 30}
{"loss": 0.16124176979064941, "acc": 0.9501356482505798, "length": 3.996527671813965, "mode": "test", "epoch": 30}
{"loss": 0.08287195861339569, "acc": 0.9703262448310852, "length": 3.9795217514038086, "mode": "train", "epoch": 31}
{"loss": 0.14909154176712036, "acc": 0.957118034362793, "length": 4.0, "mode": "test", "epoch": 31}
{"loss": 0.07831179350614548, "acc": 0.9734922647476196, "length": 3.9852194786071777, "mode": "train", "epoch": 32}
{"loss": 0.15521246194839478, "acc": 0.953282356262207, "length": 3.996527671813965, "mode": "test", "epoch": 32}
{"loss": 0.07692661136388779, "acc": 0.9712502360343933, "length": 3.9835898876190186, "mode": "train", "epoch": 33}
{"loss": 0.15098994970321655, "acc": 0.9546060562133789, "length": 3.996527671813965, "mode": "test", "epoch": 33}
{"loss": 0.08157005906105042, "acc": 0.9695680141448975, "length": 3.9864320755004883, "mode": "train", "epoch": 34}
{"loss": 0.15865109860897064, "acc": 0.9480903148651123, "length": 4.0, "mode": "test", "epoch": 34}
{"loss": 0.07377992570400238, "acc": 0.9729394912719727, "length": 3.99113392829895, "mode": "train", "epoch": 35}
{"loss": 0.14971871674060822, "acc": 0.9559028148651123, "length": 4.0, "mode": "test", "epoch": 35}
{"loss": 0.07476340979337692, "acc": 0.9732922911643982, "length": 3.9924049377441406, "mode": "train", "epoch": 36}
{"loss": 0.1574118435382843, "acc": 0.9552083611488342, "length": 4.0, "mode": "test", "epoch": 36}
{"loss": 0.07507813721895218, "acc": 0.9761545062065125, "length": 3.9922618865966797, "mode": "train", "epoch": 37}
{"loss": 0.16339963674545288, "acc": 0.9527778625488281, "length": 4.0, "mode": "test", "epoch": 37}
{"loss": 0.07009585946798325, "acc": 0.9770278334617615, "length": 3.9900364875793457, "mode": "train", "epoch": 38}
{"loss": 0.16950193047523499, "acc": 0.9493052959442139, "length": 4.0, "mode": "test", "epoch": 38}
{"loss": 0.08392702788114548, "acc": 0.9715944528579712, "length": 3.9983599185943604, "mode": "train", "epoch": 39}
{"loss": 0.19695092737674713, "acc": 0.9456597566604614, "length": 4.0, "mode": "test", "epoch": 39}
{"loss": 0.109532430768013, "acc": 0.9615841507911682, "length": 3.9900529384613037, "mode": "train", "epoch": 40}
{"loss": 0.15324215590953827, "acc": 0.9484374523162842, "length": 4.0, "mode": "test", "epoch": 40}
{"loss": 0.08988748490810394, "acc": 0.9672433137893677, "length": 3.990983486175537, "mode": "train", "epoch": 41}
{"loss": 0.1321353316307068, "acc": 0.9555554986000061, "length": 4.0, "mode": "test", "epoch": 41}
{"loss": 0.08970250189304352, "acc": 0.970238983631134, "length": 3.992353677749634, "mode": "train", "epoch": 42}
{"loss": 0.1468236744403839, "acc": 0.9501736164093018, "length": 4.0, "mode": "test", "epoch": 42}
{"loss": 0.07683618366718292, "acc": 0.9729762077331543, "length": 3.9956915378570557, "mode": "train", "epoch": 43}
{"loss": 0.1437242329120636, "acc": 0.9545139670372009, "length": 4.0, "mode": "test", "epoch": 43}
{"loss": 0.06972763687372208, "acc": 0.9767175912857056, "length": 3.9983675479888916, "mode": "train", "epoch": 44}
{"loss": 0.1375492364168167, "acc": 0.9602431058883667, "length": 4.0, "mode": "test", "epoch": 44}
{"loss": 0.060632314532995224, "acc": 0.9815417528152466, "length": 3.9993295669555664, "mode": "train", "epoch": 45}
{"loss": 0.16269852221012115, "acc": 0.9545138478279114, "length": 4.0, "mode": "test", "epoch": 45}
{"loss": 0.07791256904602051, "acc": 0.9727328419685364, "length": 3.999606132507324, "mode": "train", "epoch": 46}
{"loss": 0.20856672525405884, "acc": 0.9394097924232483, "length": 4.0, "mode": "test", "epoch": 46}
{"loss": 0.07909969240427017, "acc": 0.970792829990387, "length": 3.9966049194335938, "mode": "train", "epoch": 47}
{"loss": 0.18085485696792603, "acc": 0.9510416388511658, "length": 4.0, "mode": "test", "epoch": 47}
{"loss": 0.06884351372718811, "acc": 0.9761528372764587, "length": 3.999511957168579, "mode": "train", "epoch": 48}
{"loss": 0.1515699177980423, "acc": 0.9543402791023254, "length": 4.0, "mode": "test", "epoch": 48}
{"loss": 0.063411183655262, "acc": 0.979952871799469, "length": 3.9984889030456543, "mode": "train", "epoch": 49}
{"loss": 0.14207543432712555, "acc": 0.9479166865348816, "length": 4.0, "mode": "test", "epoch": 49}
{"loss": 0.05802929773926735, "acc": 0.9804505109786987, "length": 3.9998648166656494, "mode": "train", "epoch": 50}
{"loss": 0.11759061366319656, "acc": 0.9612847566604614, "length": 4.0, "mode": "test", "epoch": 50}
{"loss": 0.05945465713739395, "acc": 0.9805091619491577, "length": 3.9999499320983887, "mode": "train", "epoch": 51}
{"loss": 0.1408316195011139, "acc": 0.9529513120651245, "length": 4.0, "mode": "test", "epoch": 51}
{"loss": 0.06069282814860344, "acc": 0.9790686368942261, "length": 3.998170852661133, "mode": "train", "epoch": 52}
{"loss": 0.12481902539730072, "acc": 0.9600694179534912, "length": 4.0, "mode": "test", "epoch": 52}
{"loss": 0.049220915883779526, "acc": 0.9835004210472107, "length": 3.998648166656494, "mode": "train", "epoch": 53}
{"loss": 0.13296034932136536, "acc": 0.9644097089767456, "length": 4.0, "mode": "test", "epoch": 53}
{"loss": 0.051333654671907425, "acc": 0.9831520318984985, "length": 3.9989235401153564, "mode": "train", "epoch": 54}
{"loss": 0.12824644148349762, "acc": 0.9598957896232605, "length": 4.0, "mode": "test", "epoch": 54}
{"loss": 0.05351514741778374, "acc": 0.9840611815452576, "length": 3.9985454082489014, "mode": "train", "epoch": 55}
{"loss": 0.1427629590034485, "acc": 0.9545138478279114, "length": 4.0, "mode": "test", "epoch": 55}
{"loss": 0.055238623172044754, "acc": 0.9826396703720093, "length": 3.99916672706604, "mode": "train", "epoch": 56}
{"loss": 0.13438323140144348, "acc": 0.9624999165534973, "length": 4.0, "mode": "test", "epoch": 56}
{"loss": 0.04637710377573967, "acc": 0.9842193126678467, "length": 3.9998791217803955, "mode": "train", "epoch": 57}
{"loss": 0.10564335435628891, "acc": 0.9611111879348755, "length": 4.0, "mode": "test", "epoch": 57}
{"loss": 0.047375958412885666, "acc": 0.985496997833252, "length": 3.999922513961792, "mode": "train", "epoch": 58}
{"loss": 0.1137450709939003, "acc": 0.9663195013999939, "length": 4.0, "mode": "test", "epoch": 58}
{"loss": 0.04398389533162117, "acc": 0.9867543578147888, "length": 3.9969778060913086, "mode": "train", "epoch": 59}
{"loss": 0.09455094486474991, "acc": 0.9701388478279114, "length": 4.0, "mode": "test", "epoch": 59}
{"loss": 0.03831055760383606, "acc": 0.9874100685119629, "length": 3.9999008178710938, "mode": "train", "epoch": 60}
{"loss": 0.09843182563781738, "acc": 0.9734375476837158, "length": 4.0, "mode": "test", "epoch": 60}
test accuracy: 0.7751724720001221
