# ["--attributes=3", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.97", "--temperature=2"]
Creating train_ds and val_ds...

Creating test_ds...
{"loss": 0.6990213990211487, "acc": 0.5008326768875122, "length": 3.051009178161621, "mode": "train", "epoch": 1}
{"loss": 0.6952412128448486, "acc": 0.4786713719367981, "length": 1.0, "mode": "test", "epoch": 1}
{"loss": 0.6620928645133972, "acc": 0.6313225030899048, "length": 2.239739179611206, "mode": "train", "epoch": 2}
{"loss": 0.6107226610183716, "acc": 0.7133620977401733, "length": 2.468531370162964, "mode": "test", "epoch": 2}
{"loss": 0.5715517401695251, "acc": 0.7273212671279907, "length": 2.4361681938171387, "mode": "train", "epoch": 3}
{"loss": 0.5417195558547974, "acc": 0.7671273946762085, "length": 2.5, "mode": "test", "epoch": 3}
{"loss": 0.49620136618614197, "acc": 0.7816100716590881, "length": 2.4242138862609863, "mode": "train", "epoch": 4}
{"loss": 0.49057522416114807, "acc": 0.770384669303894, "length": 2.37062931060791, "mode": "test", "epoch": 4}
{"loss": 0.4640886187553406, "acc": 0.7860134840011597, "length": 2.379622220993042, "mode": "train", "epoch": 5}
{"loss": 0.5161102414131165, "acc": 0.7691528797149658, "length": 2.5419580936431885, "mode": "test", "epoch": 5}
{"loss": 0.4504142999649048, "acc": 0.7869654297828674, "length": 2.405147075653076, "mode": "train", "epoch": 6}
{"loss": 0.469614714384079, "acc": 0.777256429195404, "length": 2.454545497894287, "mode": "test", "epoch": 6}
{"loss": 0.4357583522796631, "acc": 0.7902911305427551, "length": 2.558337688446045, "mode": "train", "epoch": 7}
{"loss": 0.4585840404033661, "acc": 0.7763917446136475, "length": 2.699300765991211, "mode": "test", "epoch": 7}
{"loss": 0.4192010164260864, "acc": 0.8011549115180969, "length": 2.983640670776367, "mode": "train", "epoch": 8}
{"loss": 0.4637121260166168, "acc": 0.8032503128051758, "length": 3.4195804595947266, "mode": "test", "epoch": 8}
{"loss": 0.3908516466617584, "acc": 0.8257230520248413, "length": 3.2586495876312256, "mode": "train", "epoch": 9}
{"loss": 0.4095046818256378, "acc": 0.8075644373893738, "length": 3.3881118297576904, "mode": "test", "epoch": 9}
{"loss": 0.3700272738933563, "acc": 0.8385717272758484, "length": 3.318399667739868, "mode": "train", "epoch": 10}
{"loss": 0.41407015919685364, "acc": 0.8192442655563354, "length": 3.437062978744507, "mode": "test", "epoch": 10}
{"loss": 0.36347103118896484, "acc": 0.8401969075202942, "length": 3.3112430572509766, "mode": "train", "epoch": 11}
{"loss": 0.3934524357318878, "acc": 0.8314605951309204, "length": 3.339160919189453, "mode": "test", "epoch": 11}
{"loss": 0.3547426164150238, "acc": 0.8454135060310364, "length": 3.3191280364990234, "mode": "train", "epoch": 12}
{"loss": 0.3971831500530243, "acc": 0.8247964978218079, "length": 3.3566434383392334, "mode": "test", "epoch": 12}
{"loss": 0.35206279158592224, "acc": 0.8479201197624207, "length": 3.3002617359161377, "mode": "train", "epoch": 13}
{"loss": 0.40009522438049316, "acc": 0.8357816338539124, "length": 3.300699234008789, "mode": "test", "epoch": 13}
{"loss": 0.34879907965660095, "acc": 0.8461664915084839, "length": 3.3143579959869385, "mode": "train", "epoch": 14}
{"loss": 0.3771797716617584, "acc": 0.8341015577316284, "length": 3.300699234008789, "mode": "test", "epoch": 14}
{"loss": 0.3397422730922699, "acc": 0.8482644557952881, "length": 3.3135898113250732, "mode": "train", "epoch": 15}
{"loss": 0.39066725969314575, "acc": 0.8349713087081909, "length": 3.339160919189453, "mode": "test", "epoch": 15}
{"loss": 0.33688926696777344, "acc": 0.8518829941749573, "length": 3.319100856781006, "mode": "train", "epoch": 16}
{"loss": 0.3799925744533539, "acc": 0.8422723412513733, "length": 3.276223659515381, "mode": "test", "epoch": 16}
{"loss": 0.3308945894241333, "acc": 0.8513832092285156, "length": 3.314720392227173, "mode": "train", "epoch": 17}
{"loss": 0.3952487111091614, "acc": 0.8339378833770752, "length": 3.346153736114502, "mode": "test", "epoch": 17}
{"loss": 0.3280220031738281, "acc": 0.8520844578742981, "length": 3.3078768253326416, "mode": "train", "epoch": 18}
{"loss": 0.3724350035190582, "acc": 0.8363462090492249, "length": 3.2727272510528564, "mode": "test", "epoch": 18}
{"loss": 0.31381160020828247, "acc": 0.8581893444061279, "length": 3.366900682449341, "mode": "train", "epoch": 19}
{"loss": 0.36442795395851135, "acc": 0.8416455388069153, "length": 3.283216714859009, "mode": "test", "epoch": 19}
{"loss": 0.2999922037124634, "acc": 0.8655572533607483, "length": 3.387122869491577, "mode": "train", "epoch": 20}
{"loss": 0.3382735848426819, "acc": 0.8496080636978149, "length": 3.360139846801758, "mode": "test", "epoch": 20}
{"loss": 0.289335161447525, "acc": 0.8734285235404968, "length": 3.370603084564209, "mode": "train", "epoch": 21}
{"loss": 0.328786164522171, "acc": 0.8613228797912598, "length": 3.486013889312744, "mode": "test", "epoch": 21}
{"loss": 0.28219521045684814, "acc": 0.8758252859115601, "length": 3.459069013595581, "mode": "train", "epoch": 22}
{"loss": 0.3299710750579834, "acc": 0.8666896224021912, "length": 3.513986110687256, "mode": "test", "epoch": 22}
{"loss": 0.2652305066585541, "acc": 0.8885147571563721, "length": 3.4887304306030273, "mode": "train", "epoch": 23}
{"loss": 0.3228093385696411, "acc": 0.8712241649627686, "length": 3.4965035915374756, "mode": "test", "epoch": 23}
{"loss": 0.2582113444805145, "acc": 0.8915139436721802, "length": 3.5151479244232178, "mode": "train", "epoch": 24}
{"loss": 0.3048464357852936, "acc": 0.8756235837936401, "length": 3.538461446762085, "mode": "test", "epoch": 24}
{"loss": 0.24338635802268982, "acc": 0.9033159613609314, "length": 3.5401034355163574, "mode": "train", "epoch": 25}
{"loss": 0.2875101864337921, "acc": 0.883248507976532, "length": 3.6643357276916504, "mode": "test", "epoch": 25}
{"loss": 0.23328723013401031, "acc": 0.9053212404251099, "length": 3.6417038440704346, "mode": "train", "epoch": 26}
{"loss": 0.28093627095222473, "acc": 0.8823262453079224, "length": 3.6643357276916504, "mode": "test", "epoch": 26}
{"loss": 0.21816731989383698, "acc": 0.9119697213172913, "length": 3.7106282711029053, "mode": "train", "epoch": 27}
{"loss": 0.26438453793525696, "acc": 0.8953089118003845, "length": 3.800699234008789, "mode": "test", "epoch": 27}
{"loss": 0.2151559591293335, "acc": 0.9170405268669128, "length": 3.839292526245117, "mode": "train", "epoch": 28}
{"loss": 0.2623162865638733, "acc": 0.9028834700584412, "length": 3.884615421295166, "mode": "test", "epoch": 28}
{"loss": 0.20556439459323883, "acc": 0.9202872514724731, "length": 3.8715591430664062, "mode": "train", "epoch": 29}
{"loss": 0.24473357200622559, "acc": 0.9083915948867798, "length": 4.0, "mode": "test", "epoch": 29}
{"loss": 0.19262996315956116, "acc": 0.9255820512771606, "length": 3.9769129753112793, "mode": "train", "epoch": 30}
{"loss": 0.3157660663127899, "acc": 0.895804226398468, "length": 4.0, "mode": "test", "epoch": 30}
{"loss": 0.18789614737033844, "acc": 0.9238794445991516, "length": 3.987175703048706, "mode": "train", "epoch": 31}
{"loss": 0.21691282093524933, "acc": 0.9141609072685242, "length": 4.0, "mode": "test", "epoch": 31}
{"loss": 0.17743930220603943, "acc": 0.9314898252487183, "length": 3.9930548667907715, "mode": "train", "epoch": 32}
{"loss": 0.23204374313354492, "acc": 0.9071678519248962, "length": 4.0, "mode": "test", "epoch": 32}
{"loss": 0.17459344863891602, "acc": 0.9334706664085388, "length": 3.996701240539551, "mode": "train", "epoch": 33}
{"loss": 0.2213231474161148, "acc": 0.923601508140564, "length": 4.0, "mode": "test", "epoch": 33}
{"loss": 0.17016497254371643, "acc": 0.932405948638916, "length": 3.9955453872680664, "mode": "train", "epoch": 34}
{"loss": 0.20875640213489532, "acc": 0.9272726774215698, "length": 4.0, "mode": "test", "epoch": 34}
{"loss": 0.1598564088344574, "acc": 0.9371657967567444, "length": 3.9967641830444336, "mode": "train", "epoch": 35}
{"loss": 0.23109681904315948, "acc": 0.91206294298172, "length": 4.0, "mode": "test", "epoch": 35}
{"loss": 0.15718962252140045, "acc": 0.938395082950592, "length": 3.999507188796997, "mode": "train", "epoch": 36}
{"loss": 0.2199968844652176, "acc": 0.9192308783531189, "length": 4.0, "mode": "test", "epoch": 36}
{"loss": 0.16051970422267914, "acc": 0.9398490786552429, "length": 3.999183416366577, "mode": "train", "epoch": 37}
{"loss": 0.21834345161914825, "acc": 0.9087412357330322, "length": 4.0, "mode": "test", "epoch": 37}
{"loss": 0.1552775651216507, "acc": 0.9403072595596313, "length": 3.9975295066833496, "mode": "train", "epoch": 38}
{"loss": 0.20597364008426666, "acc": 0.9243007302284241, "length": 4.0, "mode": "test", "epoch": 38}
{"loss": 0.1361428052186966, "acc": 0.9484767317771912, "length": 3.9999427795410156, "mode": "train", "epoch": 39}
{"loss": 0.1824379712343216, "acc": 0.9351397752761841, "length": 4.0, "mode": "test", "epoch": 39}
{"loss": 0.12369231879711151, "acc": 0.9561449289321899, "length": 3.999908447265625, "mode": "train", "epoch": 40}
{"loss": 0.21243925392627716, "acc": 0.9360140562057495, "length": 4.0, "mode": "test", "epoch": 40}
{"loss": 0.12358483672142029, "acc": 0.9555522799491882, "length": 3.9997129440307617, "mode": "train", "epoch": 41}
{"loss": 0.17062175273895264, "acc": 0.940384566783905, "length": 4.0, "mode": "test", "epoch": 41}
{"loss": 0.1444941610097885, "acc": 0.9466012716293335, "length": 3.999903440475464, "mode": "train", "epoch": 42}
{"loss": 0.20641940832138062, "acc": 0.9283216595649719, "length": 4.0, "mode": "test", "epoch": 42}
{"loss": 0.15258589386940002, "acc": 0.9428538084030151, "length": 3.999901294708252, "mode": "train", "epoch": 43}
{"loss": 0.21180303394794464, "acc": 0.9229020476341248, "length": 4.0, "mode": "test", "epoch": 43}
{"loss": 0.14309567213058472, "acc": 0.9420256018638611, "length": 3.999669313430786, "mode": "train", "epoch": 44}
{"loss": 0.18018588423728943, "acc": 0.9365383982658386, "length": 4.0, "mode": "test", "epoch": 44}
{"loss": 0.13464504480361938, "acc": 0.9480664730072021, "length": 3.99996018409729, "mode": "train", "epoch": 45}
{"loss": 0.16360774636268616, "acc": 0.9442307353019714, "length": 4.0, "mode": "test", "epoch": 45}
{"loss": 0.12559029459953308, "acc": 0.9521660208702087, "length": 3.999985694885254, "mode": "train", "epoch": 46}
{"loss": 0.17615753412246704, "acc": 0.9358392357826233, "length": 4.0, "mode": "test", "epoch": 46}
{"loss": 0.12487497925758362, "acc": 0.949527382850647, "length": 3.9998674392700195, "mode": "train", "epoch": 47}
{"loss": 0.14759646356105804, "acc": 0.9472026824951172, "length": 4.0, "mode": "test", "epoch": 47}
{"loss": 0.11287019401788712, "acc": 0.9574351906776428, "length": 3.999988079071045, "mode": "train", "epoch": 48}
{"loss": 0.15481026470661163, "acc": 0.9479021430015564, "length": 4.0, "mode": "test", "epoch": 48}
{"loss": 0.1042698472738266, "acc": 0.9597769975662231, "length": 3.9999775886535645, "mode": "train", "epoch": 49}
{"loss": 0.15039576590061188, "acc": 0.9465035200119019, "length": 4.0, "mode": "test", "epoch": 49}
{"loss": 0.13570630550384521, "acc": 0.9470047354698181, "length": 3.9997398853302, "mode": "train", "epoch": 50}
{"loss": 0.1893269568681717, "acc": 0.9201048612594604, "length": 4.0, "mode": "test", "epoch": 50}
{"loss": 0.12541203200817108, "acc": 0.9464230537414551, "length": 3.999751329421997, "mode": "train", "epoch": 51}
{"loss": 0.16173987090587616, "acc": 0.9438812732696533, "length": 4.0, "mode": "test", "epoch": 51}
{"loss": 0.11826373636722565, "acc": 0.9525107145309448, "length": 3.99980092048645, "mode": "train", "epoch": 52}
{"loss": 0.18036620318889618, "acc": 0.940384566783905, "length": 4.0, "mode": "test", "epoch": 52}
{"loss": 0.11483200639486313, "acc": 0.9544464945793152, "length": 3.9998650550842285, "mode": "train", "epoch": 53}
{"loss": 0.20285676419734955, "acc": 0.9384615421295166, "length": 4.0, "mode": "test", "epoch": 53}
{"loss": 0.11427535116672516, "acc": 0.955384373664856, "length": 3.999927043914795, "mode": "train", "epoch": 54}
{"loss": 0.2007938176393509, "acc": 0.9374126195907593, "length": 4.0, "mode": "test", "epoch": 54}
{"loss": 0.11474648863077164, "acc": 0.9556201696395874, "length": 3.9999852180480957, "mode": "train", "epoch": 55}
{"loss": 0.17549999058246613, "acc": 0.9496503472328186, "length": 4.0, "mode": "test", "epoch": 55}
{"loss": 0.10597801208496094, "acc": 0.9585452675819397, "length": 3.999884843826294, "mode": "train", "epoch": 56}
{"loss": 0.1939612776041031, "acc": 0.9400351047515869, "length": 4.0, "mode": "test", "epoch": 56}
{"loss": 0.10856366902589798, "acc": 0.9607141613960266, "length": 3.9999947547912598, "mode": "train", "epoch": 57}
{"loss": 0.14928670227527618, "acc": 0.955069899559021, "length": 4.0, "mode": "test", "epoch": 57}
{"loss": 0.08977292478084564, "acc": 0.9656874537467957, "length": 3.9998738765716553, "mode": "train", "epoch": 58}
{"loss": 0.20178857445716858, "acc": 0.9479021430015564, "length": 4.0, "mode": "test", "epoch": 58}
{"loss": 0.0912976786494255, "acc": 0.9694857597351074, "length": 3.9996724128723145, "mode": "train", "epoch": 59}
{"loss": 0.16151799261569977, "acc": 0.9541959166526794, "length": 4.0, "mode": "test", "epoch": 59}
{"loss": 0.08934396505355835, "acc": 0.968146800994873, "length": 3.9999186992645264, "mode": "train", "epoch": 60}
{"loss": 0.14865656197071075, "acc": 0.953321635723114, "length": 4.0, "mode": "test", "epoch": 60}
test accuracy: 0.7931666374206543
