# ["--attributes=5", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.97", "--temperature=1"]
Creating train_ds and val_ds...

Creating test_ds...
{"loss": 0.6945169568061829, "acc": 0.5062077045440674, "length": 3.1146795749664307, "mode": "train", "epoch": 1}
{"loss": 0.6717149019241333, "acc": 0.5980741381645203, "length": 2.3195877075195312, "mode": "test", "epoch": 1}
{"loss": 0.6092875003814697, "acc": 0.6959441900253296, "length": 2.871022939682007, "mode": "train", "epoch": 2}
{"loss": 0.5506741404533386, "acc": 0.741178035736084, "length": 2.7869415283203125, "mode": "test", "epoch": 2}
{"loss": 0.5051447153091431, "acc": 0.7710406184196472, "length": 3.280890703201294, "mode": "train", "epoch": 3}
{"loss": 0.4977412223815918, "acc": 0.7615388631820679, "length": 3.8144330978393555, "mode": "test", "epoch": 3}
{"loss": 0.45914873480796814, "acc": 0.8002952337265015, "length": 3.790557622909546, "mode": "train", "epoch": 4}
{"loss": 0.4582558572292328, "acc": 0.7986254096031189, "length": 4.0, "mode": "test", "epoch": 4}
{"loss": 0.424217164516449, "acc": 0.812391996383667, "length": 3.956711769104004, "mode": "train", "epoch": 5}
{"loss": 0.42975616455078125, "acc": 0.8051546216011047, "length": 4.0, "mode": "test", "epoch": 5}
{"loss": 0.3896848261356354, "acc": 0.8299153447151184, "length": 3.9917054176330566, "mode": "train", "epoch": 6}
{"loss": 0.3807624280452728, "acc": 0.8266322612762451, "length": 4.0, "mode": "test", "epoch": 6}
{"loss": 0.34529009461402893, "acc": 0.8579100966453552, "length": 3.991758108139038, "mode": "train", "epoch": 7}
{"loss": 0.3490442931652069, "acc": 0.8530928492546082, "length": 4.0, "mode": "test", "epoch": 7}
{"loss": 0.31143730878829956, "acc": 0.8669188022613525, "length": 3.9908607006073, "mode": "train", "epoch": 8}
{"loss": 0.3360746502876282, "acc": 0.8510308265686035, "length": 4.0, "mode": "test", "epoch": 8}
{"loss": 0.29351964592933655, "acc": 0.8724038004875183, "length": 3.9923255443573, "mode": "train", "epoch": 9}
{"loss": 0.30338072776794434, "acc": 0.8750858902931213, "length": 4.0, "mode": "test", "epoch": 9}
{"loss": 0.26986369490623474, "acc": 0.8879489302635193, "length": 3.9971425533294678, "mode": "train", "epoch": 10}
{"loss": 0.3226311206817627, "acc": 0.868384838104248, "length": 4.0, "mode": "test", "epoch": 10}
{"loss": 0.26984357833862305, "acc": 0.8908318877220154, "length": 3.9974653720855713, "mode": "train", "epoch": 11}
{"loss": 0.3036295473575592, "acc": 0.8707904815673828, "length": 4.0, "mode": "test", "epoch": 11}
{"loss": 0.26077136397361755, "acc": 0.8902943134307861, "length": 3.9987151622772217, "mode": "train", "epoch": 12}
{"loss": 0.2850921154022217, "acc": 0.8792096376419067, "length": 4.0, "mode": "test", "epoch": 12}
{"loss": 0.2436261922121048, "acc": 0.9014066457748413, "length": 3.9981000423431396, "mode": "train", "epoch": 13}
{"loss": 0.2810754179954529, "acc": 0.8850514888763428, "length": 4.0, "mode": "test", "epoch": 13}
{"loss": 0.23866397142410278, "acc": 0.9029135704040527, "length": 3.9978132247924805, "mode": "train", "epoch": 14}
{"loss": 0.2580234110355377, "acc": 0.8989691138267517, "length": 4.0, "mode": "test", "epoch": 14}
{"loss": 0.22559459507465363, "acc": 0.9103276133537292, "length": 3.99841046333313, "mode": "train", "epoch": 15}
{"loss": 0.23810814321041107, "acc": 0.900343656539917, "length": 4.0, "mode": "test", "epoch": 15}
{"loss": 0.23638583719730377, "acc": 0.9107677340507507, "length": 3.9987053871154785, "mode": "train", "epoch": 16}
{"loss": 0.23514489829540253, "acc": 0.9051547050476074, "length": 4.0, "mode": "test", "epoch": 16}
{"loss": 0.23312623798847198, "acc": 0.9062048196792603, "length": 3.999652862548828, "mode": "train", "epoch": 17}
{"loss": 0.2517409026622772, "acc": 0.8948454260826111, "length": 4.0, "mode": "test", "epoch": 17}
{"loss": 0.22733654081821442, "acc": 0.9108594059944153, "length": 3.9993605613708496, "mode": "train", "epoch": 18}
{"loss": 0.25233057141304016, "acc": 0.8979381918907166, "length": 4.0, "mode": "test", "epoch": 18}
{"loss": 0.22453391551971436, "acc": 0.9119608998298645, "length": 3.9997506141662598, "mode": "train", "epoch": 19}
{"loss": 0.22981558740139008, "acc": 0.9087628126144409, "length": 4.0, "mode": "test", "epoch": 19}
{"loss": 0.2217167764902115, "acc": 0.9120203852653503, "length": 3.9999001026153564, "mode": "train", "epoch": 20}
{"loss": 0.229364275932312, "acc": 0.9077320694923401, "length": 4.0, "mode": "test", "epoch": 20}
{"loss": 0.21618743240833282, "acc": 0.9161919355392456, "length": 3.999230146408081, "mode": "train", "epoch": 21}
{"loss": 0.22606050968170166, "acc": 0.9070447087287903, "length": 4.0, "mode": "test", "epoch": 21}
{"loss": 0.22126340866088867, "acc": 0.91581791639328, "length": 3.998516082763672, "mode": "train", "epoch": 22}
{"loss": 0.2177366018295288, "acc": 0.9154638051986694, "length": 4.0, "mode": "test", "epoch": 22}
{"loss": 0.20838136970996857, "acc": 0.9198704361915588, "length": 3.998497724533081, "mode": "train", "epoch": 23}
{"loss": 0.21057064831256866, "acc": 0.919244110584259, "length": 4.0, "mode": "test", "epoch": 23}
{"loss": 0.21840065717697144, "acc": 0.9177200198173523, "length": 3.999958038330078, "mode": "train", "epoch": 24}
{"loss": 0.21272985637187958, "acc": 0.9163228869438171, "length": 4.0, "mode": "test", "epoch": 24}
{"loss": 0.2284928560256958, "acc": 0.9104704260826111, "length": 3.99996280670166, "mode": "train", "epoch": 25}
{"loss": 0.2220529317855835, "acc": 0.9213058352470398, "length": 4.0, "mode": "test", "epoch": 25}
{"loss": 0.20776981115341187, "acc": 0.9248510003089905, "length": 3.999880313873291, "mode": "train", "epoch": 26}
{"loss": 0.20451365411281586, "acc": 0.9305841326713562, "length": 4.0, "mode": "test", "epoch": 26}
{"loss": 0.1925264149904251, "acc": 0.9292259812355042, "length": 3.99979567527771, "mode": "train", "epoch": 27}
{"loss": 0.2043476402759552, "acc": 0.9211339950561523, "length": 4.0, "mode": "test", "epoch": 27}
{"loss": 0.19999246299266815, "acc": 0.9239951968193054, "length": 3.997985601425171, "mode": "train", "epoch": 28}
{"loss": 0.2023361772298813, "acc": 0.9247422814369202, "length": 4.0, "mode": "test", "epoch": 28}
{"loss": 0.18769989907741547, "acc": 0.930432140827179, "length": 3.9999184608459473, "mode": "train", "epoch": 29}
{"loss": 0.19980166852474213, "acc": 0.9254295229911804, "length": 4.0, "mode": "test", "epoch": 29}
{"loss": 0.1898009479045868, "acc": 0.9281826019287109, "length": 3.9997029304504395, "mode": "train", "epoch": 30}
{"loss": 0.1896410435438156, "acc": 0.9281787276268005, "length": 4.0, "mode": "test", "epoch": 30}
{"loss": 0.1864665448665619, "acc": 0.9269714951515198, "length": 3.999756336212158, "mode": "train", "epoch": 31}
{"loss": 0.2088366001844406, "acc": 0.9235395193099976, "length": 4.0, "mode": "test", "epoch": 31}
{"loss": 0.17913863062858582, "acc": 0.9338663220405579, "length": 3.9986767768859863, "mode": "train", "epoch": 32}
{"loss": 0.18964913487434387, "acc": 0.9286941289901733, "length": 4.0, "mode": "test", "epoch": 32}
{"loss": 0.17216649651527405, "acc": 0.9332948923110962, "length": 3.999596357345581, "mode": "train", "epoch": 33}
{"loss": 0.19258803129196167, "acc": 0.9310997128486633, "length": 4.0, "mode": "test", "epoch": 33}
{"loss": 0.17070920765399933, "acc": 0.9348670840263367, "length": 3.999964714050293, "mode": "train", "epoch": 34}
{"loss": 0.18548989295959473, "acc": 0.9395189881324768, "length": 4.0, "mode": "test", "epoch": 34}
{"loss": 0.17386727035045624, "acc": 0.9327070116996765, "length": 3.9988315105438232, "mode": "train", "epoch": 35}
{"loss": 0.18690305948257446, "acc": 0.9378006458282471, "length": 4.0, "mode": "test", "epoch": 35}
{"loss": 0.165488600730896, "acc": 0.9367653727531433, "length": 3.9999747276306152, "mode": "train", "epoch": 36}
{"loss": 0.1948155164718628, "acc": 0.9402062892913818, "length": 4.0, "mode": "test", "epoch": 36}
{"loss": 0.16081267595291138, "acc": 0.9394703507423401, "length": 3.9999923706054688, "mode": "train", "epoch": 37}
{"loss": 0.18568281829357147, "acc": 0.9403780102729797, "length": 4.0, "mode": "test", "epoch": 37}
{"loss": 0.15747350454330444, "acc": 0.9406534433364868, "length": 3.9996390342712402, "mode": "train", "epoch": 38}
{"loss": 0.18345150351524353, "acc": 0.9407217502593994, "length": 4.0, "mode": "test", "epoch": 38}
{"loss": 0.1553311049938202, "acc": 0.9442461133003235, "length": 3.999990224838257, "mode": "train", "epoch": 39}
{"loss": 0.1773238331079483, "acc": 0.9415808320045471, "length": 4.0, "mode": "test", "epoch": 39}
{"loss": 0.15490776300430298, "acc": 0.9414268732070923, "length": 3.999997854232788, "mode": "train", "epoch": 40}
{"loss": 0.18592530488967896, "acc": 0.9400342106819153, "length": 4.0, "mode": "test", "epoch": 40}
{"loss": 0.15987452864646912, "acc": 0.9425773024559021, "length": 3.999985694885254, "mode": "train", "epoch": 41}
{"loss": 0.173799067735672, "acc": 0.9469071626663208, "length": 4.0, "mode": "test", "epoch": 41}
{"loss": 0.15869316458702087, "acc": 0.9434402585029602, "length": 3.9999794960021973, "mode": "train", "epoch": 42}
{"loss": 0.177854523062706, "acc": 0.9438145160675049, "length": 4.0, "mode": "test", "epoch": 42}
{"loss": 0.15196526050567627, "acc": 0.9410237669944763, "length": 3.99993634223938, "mode": "train", "epoch": 43}
{"loss": 0.19882908463478088, "acc": 0.9410653114318848, "length": 4.0, "mode": "test", "epoch": 43}
{"loss": 0.14977116882801056, "acc": 0.9445874094963074, "length": 3.999709129333496, "mode": "train", "epoch": 44}
{"loss": 0.18051841855049133, "acc": 0.9419243931770325, "length": 4.0, "mode": "test", "epoch": 44}
{"loss": 0.15896959602832794, "acc": 0.9404458999633789, "length": 3.9998438358306885, "mode": "train", "epoch": 45}
{"loss": 0.19547460973262787, "acc": 0.9402062296867371, "length": 4.0, "mode": "test", "epoch": 45}
{"loss": 0.15191593766212463, "acc": 0.9439558982849121, "length": 3.9999730587005615, "mode": "train", "epoch": 46}
{"loss": 0.17101235687732697, "acc": 0.9426116347312927, "length": 4.0, "mode": "test", "epoch": 46}
{"loss": 0.14574070274829865, "acc": 0.9450517296791077, "length": 3.999998092651367, "mode": "train", "epoch": 47}
{"loss": 0.17928583920001984, "acc": 0.9410651922225952, "length": 4.0, "mode": "test", "epoch": 47}
{"loss": 0.14080002903938293, "acc": 0.9463173151016235, "length": 3.9999961853027344, "mode": "train", "epoch": 48}
{"loss": 0.16308563947677612, "acc": 0.9489690661430359, "length": 4.0, "mode": "test", "epoch": 48}
{"loss": 0.14654473960399628, "acc": 0.9494820237159729, "length": 3.999997138977051, "mode": "train", "epoch": 49}
{"loss": 0.163859561085701, "acc": 0.9506873488426208, "length": 4.0, "mode": "test", "epoch": 49}
{"loss": 0.13643436133861542, "acc": 0.9465476274490356, "length": 3.99999737739563, "mode": "train", "epoch": 50}
{"loss": 0.16854891180992126, "acc": 0.9512026906013489, "length": 4.0, "mode": "test", "epoch": 50}
{"loss": 0.12992975115776062, "acc": 0.9511507749557495, "length": 3.9999990463256836, "mode": "train", "epoch": 51}
{"loss": 0.16366396844387054, "acc": 0.9525773525238037, "length": 4.0, "mode": "test", "epoch": 51}
{"loss": 0.13610246777534485, "acc": 0.9497696757316589, "length": 3.999997854232788, "mode": "train", "epoch": 52}
{"loss": 0.16135719418525696, "acc": 0.9513745903968811, "length": 4.0, "mode": "test", "epoch": 52}
{"loss": 0.13130158185958862, "acc": 0.9526465535163879, "length": 3.999988317489624, "mode": "train", "epoch": 53}
{"loss": 0.17440922558307648, "acc": 0.9501718282699585, "length": 4.0, "mode": "test", "epoch": 53}
{"loss": 0.12959794700145721, "acc": 0.9525882601737976, "length": 3.999976873397827, "mode": "train", "epoch": 54}
{"loss": 0.16626261174678802, "acc": 0.9512026906013489, "length": 4.0, "mode": "test", "epoch": 54}
{"loss": 0.13445374369621277, "acc": 0.9490209817886353, "length": 3.999985694885254, "mode": "train", "epoch": 55}
{"loss": 0.17371444404125214, "acc": 0.9445017576217651, "length": 4.0, "mode": "test", "epoch": 55}
{"loss": 0.16011075675487518, "acc": 0.9402720332145691, "length": 3.9998691082000732, "mode": "train", "epoch": 56}
{"loss": 0.23595349490642548, "acc": 0.9333332777023315, "length": 4.0, "mode": "test", "epoch": 56}
{"loss": 0.17603059113025665, "acc": 0.9354996085166931, "length": 3.999957323074341, "mode": "train", "epoch": 57}
{"loss": 0.18868324160575867, "acc": 0.9426116347312927, "length": 4.0, "mode": "test", "epoch": 57}
{"loss": 0.13691554963588715, "acc": 0.9510933756828308, "length": 3.999999523162842, "mode": "train", "epoch": 58}
{"loss": 0.1556939333677292, "acc": 0.9482817053794861, "length": 4.0, "mode": "test", "epoch": 58}
{"loss": 0.1347794383764267, "acc": 0.9470080733299255, "length": 3.99999737739563, "mode": "train", "epoch": 59}
{"loss": 0.1714867204427719, "acc": 0.9436427354812622, "length": 4.0, "mode": "test", "epoch": 59}
{"loss": 0.14058122038841248, "acc": 0.9494815468788147, "length": 3.999988555908203, "mode": "train", "epoch": 60}
{"loss": 0.16498658061027527, "acc": 0.9463919401168823, "length": 4.0, "mode": "test", "epoch": 60}
test accuracy: 0.783928632736206
