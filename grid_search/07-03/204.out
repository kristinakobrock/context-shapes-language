# ["--attributes=5", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=128", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.97", "--temperature=1"]
Creating train_ds and val_ds...

Creating test_ds...
{"loss": 0.7000988125801086, "acc": 0.4946862757205963, "length": 3.4711759090423584, "mode": "train", "epoch": 1}
{"loss": 0.6905879974365234, "acc": 0.5278156995773315, "length": 1.0, "mode": "test", "epoch": 1}
{"loss": 0.6944709420204163, "acc": 0.5102914571762085, "length": 3.303818464279175, "mode": "train", "epoch": 2}
{"loss": 0.6921367049217224, "acc": 0.4901024103164673, "length": 1.0, "mode": "test", "epoch": 2}
{"loss": 0.6903455853462219, "acc": 0.5327708721160889, "length": 2.946730613708496, "mode": "train", "epoch": 3}
{"loss": 0.6856011152267456, "acc": 0.5463165044784546, "length": 1.38225257396698, "mode": "test", "epoch": 3}
{"loss": 0.6798161268234253, "acc": 0.615384578704834, "length": 2.8914992809295654, "mode": "train", "epoch": 4}
{"loss": 0.6494932174682617, "acc": 0.7502843737602234, "length": 3.3003413677215576, "mode": "test", "epoch": 4}
{"loss": 0.647775411605835, "acc": 0.7215675115585327, "length": 3.332348585128784, "mode": "train", "epoch": 5}
{"loss": 0.5987492799758911, "acc": 0.8021270036697388, "length": 3.9829351902008057, "mode": "test", "epoch": 5}
{"loss": 0.583827793598175, "acc": 0.7837609052658081, "length": 3.7167751789093018, "mode": "train", "epoch": 6}
{"loss": 0.5260680913925171, "acc": 0.7962458729743958, "length": 4.0, "mode": "test", "epoch": 6}
{"loss": 0.4878617525100708, "acc": 0.8173449635505676, "length": 3.904944896697998, "mode": "train", "epoch": 7}
{"loss": 0.4595201909542084, "acc": 0.8262797594070435, "length": 4.0, "mode": "test", "epoch": 7}
{"loss": 0.42953595519065857, "acc": 0.83097904920578, "length": 3.972118854522705, "mode": "train", "epoch": 8}
{"loss": 0.43830567598342896, "acc": 0.8254265189170837, "length": 4.0, "mode": "test", "epoch": 8}
{"loss": 0.4098483920097351, "acc": 0.8352477550506592, "length": 3.9886083602905273, "mode": "train", "epoch": 9}
{"loss": 0.42830678820610046, "acc": 0.8266211152076721, "length": 4.0, "mode": "test", "epoch": 9}
{"loss": 0.39993634819984436, "acc": 0.836445689201355, "length": 3.9953689575195312, "mode": "train", "epoch": 10}
{"loss": 0.41232413053512573, "acc": 0.829863429069519, "length": 4.0, "mode": "test", "epoch": 10}
{"loss": 0.38961857557296753, "acc": 0.8344238996505737, "length": 3.993964672088623, "mode": "train", "epoch": 11}
{"loss": 0.4097732901573181, "acc": 0.832423210144043, "length": 4.0, "mode": "test", "epoch": 11}
{"loss": 0.3774509131908417, "acc": 0.8390764594078064, "length": 3.9965670108795166, "mode": "train", "epoch": 12}
{"loss": 0.40786808729171753, "acc": 0.8399316668510437, "length": 4.0, "mode": "test", "epoch": 12}
{"loss": 0.3692532777786255, "acc": 0.8484620451927185, "length": 3.995628833770752, "mode": "train", "epoch": 13}
{"loss": 0.4081351161003113, "acc": 0.8305460810661316, "length": 4.0, "mode": "test", "epoch": 13}
{"loss": 0.3541797995567322, "acc": 0.8476037979125977, "length": 3.995875597000122, "mode": "train", "epoch": 14}
{"loss": 0.40110158920288086, "acc": 0.838395893573761, "length": 4.0, "mode": "test", "epoch": 14}
{"loss": 0.34227806329727173, "acc": 0.8483904600143433, "length": 3.991384267807007, "mode": "train", "epoch": 15}
{"loss": 0.3782687187194824, "acc": 0.8445391654968262, "length": 4.0, "mode": "test", "epoch": 15}
{"loss": 0.3319481611251831, "acc": 0.8615337610244751, "length": 3.996917247772217, "mode": "train", "epoch": 16}
{"loss": 0.3445158898830414, "acc": 0.8547781109809875, "length": 4.0, "mode": "test", "epoch": 16}
{"loss": 0.31865042448043823, "acc": 0.8677663803100586, "length": 3.998497247695923, "mode": "train", "epoch": 17}
{"loss": 0.3598078191280365, "acc": 0.8459044098854065, "length": 4.0, "mode": "test", "epoch": 17}
{"loss": 0.30365481972694397, "acc": 0.8757936954498291, "length": 3.9951043128967285, "mode": "train", "epoch": 18}
{"loss": 0.3031873404979706, "acc": 0.8793514966964722, "length": 4.0, "mode": "test", "epoch": 18}
{"loss": 0.29375743865966797, "acc": 0.8817358016967773, "length": 3.9983627796173096, "mode": "train", "epoch": 19}
{"loss": 0.2866876423358917, "acc": 0.8883958458900452, "length": 4.0, "mode": "test", "epoch": 19}
{"loss": 0.28982409834861755, "acc": 0.883022129535675, "length": 3.996392011642456, "mode": "train", "epoch": 20}
{"loss": 0.2809111475944519, "acc": 0.8897611498832703, "length": 4.0, "mode": "test", "epoch": 20}
{"loss": 0.27864980697631836, "acc": 0.8849029541015625, "length": 3.998082399368286, "mode": "train", "epoch": 21}
{"loss": 0.27442753314971924, "acc": 0.886518657207489, "length": 4.0, "mode": "test", "epoch": 21}
{"loss": 0.2715769410133362, "acc": 0.8886348009109497, "length": 3.998025417327881, "mode": "train", "epoch": 22}
{"loss": 0.2689524292945862, "acc": 0.8957337141036987, "length": 4.0, "mode": "test", "epoch": 22}
{"loss": 0.2660898268222809, "acc": 0.887718677520752, "length": 3.998694896697998, "mode": "train", "epoch": 23}
{"loss": 0.27097567915916443, "acc": 0.8965871930122375, "length": 4.0, "mode": "test", "epoch": 23}
{"loss": 0.25631195306777954, "acc": 0.8973615765571594, "length": 3.9989752769470215, "mode": "train", "epoch": 24}
{"loss": 0.26078563928604126, "acc": 0.902559757232666, "length": 4.0, "mode": "test", "epoch": 24}
{"loss": 0.25759562849998474, "acc": 0.8987836837768555, "length": 3.998448610305786, "mode": "train", "epoch": 25}
{"loss": 0.2573195695877075, "acc": 0.900170624256134, "length": 4.0, "mode": "test", "epoch": 25}
{"loss": 0.24615952372550964, "acc": 0.9011566638946533, "length": 3.9983935356140137, "mode": "train", "epoch": 26}
{"loss": 0.25907787680625916, "acc": 0.9015358090400696, "length": 4.0, "mode": "test", "epoch": 26}
{"loss": 0.24623025953769684, "acc": 0.8988474607467651, "length": 3.998992919921875, "mode": "train", "epoch": 27}
{"loss": 0.2444537878036499, "acc": 0.9020477533340454, "length": 4.0, "mode": "test", "epoch": 27}
{"loss": 0.23806102573871613, "acc": 0.9082899689674377, "length": 3.9978623390197754, "mode": "train", "epoch": 28}
{"loss": 0.23943614959716797, "acc": 0.9085322618484497, "length": 4.0, "mode": "test", "epoch": 28}
{"loss": 0.23598580062389374, "acc": 0.9073379635810852, "length": 3.9990062713623047, "mode": "train", "epoch": 29}
{"loss": 0.24944286048412323, "acc": 0.9090442657470703, "length": 4.0, "mode": "test", "epoch": 29}
{"loss": 0.22741633653640747, "acc": 0.9121223092079163, "length": 3.998948335647583, "mode": "train", "epoch": 30}
{"loss": 0.2365466058254242, "acc": 0.9092149138450623, "length": 4.0, "mode": "test", "epoch": 30}
{"loss": 0.2285899668931961, "acc": 0.9101629853248596, "length": 3.997117042541504, "mode": "train", "epoch": 31}
{"loss": 0.23116087913513184, "acc": 0.9124572277069092, "length": 4.0, "mode": "test", "epoch": 31}
{"loss": 0.21909484267234802, "acc": 0.914466142654419, "length": 3.999091625213623, "mode": "train", "epoch": 32}
{"loss": 0.2344474196434021, "acc": 0.91825932264328, "length": 4.0, "mode": "test", "epoch": 32}
{"loss": 0.219512939453125, "acc": 0.9161840677261353, "length": 3.9993741512298584, "mode": "train", "epoch": 33}
{"loss": 0.2146894782781601, "acc": 0.9175767302513123, "length": 4.0, "mode": "test", "epoch": 33}
{"loss": 0.23553937673568726, "acc": 0.9084920883178711, "length": 3.999680519104004, "mode": "train", "epoch": 34}
{"loss": 0.23724377155303955, "acc": 0.9119453430175781, "length": 4.0, "mode": "test", "epoch": 34}
{"loss": 0.21857959032058716, "acc": 0.9152695536613464, "length": 3.9990921020507812, "mode": "train", "epoch": 35}
{"loss": 0.22039483487606049, "acc": 0.9249146580696106, "length": 4.0, "mode": "test", "epoch": 35}
{"loss": 0.21250133216381073, "acc": 0.9192934036254883, "length": 3.998668670654297, "mode": "train", "epoch": 36}
{"loss": 0.21379534900188446, "acc": 0.925426721572876, "length": 4.0, "mode": "test", "epoch": 36}
{"loss": 0.21258671581745148, "acc": 0.9184263944625854, "length": 3.9979074001312256, "mode": "train", "epoch": 37}
{"loss": 0.21908316016197205, "acc": 0.9145050644874573, "length": 4.0, "mode": "test", "epoch": 37}
{"loss": 0.20751984417438507, "acc": 0.9207310080528259, "length": 3.999361991882324, "mode": "train", "epoch": 38}
{"loss": 0.21649031341075897, "acc": 0.9201364517211914, "length": 4.0, "mode": "test", "epoch": 38}
{"loss": 0.20174652338027954, "acc": 0.9226749539375305, "length": 3.998987913131714, "mode": "train", "epoch": 39}
{"loss": 0.21770446002483368, "acc": 0.9250853657722473, "length": 4.0, "mode": "test", "epoch": 39}
{"loss": 0.19830726087093353, "acc": 0.9270254969596863, "length": 3.9972426891326904, "mode": "train", "epoch": 40}
{"loss": 0.2098870575428009, "acc": 0.9278156161308289, "length": 4.0, "mode": "test", "epoch": 40}
{"loss": 0.19494546949863434, "acc": 0.9265432357788086, "length": 3.9983253479003906, "mode": "train", "epoch": 41}
{"loss": 0.2225523442029953, "acc": 0.9187713861465454, "length": 4.0, "mode": "test", "epoch": 41}
{"loss": 0.1963411420583725, "acc": 0.9254703521728516, "length": 3.9992756843566895, "mode": "train", "epoch": 42}
{"loss": 0.2203860729932785, "acc": 0.9238907098770142, "length": 4.0, "mode": "test", "epoch": 42}
{"loss": 0.19807523488998413, "acc": 0.9237337708473206, "length": 3.9984617233276367, "mode": "train", "epoch": 43}
{"loss": 0.2160022258758545, "acc": 0.9153584241867065, "length": 4.0, "mode": "test", "epoch": 43}
{"loss": 0.19349174201488495, "acc": 0.9274781346321106, "length": 3.9998395442962646, "mode": "train", "epoch": 44}
{"loss": 0.21318218111991882, "acc": 0.9182594418525696, "length": 4.0, "mode": "test", "epoch": 44}
{"loss": 0.1894121766090393, "acc": 0.9281952381134033, "length": 3.9968791007995605, "mode": "train", "epoch": 45}
{"loss": 0.2066848874092102, "acc": 0.9242319464683533, "length": 4.0, "mode": "test", "epoch": 45}
{"loss": 0.18914340436458588, "acc": 0.9281439185142517, "length": 3.999251365661621, "mode": "train", "epoch": 46}
{"loss": 0.21767191588878632, "acc": 0.9179180264472961, "length": 4.0, "mode": "test", "epoch": 46}
{"loss": 0.18801531195640564, "acc": 0.9270545840263367, "length": 3.99843168258667, "mode": "train", "epoch": 47}
{"loss": 0.20476041734218597, "acc": 0.9232080578804016, "length": 4.0, "mode": "test", "epoch": 47}
{"loss": 0.18853726983070374, "acc": 0.9242523908615112, "length": 3.9988768100738525, "mode": "train", "epoch": 48}
{"loss": 0.21731188893318176, "acc": 0.9211605191230774, "length": 4.0, "mode": "test", "epoch": 48}
{"loss": 0.18911796808242798, "acc": 0.9261001348495483, "length": 3.9993107318878174, "mode": "train", "epoch": 49}
{"loss": 0.2023545205593109, "acc": 0.9295220971107483, "length": 4.0, "mode": "test", "epoch": 49}
{"loss": 0.18176928162574768, "acc": 0.9314635992050171, "length": 3.999765157699585, "mode": "train", "epoch": 50}
{"loss": 0.19810175895690918, "acc": 0.9276449084281921, "length": 4.0, "mode": "test", "epoch": 50}
{"loss": 0.17643432319164276, "acc": 0.9349977970123291, "length": 3.9993057250976562, "mode": "train", "epoch": 51}
{"loss": 0.20062974095344543, "acc": 0.9324232339859009, "length": 4.0, "mode": "test", "epoch": 51}
{"loss": 0.18081705272197723, "acc": 0.9343671202659607, "length": 3.9996449947357178, "mode": "train", "epoch": 52}
{"loss": 0.20822648704051971, "acc": 0.9295220971107483, "length": 4.0, "mode": "test", "epoch": 52}
{"loss": 0.17229704558849335, "acc": 0.9327980875968933, "length": 3.9983694553375244, "mode": "train", "epoch": 53}
{"loss": 0.19356638193130493, "acc": 0.9366893768310547, "length": 4.0, "mode": "test", "epoch": 53}
{"loss": 0.18130548298358917, "acc": 0.9303759932518005, "length": 3.9995646476745605, "mode": "train", "epoch": 54}
{"loss": 0.21801111102104187, "acc": 0.9204778671264648, "length": 4.0, "mode": "test", "epoch": 54}
{"loss": 0.19460837543010712, "acc": 0.9234225153923035, "length": 3.999363422393799, "mode": "train", "epoch": 55}
{"loss": 0.19482383131980896, "acc": 0.9250853061676025, "length": 4.0, "mode": "test", "epoch": 55}
{"loss": 0.18961378931999207, "acc": 0.9250258803367615, "length": 3.999922513961792, "mode": "train", "epoch": 56}
{"loss": 0.19765441119670868, "acc": 0.920648455619812, "length": 4.0, "mode": "test", "epoch": 56}
{"loss": 0.17525891959667206, "acc": 0.9339803457260132, "length": 3.998807907104492, "mode": "train", "epoch": 57}
{"loss": 0.19008055329322815, "acc": 0.9327643513679504, "length": 4.0, "mode": "test", "epoch": 57}
{"loss": 0.17692606151103973, "acc": 0.9317358136177063, "length": 3.9987847805023193, "mode": "train", "epoch": 58}
{"loss": 0.1972969025373459, "acc": 0.925938606262207, "length": 4.0, "mode": "test", "epoch": 58}
{"loss": 0.17633698880672455, "acc": 0.9330889582633972, "length": 3.99875807762146, "mode": "train", "epoch": 59}
{"loss": 0.19672250747680664, "acc": 0.9134811162948608, "length": 4.0, "mode": "test", "epoch": 59}
{"loss": 0.17513509094715118, "acc": 0.9348957538604736, "length": 3.9965693950653076, "mode": "train", "epoch": 60}
{"loss": 0.19793705642223358, "acc": 0.9276450276374817, "length": 4.0, "mode": "test", "epoch": 60}
test accuracy: 0.7862962484359741
