# ["--attributes=5", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=128", "--learning_rate=0.0005", "--hidden_size=256", "--temp_update=0.97", "--temperature=2"]
Creating train_ds and val_ds...

Creating test_ds...
{"loss": 0.7089760303497314, "acc": 0.5038890242576599, "length": 3.504629611968994, "mode": "train", "epoch": 1}
{"loss": 0.6964890956878662, "acc": 0.5050698518753052, "length": 1.0, "mode": "test", "epoch": 1}
{"loss": 0.6944454312324524, "acc": 0.5232239365577698, "length": 3.23673415184021, "mode": "train", "epoch": 2}
{"loss": 0.6974546313285828, "acc": 0.49318182468414307, "length": 1.0, "mode": "test", "epoch": 2}
{"loss": 0.6890519857406616, "acc": 0.5314635634422302, "length": 2.6933419704437256, "mode": "train", "epoch": 3}
{"loss": 0.6941035985946655, "acc": 0.5041958093643188, "length": 1.0, "mode": "test", "epoch": 3}
{"loss": 0.6833847165107727, "acc": 0.5739294290542603, "length": 2.350254535675049, "mode": "train", "epoch": 4}
{"loss": 0.6839178800582886, "acc": 0.5586768388748169, "length": 1.5244755744934082, "mode": "test", "epoch": 4}
{"loss": 0.6692022681236267, "acc": 0.615801990032196, "length": 2.8348729610443115, "mode": "train", "epoch": 5}
{"loss": 0.6582173705101013, "acc": 0.6194642782211304, "length": 2.7412588596343994, "mode": "test", "epoch": 5}
{"loss": 0.6295187473297119, "acc": 0.6849882006645203, "length": 3.302424430847168, "mode": "train", "epoch": 6}
{"loss": 0.5815810561180115, "acc": 0.7131104469299316, "length": 3.545454502105713, "mode": "test", "epoch": 6}
{"loss": 0.5800983905792236, "acc": 0.7164731025695801, "length": 3.584958076477051, "mode": "train", "epoch": 7}
{"loss": 0.5522032380104065, "acc": 0.7276524305343628, "length": 3.9265735149383545, "mode": "test", "epoch": 7}
{"loss": 0.5560308694839478, "acc": 0.7218531370162964, "length": 3.7680680751800537, "mode": "train", "epoch": 8}
{"loss": 0.564738929271698, "acc": 0.7189398407936096, "length": 3.9580419063568115, "mode": "test", "epoch": 8}
{"loss": 0.540480375289917, "acc": 0.7406375408172607, "length": 3.7690718173980713, "mode": "train", "epoch": 9}
{"loss": 0.5225703716278076, "acc": 0.7606775164604187, "length": 3.7482516765594482, "mode": "test", "epoch": 9}
{"loss": 0.5133081674575806, "acc": 0.770146906375885, "length": 3.687082052230835, "mode": "train", "epoch": 10}
{"loss": 0.4851192235946655, "acc": 0.7800000309944153, "length": 3.7727272510528564, "mode": "test", "epoch": 10}
{"loss": 0.47782769799232483, "acc": 0.7893550992012024, "length": 3.640113592147827, "mode": "train", "epoch": 11}
{"loss": 0.4428456723690033, "acc": 0.8102348446846008, "length": 3.814685344696045, "mode": "test", "epoch": 11}
{"loss": 0.4361202120780945, "acc": 0.8173190355300903, "length": 3.6526529788970947, "mode": "train", "epoch": 12}
{"loss": 0.3956591486930847, "acc": 0.8304270505905151, "length": 3.744755268096924, "mode": "test", "epoch": 12}
{"loss": 0.40102091431617737, "acc": 0.8293852210044861, "length": 3.676837205886841, "mode": "train", "epoch": 13}
{"loss": 0.3756381869316101, "acc": 0.8400358557701111, "length": 3.7202796936035156, "mode": "test", "epoch": 13}
{"loss": 0.37330347299575806, "acc": 0.8456431031227112, "length": 3.677528142929077, "mode": "train", "epoch": 14}
{"loss": 0.3682093620300293, "acc": 0.8497805595397949, "length": 3.877622365951538, "mode": "test", "epoch": 14}
{"loss": 0.34799960255622864, "acc": 0.8514392971992493, "length": 3.7550878524780273, "mode": "train", "epoch": 15}
{"loss": 0.3489786982536316, "acc": 0.8532165884971619, "length": 3.8636362552642822, "mode": "test", "epoch": 15}
{"loss": 0.3288643956184387, "acc": 0.8613324761390686, "length": 3.77706241607666, "mode": "train", "epoch": 16}
{"loss": 0.33007359504699707, "acc": 0.8737732172012329, "length": 3.884615421295166, "mode": "test", "epoch": 16}
{"loss": 0.31507769227027893, "acc": 0.8697390556335449, "length": 3.79789137840271, "mode": "train", "epoch": 17}
{"loss": 0.3004736304283142, "acc": 0.8797964453697205, "length": 3.793706178665161, "mode": "test", "epoch": 17}
{"loss": 0.29838383197784424, "acc": 0.8833386898040771, "length": 3.771183967590332, "mode": "train", "epoch": 18}
{"loss": 0.2971135973930359, "acc": 0.8851047158241272, "length": 3.839160919189453, "mode": "test", "epoch": 18}
{"loss": 0.278921514749527, "acc": 0.8866181969642639, "length": 3.7839114665985107, "mode": "train", "epoch": 19}
{"loss": 0.29093271493911743, "acc": 0.8894965052604675, "length": 3.832167863845825, "mode": "test", "epoch": 19}
{"loss": 0.26767274737358093, "acc": 0.8940003514289856, "length": 3.828584909439087, "mode": "train", "epoch": 20}
{"loss": 0.27294260263442993, "acc": 0.8871411681175232, "length": 3.8356642723083496, "mode": "test", "epoch": 20}
{"loss": 0.2521899938583374, "acc": 0.8993279337882996, "length": 3.8162097930908203, "mode": "train", "epoch": 21}
{"loss": 0.26091477274894714, "acc": 0.8932265639305115, "length": 3.8811187744140625, "mode": "test", "epoch": 21}
{"loss": 0.23896297812461853, "acc": 0.9087426066398621, "length": 3.8733861446380615, "mode": "train", "epoch": 22}
{"loss": 0.24896763265132904, "acc": 0.8976015448570251, "length": 3.8986012935638428, "mode": "test", "epoch": 22}
{"loss": 0.231105238199234, "acc": 0.9082245826721191, "length": 3.858928680419922, "mode": "train", "epoch": 23}
{"loss": 0.236623615026474, "acc": 0.9058616757392883, "length": 3.884615421295166, "mode": "test", "epoch": 23}
{"loss": 0.22229178249835968, "acc": 0.9140403866767883, "length": 3.8702292442321777, "mode": "train", "epoch": 24}
{"loss": 0.24257540702819824, "acc": 0.9017208218574524, "length": 3.9265735149383545, "mode": "test", "epoch": 24}
{"loss": 0.22554120421409607, "acc": 0.9129688739776611, "length": 3.9087843894958496, "mode": "train", "epoch": 25}
{"loss": 0.23894856870174408, "acc": 0.9008886218070984, "length": 3.9440560340881348, "mode": "test", "epoch": 25}
{"loss": 0.2152813822031021, "acc": 0.9137610197067261, "length": 3.9167654514312744, "mode": "train", "epoch": 26}
{"loss": 0.21825596690177917, "acc": 0.9088183045387268, "length": 3.9405593872070312, "mode": "test", "epoch": 26}
{"loss": 0.20534564554691315, "acc": 0.9182772040367126, "length": 3.911187171936035, "mode": "train", "epoch": 27}
{"loss": 0.21389101445674896, "acc": 0.9176436066627502, "length": 3.9440560340881348, "mode": "test", "epoch": 27}
{"loss": 0.2067142277956009, "acc": 0.9214009642601013, "length": 3.891775608062744, "mode": "train", "epoch": 28}
{"loss": 0.22305172681808472, "acc": 0.9058115482330322, "length": 3.9510488510131836, "mode": "test", "epoch": 28}
{"loss": 0.20642957091331482, "acc": 0.9182456135749817, "length": 3.9067585468292236, "mode": "train", "epoch": 29}
{"loss": 0.2261197566986084, "acc": 0.9128374457359314, "length": 3.961538553237915, "mode": "test", "epoch": 29}
{"loss": 0.20095810294151306, "acc": 0.9251776337623596, "length": 3.9055564403533936, "mode": "train", "epoch": 30}
{"loss": 0.21666716039180756, "acc": 0.9216290712356567, "length": 3.961538553237915, "mode": "test", "epoch": 30}
{"loss": 0.18279573321342468, "acc": 0.9302868247032166, "length": 3.918973922729492, "mode": "train", "epoch": 31}
{"loss": 0.19565992057323456, "acc": 0.9285730719566345, "length": 3.961538553237915, "mode": "test", "epoch": 31}
{"loss": 0.18086090683937073, "acc": 0.931480884552002, "length": 3.9137542247772217, "mode": "train", "epoch": 32}
{"loss": 0.19552230834960938, "acc": 0.9249494075775146, "length": 3.9650349617004395, "mode": "test", "epoch": 32}
{"loss": 0.17985232174396515, "acc": 0.9330422282218933, "length": 3.9016332626342773, "mode": "train", "epoch": 33}
{"loss": 0.18533551692962646, "acc": 0.9315354228019714, "length": 3.961538553237915, "mode": "test", "epoch": 33}
{"loss": 0.16402867436408997, "acc": 0.9371236562728882, "length": 3.9158833026885986, "mode": "train", "epoch": 34}
{"loss": 0.19757287204265594, "acc": 0.9335405230522156, "length": 3.968531370162964, "mode": "test", "epoch": 34}
{"loss": 0.15519821643829346, "acc": 0.9420844912528992, "length": 3.909773349761963, "mode": "train", "epoch": 35}
{"loss": 0.15682533383369446, "acc": 0.9436571002006531, "length": 3.968531370162964, "mode": "test", "epoch": 35}
{"loss": 0.1472657173871994, "acc": 0.9464784860610962, "length": 3.9186065196990967, "mode": "train", "epoch": 36}
{"loss": 0.16588318347930908, "acc": 0.9398150444030762, "length": 3.9720280170440674, "mode": "test", "epoch": 36}
{"loss": 0.14574997127056122, "acc": 0.945522129535675, "length": 3.9241108894348145, "mode": "train", "epoch": 37}
{"loss": 0.1545056402683258, "acc": 0.9471113085746765, "length": 3.9720280170440674, "mode": "test", "epoch": 37}
{"loss": 0.13166165351867676, "acc": 0.9512989521026611, "length": 3.9291980266571045, "mode": "train", "epoch": 38}
{"loss": 0.14559027552604675, "acc": 0.9526441693305969, "length": 3.9720280170440674, "mode": "test", "epoch": 38}
{"loss": 0.13343392312526703, "acc": 0.947138786315918, "length": 3.906379461288452, "mode": "train", "epoch": 39}
{"loss": 0.16668638586997986, "acc": 0.9419142603874207, "length": 3.9580419063568115, "mode": "test", "epoch": 39}
{"loss": 0.12985223531723022, "acc": 0.9507676362991333, "length": 3.917940616607666, "mode": "train", "epoch": 40}
{"loss": 0.15348146855831146, "acc": 0.9463258981704712, "length": 3.9790210723876953, "mode": "test", "epoch": 40}
{"loss": 0.13727250695228577, "acc": 0.948599100112915, "length": 3.9452035427093506, "mode": "train", "epoch": 41}
{"loss": 0.11991548538208008, "acc": 0.955069899559021, "length": 3.9825174808502197, "mode": "test", "epoch": 41}
{"loss": 0.12390149384737015, "acc": 0.9515426754951477, "length": 3.9290454387664795, "mode": "train", "epoch": 42}
{"loss": 0.14898866415023804, "acc": 0.9446200132369995, "length": 3.9510488510131836, "mode": "test", "epoch": 42}
{"loss": 0.12435736507177353, "acc": 0.953557550907135, "length": 3.8832712173461914, "mode": "train", "epoch": 43}
{"loss": 0.12888741493225098, "acc": 0.9508796334266663, "length": 3.9580419063568115, "mode": "test", "epoch": 43}
{"loss": 0.1214262917637825, "acc": 0.9546521902084351, "length": 3.912956714630127, "mode": "train", "epoch": 44}
{"loss": 0.12431028485298157, "acc": 0.9477081298828125, "length": 3.961538553237915, "mode": "test", "epoch": 44}
{"loss": 0.11844082921743393, "acc": 0.9554843306541443, "length": 3.912764549255371, "mode": "train", "epoch": 45}
{"loss": 0.13220348954200745, "acc": 0.9463777542114258, "length": 3.9580419063568115, "mode": "test", "epoch": 45}
{"loss": 0.11110037565231323, "acc": 0.957747220993042, "length": 3.9158427715301514, "mode": "train", "epoch": 46}
{"loss": 0.12618198990821838, "acc": 0.9475129842758179, "length": 3.986013889312744, "mode": "test", "epoch": 46}
{"loss": 0.10796529054641724, "acc": 0.9592863917350769, "length": 3.943329095840454, "mode": "train", "epoch": 47}
{"loss": 0.11868356168270111, "acc": 0.9502102732658386, "length": 3.9895105361938477, "mode": "test", "epoch": 47}
{"loss": 0.10194329917430878, "acc": 0.9604302048683167, "length": 3.9403939247131348, "mode": "train", "epoch": 48}
{"loss": 0.11201958358287811, "acc": 0.9571322798728943, "length": 3.986013889312744, "mode": "test", "epoch": 48}
{"loss": 0.09699556976556778, "acc": 0.96732497215271, "length": 3.9480884075164795, "mode": "train", "epoch": 49}
{"loss": 0.10441359132528305, "acc": 0.9636362791061401, "length": 3.9895105361938477, "mode": "test", "epoch": 49}
{"loss": 0.09053156524896622, "acc": 0.9639201760292053, "length": 3.950108051300049, "mode": "train", "epoch": 50}
{"loss": 0.09040242433547974, "acc": 0.9623059630393982, "length": 3.986013889312744, "mode": "test", "epoch": 50}
{"loss": 0.09154284745454788, "acc": 0.9657412767410278, "length": 3.941843032836914, "mode": "train", "epoch": 51}
{"loss": 0.1084619015455246, "acc": 0.9651278853416443, "length": 3.9895105361938477, "mode": "test", "epoch": 51}
{"loss": 0.08656153082847595, "acc": 0.9690344333648682, "length": 3.9310765266418457, "mode": "train", "epoch": 52}
{"loss": 0.09498937427997589, "acc": 0.9638167023658752, "length": 3.9720280170440674, "mode": "test", "epoch": 52}
{"loss": 0.0851745530962944, "acc": 0.9666325449943542, "length": 3.9170913696289062, "mode": "train", "epoch": 53}
{"loss": 0.08208685368299484, "acc": 0.9676204323768616, "length": 3.9895105361938477, "mode": "test", "epoch": 53}
{"loss": 0.08437418192625046, "acc": 0.9693503379821777, "length": 3.9469428062438965, "mode": "train", "epoch": 54}
{"loss": 0.093207448720932, "acc": 0.9636021256446838, "length": 3.9965035915374756, "mode": "test", "epoch": 54}
{"loss": 0.08079978078603745, "acc": 0.9689575433731079, "length": 3.9440224170684814, "mode": "train", "epoch": 55}
{"loss": 0.10088738054037094, "acc": 0.9659159183502197, "length": 3.9895105361938477, "mode": "test", "epoch": 55}
{"loss": 0.0790843665599823, "acc": 0.9705253839492798, "length": 3.9289145469665527, "mode": "train", "epoch": 56}
{"loss": 0.10065098851919174, "acc": 0.9661973118782043, "length": 3.986013889312744, "mode": "test", "epoch": 56}
{"loss": 0.07904872298240662, "acc": 0.9705541133880615, "length": 3.9336133003234863, "mode": "train", "epoch": 57}
{"loss": 0.08124569058418274, "acc": 0.9642195105552673, "length": 3.9825174808502197, "mode": "test", "epoch": 57}
{"loss": 0.0772254467010498, "acc": 0.970506489276886, "length": 3.930596113204956, "mode": "train", "epoch": 58}
{"loss": 0.11183834075927734, "acc": 0.9614537358283997, "length": 3.9895105361938477, "mode": "test", "epoch": 58}
{"loss": 0.07542707026004791, "acc": 0.9733849763870239, "length": 3.9299046993255615, "mode": "train", "epoch": 59}
{"loss": 0.10857680439949036, "acc": 0.96433424949646, "length": 3.9790210723876953, "mode": "test", "epoch": 59}
{"loss": 0.08647999912500381, "acc": 0.9688973426818848, "length": 3.9236297607421875, "mode": "train", "epoch": 60}
{"loss": 0.10392924398183823, "acc": 0.9619045853614807, "length": 3.986013889312744, "mode": "test", "epoch": 60}
test accuracy: 0.8661965727806091
