# ["--attributes=3", "--values=16", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=128", "--learning_rate=0.0005", "--hidden_size=256", "--temp_update=0.97", "--temperature=1.5"]
Creating train_ds and val_ds...

Creating test_ds...
{"loss": 0.6991151571273804, "acc": 0.5077030658721924, "length": 3.48978328704834, "mode": "train", "epoch": 1}
{"loss": 0.687288761138916, "acc": 0.5486254692077637, "length": 1.0, "mode": "test", "epoch": 1}
{"loss": 0.6897675395011902, "acc": 0.533340573310852, "length": 3.263498306274414, "mode": "train", "epoch": 2}
{"loss": 0.6929799914360046, "acc": 0.49003443121910095, "length": 1.0, "mode": "test", "epoch": 2}
{"loss": 0.6859066486358643, "acc": 0.5500165820121765, "length": 2.8399646282196045, "mode": "train", "epoch": 3}
{"loss": 0.6899122595787048, "acc": 0.5429298281669617, "length": 1.024055004119873, "mode": "test", "epoch": 3}
{"loss": 0.6650899648666382, "acc": 0.6168369054794312, "length": 2.4704275131225586, "mode": "train", "epoch": 4}
{"loss": 0.6276878714561462, "acc": 0.7079197764396667, "length": 2.0584192276000977, "mode": "test", "epoch": 4}
{"loss": 0.6200388669967651, "acc": 0.7192730903625488, "length": 2.649869203567505, "mode": "train", "epoch": 5}
{"loss": 0.5645219087600708, "acc": 0.7828587293624878, "length": 2.6838488578796387, "mode": "test", "epoch": 5}
{"loss": 0.5515524744987488, "acc": 0.7788648009300232, "length": 2.845557689666748, "mode": "train", "epoch": 6}
{"loss": 0.5031596422195435, "acc": 0.7761367559432983, "length": 3.1890034675598145, "mode": "test", "epoch": 6}
{"loss": 0.4885704517364502, "acc": 0.7741432189941406, "length": 3.116765022277832, "mode": "train", "epoch": 7}
{"loss": 0.4702090620994568, "acc": 0.8004944324493408, "length": 3.2817869186401367, "mode": "test", "epoch": 7}
{"loss": 0.4443890154361725, "acc": 0.7928428649902344, "length": 3.2923972606658936, "mode": "train", "epoch": 8}
{"loss": 0.4448753595352173, "acc": 0.8159090280532837, "length": 3.371134042739868, "mode": "test", "epoch": 8}
{"loss": 0.42069360613822937, "acc": 0.8153793215751648, "length": 3.4400408267974854, "mode": "train", "epoch": 9}
{"loss": 0.43247270584106445, "acc": 0.811290979385376, "length": 3.5154638290405273, "mode": "test", "epoch": 9}
{"loss": 0.4003804624080658, "acc": 0.8220058083534241, "length": 3.4407594203948975, "mode": "train", "epoch": 10}
{"loss": 0.42441290616989136, "acc": 0.8192583322525024, "length": 3.529209613800049, "mode": "test", "epoch": 10}
{"loss": 0.3837715685367584, "acc": 0.8321408033370972, "length": 3.51442813873291, "mode": "train", "epoch": 11}
{"loss": 0.4004250764846802, "acc": 0.8343738913536072, "length": 3.621993064880371, "mode": "test", "epoch": 11}
{"loss": 0.3668050467967987, "acc": 0.8443127274513245, "length": 3.5756287574768066, "mode": "train", "epoch": 12}
{"loss": 0.3901802897453308, "acc": 0.8349974155426025, "length": 3.5670104026794434, "mode": "test", "epoch": 12}
{"loss": 0.34988269209861755, "acc": 0.8557209968566895, "length": 3.6317005157470703, "mode": "train", "epoch": 13}
{"loss": 0.3865581452846527, "acc": 0.8353983163833618, "length": 3.649484634399414, "mode": "test", "epoch": 13}
{"loss": 0.33589237928390503, "acc": 0.8574994206428528, "length": 3.659266233444214, "mode": "train", "epoch": 14}
{"loss": 0.3443954586982727, "acc": 0.8623644709587097, "length": 3.7560136318206787, "mode": "test", "epoch": 14}
{"loss": 0.32007142901420593, "acc": 0.8701430559158325, "length": 3.6872146129608154, "mode": "train", "epoch": 15}
{"loss": 0.34008121490478516, "acc": 0.8605055809020996, "length": 3.7182130813598633, "mode": "test", "epoch": 15}
{"loss": 0.30771079659461975, "acc": 0.8789806365966797, "length": 3.7014353275299072, "mode": "train", "epoch": 16}
{"loss": 0.3385104835033417, "acc": 0.8622069358825684, "length": 3.728522300720215, "mode": "test", "epoch": 16}
{"loss": 0.29821154475212097, "acc": 0.8788859248161316, "length": 3.7241427898406982, "mode": "train", "epoch": 17}
{"loss": 0.3096965551376343, "acc": 0.8777713775634766, "length": 3.7663230895996094, "mode": "test", "epoch": 17}
{"loss": 0.279582679271698, "acc": 0.8845115303993225, "length": 3.7599525451660156, "mode": "train", "epoch": 18}
{"loss": 0.28725752234458923, "acc": 0.8813228011131287, "length": 3.752577304840088, "mode": "test", "epoch": 18}
{"loss": 0.26469001173973083, "acc": 0.8931798934936523, "length": 3.7708113193511963, "mode": "train", "epoch": 19}
{"loss": 0.2821202874183655, "acc": 0.8901756405830383, "length": 3.8384878635406494, "mode": "test", "epoch": 19}
{"loss": 0.25459596514701843, "acc": 0.896182656288147, "length": 3.82145094871521, "mode": "train", "epoch": 20}
{"loss": 0.2630004286766052, "acc": 0.892487645149231, "length": 3.821305751800537, "mode": "test", "epoch": 20}
{"loss": 0.24112345278263092, "acc": 0.9037907719612122, "length": 3.832367181777954, "mode": "train", "epoch": 21}
{"loss": 0.2432996928691864, "acc": 0.907921552658081, "length": 3.8625428676605225, "mode": "test", "epoch": 21}
{"loss": 0.23527762293815613, "acc": 0.9074605703353882, "length": 3.8603861331939697, "mode": "train", "epoch": 22}
{"loss": 0.25098177790641785, "acc": 0.8987123966217041, "length": 3.8384878635406494, "mode": "test", "epoch": 22}
{"loss": 0.22561952471733093, "acc": 0.9076851606369019, "length": 3.8411808013916016, "mode": "train", "epoch": 23}
{"loss": 0.239018052816391, "acc": 0.9078640937805176, "length": 3.8075602054595947, "mode": "test", "epoch": 23}
{"loss": 0.2128516286611557, "acc": 0.9178481101989746, "length": 3.8247931003570557, "mode": "train", "epoch": 24}
{"loss": 0.23550480604171753, "acc": 0.9090146422386169, "length": 3.8419244289398193, "mode": "test", "epoch": 24}
{"loss": 0.21785764396190643, "acc": 0.9130212664604187, "length": 3.833573579788208, "mode": "train", "epoch": 25}
{"loss": 0.2237541526556015, "acc": 0.9105849862098694, "length": 3.828178644180298, "mode": "test", "epoch": 25}
{"loss": 0.1985672265291214, "acc": 0.9231104254722595, "length": 3.807769536972046, "mode": "train", "epoch": 26}
{"loss": 0.22314421832561493, "acc": 0.9204385876655579, "length": 3.8075602054595947, "mode": "test", "epoch": 26}
{"loss": 0.19762898981571198, "acc": 0.9248746633529663, "length": 3.7647955417633057, "mode": "train", "epoch": 27}
{"loss": 0.21824632585048676, "acc": 0.9193575382232666, "length": 3.721649408340454, "mode": "test", "epoch": 27}
{"loss": 0.1855148822069168, "acc": 0.9278045892715454, "length": 3.796679735183716, "mode": "train", "epoch": 28}
{"loss": 0.19480197131633759, "acc": 0.928090512752533, "length": 3.752577304840088, "mode": "test", "epoch": 28}
{"loss": 0.17908212542533875, "acc": 0.931504487991333, "length": 3.787729024887085, "mode": "train", "epoch": 29}
{"loss": 0.18997839093208313, "acc": 0.9300004243850708, "length": 3.7938144207000732, "mode": "test", "epoch": 29}
{"loss": 0.17182083427906036, "acc": 0.9336757659912109, "length": 3.81685209274292, "mode": "train", "epoch": 30}
{"loss": 0.18139860033988953, "acc": 0.9380302429199219, "length": 3.7388315200805664, "mode": "test", "epoch": 30}
{"loss": 0.17431722581386566, "acc": 0.9330829977989197, "length": 3.788728952407837, "mode": "train", "epoch": 31}
{"loss": 0.17607508599758148, "acc": 0.9308263063430786, "length": 3.749140977859497, "mode": "test", "epoch": 31}
{"loss": 0.16653987765312195, "acc": 0.935189425945282, "length": 3.8165059089660645, "mode": "train", "epoch": 32}
{"loss": 0.17419014871120453, "acc": 0.9350296258926392, "length": 3.7697594165802, "mode": "test", "epoch": 32}
{"loss": 0.1597377508878708, "acc": 0.9366105794906616, "length": 3.7867026329040527, "mode": "train", "epoch": 33}
{"loss": 0.17338228225708008, "acc": 0.9356815218925476, "length": 3.7938144207000732, "mode": "test", "epoch": 33}
{"loss": 0.14831595122814178, "acc": 0.9452298283576965, "length": 3.822484016418457, "mode": "train", "epoch": 34}
{"loss": 0.1864262819290161, "acc": 0.9408406019210815, "length": 3.8075602054595947, "mode": "test", "epoch": 34}
{"loss": 0.1419922560453415, "acc": 0.9497972130775452, "length": 3.822753429412842, "mode": "train", "epoch": 35}
{"loss": 0.18074911832809448, "acc": 0.9414104223251343, "length": 3.84879732131958, "mode": "test", "epoch": 35}
{"loss": 0.13978445529937744, "acc": 0.9486457705497742, "length": 3.8244645595550537, "mode": "train", "epoch": 36}
{"loss": 0.1560407280921936, "acc": 0.9367187023162842, "length": 3.745704412460327, "mode": "test", "epoch": 36}
{"loss": 0.15048794448375702, "acc": 0.9414275288581848, "length": 3.8423492908477783, "mode": "train", "epoch": 37}
{"loss": 0.1749695986509323, "acc": 0.935801088809967, "length": 3.7938144207000732, "mode": "test", "epoch": 37}
{"loss": 0.1486009955406189, "acc": 0.9455919861793518, "length": 3.8211758136749268, "mode": "train", "epoch": 38}
{"loss": 0.19017508625984192, "acc": 0.9295647740364075, "length": 3.872852325439453, "mode": "test", "epoch": 38}
{"loss": 0.15086910128593445, "acc": 0.9431974291801453, "length": 3.8002994060516357, "mode": "train", "epoch": 39}
{"loss": 0.1444370299577713, "acc": 0.9439723491668701, "length": 3.797250747680664, "mode": "test", "epoch": 39}
{"loss": 0.1277327984571457, "acc": 0.9536238312721252, "length": 3.8421120643615723, "mode": "train", "epoch": 40}
{"loss": 0.15398919582366943, "acc": 0.9435871839523315, "length": 3.8178694248199463, "mode": "test", "epoch": 40}
{"loss": 0.12723083794116974, "acc": 0.9518394470214844, "length": 3.8321330547332764, "mode": "train", "epoch": 41}
{"loss": 0.15654508769512177, "acc": 0.9485252499580383, "length": 3.824742317199707, "mode": "test", "epoch": 41}
{"loss": 0.12252447754144669, "acc": 0.955136775970459, "length": 3.805900812149048, "mode": "train", "epoch": 42}
{"loss": 0.1502842754125595, "acc": 0.9487835168838501, "length": 3.8075602054595947, "mode": "test", "epoch": 42}
{"loss": 0.11719198524951935, "acc": 0.9542183876037598, "length": 3.8284919261932373, "mode": "train", "epoch": 43}
{"loss": 0.12857268750667572, "acc": 0.9543853402137756, "length": 3.800687313079834, "mode": "test", "epoch": 43}
{"loss": 0.11593159288167953, "acc": 0.9570212960243225, "length": 3.83115291595459, "mode": "train", "epoch": 44}
{"loss": 0.12510906159877777, "acc": 0.9483797550201416, "length": 3.8384878635406494, "mode": "test", "epoch": 44}
{"loss": 0.10496223717927933, "acc": 0.9595534205436707, "length": 3.826120138168335, "mode": "train", "epoch": 45}
{"loss": 0.13189877569675446, "acc": 0.9481667876243591, "length": 3.8178694248199463, "mode": "test", "epoch": 45}
{"loss": 0.1056615486741066, "acc": 0.9587212204933167, "length": 3.8150150775909424, "mode": "train", "epoch": 46}
{"loss": 0.11103840917348862, "acc": 0.9629130959510803, "length": 3.8075602054595947, "mode": "test", "epoch": 46}
{"loss": 0.1061822921037674, "acc": 0.9582303762435913, "length": 3.8426902294158936, "mode": "train", "epoch": 47}
{"loss": 0.14648716151714325, "acc": 0.9482475519180298, "length": 3.896907329559326, "mode": "test", "epoch": 47}
{"loss": 0.10659077018499374, "acc": 0.9634056091308594, "length": 3.870758533477783, "mode": "train", "epoch": 48}
{"loss": 0.11316513270139694, "acc": 0.9595589637756348, "length": 3.804123640060425, "mode": "test", "epoch": 48}
{"loss": 0.10226020216941833, "acc": 0.961386501789093, "length": 3.826601982116699, "mode": "train", "epoch": 49}
{"loss": 0.13601768016815186, "acc": 0.9476586580276489, "length": 3.852233648300171, "mode": "test", "epoch": 49}
{"loss": 0.09624498337507248, "acc": 0.9654382467269897, "length": 3.8344838619232178, "mode": "train", "epoch": 50}
{"loss": 0.12336087226867676, "acc": 0.9539549350738525, "length": 3.8075602054595947, "mode": "test", "epoch": 50}
{"loss": 0.09988299757242203, "acc": 0.9617857933044434, "length": 3.8207366466522217, "mode": "train", "epoch": 51}
{"loss": 0.1244562491774559, "acc": 0.9574494957923889, "length": 3.8350515365600586, "mode": "test", "epoch": 51}
{"loss": 0.09815327823162079, "acc": 0.9624267220497131, "length": 3.8441667556762695, "mode": "train", "epoch": 52}
{"loss": 0.12565189599990845, "acc": 0.9538520574569702, "length": 3.8419244289398193, "mode": "test", "epoch": 52}
{"loss": 0.09443048387765884, "acc": 0.9640461206436157, "length": 3.839829921722412, "mode": "train", "epoch": 53}
{"loss": 0.11377279460430145, "acc": 0.9589476585388184, "length": 3.8178694248199463, "mode": "test", "epoch": 53}
{"loss": 0.08262227475643158, "acc": 0.9706425070762634, "length": 3.793368339538574, "mode": "train", "epoch": 54}
{"loss": 0.10524307936429977, "acc": 0.9604495167732239, "length": 3.8144330978393555, "mode": "test", "epoch": 54}
{"loss": 0.07979025691747665, "acc": 0.9708875417709351, "length": 3.8414204120635986, "mode": "train", "epoch": 55}
{"loss": 0.10402731597423553, "acc": 0.9596326947212219, "length": 3.804123640060425, "mode": "test", "epoch": 55}
{"loss": 0.07702486217021942, "acc": 0.9717540740966797, "length": 3.8311362266540527, "mode": "train", "epoch": 56}
{"loss": 0.13227732479572296, "acc": 0.9531401991844177, "length": 3.869415760040283, "mode": "test", "epoch": 56}
{"loss": 0.08310316503047943, "acc": 0.9684843420982361, "length": 3.839031219482422, "mode": "train", "epoch": 57}
{"loss": 0.10009698569774628, "acc": 0.9639576077461243, "length": 3.8109965324401855, "mode": "test", "epoch": 57}
{"loss": 0.07812480628490448, "acc": 0.9714174270629883, "length": 3.8350632190704346, "mode": "train", "epoch": 58}
{"loss": 0.12218844890594482, "acc": 0.9554409980773926, "length": 3.8591065406799316, "mode": "test", "epoch": 58}
{"loss": 0.07719048857688904, "acc": 0.9717478156089783, "length": 3.8665871620178223, "mode": "train", "epoch": 59}
{"loss": 0.10469484329223633, "acc": 0.9628373384475708, "length": 3.8178694248199463, "mode": "test", "epoch": 59}
{"loss": 0.08621455729007721, "acc": 0.9667936563491821, "length": 3.770256757736206, "mode": "train", "epoch": 60}
{"loss": 0.11884036660194397, "acc": 0.9599334597587585, "length": 3.800687313079834, "mode": "test", "epoch": 60}
test accuracy: 0.7888476848602295
