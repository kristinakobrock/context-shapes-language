# ["--attributes=3", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=128", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.97", "--temperature=1"]
Creating train_ds and val_ds...

Creating test_ds...
{"loss": 0.6905480623245239, "acc": 0.541714608669281, "length": 3.5363540649414062, "mode": "train", "epoch": 1}
{"loss": 0.6876162886619568, "acc": 0.5711109638214111, "length": 2.0, "mode": "test", "epoch": 1}
{"loss": 0.6886613368988037, "acc": 0.5374051332473755, "length": 3.4929256439208984, "mode": "train", "epoch": 2}
{"loss": 0.6762464046478271, "acc": 0.5745752453804016, "length": 3.249110221862793, "mode": "test", "epoch": 2}
{"loss": 0.6828305721282959, "acc": 0.5558846592903137, "length": 3.4628849029541016, "mode": "train", "epoch": 3}
{"loss": 0.6698831915855408, "acc": 0.6214671730995178, "length": 3.9466192722320557, "mode": "test", "epoch": 3}
{"loss": 0.6724346876144409, "acc": 0.5872513651847839, "length": 3.5166802406311035, "mode": "train", "epoch": 4}
{"loss": 0.6480133533477783, "acc": 0.6882562637329102, "length": 4.0, "mode": "test", "epoch": 4}
{"loss": 0.6368420124053955, "acc": 0.6745294332504272, "length": 3.754568338394165, "mode": "train", "epoch": 5}
{"loss": 0.6098676919937134, "acc": 0.7224199175834656, "length": 4.0, "mode": "test", "epoch": 5}
{"loss": 0.5769932866096497, "acc": 0.7271210551261902, "length": 3.921581983566284, "mode": "train", "epoch": 6}
{"loss": 0.56327223777771, "acc": 0.7877224683761597, "length": 4.0, "mode": "test", "epoch": 6}
{"loss": 0.515189528465271, "acc": 0.7746697664260864, "length": 3.9719038009643555, "mode": "train", "epoch": 7}
{"loss": 0.507993221282959, "acc": 0.788968026638031, "length": 4.0, "mode": "test", "epoch": 7}
{"loss": 0.45250001549720764, "acc": 0.8041216731071472, "length": 3.988813877105713, "mode": "train", "epoch": 8}
{"loss": 0.4657629430294037, "acc": 0.7893238663673401, "length": 4.0, "mode": "test", "epoch": 8}
{"loss": 0.41077688336372375, "acc": 0.8240497708320618, "length": 3.9799585342407227, "mode": "train", "epoch": 9}
{"loss": 0.4602029323577881, "acc": 0.8101425170898438, "length": 4.0, "mode": "test", "epoch": 9}
{"loss": 0.3895898461341858, "acc": 0.8297101855278015, "length": 3.988560676574707, "mode": "train", "epoch": 10}
{"loss": 0.4578123092651367, "acc": 0.8026692271232605, "length": 4.0, "mode": "test", "epoch": 10}
{"loss": 0.37594345211982727, "acc": 0.8355305790901184, "length": 3.981832981109619, "mode": "train", "epoch": 11}
{"loss": 0.43704479932785034, "acc": 0.8042703866958618, "length": 4.0, "mode": "test", "epoch": 11}
{"loss": 0.36233025789260864, "acc": 0.8445405960083008, "length": 3.988957405090332, "mode": "train", "epoch": 12}
{"loss": 0.41184544563293457, "acc": 0.8247330188751221, "length": 4.0, "mode": "test", "epoch": 12}
{"loss": 0.34683161973953247, "acc": 0.8498499989509583, "length": 3.989851713180542, "mode": "train", "epoch": 13}
{"loss": 0.4209750294685364, "acc": 0.8222418427467346, "length": 4.0, "mode": "test", "epoch": 13}
{"loss": 0.3378601372241974, "acc": 0.8551424741744995, "length": 3.9863052368164062, "mode": "train", "epoch": 14}
{"loss": 0.3983095586299896, "acc": 0.8229536414146423, "length": 4.0, "mode": "test", "epoch": 14}
{"loss": 0.3268415927886963, "acc": 0.8606806993484497, "length": 3.9967246055603027, "mode": "train", "epoch": 15}
{"loss": 0.39185675978660583, "acc": 0.832206666469574, "length": 4.0, "mode": "test", "epoch": 15}
{"loss": 0.31497347354888916, "acc": 0.86695396900177, "length": 3.9948716163635254, "mode": "train", "epoch": 16}
{"loss": 0.38021063804626465, "acc": 0.8407472372055054, "length": 4.0, "mode": "test", "epoch": 16}
{"loss": 0.304272323846817, "acc": 0.873364269733429, "length": 3.995238780975342, "mode": "train", "epoch": 17}
{"loss": 0.379600465297699, "acc": 0.8407473564147949, "length": 4.0, "mode": "test", "epoch": 17}
{"loss": 0.29883283376693726, "acc": 0.8771761059761047, "length": 3.9968185424804688, "mode": "train", "epoch": 18}
{"loss": 0.3456586003303528, "acc": 0.8581849932670593, "length": 4.0, "mode": "test", "epoch": 18}
{"loss": 0.29182717204093933, "acc": 0.8778808116912842, "length": 3.997382879257202, "mode": "train", "epoch": 19}
{"loss": 0.35101550817489624, "acc": 0.857829213142395, "length": 4.0, "mode": "test", "epoch": 19}
{"loss": 0.2759381830692291, "acc": 0.8854163289070129, "length": 3.9974937438964844, "mode": "train", "epoch": 20}
{"loss": 0.33116745948791504, "acc": 0.8637009859085083, "length": 4.0, "mode": "test", "epoch": 20}
{"loss": 0.26943427324295044, "acc": 0.8858087062835693, "length": 3.999535322189331, "mode": "train", "epoch": 21}
{"loss": 0.30664512515068054, "acc": 0.8766904473304749, "length": 4.0, "mode": "test", "epoch": 21}
{"loss": 0.26239705085754395, "acc": 0.8924557566642761, "length": 3.9982998371124268, "mode": "train", "epoch": 22}
{"loss": 0.2937225103378296, "acc": 0.8857651352882385, "length": 4.0, "mode": "test", "epoch": 22}
{"loss": 0.24957001209259033, "acc": 0.8981286287307739, "length": 3.998192071914673, "mode": "train", "epoch": 23}
{"loss": 0.2871510684490204, "acc": 0.8845193982124329, "length": 4.0, "mode": "test", "epoch": 23}
{"loss": 0.24877718091011047, "acc": 0.9017188549041748, "length": 3.9996678829193115, "mode": "train", "epoch": 24}
{"loss": 0.2990691661834717, "acc": 0.8836299777030945, "length": 4.0, "mode": "test", "epoch": 24}
{"loss": 0.2284207046031952, "acc": 0.910271167755127, "length": 3.9982588291168213, "mode": "train", "epoch": 25}
{"loss": 0.30041396617889404, "acc": 0.888256311416626, "length": 4.0, "mode": "test", "epoch": 25}
{"loss": 0.21960508823394775, "acc": 0.9144237041473389, "length": 3.9986438751220703, "mode": "train", "epoch": 26}
{"loss": 0.28052031993865967, "acc": 0.9003558158874512, "length": 4.0, "mode": "test", "epoch": 26}
{"loss": 0.2131304293870926, "acc": 0.9133358001708984, "length": 3.9990394115448, "mode": "train", "epoch": 27}
{"loss": 0.298794686794281, "acc": 0.8982205390930176, "length": 4.0, "mode": "test", "epoch": 27}
{"loss": 0.21169832348823547, "acc": 0.9120720028877258, "length": 3.9991660118103027, "mode": "train", "epoch": 28}
{"loss": 0.2735222280025482, "acc": 0.9119216799736023, "length": 4.0, "mode": "test", "epoch": 28}
{"loss": 0.2102331966161728, "acc": 0.9202591776847839, "length": 3.9998722076416016, "mode": "train", "epoch": 29}
{"loss": 0.25976499915122986, "acc": 0.9169039726257324, "length": 4.0, "mode": "test", "epoch": 29}
{"loss": 0.20612254738807678, "acc": 0.9241778254508972, "length": 3.999295473098755, "mode": "train", "epoch": 30}
{"loss": 0.27542993426322937, "acc": 0.9122776985168457, "length": 4.0, "mode": "test", "epoch": 30}
{"loss": 0.19371120631694794, "acc": 0.9267518520355225, "length": 3.9996001720428467, "mode": "train", "epoch": 31}
{"loss": 0.2686063051223755, "acc": 0.9186833500862122, "length": 4.0, "mode": "test", "epoch": 31}
{"loss": 0.19343118369579315, "acc": 0.9279858469963074, "length": 3.998666763305664, "mode": "train", "epoch": 32}
{"loss": 0.2631155848503113, "acc": 0.9254447817802429, "length": 4.0, "mode": "test", "epoch": 32}
{"loss": 0.18613354861736298, "acc": 0.9282317757606506, "length": 3.999406099319458, "mode": "train", "epoch": 33}
{"loss": 0.2635068893432617, "acc": 0.924021303653717, "length": 4.0, "mode": "test", "epoch": 33}
{"loss": 0.18344317376613617, "acc": 0.9331567287445068, "length": 3.998534679412842, "mode": "train", "epoch": 34}
{"loss": 0.2554796040058136, "acc": 0.9254449009895325, "length": 4.0, "mode": "test", "epoch": 34}
{"loss": 0.17661723494529724, "acc": 0.9371811747550964, "length": 3.9997329711914062, "mode": "train", "epoch": 35}
{"loss": 0.26132985949516296, "acc": 0.9307828545570374, "length": 4.0, "mode": "test", "epoch": 35}
{"loss": 0.1733996570110321, "acc": 0.9394397139549255, "length": 3.999699115753174, "mode": "train", "epoch": 36}
{"loss": 0.26043811440467834, "acc": 0.9282918572425842, "length": 4.0, "mode": "test", "epoch": 36}
{"loss": 0.1706356257200241, "acc": 0.9394340515136719, "length": 3.998568534851074, "mode": "train", "epoch": 37}
{"loss": 0.2602022588253021, "acc": 0.9293593168258667, "length": 4.0, "mode": "test", "epoch": 37}
{"loss": 0.16764019429683685, "acc": 0.9379593133926392, "length": 3.9999067783355713, "mode": "train", "epoch": 38}
{"loss": 0.2512529492378235, "acc": 0.93291836977005, "length": 4.0, "mode": "test", "epoch": 38}
{"loss": 0.1719081699848175, "acc": 0.9401006698608398, "length": 3.999798536300659, "mode": "train", "epoch": 39}
{"loss": 0.2536894679069519, "acc": 0.9279359579086304, "length": 4.0, "mode": "test", "epoch": 39}
{"loss": 0.1657373607158661, "acc": 0.9398218989372253, "length": 3.997457981109619, "mode": "train", "epoch": 40}
{"loss": 0.25271540880203247, "acc": 0.9366548657417297, "length": 4.0, "mode": "test", "epoch": 40}
{"loss": 0.16614365577697754, "acc": 0.9392226338386536, "length": 3.9991750717163086, "mode": "train", "epoch": 41}
{"loss": 0.246608167886734, "acc": 0.9345197081565857, "length": 4.0, "mode": "test", "epoch": 41}
{"loss": 0.15714335441589355, "acc": 0.943814218044281, "length": 3.9980380535125732, "mode": "train", "epoch": 42}
{"loss": 0.24886295199394226, "acc": 0.9375444054603577, "length": 4.0, "mode": "test", "epoch": 42}
{"loss": 0.15609459578990936, "acc": 0.9437351822853088, "length": 3.9997384548187256, "mode": "train", "epoch": 43}
{"loss": 0.25275471806526184, "acc": 0.9377224445343018, "length": 4.0, "mode": "test", "epoch": 43}
{"loss": 0.15860769152641296, "acc": 0.9422031044960022, "length": 3.997506618499756, "mode": "train", "epoch": 44}
{"loss": 0.24797993898391724, "acc": 0.9371885061264038, "length": 4.0, "mode": "test", "epoch": 44}
{"loss": 0.15181639790534973, "acc": 0.9459369778633118, "length": 3.999626398086548, "mode": "train", "epoch": 45}
{"loss": 0.25332531332969666, "acc": 0.9366547465324402, "length": 4.0, "mode": "test", "epoch": 45}
{"loss": 0.14998751878738403, "acc": 0.9456247091293335, "length": 3.9991846084594727, "mode": "train", "epoch": 46}
{"loss": 0.2385079562664032, "acc": 0.9379003047943115, "length": 4.0, "mode": "test", "epoch": 46}
{"loss": 0.14785106480121613, "acc": 0.9475942850112915, "length": 3.9984710216522217, "mode": "train", "epoch": 47}
{"loss": 0.2549067735671997, "acc": 0.9403913617134094, "length": 4.0, "mode": "test", "epoch": 47}
{"loss": 0.14596323668956757, "acc": 0.948090672492981, "length": 3.999934196472168, "mode": "train", "epoch": 48}
{"loss": 0.24595871567726135, "acc": 0.9411032199859619, "length": 4.0, "mode": "test", "epoch": 48}
{"loss": 0.14564405381679535, "acc": 0.9465180039405823, "length": 3.999361038208008, "mode": "train", "epoch": 49}
{"loss": 0.2545270323753357, "acc": 0.9391459822654724, "length": 4.0, "mode": "test", "epoch": 49}
{"loss": 0.13975422084331512, "acc": 0.9532113075256348, "length": 3.999744176864624, "mode": "train", "epoch": 50}
{"loss": 0.2422742247581482, "acc": 0.9430605173110962, "length": 4.0, "mode": "test", "epoch": 50}
{"loss": 0.13514891266822815, "acc": 0.9514816403388977, "length": 3.999655246734619, "mode": "train", "epoch": 51}
{"loss": 0.23669540882110596, "acc": 0.9366547465324402, "length": 4.0, "mode": "test", "epoch": 51}
{"loss": 0.13588805496692657, "acc": 0.9512500166893005, "length": 3.9999423027038574, "mode": "train", "epoch": 52}
{"loss": 0.2640688121318817, "acc": 0.9339858889579773, "length": 4.0, "mode": "test", "epoch": 52}
{"loss": 0.13741403818130493, "acc": 0.9510713219642639, "length": 3.999971866607666, "mode": "train", "epoch": 53}
{"loss": 0.25951087474823, "acc": 0.9380782246589661, "length": 4.0, "mode": "test", "epoch": 53}
{"loss": 0.1334589123725891, "acc": 0.9533296227455139, "length": 3.997533082962036, "mode": "train", "epoch": 54}
{"loss": 0.25781840085983276, "acc": 0.937010645866394, "length": 4.0, "mode": "test", "epoch": 54}
{"loss": 0.13058853149414062, "acc": 0.9513100981712341, "length": 3.999969244003296, "mode": "train", "epoch": 55}
{"loss": 0.2773192226886749, "acc": 0.9355872869491577, "length": 4.0, "mode": "test", "epoch": 55}
{"loss": 0.1340150535106659, "acc": 0.9511913657188416, "length": 3.9999818801879883, "mode": "train", "epoch": 56}
{"loss": 0.24914972484111786, "acc": 0.939323902130127, "length": 4.0, "mode": "test", "epoch": 56}
{"loss": 0.1387936919927597, "acc": 0.9498627185821533, "length": 3.999274969100952, "mode": "train", "epoch": 57}
{"loss": 0.2549678385257721, "acc": 0.941459059715271, "length": 4.0, "mode": "test", "epoch": 57}
{"loss": 0.13285879790782928, "acc": 0.9493424892425537, "length": 3.999906063079834, "mode": "train", "epoch": 58}
{"loss": 0.23794692754745483, "acc": 0.9384341835975647, "length": 4.0, "mode": "test", "epoch": 58}
{"loss": 0.13679035007953644, "acc": 0.9507145285606384, "length": 3.9999868869781494, "mode": "train", "epoch": 59}
{"loss": 0.25840330123901367, "acc": 0.9377224445343018, "length": 4.0, "mode": "test", "epoch": 59}
{"loss": 0.13261042535305023, "acc": 0.9533368349075317, "length": 3.999988317489624, "mode": "train", "epoch": 60}
{"loss": 0.20375578105449677, "acc": 0.939323902130127, "length": 4.0, "mode": "test", "epoch": 60}
test accuracy: 0.842343807220459
