# ["--attributes=3", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=64", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.99", "--temperature=2"]
Creating train_ds and val_ds...

Creating test_ds...
{"loss": 0.6964446306228638, "acc": 0.5180847644805908, "length": 3.5035340785980225, "mode": "train", "epoch": 1}
{"loss": 0.6910157203674316, "acc": 0.5360732078552246, "length": 1.0104166269302368, "mode": "test", "epoch": 1}
{"loss": 0.6870846152305603, "acc": 0.5437325239181519, "length": 3.086737871170044, "mode": "train", "epoch": 2}
{"loss": 0.6608402132987976, "acc": 0.6802951097488403, "length": 2.2395832538604736, "mode": "test", "epoch": 2}
{"loss": 0.6431434154510498, "acc": 0.6705883741378784, "length": 3.064772129058838, "mode": "train", "epoch": 3}
{"loss": 0.5824342370033264, "acc": 0.7474772334098816, "length": 2.9895832538604736, "mode": "test", "epoch": 3}
{"loss": 0.543287456035614, "acc": 0.7518295049667358, "length": 3.209374189376831, "mode": "train", "epoch": 4}
{"loss": 0.5079210996627808, "acc": 0.7771539092063904, "length": 3.2986111640930176, "mode": "test", "epoch": 4}
{"loss": 0.47196486592292786, "acc": 0.7877269983291626, "length": 3.36698055267334, "mode": "train", "epoch": 5}
{"loss": 0.4705895483493805, "acc": 0.7999104857444763, "length": 3.503472328186035, "mode": "test", "epoch": 5}
{"loss": 0.4186829626560211, "acc": 0.8108992576599121, "length": 3.781524419784546, "mode": "train", "epoch": 6}
{"loss": 0.44187527894973755, "acc": 0.792187511920929, "length": 4.0, "mode": "test", "epoch": 6}
{"loss": 0.35087522864341736, "acc": 0.8474019169807434, "length": 3.8652596473693848, "mode": "train", "epoch": 7}
{"loss": 0.44940438866615295, "acc": 0.8109375834465027, "length": 4.0, "mode": "test", "epoch": 7}
{"loss": 0.3261025846004486, "acc": 0.8640398979187012, "length": 3.9398181438446045, "mode": "train", "epoch": 8}
{"loss": 0.45942774415016174, "acc": 0.8001735210418701, "length": 4.0, "mode": "test", "epoch": 8}
{"loss": 0.29998767375946045, "acc": 0.8721038699150085, "length": 3.962824583053589, "mode": "train", "epoch": 9}
{"loss": 0.4386045038700104, "acc": 0.8199653029441833, "length": 4.0, "mode": "test", "epoch": 9}
{"loss": 0.2798985242843628, "acc": 0.8853662014007568, "length": 3.9691388607025146, "mode": "train", "epoch": 10}
{"loss": 0.39518794417381287, "acc": 0.8366320729255676, "length": 4.0, "mode": "test", "epoch": 10}
{"loss": 0.2620769441127777, "acc": 0.8922647833824158, "length": 3.9744155406951904, "mode": "train", "epoch": 11}
{"loss": 0.3757365047931671, "acc": 0.8413195610046387, "length": 4.0, "mode": "test", "epoch": 11}
{"loss": 0.24322307109832764, "acc": 0.9060763120651245, "length": 3.978437662124634, "mode": "train", "epoch": 12}
{"loss": 0.3930937945842743, "acc": 0.8430556654930115, "length": 4.0, "mode": "test", "epoch": 12}
{"loss": 0.23213978111743927, "acc": 0.9089409112930298, "length": 3.982262134552002, "mode": "train", "epoch": 13}
{"loss": 0.36572858691215515, "acc": 0.8557290434837341, "length": 4.0, "mode": "test", "epoch": 13}
{"loss": 0.2225889265537262, "acc": 0.9142963886260986, "length": 3.9844651222229004, "mode": "train", "epoch": 14}
{"loss": 0.3503933846950531, "acc": 0.8597222566604614, "length": 4.0, "mode": "test", "epoch": 14}
{"loss": 0.21647067368030548, "acc": 0.9146358370780945, "length": 3.9861934185028076, "mode": "train", "epoch": 15}
{"loss": 0.33966946601867676, "acc": 0.8487846851348877, "length": 4.0, "mode": "test", "epoch": 15}
{"loss": 0.20631703734397888, "acc": 0.9177205562591553, "length": 3.988762140274048, "mode": "train", "epoch": 16}
{"loss": 0.365723580121994, "acc": 0.8631944060325623, "length": 4.0, "mode": "test", "epoch": 16}
{"loss": 0.19838711619377136, "acc": 0.9240171313285828, "length": 3.9888737201690674, "mode": "train", "epoch": 17}
{"loss": 0.3442341983318329, "acc": 0.8680555820465088, "length": 4.0, "mode": "test", "epoch": 17}
{"loss": 0.19165900349617004, "acc": 0.9254614114761353, "length": 3.9910829067230225, "mode": "train", "epoch": 18}
{"loss": 0.342623770236969, "acc": 0.8607639074325562, "length": 4.0, "mode": "test", "epoch": 18}
{"loss": 0.18883056938648224, "acc": 0.925540566444397, "length": 3.99312162399292, "mode": "train", "epoch": 19}
{"loss": 0.34085318446159363, "acc": 0.8751736879348755, "length": 4.0, "mode": "test", "epoch": 19}
{"loss": 0.1877821385860443, "acc": 0.9258803725242615, "length": 3.993096113204956, "mode": "train", "epoch": 20}
{"loss": 0.3565864562988281, "acc": 0.8635416030883789, "length": 4.0, "mode": "test", "epoch": 20}
{"loss": 0.18395398557186127, "acc": 0.9254094958305359, "length": 3.9940783977508545, "mode": "train", "epoch": 21}
{"loss": 0.31307515501976013, "acc": 0.8755208849906921, "length": 4.0, "mode": "test", "epoch": 21}
{"loss": 0.18480579555034637, "acc": 0.9242262840270996, "length": 3.9949538707733154, "mode": "train", "epoch": 22}
{"loss": 0.31043803691864014, "acc": 0.8805555105209351, "length": 4.0, "mode": "test", "epoch": 22}
{"loss": 0.171647846698761, "acc": 0.9326363205909729, "length": 3.9953553676605225, "mode": "train", "epoch": 23}
{"loss": 0.3052442967891693, "acc": 0.870312511920929, "length": 4.0, "mode": "test", "epoch": 23}
{"loss": 0.16977402567863464, "acc": 0.9356774687767029, "length": 3.9943978786468506, "mode": "train", "epoch": 24}
{"loss": 0.2945416271686554, "acc": 0.8826388120651245, "length": 4.0, "mode": "test", "epoch": 24}
{"loss": 0.16402862966060638, "acc": 0.9399055242538452, "length": 3.9950356483459473, "mode": "train", "epoch": 25}
{"loss": 0.2979945242404938, "acc": 0.8769097924232483, "length": 4.0, "mode": "test", "epoch": 25}
{"loss": 0.14989247918128967, "acc": 0.9445946216583252, "length": 3.996061086654663, "mode": "train", "epoch": 26}
{"loss": 0.3035544753074646, "acc": 0.8885417580604553, "length": 4.0, "mode": "test", "epoch": 26}
{"loss": 0.1469906121492386, "acc": 0.9439350366592407, "length": 3.9969394207000732, "mode": "train", "epoch": 27}
{"loss": 0.26511117815971375, "acc": 0.902256965637207, "length": 4.0, "mode": "test", "epoch": 27}
{"loss": 0.14878061413764954, "acc": 0.944060206413269, "length": 3.9972903728485107, "mode": "train", "epoch": 28}
{"loss": 0.2739112079143524, "acc": 0.8852429986000061, "length": 4.0, "mode": "test", "epoch": 28}
{"loss": 0.1353955864906311, "acc": 0.9523978233337402, "length": 3.9972198009490967, "mode": "train", "epoch": 29}
{"loss": 0.24878709018230438, "acc": 0.8967013955116272, "length": 4.0, "mode": "test", "epoch": 29}
{"loss": 0.13717228174209595, "acc": 0.9466529488563538, "length": 3.9968442916870117, "mode": "train", "epoch": 30}
{"loss": 0.24173603951931, "acc": 0.8960070013999939, "length": 4.0, "mode": "test", "epoch": 30}
{"loss": 0.12342903017997742, "acc": 0.9559981822967529, "length": 3.9972057342529297, "mode": "train", "epoch": 31}
{"loss": 0.25609567761421204, "acc": 0.8887152075767517, "length": 4.0, "mode": "test", "epoch": 31}
{"loss": 0.13188165426254272, "acc": 0.951732873916626, "length": 3.997877597808838, "mode": "train", "epoch": 32}
{"loss": 0.24497845768928528, "acc": 0.8965277075767517, "length": 4.0, "mode": "test", "epoch": 32}
{"loss": 0.13037383556365967, "acc": 0.9531227946281433, "length": 3.9978926181793213, "mode": "train", "epoch": 33}
{"loss": 0.23003654181957245, "acc": 0.917881965637207, "length": 4.0, "mode": "test", "epoch": 33}
{"loss": 0.1154131069779396, "acc": 0.9606571197509766, "length": 3.998039484024048, "mode": "train", "epoch": 34}
{"loss": 0.22095608711242676, "acc": 0.9092013835906982, "length": 4.0, "mode": "test", "epoch": 34}
{"loss": 0.11075837910175323, "acc": 0.9577651023864746, "length": 3.998065233230591, "mode": "train", "epoch": 35}
{"loss": 0.21375985443592072, "acc": 0.9093750715255737, "length": 4.0, "mode": "test", "epoch": 35}
{"loss": 0.10657498985528946, "acc": 0.9624050855636597, "length": 3.9980998039245605, "mode": "train", "epoch": 36}
{"loss": 0.19738700985908508, "acc": 0.9253472089767456, "length": 4.0, "mode": "test", "epoch": 36}
{"loss": 0.10461349785327911, "acc": 0.9635779857635498, "length": 3.998138904571533, "mode": "train", "epoch": 37}
{"loss": 0.19424539804458618, "acc": 0.9359375834465027, "length": 4.0, "mode": "test", "epoch": 37}
{"loss": 0.09727855771780014, "acc": 0.9654947519302368, "length": 3.998598575592041, "mode": "train", "epoch": 38}
{"loss": 0.20776425302028656, "acc": 0.9279513955116272, "length": 4.0, "mode": "test", "epoch": 38}
{"loss": 0.09707971662282944, "acc": 0.9642656445503235, "length": 3.9969253540039062, "mode": "train", "epoch": 39}
{"loss": 0.2198871672153473, "acc": 0.926215410232544, "length": 4.0, "mode": "test", "epoch": 39}
{"loss": 0.09707503020763397, "acc": 0.9637730121612549, "length": 3.9990220069885254, "mode": "train", "epoch": 40}
{"loss": 0.21244755387306213, "acc": 0.9190971851348877, "length": 4.0, "mode": "test", "epoch": 40}
{"loss": 0.09917514771223068, "acc": 0.9663199186325073, "length": 3.999002456665039, "mode": "train", "epoch": 41}
{"loss": 0.20795901119709015, "acc": 0.9331597089767456, "length": 4.0, "mode": "test", "epoch": 41}
{"loss": 0.08856550604104996, "acc": 0.9691639542579651, "length": 3.9989795684814453, "mode": "train", "epoch": 42}
{"loss": 0.18867774307727814, "acc": 0.9272570013999939, "length": 4.0, "mode": "test", "epoch": 42}
{"loss": 0.08418572694063187, "acc": 0.9720693230628967, "length": 3.999185085296631, "mode": "train", "epoch": 43}
{"loss": 0.16787831485271454, "acc": 0.9375, "length": 4.0, "mode": "test", "epoch": 43}
{"loss": 0.08302139490842819, "acc": 0.9724799394607544, "length": 3.9992077350616455, "mode": "train", "epoch": 44}
{"loss": 0.16257283091545105, "acc": 0.9362847208976746, "length": 4.0, "mode": "test", "epoch": 44}
{"loss": 0.08168695122003555, "acc": 0.9711896777153015, "length": 3.998887300491333, "mode": "train", "epoch": 45}
{"loss": 0.14789773523807526, "acc": 0.9458333253860474, "length": 4.0, "mode": "test", "epoch": 45}
{"loss": 0.07803583145141602, "acc": 0.9693933725357056, "length": 3.9978222846984863, "mode": "train", "epoch": 46}
{"loss": 0.16791556775569916, "acc": 0.9326388835906982, "length": 4.0, "mode": "test", "epoch": 46}
{"loss": 0.07564695924520493, "acc": 0.9757298827171326, "length": 3.999389410018921, "mode": "train", "epoch": 47}
{"loss": 0.14946289360523224, "acc": 0.9493052959442139, "length": 4.0, "mode": "test", "epoch": 47}
{"loss": 0.07107845693826675, "acc": 0.9746851921081543, "length": 3.999293088912964, "mode": "train", "epoch": 48}
{"loss": 0.13841108977794647, "acc": 0.9527777433395386, "length": 4.0, "mode": "test", "epoch": 48}
{"loss": 0.07041166722774506, "acc": 0.9771105647087097, "length": 3.9990971088409424, "mode": "train", "epoch": 49}
{"loss": 0.15676230192184448, "acc": 0.9380208253860474, "length": 4.0, "mode": "test", "epoch": 49}
{"loss": 0.0720297321677208, "acc": 0.9756142497062683, "length": 3.9993896484375, "mode": "train", "epoch": 50}
{"loss": 0.1236698180437088, "acc": 0.956944465637207, "length": 4.0, "mode": "test", "epoch": 50}
{"loss": 0.07245712727308273, "acc": 0.9734726548194885, "length": 3.9994957447052, "mode": "train", "epoch": 51}
{"loss": 0.14060191810131073, "acc": 0.9517361521720886, "length": 4.0, "mode": "test", "epoch": 51}
{"loss": 0.06551935523748398, "acc": 0.9760870337486267, "length": 3.9995474815368652, "mode": "train", "epoch": 52}
{"loss": 0.14864812791347504, "acc": 0.9486110210418701, "length": 4.0, "mode": "test", "epoch": 52}
{"loss": 0.065123051404953, "acc": 0.9774219393730164, "length": 3.999624252319336, "mode": "train", "epoch": 53}
{"loss": 0.13459400832653046, "acc": 0.9519097208976746, "length": 4.0, "mode": "test", "epoch": 53}
{"loss": 0.05986110121011734, "acc": 0.9772505760192871, "length": 3.999617099761963, "mode": "train", "epoch": 54}
{"loss": 0.13116715848445892, "acc": 0.9531248807907104, "length": 4.0, "mode": "test", "epoch": 54}
{"loss": 0.06628185510635376, "acc": 0.9756214022636414, "length": 3.9994404315948486, "mode": "train", "epoch": 55}
{"loss": 0.11767369508743286, "acc": 0.9520832896232605, "length": 4.0, "mode": "test", "epoch": 55}
{"loss": 0.05664447322487831, "acc": 0.9811873435974121, "length": 3.9994399547576904, "mode": "train", "epoch": 56}
{"loss": 0.11881246417760849, "acc": 0.9489583969116211, "length": 4.0, "mode": "test", "epoch": 56}
{"loss": 0.05082035809755325, "acc": 0.9848517179489136, "length": 3.999769687652588, "mode": "train", "epoch": 57}
{"loss": 0.09669796377420425, "acc": 0.9635416865348816, "length": 4.0, "mode": "test", "epoch": 57}
{"loss": 0.05157482251524925, "acc": 0.9830489158630371, "length": 3.9996423721313477, "mode": "train", "epoch": 58}
{"loss": 0.10209079086780548, "acc": 0.9607638120651245, "length": 4.0, "mode": "test", "epoch": 58}
{"loss": 0.04879811033606529, "acc": 0.9834495782852173, "length": 3.9995784759521484, "mode": "train", "epoch": 59}
{"loss": 0.09471488744020462, "acc": 0.9644098281860352, "length": 4.0, "mode": "test", "epoch": 59}
{"loss": 0.04724220559000969, "acc": 0.9850216507911682, "length": 3.9996447563171387, "mode": "train", "epoch": 60}
{"loss": 0.1013401672244072, "acc": 0.9609375, "length": 4.0, "mode": "test", "epoch": 60}
test accuracy: 0.8687931299209595
