# ["--attributes=5", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=128", "--learning_rate=0.0005", "--hidden_size=256", "--temp_update=0.99", "--temperature=2"]
Creating train_ds and val_ds...

Creating test_ds...
{"loss": 0.7007467746734619, "acc": 0.5123559832572937, "length": 3.4848344326019287, "mode": "train", "epoch": 1}
{"loss": 0.6940587759017944, "acc": 0.5020477771759033, "length": 1.0, "mode": "test", "epoch": 1}
{"loss": 0.6940233111381531, "acc": 0.5124152898788452, "length": 3.275646924972534, "mode": "train", "epoch": 2}
{"loss": 0.6947264075279236, "acc": 0.490443617105484, "length": 1.0, "mode": "test", "epoch": 2}
{"loss": 0.6878921985626221, "acc": 0.5373183488845825, "length": 2.8022549152374268, "mode": "train", "epoch": 3}
{"loss": 0.6942909955978394, "acc": 0.5110974907875061, "length": 1.040955662727356, "mode": "test", "epoch": 3}
{"loss": 0.6729205846786499, "acc": 0.5955519080162048, "length": 2.4725165367126465, "mode": "train", "epoch": 4}
{"loss": 0.6546941995620728, "acc": 0.6381222009658813, "length": 1.8600682020187378, "mode": "test", "epoch": 4}
{"loss": 0.6388667821884155, "acc": 0.6849223375320435, "length": 2.6550655364990234, "mode": "train", "epoch": 5}
{"loss": 0.5968205332756042, "acc": 0.7286931872367859, "length": 2.6996586322784424, "mode": "test", "epoch": 5}
{"loss": 0.5835241079330444, "acc": 0.7204794883728027, "length": 2.8758151531219482, "mode": "train", "epoch": 6}
{"loss": 0.5585311651229858, "acc": 0.7383483052253723, "length": 3.1706485748291016, "mode": "test", "epoch": 6}
{"loss": 0.5331766605377197, "acc": 0.7412276864051819, "length": 2.903773069381714, "mode": "train", "epoch": 7}
{"loss": 0.5254504084587097, "acc": 0.7574557065963745, "length": 3.0068259239196777, "mode": "test", "epoch": 7}
{"loss": 0.4926301836967468, "acc": 0.7767027020454407, "length": 2.8155901432037354, "mode": "train", "epoch": 8}
{"loss": 0.5021188259124756, "acc": 0.770695149898529, "length": 2.9897611141204834, "mode": "test", "epoch": 8}
{"loss": 0.4720436632633209, "acc": 0.781528890132904, "length": 2.741499423980713, "mode": "train", "epoch": 9}
{"loss": 0.4861446022987366, "acc": 0.8104844093322754, "length": 3.047781467437744, "mode": "test", "epoch": 9}
{"loss": 0.45554599165916443, "acc": 0.7934251427650452, "length": 2.795266628265381, "mode": "train", "epoch": 10}
{"loss": 0.4658045172691345, "acc": 0.8122973442077637, "length": 2.9556314945220947, "mode": "test", "epoch": 10}
{"loss": 0.44298845529556274, "acc": 0.8058549165725708, "length": 2.7498395442962646, "mode": "train", "epoch": 11}
{"loss": 0.4529188871383667, "acc": 0.8103849291801453, "length": 2.94197940826416, "mode": "test", "epoch": 11}
{"loss": 0.42817339301109314, "acc": 0.8139054179191589, "length": 2.799098253250122, "mode": "train", "epoch": 12}
{"loss": 0.44627225399017334, "acc": 0.813601553440094, "length": 2.9317405223846436, "mode": "test", "epoch": 12}
{"loss": 0.4216281473636627, "acc": 0.8116203546524048, "length": 2.6964774131774902, "mode": "train", "epoch": 13}
{"loss": 0.43697452545166016, "acc": 0.8200622200965881, "length": 2.873720169067383, "mode": "test", "epoch": 13}
{"loss": 0.4104105234146118, "acc": 0.81846684217453, "length": 2.664590358734131, "mode": "train", "epoch": 14}
{"loss": 0.444985032081604, "acc": 0.8214385509490967, "length": 2.921501636505127, "mode": "test", "epoch": 14}
{"loss": 0.403758704662323, "acc": 0.8180075287818909, "length": 2.680248260498047, "mode": "train", "epoch": 15}
{"loss": 0.42496007680892944, "acc": 0.8204768300056458, "length": 2.8020477294921875, "mode": "test", "epoch": 15}
{"loss": 0.39421918988227844, "acc": 0.8225130438804626, "length": 2.683666229248047, "mode": "train", "epoch": 16}
{"loss": 0.4201532006263733, "acc": 0.8218900561332703, "length": 2.8293514251708984, "mode": "test", "epoch": 16}
{"loss": 0.3870163857936859, "acc": 0.825141191482544, "length": 2.6929397583007812, "mode": "train", "epoch": 17}
{"loss": 0.43364620208740234, "acc": 0.8275133967399597, "length": 2.8225255012512207, "mode": "test", "epoch": 17}
{"loss": 0.3778049647808075, "acc": 0.8302962779998779, "length": 2.705559492111206, "mode": "train", "epoch": 18}
{"loss": 0.4242396950721741, "acc": 0.8274098634719849, "length": 2.8327643871307373, "mode": "test", "epoch": 18}
{"loss": 0.3648151159286499, "acc": 0.8357394933700562, "length": 2.882614850997925, "mode": "train", "epoch": 19}
{"loss": 0.40680211782455444, "acc": 0.8325676321983337, "length": 2.9078497886657715, "mode": "test", "epoch": 19}
{"loss": 0.3440547287464142, "acc": 0.8489345908164978, "length": 3.0013813972473145, "mode": "train", "epoch": 20}
{"loss": 0.3848246932029724, "acc": 0.8492095470428467, "length": 3.23549485206604, "mode": "test", "epoch": 20}
{"loss": 0.31784147024154663, "acc": 0.8615089058876038, "length": 3.2455008029937744, "mode": "train", "epoch": 21}
{"loss": 0.3646319806575775, "acc": 0.8637287020683289, "length": 3.3276450634002686, "mode": "test", "epoch": 21}
{"loss": 0.3006858229637146, "acc": 0.8681232929229736, "length": 3.304530143737793, "mode": "train", "epoch": 22}
{"loss": 0.3507562577724457, "acc": 0.8709737658500671, "length": 3.498293399810791, "mode": "test", "epoch": 22}
{"loss": 0.2909599244594574, "acc": 0.8809641599655151, "length": 3.3704564571380615, "mode": "train", "epoch": 23}
{"loss": 0.35418033599853516, "acc": 0.8736048936843872, "length": 3.368600606918335, "mode": "test", "epoch": 23}
{"loss": 0.2745591104030609, "acc": 0.8814361691474915, "length": 3.398378849029541, "mode": "train", "epoch": 24}
{"loss": 0.3306220471858978, "acc": 0.8760771751403809, "length": 3.5153584480285645, "mode": "test", "epoch": 24}
{"loss": 0.2697390913963318, "acc": 0.8844538331031799, "length": 3.4250195026397705, "mode": "train", "epoch": 25}
{"loss": 0.3339938819408417, "acc": 0.879983127117157, "length": 3.4641637802124023, "mode": "test", "epoch": 25}
{"loss": 0.2619422674179077, "acc": 0.893278956413269, "length": 3.4065589904785156, "mode": "train", "epoch": 26}
{"loss": 0.33590054512023926, "acc": 0.8809024691581726, "length": 3.5358362197875977, "mode": "test", "epoch": 26}
{"loss": 0.25209254026412964, "acc": 0.8933390974998474, "length": 3.4463815689086914, "mode": "train", "epoch": 27}
{"loss": 0.3090845048427582, "acc": 0.8822885155677795, "length": 3.600682497024536, "mode": "test", "epoch": 27}
{"loss": 0.24335642158985138, "acc": 0.8980722427368164, "length": 3.5166714191436768, "mode": "train", "epoch": 28}
{"loss": 0.3069024682044983, "acc": 0.8856363892555237, "length": 3.52901029586792, "mode": "test", "epoch": 28}
{"loss": 0.24086643755435944, "acc": 0.8964552879333496, "length": 3.5171782970428467, "mode": "train", "epoch": 29}
{"loss": 0.29844677448272705, "acc": 0.891312837600708, "length": 3.604095458984375, "mode": "test", "epoch": 29}
{"loss": 0.2250380665063858, "acc": 0.9045591354370117, "length": 3.5206828117370605, "mode": "train", "epoch": 30}
{"loss": 0.27731263637542725, "acc": 0.8946311473846436, "length": 3.5870306491851807, "mode": "test", "epoch": 30}
{"loss": 0.21407923102378845, "acc": 0.9107632637023926, "length": 3.564943552017212, "mode": "train", "epoch": 31}
{"loss": 0.26827943325042725, "acc": 0.9028353691101074, "length": 3.6416382789611816, "mode": "test", "epoch": 31}
{"loss": 0.2076491266489029, "acc": 0.9121825695037842, "length": 3.5479118824005127, "mode": "train", "epoch": 32}
{"loss": 0.2686137557029724, "acc": 0.902929961681366, "length": 3.583617687225342, "mode": "test", "epoch": 32}
{"loss": 0.1929231733083725, "acc": 0.9224864840507507, "length": 3.55784273147583, "mode": "train", "epoch": 33}
{"loss": 0.2636960446834564, "acc": 0.9068553447723389, "length": 3.6689419746398926, "mode": "test", "epoch": 33}
{"loss": 0.1901913732290268, "acc": 0.920258641242981, "length": 3.597933769226074, "mode": "train", "epoch": 34}
{"loss": 0.24439933896064758, "acc": 0.9140895009040833, "length": 3.604095458984375, "mode": "test", "epoch": 34}
{"loss": 0.18204811215400696, "acc": 0.9236042499542236, "length": 3.6138875484466553, "mode": "train", "epoch": 35}
{"loss": 0.256287157535553, "acc": 0.9099884629249573, "length": 3.7167234420776367, "mode": "test", "epoch": 35}
{"loss": 0.17043668031692505, "acc": 0.9332047700881958, "length": 3.574742555618286, "mode": "train", "epoch": 36}
{"loss": 0.24510160088539124, "acc": 0.9155985116958618, "length": 3.70648455619812, "mode": "test", "epoch": 36}
{"loss": 0.16153621673583984, "acc": 0.9369804263114929, "length": 3.6466212272644043, "mode": "train", "epoch": 37}
{"loss": 0.22988778352737427, "acc": 0.9193076491355896, "length": 3.6757678985595703, "mode": "test", "epoch": 37}
{"loss": 0.148114413022995, "acc": 0.9427533149719238, "length": 3.637768268585205, "mode": "train", "epoch": 38}
{"loss": 0.22557389736175537, "acc": 0.9263049364089966, "length": 3.662116050720215, "mode": "test", "epoch": 38}
{"loss": 0.1477183699607849, "acc": 0.9409132599830627, "length": 3.6093368530273438, "mode": "train", "epoch": 39}
{"loss": 0.2202776074409485, "acc": 0.9291207790374756, "length": 3.6757678985595703, "mode": "test", "epoch": 39}
{"loss": 0.14059747755527496, "acc": 0.9473220109939575, "length": 3.6220898628234863, "mode": "train", "epoch": 40}
{"loss": 0.22293272614479065, "acc": 0.9296690821647644, "length": 3.713310480117798, "mode": "test", "epoch": 40}
{"loss": 0.13479100167751312, "acc": 0.9501148462295532, "length": 3.679094076156616, "mode": "train", "epoch": 41}
{"loss": 0.2108549177646637, "acc": 0.934998095035553, "length": 3.6245734691619873, "mode": "test", "epoch": 41}
{"loss": 0.12807166576385498, "acc": 0.952033519744873, "length": 3.631516456604004, "mode": "train", "epoch": 42}
{"loss": 0.21299028396606445, "acc": 0.9317657351493835, "length": 3.7508533000946045, "mode": "test", "epoch": 42}
{"loss": 0.11807529628276825, "acc": 0.955810546875, "length": 3.662883996963501, "mode": "train", "epoch": 43}
{"loss": 0.21273115277290344, "acc": 0.9343637824058533, "length": 3.6757678985595703, "mode": "test", "epoch": 43}
{"loss": 0.11498576402664185, "acc": 0.9570693373680115, "length": 3.677729368209839, "mode": "train", "epoch": 44}
{"loss": 0.2056746482849121, "acc": 0.931010901927948, "length": 3.73378849029541, "mode": "test", "epoch": 44}
{"loss": 0.11136148869991302, "acc": 0.9604339599609375, "length": 3.6953139305114746, "mode": "train", "epoch": 45}
{"loss": 0.18512555956840515, "acc": 0.9400216937065125, "length": 3.713310480117798, "mode": "test", "epoch": 45}
{"loss": 0.10830889642238617, "acc": 0.9606276750564575, "length": 3.671879529953003, "mode": "train", "epoch": 46}
{"loss": 0.19029203057289124, "acc": 0.9379775524139404, "length": 3.6962456703186035, "mode": "test", "epoch": 46}
{"loss": 0.10425320267677307, "acc": 0.9623209238052368, "length": 3.6788601875305176, "mode": "train", "epoch": 47}
{"loss": 0.1890128254890442, "acc": 0.936967670917511, "length": 3.6962456703186035, "mode": "test", "epoch": 47}
{"loss": 0.10538846999406815, "acc": 0.9588744044303894, "length": 3.6534006595611572, "mode": "train", "epoch": 48}
{"loss": 0.19724127650260925, "acc": 0.9465259909629822, "length": 3.7030715942382812, "mode": "test", "epoch": 48}
{"loss": 0.09818614274263382, "acc": 0.9641337394714355, "length": 3.7092437744140625, "mode": "train", "epoch": 49}
{"loss": 0.17595767974853516, "acc": 0.952518105506897, "length": 3.709897518157959, "mode": "test", "epoch": 49}
{"loss": 0.08997473865747452, "acc": 0.9672335982322693, "length": 3.6989612579345703, "mode": "train", "epoch": 50}
{"loss": 0.1945461630821228, "acc": 0.9513078927993774, "length": 3.737201452255249, "mode": "test", "epoch": 50}
{"loss": 0.08628903329372406, "acc": 0.968036949634552, "length": 3.7128758430480957, "mode": "train", "epoch": 51}
{"loss": 0.18215584754943848, "acc": 0.9528578519821167, "length": 3.7235496044158936, "mode": "test", "epoch": 51}
{"loss": 0.09203560650348663, "acc": 0.9652253985404968, "length": 3.7073357105255127, "mode": "train", "epoch": 52}
{"loss": 0.17574560642242432, "acc": 0.9509914517402649, "length": 3.686006784439087, "mode": "test", "epoch": 52}
{"loss": 0.08597525954246521, "acc": 0.9685612320899963, "length": 3.6718087196350098, "mode": "train", "epoch": 53}
{"loss": 0.17732441425323486, "acc": 0.949988067150116, "length": 3.709897518157959, "mode": "test", "epoch": 53}
{"loss": 0.08699650317430496, "acc": 0.966016411781311, "length": 3.6844873428344727, "mode": "train", "epoch": 54}
{"loss": 0.17562775313854218, "acc": 0.9500181674957275, "length": 3.7269625663757324, "mode": "test", "epoch": 54}
{"loss": 0.08093614876270294, "acc": 0.9708164930343628, "length": 3.681209087371826, "mode": "train", "epoch": 55}
{"loss": 0.18317058682441711, "acc": 0.9494760036468506, "length": 3.7167234420776367, "mode": "test", "epoch": 55}
{"loss": 0.08266828209161758, "acc": 0.9704710841178894, "length": 3.705267906188965, "mode": "train", "epoch": 56}
{"loss": 0.1742033213376999, "acc": 0.9514950513839722, "length": 3.740614414215088, "mode": "test", "epoch": 56}
{"loss": 0.082852803170681, "acc": 0.97055983543396, "length": 3.6989119052886963, "mode": "train", "epoch": 57}
{"loss": 0.18844899535179138, "acc": 0.9508125185966492, "length": 3.679180860519409, "mode": "test", "epoch": 57}
{"loss": 0.0772603452205658, "acc": 0.9721757769584656, "length": 3.641887664794922, "mode": "train", "epoch": 58}
{"loss": 0.1702900379896164, "acc": 0.9458932876586914, "length": 3.7167234420776367, "mode": "test", "epoch": 58}
{"loss": 0.07667537033557892, "acc": 0.9729887843132019, "length": 3.6862952709198, "mode": "train", "epoch": 59}
{"loss": 0.16633178293704987, "acc": 0.961762011051178, "length": 3.7269625663757324, "mode": "test", "epoch": 59}
{"loss": 0.07390138506889343, "acc": 0.9732488393783569, "length": 3.7194557189941406, "mode": "train", "epoch": 60}
{"loss": 0.18993715941905975, "acc": 0.9562945365905762, "length": 3.7474403381347656, "mode": "test", "epoch": 60}
test accuracy: 0.8422670960426331
