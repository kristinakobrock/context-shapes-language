# ["--attributes=5", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=128", "--learning_rate=0.001", "--hidden_size=256", "--temp_update=0.99", "--temperature=1"]
Creating train_ds and val_ds...

Creating test_ds...
{"loss": 0.7083458304405212, "acc": 0.5140740275382996, "length": 3.1928045749664307, "mode": "train", "epoch": 1}
{"loss": 0.7014473676681519, "acc": 0.4973497688770294, "length": 1.0, "mode": "test", "epoch": 1}
{"loss": 0.69270259141922, "acc": 0.5275812745094299, "length": 1.7160505056381226, "mode": "train", "epoch": 2}
{"loss": 0.6669960021972656, "acc": 0.587516188621521, "length": 1.5441696643829346, "mode": "test", "epoch": 2}
{"loss": 0.649645984172821, "acc": 0.6384481191635132, "length": 2.1942663192749023, "mode": "train", "epoch": 3}
{"loss": 0.6094903945922852, "acc": 0.6938654184341431, "length": 2.34628963470459, "mode": "test", "epoch": 3}
{"loss": 0.5956259965896606, "acc": 0.7099013328552246, "length": 2.3635473251342773, "mode": "train", "epoch": 4}
{"loss": 0.5890908241271973, "acc": 0.7113272547721863, "length": 2.388692617416382, "mode": "test", "epoch": 4}
{"loss": 0.5793041586875916, "acc": 0.7092946171760559, "length": 2.353504180908203, "mode": "train", "epoch": 5}
{"loss": 0.5844951868057251, "acc": 0.716120719909668, "length": 2.2932863235473633, "mode": "test", "epoch": 5}
{"loss": 0.5745123624801636, "acc": 0.7121871709823608, "length": 2.285994529724121, "mode": "train", "epoch": 6}
{"loss": 0.5729824900627136, "acc": 0.7048479318618774, "length": 2.494699716567993, "mode": "test", "epoch": 6}
{"loss": 0.5684155225753784, "acc": 0.7102246880531311, "length": 2.2488980293273926, "mode": "train", "epoch": 7}
{"loss": 0.5669446587562561, "acc": 0.696174144744873, "length": 2.4416961669921875, "mode": "test", "epoch": 7}
{"loss": 0.560279369354248, "acc": 0.7132405042648315, "length": 2.422598123550415, "mode": "train", "epoch": 8}
{"loss": 0.554041862487793, "acc": 0.7407946586608887, "length": 2.4416961669921875, "mode": "test", "epoch": 8}
{"loss": 0.5423370599746704, "acc": 0.7293723225593567, "length": 2.482020378112793, "mode": "train", "epoch": 9}
{"loss": 0.5306452512741089, "acc": 0.7470176815986633, "length": 2.7915194034576416, "mode": "test", "epoch": 9}
{"loss": 0.5019643306732178, "acc": 0.7611083984375, "length": 2.821648120880127, "mode": "train", "epoch": 10}
{"loss": 0.4803736209869385, "acc": 0.7887285351753235, "length": 3.1519434452056885, "mode": "test", "epoch": 10}
{"loss": 0.4543190896511078, "acc": 0.7951949834823608, "length": 3.0603935718536377, "mode": "train", "epoch": 11}
{"loss": 0.43281424045562744, "acc": 0.7891536355018616, "length": 3.2579505443573, "mode": "test", "epoch": 11}
{"loss": 0.4191749393939972, "acc": 0.8122418522834778, "length": 3.1554555892944336, "mode": "train", "epoch": 12}
{"loss": 0.4191478192806244, "acc": 0.8099746704101562, "length": 3.2261483669281006, "mode": "test", "epoch": 12}
{"loss": 0.3942737877368927, "acc": 0.8302268385887146, "length": 3.1592984199523926, "mode": "train", "epoch": 13}
{"loss": 0.40573355555534363, "acc": 0.8323349356651306, "length": 3.2791519165039062, "mode": "test", "epoch": 13}
{"loss": 0.3785967528820038, "acc": 0.8351109027862549, "length": 3.1879377365112305, "mode": "train", "epoch": 14}
{"loss": 0.38702934980392456, "acc": 0.8377581238746643, "length": 3.2261483669281006, "mode": "test", "epoch": 14}
{"loss": 0.3643704652786255, "acc": 0.8394548892974854, "length": 3.1454341411590576, "mode": "train", "epoch": 15}
{"loss": 0.3786002993583679, "acc": 0.8436207175254822, "length": 3.2367491722106934, "mode": "test", "epoch": 15}
{"loss": 0.3526232838630676, "acc": 0.8480730652809143, "length": 3.1949799060821533, "mode": "train", "epoch": 16}
{"loss": 0.369968980550766, "acc": 0.8447511196136475, "length": 3.247349739074707, "mode": "test", "epoch": 16}
{"loss": 0.3348231017589569, "acc": 0.8569179773330688, "length": 3.1727190017700195, "mode": "train", "epoch": 17}
{"loss": 0.35082101821899414, "acc": 0.8655281662940979, "length": 3.2261483669281006, "mode": "test", "epoch": 17}
{"loss": 0.31799668073654175, "acc": 0.8682267069816589, "length": 3.1480445861816406, "mode": "train", "epoch": 18}
{"loss": 0.3353460729122162, "acc": 0.8676623106002808, "length": 3.204946994781494, "mode": "test", "epoch": 18}
{"loss": 0.3103053569793701, "acc": 0.8657854199409485, "length": 3.160207509994507, "mode": "train", "epoch": 19}
{"loss": 0.3224133253097534, "acc": 0.8731873035430908, "length": 3.2261483669281006, "mode": "test", "epoch": 19}
{"loss": 0.29924362897872925, "acc": 0.8706650137901306, "length": 3.227097749710083, "mode": "train", "epoch": 20}
{"loss": 0.32705724239349365, "acc": 0.8723718523979187, "length": 3.215547800064087, "mode": "test", "epoch": 20}
{"loss": 0.29555749893188477, "acc": 0.8729219436645508, "length": 3.171245574951172, "mode": "train", "epoch": 21}
{"loss": 0.3301255404949188, "acc": 0.875607967376709, "length": 3.2685513496398926, "mode": "test", "epoch": 21}
{"loss": 0.29298844933509827, "acc": 0.8734643459320068, "length": 3.1575303077697754, "mode": "train", "epoch": 22}
{"loss": 0.3166848421096802, "acc": 0.8746685981750488, "length": 3.215547800064087, "mode": "test", "epoch": 22}
{"loss": 0.2926536500453949, "acc": 0.8727843761444092, "length": 3.164863348007202, "mode": "train", "epoch": 23}
{"loss": 0.31695711612701416, "acc": 0.878286600112915, "length": 3.215547800064087, "mode": "test", "epoch": 23}
{"loss": 0.28042665123939514, "acc": 0.8758020997047424, "length": 3.1678168773651123, "mode": "train", "epoch": 24}
{"loss": 0.30921149253845215, "acc": 0.8747570514678955, "length": 3.215547800064087, "mode": "test", "epoch": 24}
{"loss": 0.2788486182689667, "acc": 0.8786886930465698, "length": 3.1881375312805176, "mode": "train", "epoch": 25}
{"loss": 0.3046931326389313, "acc": 0.8824975490570068, "length": 3.2791519165039062, "mode": "test", "epoch": 25}
{"loss": 0.27984708547592163, "acc": 0.8800448179244995, "length": 3.1808319091796875, "mode": "train", "epoch": 26}
{"loss": 0.30900833010673523, "acc": 0.8800845742225647, "length": 3.204946994781494, "mode": "test", "epoch": 26}
{"loss": 0.27734512090682983, "acc": 0.8798544406890869, "length": 3.143768072128296, "mode": "train", "epoch": 27}
{"loss": 0.3045935034751892, "acc": 0.8751960396766663, "length": 3.2261483669281006, "mode": "test", "epoch": 27}
{"loss": 0.2751644551753998, "acc": 0.880130410194397, "length": 3.2286770343780518, "mode": "train", "epoch": 28}
{"loss": 0.2974482774734497, "acc": 0.8774440884590149, "length": 3.2579505443573, "mode": "test", "epoch": 28}
{"loss": 0.2689787745475769, "acc": 0.8814277052879333, "length": 3.2085955142974854, "mode": "train", "epoch": 29}
{"loss": 0.29337453842163086, "acc": 0.8839590549468994, "length": 3.215547800064087, "mode": "test", "epoch": 29}
{"loss": 0.26993119716644287, "acc": 0.8821359872817993, "length": 3.1698553562164307, "mode": "train", "epoch": 30}
{"loss": 0.29538488388061523, "acc": 0.8839457631111145, "length": 3.2261483669281006, "mode": "test", "epoch": 30}
{"loss": 0.2647526264190674, "acc": 0.8838801383972168, "length": 3.2263994216918945, "mode": "train", "epoch": 31}
{"loss": 0.2889863848686218, "acc": 0.8802151679992676, "length": 3.2261483669281006, "mode": "test", "epoch": 31}
{"loss": 0.2625718116760254, "acc": 0.8853832483291626, "length": 3.186997890472412, "mode": "train", "epoch": 32}
{"loss": 0.2883675992488861, "acc": 0.8843151926994324, "length": 3.2367491722106934, "mode": "test", "epoch": 32}
{"loss": 0.25784897804260254, "acc": 0.8861891031265259, "length": 3.265456199645996, "mode": "train", "epoch": 33}
{"loss": 0.28872033953666687, "acc": 0.8844045400619507, "length": 3.2685513496398926, "mode": "test", "epoch": 33}
{"loss": 0.2585693299770355, "acc": 0.884708821773529, "length": 3.232070207595825, "mode": "train", "epoch": 34}
{"loss": 0.2897542417049408, "acc": 0.8799376487731934, "length": 3.2579505443573, "mode": "test", "epoch": 34}
{"loss": 0.2597418427467346, "acc": 0.8857557773590088, "length": 3.2023911476135254, "mode": "train", "epoch": 35}
{"loss": 0.28291162848472595, "acc": 0.8826763033866882, "length": 3.215547800064087, "mode": "test", "epoch": 35}
{"loss": 0.25970301032066345, "acc": 0.8874924778938293, "length": 3.198284864425659, "mode": "train", "epoch": 36}
{"loss": 0.29555508494377136, "acc": 0.8775191307067871, "length": 3.247349739074707, "mode": "test", "epoch": 36}
{"loss": 0.2533115744590759, "acc": 0.8881219029426575, "length": 3.2480955123901367, "mode": "train", "epoch": 37}
{"loss": 0.29466184973716736, "acc": 0.8780518770217896, "length": 3.247349739074707, "mode": "test", "epoch": 37}
{"loss": 0.2490745186805725, "acc": 0.8903070688247681, "length": 3.2357418537139893, "mode": "train", "epoch": 38}
{"loss": 0.2928881347179413, "acc": 0.8774685859680176, "length": 3.406360387802124, "mode": "test", "epoch": 38}
{"loss": 0.25052013993263245, "acc": 0.8906611800193787, "length": 3.3194379806518555, "mode": "train", "epoch": 39}
{"loss": 0.2857944071292877, "acc": 0.8860186338424683, "length": 3.2932863235473633, "mode": "test", "epoch": 39}
{"loss": 0.24570806324481964, "acc": 0.8955912590026855, "length": 3.2167129516601562, "mode": "train", "epoch": 40}
{"loss": 0.28279298543930054, "acc": 0.889457106590271, "length": 3.2968196868896484, "mode": "test", "epoch": 40}
{"loss": 0.24642400443553925, "acc": 0.8948432207107544, "length": 3.2658371925354004, "mode": "train", "epoch": 41}
{"loss": 0.27519410848617554, "acc": 0.8906068801879883, "length": 3.307420492172241, "mode": "test", "epoch": 41}
{"loss": 0.24424242973327637, "acc": 0.8929492235183716, "length": 3.2838058471679688, "mode": "train", "epoch": 42}
{"loss": 0.2921198606491089, "acc": 0.8870245218276978, "length": 3.307420492172241, "mode": "test", "epoch": 42}
{"loss": 0.23614540696144104, "acc": 0.8983821868896484, "length": 3.2585203647613525, "mode": "train", "epoch": 43}
{"loss": 0.2862277626991272, "acc": 0.8946260809898376, "length": 3.261484146118164, "mode": "test", "epoch": 43}
{"loss": 0.23583057522773743, "acc": 0.8994077444076538, "length": 3.2502012252807617, "mode": "train", "epoch": 44}
{"loss": 0.28462058305740356, "acc": 0.8864631056785583, "length": 3.3286218643188477, "mode": "test", "epoch": 44}
{"loss": 0.23182794451713562, "acc": 0.9012306928634644, "length": 3.30553936958313, "mode": "train", "epoch": 45}
{"loss": 0.27413463592529297, "acc": 0.902274489402771, "length": 3.3710248470306396, "mode": "test", "epoch": 45}
{"loss": 0.23462332785129547, "acc": 0.9028148651123047, "length": 3.278998613357544, "mode": "train", "epoch": 46}
{"loss": 0.2688133716583252, "acc": 0.8959797024726868, "length": 3.2367491722106934, "mode": "test", "epoch": 46}
{"loss": 0.2340678870677948, "acc": 0.9017329216003418, "length": 3.2492873668670654, "mode": "train", "epoch": 47}
{"loss": 0.29238495230674744, "acc": 0.8962408304214478, "length": 3.3992931842803955, "mode": "test", "epoch": 47}
{"loss": 0.23332960903644562, "acc": 0.9019618034362793, "length": 3.347231388092041, "mode": "train", "epoch": 48}
{"loss": 0.27051013708114624, "acc": 0.8996022343635559, "length": 3.2791519165039062, "mode": "test", "epoch": 48}
{"loss": 0.22244563698768616, "acc": 0.9060671329498291, "length": 3.31195068359375, "mode": "train", "epoch": 49}
{"loss": 0.2663324773311615, "acc": 0.9010641574859619, "length": 3.424028158187866, "mode": "test", "epoch": 49}
{"loss": 0.22690165042877197, "acc": 0.9068751335144043, "length": 3.3030924797058105, "mode": "train", "epoch": 50}
{"loss": 0.26288172602653503, "acc": 0.9041127562522888, "length": 3.360424041748047, "mode": "test", "epoch": 50}
{"loss": 0.22523057460784912, "acc": 0.9076064825057983, "length": 3.3064825534820557, "mode": "train", "epoch": 51}
{"loss": 0.28361886739730835, "acc": 0.8980269432067871, "length": 3.360424041748047, "mode": "test", "epoch": 51}
{"loss": 0.23194138705730438, "acc": 0.9029505848884583, "length": 3.286011219024658, "mode": "train", "epoch": 52}
{"loss": 0.2511264383792877, "acc": 0.911626398563385, "length": 3.318021297454834, "mode": "test", "epoch": 52}
{"loss": 0.23064067959785461, "acc": 0.9073620438575745, "length": 3.2957217693328857, "mode": "train", "epoch": 53}
{"loss": 0.2744910418987274, "acc": 0.904751718044281, "length": 3.3957598209381104, "mode": "test", "epoch": 53}
{"loss": 0.22722771763801575, "acc": 0.9044061899185181, "length": 3.3565526008605957, "mode": "train", "epoch": 54}
{"loss": 0.27076491713523865, "acc": 0.8969327807426453, "length": 3.3568904399871826, "mode": "test", "epoch": 54}
{"loss": 0.22452744841575623, "acc": 0.9047955274581909, "length": 3.306424617767334, "mode": "train", "epoch": 55}
{"loss": 0.2884982228279114, "acc": 0.9009714722633362, "length": 3.2932863235473633, "mode": "test", "epoch": 55}
{"loss": 0.2181233912706375, "acc": 0.9103407859802246, "length": 3.356147527694702, "mode": "train", "epoch": 56}
{"loss": 0.28307610750198364, "acc": 0.900411069393158, "length": 3.378091812133789, "mode": "test", "epoch": 56}
{"loss": 0.22256143391132355, "acc": 0.9078398942947388, "length": 3.272542715072632, "mode": "train", "epoch": 57}
{"loss": 0.2685973644256592, "acc": 0.9060983657836914, "length": 3.2826855182647705, "mode": "test", "epoch": 57}
{"loss": 0.21960502862930298, "acc": 0.9088463187217712, "length": 3.231680154800415, "mode": "train", "epoch": 58}
{"loss": 0.25583726167678833, "acc": 0.9107935428619385, "length": 3.2544169425964355, "mode": "test", "epoch": 58}
{"loss": 0.21463054418563843, "acc": 0.9130779504776001, "length": 3.270514726638794, "mode": "train", "epoch": 59}
{"loss": 0.2788565754890442, "acc": 0.90657639503479, "length": 3.374558210372925, "mode": "test", "epoch": 59}
{"loss": 0.21781881153583527, "acc": 0.9092950820922852, "length": 3.333486557006836, "mode": "train", "epoch": 60}
{"loss": 0.2591340243816376, "acc": 0.9014652371406555, "length": 3.3250882625579834, "mode": "test", "epoch": 60}
test accuracy: 0.787555456161499
