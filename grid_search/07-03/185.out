# ["--attributes=5", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=64", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.99", "--temperature=2"]
Creating train_ds and val_ds...

Creating test_ds...
{"loss": 0.6975451111793518, "acc": 0.4981902241706848, "length": 3.358055353164673, "mode": "train", "epoch": 1}
{"loss": 0.693371057510376, "acc": 0.4942568838596344, "length": 1.0, "mode": "test", "epoch": 1}
{"loss": 0.6920493841171265, "acc": 0.5148400068283081, "length": 2.3327131271362305, "mode": "train", "epoch": 2}
{"loss": 0.6856205463409424, "acc": 0.5599530339241028, "length": 1.2635135650634766, "mode": "test", "epoch": 2}
{"loss": 0.6702901721000671, "acc": 0.6279990077018738, "length": 2.479036808013916, "mode": "train", "epoch": 3}
{"loss": 0.6231564879417419, "acc": 0.7564743757247925, "length": 2.5912163257598877, "mode": "test", "epoch": 3}
{"loss": 0.5962845087051392, "acc": 0.7446175813674927, "length": 2.7830617427825928, "mode": "train", "epoch": 4}
{"loss": 0.5236927270889282, "acc": 0.7686312198638916, "length": 2.9560811519622803, "mode": "test", "epoch": 4}
{"loss": 0.5096927881240845, "acc": 0.7784257531166077, "length": 2.918494939804077, "mode": "train", "epoch": 5}
{"loss": 0.47745442390441895, "acc": 0.8075158596038818, "length": 2.895270347595215, "mode": "test", "epoch": 5}
{"loss": 0.48535776138305664, "acc": 0.7978599071502686, "length": 2.8697590827941895, "mode": "train", "epoch": 6}
{"loss": 0.46657228469848633, "acc": 0.8082770109176636, "length": 2.8851351737976074, "mode": "test", "epoch": 6}
{"loss": 0.46765008568763733, "acc": 0.7991628646850586, "length": 3.0026464462280273, "mode": "train", "epoch": 7}
{"loss": 0.4646150767803192, "acc": 0.8083598017692566, "length": 2.8851351737976074, "mode": "test", "epoch": 7}
{"loss": 0.44615212082862854, "acc": 0.8082978129386902, "length": 3.201871156692505, "mode": "train", "epoch": 8}
{"loss": 0.4485843777656555, "acc": 0.8092830777168274, "length": 3.8918919563293457, "mode": "test", "epoch": 8}
{"loss": 0.42967355251312256, "acc": 0.8067560791969299, "length": 3.6873676776885986, "mode": "train", "epoch": 9}
{"loss": 0.4495106637477875, "acc": 0.8033784627914429, "length": 4.0, "mode": "test", "epoch": 9}
{"loss": 0.4174480736255646, "acc": 0.817634105682373, "length": 3.8416597843170166, "mode": "train", "epoch": 10}
{"loss": 0.4061715304851532, "acc": 0.8221282958984375, "length": 4.0, "mode": "test", "epoch": 10}
{"loss": 0.40113574266433716, "acc": 0.8248100876808167, "length": 3.8532629013061523, "mode": "train", "epoch": 11}
{"loss": 0.405257910490036, "acc": 0.8285473585128784, "length": 4.0, "mode": "test", "epoch": 11}
{"loss": 0.37214192748069763, "acc": 0.8428027629852295, "length": 3.8861238956451416, "mode": "train", "epoch": 12}
{"loss": 0.35866057872772217, "acc": 0.8440877795219421, "length": 4.0, "mode": "test", "epoch": 12}
{"loss": 0.32184356451034546, "acc": 0.8719026446342468, "length": 3.91255521774292, "mode": "train", "epoch": 13}
{"loss": 0.3121963143348694, "acc": 0.8734797835350037, "length": 4.0, "mode": "test", "epoch": 13}
{"loss": 0.27892038226127625, "acc": 0.8904532194137573, "length": 3.9430387020111084, "mode": "train", "epoch": 14}
{"loss": 0.28921762108802795, "acc": 0.8947637677192688, "length": 4.0, "mode": "test", "epoch": 14}
{"loss": 0.25221848487854004, "acc": 0.9007967710494995, "length": 3.962803840637207, "mode": "train", "epoch": 15}
{"loss": 0.29769986867904663, "acc": 0.875675618648529, "length": 4.0, "mode": "test", "epoch": 15}
{"loss": 0.22509697079658508, "acc": 0.9117358326911926, "length": 3.9751503467559814, "mode": "train", "epoch": 16}
{"loss": 0.29573023319244385, "acc": 0.8812500238418579, "length": 4.0, "mode": "test", "epoch": 16}
{"loss": 0.20844951272010803, "acc": 0.9213826656341553, "length": 3.9813592433929443, "mode": "train", "epoch": 17}
{"loss": 0.2667281925678253, "acc": 0.8978040814399719, "length": 4.0, "mode": "test", "epoch": 17}
{"loss": 0.19906780123710632, "acc": 0.9247065186500549, "length": 3.985013484954834, "mode": "train", "epoch": 18}
{"loss": 0.2898789346218109, "acc": 0.8876689076423645, "length": 4.0, "mode": "test", "epoch": 18}
{"loss": 0.19238387048244476, "acc": 0.9257156848907471, "length": 3.9878625869750977, "mode": "train", "epoch": 19}
{"loss": 0.2671988010406494, "acc": 0.897297203540802, "length": 4.0, "mode": "test", "epoch": 19}
{"loss": 0.18562771379947662, "acc": 0.9325999021530151, "length": 3.9892637729644775, "mode": "train", "epoch": 20}
{"loss": 0.24334287643432617, "acc": 0.9060810208320618, "length": 4.0, "mode": "test", "epoch": 20}
{"loss": 0.1800563782453537, "acc": 0.9314056038856506, "length": 3.9907844066619873, "mode": "train", "epoch": 21}
{"loss": 0.25602594017982483, "acc": 0.8978040814399719, "length": 4.0, "mode": "test", "epoch": 21}
{"loss": 0.17589744925498962, "acc": 0.9366471171379089, "length": 3.9896655082702637, "mode": "train", "epoch": 22}
{"loss": 0.2553236186504364, "acc": 0.8978040814399719, "length": 4.0, "mode": "test", "epoch": 22}
{"loss": 0.17255085706710815, "acc": 0.935143768787384, "length": 3.99117112159729, "mode": "train", "epoch": 23}
{"loss": 0.24860571324825287, "acc": 0.9006755948066711, "length": 4.0, "mode": "test", "epoch": 23}
{"loss": 0.16851191222667694, "acc": 0.9352386593818665, "length": 3.9920778274536133, "mode": "train", "epoch": 24}
{"loss": 0.21650075912475586, "acc": 0.9189189076423645, "length": 4.0, "mode": "test", "epoch": 24}
{"loss": 0.16259586811065674, "acc": 0.9400748610496521, "length": 3.9935848712921143, "mode": "train", "epoch": 25}
{"loss": 0.21440039575099945, "acc": 0.9185811877250671, "length": 4.0, "mode": "test", "epoch": 25}
{"loss": 0.15644189715385437, "acc": 0.9424006938934326, "length": 3.9948291778564453, "mode": "train", "epoch": 26}
{"loss": 0.20549912750720978, "acc": 0.9255067110061646, "length": 4.0, "mode": "test", "epoch": 26}
{"loss": 0.15469369292259216, "acc": 0.9456821084022522, "length": 3.994636058807373, "mode": "train", "epoch": 27}
{"loss": 0.21265392005443573, "acc": 0.9241554737091064, "length": 4.0, "mode": "test", "epoch": 27}
{"loss": 0.15049505233764648, "acc": 0.9470008611679077, "length": 3.9954543113708496, "mode": "train", "epoch": 28}
{"loss": 0.24542205035686493, "acc": 0.9184123873710632, "length": 4.0, "mode": "test", "epoch": 28}
{"loss": 0.1447867751121521, "acc": 0.9492770433425903, "length": 3.995737314224243, "mode": "train", "epoch": 29}
{"loss": 0.19485381245613098, "acc": 0.9305744767189026, "length": 4.0, "mode": "test", "epoch": 29}
{"loss": 0.14633610844612122, "acc": 0.9492958188056946, "length": 3.9967458248138428, "mode": "train", "epoch": 30}
{"loss": 0.20780065655708313, "acc": 0.9336147904396057, "length": 4.0, "mode": "test", "epoch": 30}
{"loss": 0.13784196972846985, "acc": 0.9508630633354187, "length": 3.9957635402679443, "mode": "train", "epoch": 31}
{"loss": 0.1861124038696289, "acc": 0.9216216802597046, "length": 4.0, "mode": "test", "epoch": 31}
{"loss": 0.14224229753017426, "acc": 0.9477326273918152, "length": 3.9970510005950928, "mode": "train", "epoch": 32}
{"loss": 0.20577888190746307, "acc": 0.9292230606079102, "length": 4.0, "mode": "test", "epoch": 32}
{"loss": 0.13937030732631683, "acc": 0.9483867883682251, "length": 3.996548891067505, "mode": "train", "epoch": 33}
{"loss": 0.19409950077533722, "acc": 0.9312499761581421, "length": 4.0, "mode": "test", "epoch": 33}
{"loss": 0.13193699717521667, "acc": 0.9527567028999329, "length": 3.9971485137939453, "mode": "train", "epoch": 34}
{"loss": 0.17638640105724335, "acc": 0.9410473704338074, "length": 4.0, "mode": "test", "epoch": 34}
{"loss": 0.12239149957895279, "acc": 0.9566645622253418, "length": 3.9973766803741455, "mode": "train", "epoch": 35}
{"loss": 0.1685866266489029, "acc": 0.9402027726173401, "length": 4.0, "mode": "test", "epoch": 35}
{"loss": 0.12858393788337708, "acc": 0.9553844928741455, "length": 3.998063087463379, "mode": "train", "epoch": 36}
{"loss": 0.16165418922901154, "acc": 0.9464526772499084, "length": 4.0, "mode": "test", "epoch": 36}
{"loss": 0.12514612078666687, "acc": 0.955801784992218, "length": 3.9966442584991455, "mode": "train", "epoch": 37}
{"loss": 0.1542748659849167, "acc": 0.950168788433075, "length": 4.0, "mode": "test", "epoch": 37}
{"loss": 0.11897143721580505, "acc": 0.958774209022522, "length": 3.9979777336120605, "mode": "train", "epoch": 38}
{"loss": 0.150237575173378, "acc": 0.9353040456771851, "length": 4.0, "mode": "test", "epoch": 38}
{"loss": 0.11564458906650543, "acc": 0.9574846029281616, "length": 3.998307228088379, "mode": "train", "epoch": 39}
{"loss": 0.14411652088165283, "acc": 0.9435811638832092, "length": 4.0, "mode": "test", "epoch": 39}
{"loss": 0.11806362867355347, "acc": 0.9595161080360413, "length": 3.998105049133301, "mode": "train", "epoch": 40}
{"loss": 0.15012751519680023, "acc": 0.9451013803482056, "length": 4.0, "mode": "test", "epoch": 40}
{"loss": 0.11398492753505707, "acc": 0.9606548547744751, "length": 3.9984781742095947, "mode": "train", "epoch": 41}
{"loss": 0.1361117660999298, "acc": 0.9474663734436035, "length": 4.0, "mode": "test", "epoch": 41}
{"loss": 0.1090426817536354, "acc": 0.9621362686157227, "length": 3.998908281326294, "mode": "train", "epoch": 42}
{"loss": 0.1302502155303955, "acc": 0.9608108997344971, "length": 4.0, "mode": "test", "epoch": 42}
{"loss": 0.10610774159431458, "acc": 0.963985025882721, "length": 3.998227119445801, "mode": "train", "epoch": 43}
{"loss": 0.1439739614725113, "acc": 0.9538850784301758, "length": 4.0, "mode": "test", "epoch": 43}
{"loss": 0.10883583873510361, "acc": 0.9614517688751221, "length": 3.998579263687134, "mode": "train", "epoch": 44}
{"loss": 0.14703522622585297, "acc": 0.9510135054588318, "length": 4.0, "mode": "test", "epoch": 44}
{"loss": 0.1078520193696022, "acc": 0.9620243310928345, "length": 3.99898624420166, "mode": "train", "epoch": 45}
{"loss": 0.13532225787639618, "acc": 0.949155330657959, "length": 4.0, "mode": "test", "epoch": 45}
{"loss": 0.1052134782075882, "acc": 0.9611819982528687, "length": 3.9990415573120117, "mode": "train", "epoch": 46}
{"loss": 0.12106657028198242, "acc": 0.9601351022720337, "length": 4.0, "mode": "test", "epoch": 46}
{"loss": 0.10656893998384476, "acc": 0.9617429971694946, "length": 3.998927354812622, "mode": "train", "epoch": 47}
{"loss": 0.1490183025598526, "acc": 0.9533783197402954, "length": 4.0, "mode": "test", "epoch": 47}
{"loss": 0.10716615617275238, "acc": 0.9615775346755981, "length": 3.9991331100463867, "mode": "train", "epoch": 48}
{"loss": 0.129741832613945, "acc": 0.9601351022720337, "length": 4.0, "mode": "test", "epoch": 48}
{"loss": 0.09953872114419937, "acc": 0.9654296636581421, "length": 3.9994590282440186, "mode": "train", "epoch": 49}
{"loss": 0.12335353344678879, "acc": 0.9638513922691345, "length": 4.0, "mode": "test", "epoch": 49}
{"loss": 0.09782164543867111, "acc": 0.967295229434967, "length": 3.9993693828582764, "mode": "train", "epoch": 50}
{"loss": 0.11736603081226349, "acc": 0.965033769607544, "length": 4.0, "mode": "test", "epoch": 50}
{"loss": 0.09822989255189896, "acc": 0.9653744101524353, "length": 3.999443531036377, "mode": "train", "epoch": 51}
{"loss": 0.12233028560876846, "acc": 0.9660472273826599, "length": 4.0, "mode": "test", "epoch": 51}
{"loss": 0.09592003375291824, "acc": 0.9651464223861694, "length": 3.9994397163391113, "mode": "train", "epoch": 52}
{"loss": 0.12000979483127594, "acc": 0.9653716087341309, "length": 4.0, "mode": "test", "epoch": 52}
{"loss": 0.09075604379177094, "acc": 0.9697276949882507, "length": 3.999502420425415, "mode": "train", "epoch": 53}
{"loss": 0.12823879718780518, "acc": 0.962837815284729, "length": 4.0, "mode": "test", "epoch": 53}
{"loss": 0.08508770912885666, "acc": 0.9699573516845703, "length": 3.9995508193969727, "mode": "train", "epoch": 54}
{"loss": 0.13031113147735596, "acc": 0.9619933366775513, "length": 4.0, "mode": "test", "epoch": 54}
{"loss": 0.08294948190450668, "acc": 0.9730130434036255, "length": 3.999659299850464, "mode": "train", "epoch": 55}
{"loss": 0.12367736548185349, "acc": 0.9587838649749756, "length": 4.0, "mode": "test", "epoch": 55}
{"loss": 0.08709797263145447, "acc": 0.9689966440200806, "length": 3.999608278274536, "mode": "train", "epoch": 56}
{"loss": 0.12286124378442764, "acc": 0.9619931578636169, "length": 4.0, "mode": "test", "epoch": 56}
{"loss": 0.08634177595376968, "acc": 0.9691661596298218, "length": 3.9996063709259033, "mode": "train", "epoch": 57}
{"loss": 0.12367186695337296, "acc": 0.9679052829742432, "length": 4.0, "mode": "test", "epoch": 57}
{"loss": 0.0849059522151947, "acc": 0.9704105257987976, "length": 3.9996111392974854, "mode": "train", "epoch": 58}
{"loss": 0.11805204302072525, "acc": 0.9635134339332581, "length": 4.0, "mode": "test", "epoch": 58}
{"loss": 0.08471603691577911, "acc": 0.9691658020019531, "length": 3.999598503112793, "mode": "train", "epoch": 59}
{"loss": 0.13795730471611023, "acc": 0.9592905044555664, "length": 4.0, "mode": "test", "epoch": 59}
{"loss": 0.08246085047721863, "acc": 0.9713721871376038, "length": 3.9996178150177, "mode": "train", "epoch": 60}
{"loss": 0.12939903140068054, "acc": 0.9542229175567627, "length": 4.0, "mode": "test", "epoch": 60}
test accuracy: 0.8217307925224304
