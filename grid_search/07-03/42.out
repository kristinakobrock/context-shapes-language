# ["--attributes=3", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=64", "--learning_rate=0.001", "--hidden_size=256", "--temp_update=0.97", "--temperature=1"]
Creating train_ds and val_ds...

Creating test_ds...
{"loss": 0.7056364417076111, "acc": 0.5202351212501526, "length": 2.3539223670959473, "mode": "train", "epoch": 1}
{"loss": 0.6910027861595154, "acc": 0.5464413166046143, "length": 1.0, "mode": "test", "epoch": 1}
{"loss": 0.6892627477645874, "acc": 0.5434053540229797, "length": 1.0097322463989258, "mode": "train", "epoch": 2}
{"loss": 0.6821311116218567, "acc": 0.5571174621582031, "length": 1.0, "mode": "test", "epoch": 2}
{"loss": 0.6860892176628113, "acc": 0.5493988394737244, "length": 1.0097204446792603, "mode": "train", "epoch": 3}
{"loss": 0.6844964027404785, "acc": 0.5345195531845093, "length": 1.0, "mode": "test", "epoch": 3}
{"loss": 0.6642584204673767, "acc": 0.5958519577980042, "length": 1.4487234354019165, "mode": "train", "epoch": 4}
{"loss": 0.609332263469696, "acc": 0.6853053569793701, "length": 2.263345241546631, "mode": "test", "epoch": 4}
{"loss": 0.5830577611923218, "acc": 0.6987242698669434, "length": 2.154393434524536, "mode": "train", "epoch": 5}
{"loss": 0.5838030576705933, "acc": 0.6913109421730042, "length": 2.1103203296661377, "mode": "test", "epoch": 5}
{"loss": 0.5545527338981628, "acc": 0.7280772924423218, "length": 2.2892770767211914, "mode": "train", "epoch": 6}
{"loss": 0.5316672325134277, "acc": 0.744209885597229, "length": 2.590747356414795, "mode": "test", "epoch": 6}
{"loss": 0.5058670043945312, "acc": 0.7581604719161987, "length": 2.475847005844116, "mode": "train", "epoch": 7}
{"loss": 0.48807772994041443, "acc": 0.7765817046165466, "length": 2.5587189197540283, "mode": "test", "epoch": 7}
{"loss": 0.48306506872177124, "acc": 0.775952160358429, "length": 2.512299060821533, "mode": "train", "epoch": 8}
{"loss": 0.4618389308452606, "acc": 0.7850792407989502, "length": 3.0498220920562744, "mode": "test", "epoch": 8}
{"loss": 0.46014004945755005, "acc": 0.790311872959137, "length": 2.777738332748413, "mode": "train", "epoch": 9}
{"loss": 0.43766656517982483, "acc": 0.7974812388420105, "length": 3.156583547592163, "mode": "test", "epoch": 9}
{"loss": 0.4342159628868103, "acc": 0.8107649087905884, "length": 2.9737703800201416, "mode": "train", "epoch": 10}
{"loss": 0.4340740740299225, "acc": 0.8110945224761963, "length": 3.177935838699341, "mode": "test", "epoch": 10}
{"loss": 0.4148964285850525, "acc": 0.81798255443573, "length": 3.193260431289673, "mode": "train", "epoch": 11}
{"loss": 0.4273145794868469, "acc": 0.8209021687507629, "length": 3.348754405975342, "mode": "test", "epoch": 11}
{"loss": 0.40991947054862976, "acc": 0.8220627307891846, "length": 3.258883237838745, "mode": "train", "epoch": 12}
{"loss": 0.3927389681339264, "acc": 0.8262041807174683, "length": 3.338078260421753, "mode": "test", "epoch": 12}
{"loss": 0.3839913606643677, "acc": 0.8299306035041809, "length": 3.2691190242767334, "mode": "train", "epoch": 13}
{"loss": 0.3834754228591919, "acc": 0.8272119760513306, "length": 3.498220682144165, "mode": "test", "epoch": 13}
{"loss": 0.3766917586326599, "acc": 0.8346415162086487, "length": 3.288299322128296, "mode": "train", "epoch": 14}
{"loss": 0.3868637979030609, "acc": 0.8153202533721924, "length": 3.498220682144165, "mode": "test", "epoch": 14}
{"loss": 0.3760039210319519, "acc": 0.8335297703742981, "length": 3.328112840652466, "mode": "train", "epoch": 15}
{"loss": 0.3647056519985199, "acc": 0.832212507724762, "length": 3.4768683910369873, "mode": "test", "epoch": 15}
{"loss": 0.3539832830429077, "acc": 0.8407347798347473, "length": 3.292055606842041, "mode": "train", "epoch": 16}
{"loss": 0.3751215934753418, "acc": 0.8166226148605347, "length": 3.4768683910369873, "mode": "test", "epoch": 16}
{"loss": 0.3653952479362488, "acc": 0.8417072296142578, "length": 3.2182366847991943, "mode": "train", "epoch": 17}
{"loss": 0.3490951955318451, "acc": 0.8443471789360046, "length": 3.252669095993042, "mode": "test", "epoch": 17}
{"loss": 0.3545345664024353, "acc": 0.8421034216880798, "length": 3.2379088401794434, "mode": "train", "epoch": 18}
{"loss": 0.34946033358573914, "acc": 0.8399912118911743, "length": 3.316725969314575, "mode": "test", "epoch": 18}
{"loss": 0.3524154722690582, "acc": 0.8439249396324158, "length": 3.2169153690338135, "mode": "train", "epoch": 19}
{"loss": 0.3523269593715668, "acc": 0.8366094827651978, "length": 3.263345241546631, "mode": "test", "epoch": 19}
{"loss": 0.3547814190387726, "acc": 0.8420007228851318, "length": 3.1639156341552734, "mode": "train", "epoch": 20}
{"loss": 0.351438969373703, "acc": 0.8522842526435852, "length": 3.508896827697754, "mode": "test", "epoch": 20}
{"loss": 0.3464374244213104, "acc": 0.8476990461349487, "length": 3.322333812713623, "mode": "train", "epoch": 21}
{"loss": 0.34246116876602173, "acc": 0.8478331565856934, "length": 3.3807828426361084, "mode": "test", "epoch": 21}
{"loss": 0.35163503885269165, "acc": 0.8424417972564697, "length": 3.212841510772705, "mode": "train", "epoch": 22}
{"loss": 0.344614177942276, "acc": 0.8352890610694885, "length": 3.316725969314575, "mode": "test", "epoch": 22}
{"loss": 0.3481113314628601, "acc": 0.8443629741668701, "length": 3.2348287105560303, "mode": "train", "epoch": 23}
{"loss": 0.34870967268943787, "acc": 0.8374652862548828, "length": 3.3060498237609863, "mode": "test", "epoch": 23}
{"loss": 0.3343392312526703, "acc": 0.8473213315010071, "length": 3.229032516479492, "mode": "train", "epoch": 24}
{"loss": 0.32849788665771484, "acc": 0.8528525829315186, "length": 3.327402114868164, "mode": "test", "epoch": 24}
{"loss": 0.33603569865226746, "acc": 0.8474999666213989, "length": 3.2280123233795166, "mode": "train", "epoch": 25}
{"loss": 0.3335791230201721, "acc": 0.8505741953849792, "length": 3.316725969314575, "mode": "test", "epoch": 25}
{"loss": 0.34839028120040894, "acc": 0.8508881330490112, "length": 3.196258783340454, "mode": "train", "epoch": 26}
{"loss": 0.33738112449645996, "acc": 0.8460983633995056, "length": 3.327402114868164, "mode": "test", "epoch": 26}
{"loss": 0.33758336305618286, "acc": 0.8460977673530579, "length": 3.189279794692993, "mode": "train", "epoch": 27}
{"loss": 0.3302055299282074, "acc": 0.8598871231079102, "length": 3.327402114868164, "mode": "test", "epoch": 27}
{"loss": 0.3359629511833191, "acc": 0.8497669696807861, "length": 3.2143301963806152, "mode": "train", "epoch": 28}
{"loss": 0.33420634269714355, "acc": 0.8552388548851013, "length": 3.3024911880493164, "mode": "test", "epoch": 28}
{"loss": 0.3268926739692688, "acc": 0.8513394594192505, "length": 3.1970200538635254, "mode": "train", "epoch": 29}
{"loss": 0.3206024765968323, "acc": 0.8575881719589233, "length": 3.2989323139190674, "mode": "test", "epoch": 29}
{"loss": 0.3466915190219879, "acc": 0.84058678150177, "length": 3.213618755340576, "mode": "train", "epoch": 30}
{"loss": 0.36662837862968445, "acc": 0.8373931050300598, "length": 3.2989323139190674, "mode": "test", "epoch": 30}
{"loss": 0.3419586718082428, "acc": 0.8435749411582947, "length": 3.2225215435028076, "mode": "train", "epoch": 31}
{"loss": 0.3344498574733734, "acc": 0.8500036597251892, "length": 3.2989323139190674, "mode": "test", "epoch": 31}
{"loss": 0.33581119775772095, "acc": 0.8525872230529785, "length": 3.170750379562378, "mode": "train", "epoch": 32}
{"loss": 0.34136679768562317, "acc": 0.8447047472000122, "length": 3.2882561683654785, "mode": "test", "epoch": 32}
{"loss": 0.3324747681617737, "acc": 0.8522873520851135, "length": 3.166645050048828, "mode": "train", "epoch": 33}
{"loss": 0.3387766480445862, "acc": 0.8486304879188538, "length": 3.2811388969421387, "mode": "test", "epoch": 33}
{"loss": 0.3320314586162567, "acc": 0.853306233882904, "length": 3.2118098735809326, "mode": "train", "epoch": 34}
{"loss": 0.3374358117580414, "acc": 0.8550362586975098, "length": 3.341636896133423, "mode": "test", "epoch": 34}
{"loss": 0.3245047926902771, "acc": 0.856356143951416, "length": 3.234036922454834, "mode": "train", "epoch": 35}
{"loss": 0.3219231069087982, "acc": 0.8602656126022339, "length": 3.3096084594726562, "mode": "test", "epoch": 35}
{"loss": 0.3110104501247406, "acc": 0.8615782260894775, "length": 3.235159158706665, "mode": "train", "epoch": 36}
{"loss": 0.3164876401424408, "acc": 0.8613778352737427, "length": 3.2989323139190674, "mode": "test", "epoch": 36}
{"loss": 0.3184926509857178, "acc": 0.8552215099334717, "length": 3.109203815460205, "mode": "train", "epoch": 37}
{"loss": 0.3199142515659332, "acc": 0.8542287349700928, "length": 3.330960750579834, "mode": "test", "epoch": 37}
{"loss": 0.3102956712245941, "acc": 0.8608953952789307, "length": 3.23604416847229, "mode": "train", "epoch": 38}
{"loss": 0.3193361461162567, "acc": 0.8587596416473389, "length": 3.330960750579834, "mode": "test", "epoch": 38}
{"loss": 0.3136768341064453, "acc": 0.8615050911903381, "length": 3.202796697616577, "mode": "train", "epoch": 39}
{"loss": 0.3160426914691925, "acc": 0.8585584163665771, "length": 3.2989323139190674, "mode": "test", "epoch": 39}
{"loss": 0.3012959957122803, "acc": 0.864413321018219, "length": 3.2361831665039062, "mode": "train", "epoch": 40}
{"loss": 0.3191036880016327, "acc": 0.8662461042404175, "length": 3.427046298980713, "mode": "test", "epoch": 40}
{"loss": 0.3136100769042969, "acc": 0.8626559376716614, "length": 3.2573704719543457, "mode": "train", "epoch": 41}
{"loss": 0.3206561505794525, "acc": 0.8657222986221313, "length": 3.2989323139190674, "mode": "test", "epoch": 41}
{"loss": 0.3160344362258911, "acc": 0.8615201711654663, "length": 3.1969354152679443, "mode": "train", "epoch": 42}
{"loss": 0.31855839490890503, "acc": 0.867409348487854, "length": 3.2989323139190674, "mode": "test", "epoch": 42}
{"loss": 0.31029844284057617, "acc": 0.8623262643814087, "length": 3.2711124420166016, "mode": "train", "epoch": 43}
{"loss": 0.32508382201194763, "acc": 0.8660356998443604, "length": 3.330960750579834, "mode": "test", "epoch": 43}
{"loss": 0.3067256510257721, "acc": 0.8615720272064209, "length": 3.2098946571350098, "mode": "train", "epoch": 44}
{"loss": 0.32140371203422546, "acc": 0.8579663038253784, "length": 3.2846975326538086, "mode": "test", "epoch": 44}
{"loss": 0.29477542638778687, "acc": 0.8653024435043335, "length": 3.2019052505493164, "mode": "train", "epoch": 45}
{"loss": 0.31631842255592346, "acc": 0.864815890789032, "length": 3.341636896133423, "mode": "test", "epoch": 45}
{"loss": 0.3128335177898407, "acc": 0.8652127981185913, "length": 3.226198434829712, "mode": "train", "epoch": 46}
{"loss": 0.3150150775909424, "acc": 0.8614800572395325, "length": 3.2989323139190674, "mode": "test", "epoch": 46}
{"loss": 0.3101297914981842, "acc": 0.8665801882743835, "length": 3.2184996604919434, "mode": "train", "epoch": 47}
{"loss": 0.31723830103874207, "acc": 0.8632091879844666, "length": 3.2989323139190674, "mode": "test", "epoch": 47}
{"loss": 0.30459752678871155, "acc": 0.8709878325462341, "length": 3.2231884002685547, "mode": "train", "epoch": 48}
{"loss": 0.3114969730377197, "acc": 0.8581194281578064, "length": 3.416370153427124, "mode": "test", "epoch": 48}
{"loss": 0.28947415947914124, "acc": 0.8672620058059692, "length": 3.2624521255493164, "mode": "train", "epoch": 49}
{"loss": 0.31411948800086975, "acc": 0.8612381219863892, "length": 3.341636896133423, "mode": "test", "epoch": 49}
{"loss": 0.29637736082077026, "acc": 0.8618490099906921, "length": 3.2318053245544434, "mode": "train", "epoch": 50}
{"loss": 0.3071351647377014, "acc": 0.8701767325401306, "length": 3.2989323139190674, "mode": "test", "epoch": 50}
{"loss": 0.3136356472969055, "acc": 0.8699659705162048, "length": 3.2266900539398193, "mode": "train", "epoch": 51}
{"loss": 0.3135152757167816, "acc": 0.8697783350944519, "length": 3.3131673336029053, "mode": "test", "epoch": 51}
{"loss": 0.30180370807647705, "acc": 0.860681414604187, "length": 3.2632243633270264, "mode": "train", "epoch": 52}
{"loss": 0.3291642367839813, "acc": 0.8685508966445923, "length": 3.4448399543762207, "mode": "test", "epoch": 52}
{"loss": 0.30602046847343445, "acc": 0.8630349040031433, "length": 3.2524428367614746, "mode": "train", "epoch": 53}
{"loss": 0.3183150887489319, "acc": 0.8534708619117737, "length": 3.3096084594726562, "mode": "test", "epoch": 53}
{"loss": 0.29988929629325867, "acc": 0.8682891726493835, "length": 3.2249622344970703, "mode": "train", "epoch": 54}
{"loss": 0.3029978275299072, "acc": 0.8733798265457153, "length": 3.3096084594726562, "mode": "test", "epoch": 54}
{"loss": 0.30978280305862427, "acc": 0.8712418079376221, "length": 3.2146224975585938, "mode": "train", "epoch": 55}
{"loss": 0.30952513217926025, "acc": 0.8656056523323059, "length": 3.2882561683654785, "mode": "test", "epoch": 55}
{"loss": 0.28961342573165894, "acc": 0.8675007224082947, "length": 3.1375272274017334, "mode": "train", "epoch": 56}
{"loss": 0.31329211592674255, "acc": 0.8487891554832458, "length": 3.3879003524780273, "mode": "test", "epoch": 56}
{"loss": 0.2968396246433258, "acc": 0.8675630688667297, "length": 3.2592804431915283, "mode": "train", "epoch": 57}
{"loss": 0.30754753947257996, "acc": 0.8710496425628662, "length": 3.3914589881896973, "mode": "test", "epoch": 57}
{"loss": 0.30282533168792725, "acc": 0.8718122243881226, "length": 3.2522268295288086, "mode": "train", "epoch": 58}
{"loss": 0.3016609847545624, "acc": 0.8673059940338135, "length": 3.338078260421753, "mode": "test", "epoch": 58}
{"loss": 0.2963218688964844, "acc": 0.8686671853065491, "length": 3.229499101638794, "mode": "train", "epoch": 59}
{"loss": 0.3035460114479065, "acc": 0.8679867386817932, "length": 3.2989323139190674, "mode": "test", "epoch": 59}
{"loss": 0.2915188670158386, "acc": 0.8696959614753723, "length": 3.2103960514068604, "mode": "train", "epoch": 60}
{"loss": 0.30408975481987, "acc": 0.8714004755020142, "length": 3.3096084594726562, "mode": "test", "epoch": 60}
test accuracy: 0.7644848823547363
