# ["--attributes=3", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=64", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.99", "--temperature=1.5"]
Creating train_ds and val_ds...

Creating test_ds...
{"loss": 0.7002881765365601, "acc": 0.490915983915329, "length": 3.451810359954834, "mode": "train", "epoch": 1}
{"loss": 0.6952990293502808, "acc": 0.5078125, "length": 1.0, "mode": "test", "epoch": 1}
{"loss": 0.6914215683937073, "acc": 0.5185766816139221, "length": 2.6750712394714355, "mode": "train", "epoch": 2}
{"loss": 0.6769422888755798, "acc": 0.5796847939491272, "length": 1.6666666269302368, "mode": "test", "epoch": 2}
{"loss": 0.6400823593139648, "acc": 0.6871788501739502, "length": 3.3807783126831055, "mode": "train", "epoch": 3}
{"loss": 0.5940081477165222, "acc": 0.7154514789581299, "length": 4.0, "mode": "test", "epoch": 3}
{"loss": 0.5419588685035706, "acc": 0.7581612467765808, "length": 3.8880774974823, "mode": "train", "epoch": 4}
{"loss": 0.5353580713272095, "acc": 0.7565972805023193, "length": 4.0, "mode": "test", "epoch": 4}
{"loss": 0.4866459369659424, "acc": 0.7740268111228943, "length": 3.965878486633301, "mode": "train", "epoch": 5}
{"loss": 0.5035730004310608, "acc": 0.7796875834465027, "length": 4.0, "mode": "test", "epoch": 5}
{"loss": 0.46401190757751465, "acc": 0.7900871634483337, "length": 3.9744207859039307, "mode": "train", "epoch": 6}
{"loss": 0.4935062527656555, "acc": 0.7835070490837097, "length": 4.0, "mode": "test", "epoch": 6}
{"loss": 0.44430720806121826, "acc": 0.8033315539360046, "length": 3.975424289703369, "mode": "train", "epoch": 7}
{"loss": 0.48986586928367615, "acc": 0.7967013120651245, "length": 4.0, "mode": "test", "epoch": 7}
{"loss": 0.426960825920105, "acc": 0.8186666965484619, "length": 3.978396415710449, "mode": "train", "epoch": 8}
{"loss": 0.4629257321357727, "acc": 0.8208333253860474, "length": 4.0, "mode": "test", "epoch": 8}
{"loss": 0.39924827218055725, "acc": 0.831965982913971, "length": 3.983565330505371, "mode": "train", "epoch": 9}
{"loss": 0.41475650668144226, "acc": 0.8413195013999939, "length": 4.0, "mode": "test", "epoch": 9}
{"loss": 0.34852883219718933, "acc": 0.8574128746986389, "length": 3.9862215518951416, "mode": "train", "epoch": 10}
{"loss": 0.39022764563560486, "acc": 0.8427082896232605, "length": 4.0, "mode": "test", "epoch": 10}
{"loss": 0.32106080651283264, "acc": 0.8640763163566589, "length": 3.9881248474121094, "mode": "train", "epoch": 11}
{"loss": 0.37095212936401367, "acc": 0.8526042699813843, "length": 4.0, "mode": "test", "epoch": 11}
{"loss": 0.30603814125061035, "acc": 0.8690253496170044, "length": 3.99279522895813, "mode": "train", "epoch": 12}
{"loss": 0.35050565004348755, "acc": 0.8607639074325562, "length": 4.0, "mode": "test", "epoch": 12}
{"loss": 0.2940281927585602, "acc": 0.8742438554763794, "length": 3.9929556846618652, "mode": "train", "epoch": 13}
{"loss": 0.34789690375328064, "acc": 0.8654513359069824, "length": 4.0, "mode": "test", "epoch": 13}
{"loss": 0.28485533595085144, "acc": 0.882668673992157, "length": 3.9958176612854004, "mode": "train", "epoch": 14}
{"loss": 0.32977139949798584, "acc": 0.8654513359069824, "length": 4.0, "mode": "test", "epoch": 14}
{"loss": 0.27426618337631226, "acc": 0.8864458203315735, "length": 3.9964981079101562, "mode": "train", "epoch": 15}
{"loss": 0.3307591378688812, "acc": 0.8744791746139526, "length": 4.0, "mode": "test", "epoch": 15}
{"loss": 0.2647237777709961, "acc": 0.8841986060142517, "length": 3.996809720993042, "mode": "train", "epoch": 16}
{"loss": 0.3128736913204193, "acc": 0.8722221851348877, "length": 4.0, "mode": "test", "epoch": 16}
{"loss": 0.25993403792381287, "acc": 0.887966513633728, "length": 3.9975926876068115, "mode": "train", "epoch": 17}
{"loss": 0.3078068792819977, "acc": 0.8842014074325562, "length": 4.0, "mode": "test", "epoch": 17}
{"loss": 0.24877972900867462, "acc": 0.8933026194572449, "length": 3.997967004776001, "mode": "train", "epoch": 18}
{"loss": 0.29344919323921204, "acc": 0.8822916150093079, "length": 4.0, "mode": "test", "epoch": 18}
{"loss": 0.24084557592868805, "acc": 0.9004842042922974, "length": 3.9978113174438477, "mode": "train", "epoch": 19}
{"loss": 0.2804536521434784, "acc": 0.8899306058883667, "length": 4.0, "mode": "test", "epoch": 19}
{"loss": 0.2217826545238495, "acc": 0.9061694145202637, "length": 3.997462749481201, "mode": "train", "epoch": 20}
{"loss": 0.26428669691085815, "acc": 0.8902777433395386, "length": 4.0, "mode": "test", "epoch": 20}
{"loss": 0.21225592494010925, "acc": 0.9129629731178284, "length": 3.998281955718994, "mode": "train", "epoch": 21}
{"loss": 0.2482108175754547, "acc": 0.9050347208976746, "length": 4.0, "mode": "test", "epoch": 21}
{"loss": 0.206578329205513, "acc": 0.9178320169448853, "length": 3.998291015625, "mode": "train", "epoch": 22}
{"loss": 0.2604382634162903, "acc": 0.9109374284744263, "length": 4.0, "mode": "test", "epoch": 22}
{"loss": 0.1896670162677765, "acc": 0.9245021343231201, "length": 3.998319387435913, "mode": "train", "epoch": 23}
{"loss": 0.23617787659168243, "acc": 0.9230902791023254, "length": 4.0, "mode": "test", "epoch": 23}
{"loss": 0.18714340031147003, "acc": 0.9299567937850952, "length": 3.99863338470459, "mode": "train", "epoch": 24}
{"loss": 0.21659138798713684, "acc": 0.9211806058883667, "length": 4.0, "mode": "test", "epoch": 24}
{"loss": 0.17796741425991058, "acc": 0.935060441493988, "length": 3.9986515045166016, "mode": "train", "epoch": 25}
{"loss": 0.19981937110424042, "acc": 0.9282986521720886, "length": 4.0, "mode": "test", "epoch": 25}
{"loss": 0.1647314876317978, "acc": 0.9397105574607849, "length": 3.999121904373169, "mode": "train", "epoch": 26}
{"loss": 0.20420502126216888, "acc": 0.9295138120651245, "length": 4.0, "mode": "test", "epoch": 26}
{"loss": 0.15201643109321594, "acc": 0.945335328578949, "length": 3.999112606048584, "mode": "train", "epoch": 27}
{"loss": 0.20729902386665344, "acc": 0.9331597089767456, "length": 4.0, "mode": "test", "epoch": 27}
{"loss": 0.15191596746444702, "acc": 0.9450383186340332, "length": 3.998725175857544, "mode": "train", "epoch": 28}
{"loss": 0.1991170197725296, "acc": 0.9342014789581299, "length": 4.0, "mode": "test", "epoch": 28}
{"loss": 0.14841333031654358, "acc": 0.9460899829864502, "length": 3.9992029666900635, "mode": "train", "epoch": 29}
{"loss": 0.1678372472524643, "acc": 0.9420139789581299, "length": 4.0, "mode": "test", "epoch": 29}
{"loss": 0.14715532958507538, "acc": 0.9472357034683228, "length": 3.9985172748565674, "mode": "train", "epoch": 30}
{"loss": 0.15584641695022583, "acc": 0.9467013478279114, "length": 4.0, "mode": "test", "epoch": 30}
{"loss": 0.14684683084487915, "acc": 0.9480994939804077, "length": 3.998455047607422, "mode": "train", "epoch": 31}
{"loss": 0.1540827751159668, "acc": 0.9477429986000061, "length": 4.0, "mode": "test", "epoch": 31}
{"loss": 0.13967961072921753, "acc": 0.9491823315620422, "length": 3.998030424118042, "mode": "train", "epoch": 32}
{"loss": 0.17606256902217865, "acc": 0.9387152791023254, "length": 4.0, "mode": "test", "epoch": 32}
{"loss": 0.13652220368385315, "acc": 0.951667308807373, "length": 3.9992218017578125, "mode": "train", "epoch": 33}
{"loss": 0.16386060416698456, "acc": 0.9428820013999939, "length": 4.0, "mode": "test", "epoch": 33}
{"loss": 0.12194456160068512, "acc": 0.9561859369277954, "length": 3.999166488647461, "mode": "train", "epoch": 34}
{"loss": 0.16176359355449677, "acc": 0.9449653625488281, "length": 4.0, "mode": "test", "epoch": 34}
{"loss": 0.1299813687801361, "acc": 0.955032467842102, "length": 3.999443292617798, "mode": "train", "epoch": 35}
{"loss": 0.1486966460943222, "acc": 0.9532986879348755, "length": 4.0, "mode": "test", "epoch": 35}
{"loss": 0.11923901736736298, "acc": 0.9573250412940979, "length": 3.998605489730835, "mode": "train", "epoch": 36}
{"loss": 0.15319453179836273, "acc": 0.9506945013999939, "length": 4.0, "mode": "test", "epoch": 36}
{"loss": 0.1210424080491066, "acc": 0.9595543742179871, "length": 3.999513626098633, "mode": "train", "epoch": 37}
{"loss": 0.15857277810573578, "acc": 0.9506945013999939, "length": 4.0, "mode": "test", "epoch": 37}
{"loss": 0.11344379186630249, "acc": 0.9611745476722717, "length": 3.999359369277954, "mode": "train", "epoch": 38}
{"loss": 0.16356542706489563, "acc": 0.949305534362793, "length": 4.0, "mode": "test", "epoch": 38}
{"loss": 0.11405525356531143, "acc": 0.9577637910842896, "length": 3.9996776580810547, "mode": "train", "epoch": 39}
{"loss": 0.14679117500782013, "acc": 0.9513888955116272, "length": 4.0, "mode": "test", "epoch": 39}
{"loss": 0.11615850031375885, "acc": 0.9587294459342957, "length": 3.998910665512085, "mode": "train", "epoch": 40}
{"loss": 0.17053329944610596, "acc": 0.9496527910232544, "length": 4.0, "mode": "test", "epoch": 40}
{"loss": 0.11545747518539429, "acc": 0.9598448276519775, "length": 3.9995369911193848, "mode": "train", "epoch": 41}
{"loss": 0.16358701884746552, "acc": 0.9513888955116272, "length": 4.0, "mode": "test", "epoch": 41}
{"loss": 0.11007285118103027, "acc": 0.9620987772941589, "length": 3.9993770122528076, "mode": "train", "epoch": 42}
{"loss": 0.1665835976600647, "acc": 0.9442707896232605, "length": 4.0, "mode": "test", "epoch": 42}
{"loss": 0.11916755139827728, "acc": 0.9579710364341736, "length": 3.9986748695373535, "mode": "train", "epoch": 43}
{"loss": 0.15030601620674133, "acc": 0.9519097208976746, "length": 4.0, "mode": "test", "epoch": 43}
{"loss": 0.10113362222909927, "acc": 0.9638019800186157, "length": 3.9999070167541504, "mode": "train", "epoch": 44}
{"loss": 0.16768085956573486, "acc": 0.9491318464279175, "length": 4.0, "mode": "test", "epoch": 44}
{"loss": 0.10002224892377853, "acc": 0.9673969745635986, "length": 3.9998767375946045, "mode": "train", "epoch": 45}
{"loss": 0.16609108448028564, "acc": 0.9517361521720886, "length": 4.0, "mode": "test", "epoch": 45}
{"loss": 0.09584369510412216, "acc": 0.9671589732170105, "length": 3.9996137619018555, "mode": "train", "epoch": 46}
{"loss": 0.1410508155822754, "acc": 0.9534722566604614, "length": 4.0, "mode": "test", "epoch": 46}
{"loss": 0.10258007794618607, "acc": 0.9655980467796326, "length": 3.9998865127563477, "mode": "train", "epoch": 47}
{"loss": 0.1404726356267929, "acc": 0.9506945013999939, "length": 4.0, "mode": "test", "epoch": 47}
{"loss": 0.1002763956785202, "acc": 0.9651904702186584, "length": 3.9997775554656982, "mode": "train", "epoch": 48}
{"loss": 0.13755576312541962, "acc": 0.9522569179534912, "length": 4.0, "mode": "test", "epoch": 48}
{"loss": 0.0925031453371048, "acc": 0.9685528874397278, "length": 3.999696969985962, "mode": "train", "epoch": 49}
{"loss": 0.17530661821365356, "acc": 0.9496527910232544, "length": 4.0, "mode": "test", "epoch": 49}
{"loss": 0.0991067960858345, "acc": 0.9672178626060486, "length": 3.99973464012146, "mode": "train", "epoch": 50}
{"loss": 0.16432760655879974, "acc": 0.9520832896232605, "length": 4.0, "mode": "test", "epoch": 50}
{"loss": 0.10185911506414413, "acc": 0.9651364088058472, "length": 3.999908685684204, "mode": "train", "epoch": 51}
{"loss": 0.12276054918766022, "acc": 0.9588541388511658, "length": 4.0, "mode": "test", "epoch": 51}
{"loss": 0.09062071144580841, "acc": 0.971052885055542, "length": 3.9999258518218994, "mode": "train", "epoch": 52}
{"loss": 0.13873352110385895, "acc": 0.956944465637207, "length": 4.0, "mode": "test", "epoch": 52}
{"loss": 0.09359874576330185, "acc": 0.970181405544281, "length": 3.999854803085327, "mode": "train", "epoch": 53}
{"loss": 0.13351236283779144, "acc": 0.9559028148651123, "length": 4.0, "mode": "test", "epoch": 53}
{"loss": 0.09288473427295685, "acc": 0.9664676785469055, "length": 3.9998703002929688, "mode": "train", "epoch": 54}
{"loss": 0.14658907055854797, "acc": 0.9597222208976746, "length": 4.0, "mode": "test", "epoch": 54}
{"loss": 0.08423774689435959, "acc": 0.9750538468360901, "length": 3.9998788833618164, "mode": "train", "epoch": 55}
{"loss": 0.16151882708072662, "acc": 0.9557291865348816, "length": 4.0, "mode": "test", "epoch": 55}
{"loss": 0.07604500651359558, "acc": 0.9766811728477478, "length": 3.9999709129333496, "mode": "train", "epoch": 56}
{"loss": 0.15319602191448212, "acc": 0.9557291865348816, "length": 4.0, "mode": "test", "epoch": 56}
{"loss": 0.0772782489657402, "acc": 0.9736649394035339, "length": 3.999974250793457, "mode": "train", "epoch": 57}
{"loss": 0.1372828483581543, "acc": 0.9576389789581299, "length": 4.0, "mode": "test", "epoch": 57}
{"loss": 0.07940435409545898, "acc": 0.9759830832481384, "length": 3.9999396800994873, "mode": "train", "epoch": 58}
{"loss": 0.12681616842746735, "acc": 0.9605902433395386, "length": 4.0, "mode": "test", "epoch": 58}
{"loss": 0.07816164940595627, "acc": 0.9731377363204956, "length": 3.9997780323028564, "mode": "train", "epoch": 59}
{"loss": 0.13512937724590302, "acc": 0.9559028148651123, "length": 4.0, "mode": "test", "epoch": 59}
{"loss": 0.0721384808421135, "acc": 0.9761578440666199, "length": 3.9999353885650635, "mode": "train", "epoch": 60}
{"loss": 0.1473550647497177, "acc": 0.9574652910232544, "length": 4.0, "mode": "test", "epoch": 60}
test accuracy: 0.8368964791297913
