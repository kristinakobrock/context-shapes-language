# ["--attributes=3", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.0005", "--hidden_size=256", "--temp_update=0.99", "--temperature=2"]
Creating train_ds and val_ds...

Creating test_ds...
{"loss": 0.6980490684509277, "acc": 0.5149291753768921, "length": 3.1601481437683105, "mode": "train", "epoch": 1}
{"loss": 0.6944310665130615, "acc": 0.48754453659057617, "length": 1.0, "mode": "test", "epoch": 1}
{"loss": 0.6457506418228149, "acc": 0.6258298754692078, "length": 2.614992380142212, "mode": "train", "epoch": 2}
{"loss": 0.5996876358985901, "acc": 0.7101950645446777, "length": 3.081850528717041, "mode": "test", "epoch": 2}
{"loss": 0.5106000304222107, "acc": 0.7543319463729858, "length": 3.1752707958221436, "mode": "train", "epoch": 3}
{"loss": 0.5036347508430481, "acc": 0.7843928337097168, "length": 3.416370153427124, "mode": "test", "epoch": 3}
{"loss": 0.3951197862625122, "acc": 0.8292685747146606, "length": 3.3696470260620117, "mode": "train", "epoch": 4}
{"loss": 0.44143256545066833, "acc": 0.8145102262496948, "length": 3.6049821376800537, "mode": "test", "epoch": 4}
{"loss": 0.3285817503929138, "acc": 0.8702839016914368, "length": 3.542780876159668, "mode": "train", "epoch": 5}
{"loss": 0.4466992914676666, "acc": 0.8143009543418884, "length": 3.5587189197540283, "mode": "test", "epoch": 5}
{"loss": 0.2867833375930786, "acc": 0.8834227323532104, "length": 3.5930097103118896, "mode": "train", "epoch": 6}
{"loss": 0.41418832540512085, "acc": 0.8364838361740112, "length": 3.750889778137207, "mode": "test", "epoch": 6}
{"loss": 0.26078706979751587, "acc": 0.8994117975234985, "length": 3.682610273361206, "mode": "train", "epoch": 7}
{"loss": 0.38615089654922485, "acc": 0.8601706027984619, "length": 3.9323842525482178, "mode": "test", "epoch": 7}
{"loss": 0.2370242178440094, "acc": 0.9015820622444153, "length": 3.7408885955810547, "mode": "train", "epoch": 8}
{"loss": 0.34734758734703064, "acc": 0.8673098087310791, "length": 3.989323854446411, "mode": "test", "epoch": 8}
{"loss": 0.22489839792251587, "acc": 0.9121664762496948, "length": 3.8437187671661377, "mode": "train", "epoch": 9}
{"loss": 0.37376224994659424, "acc": 0.8783864974975586, "length": 3.992882490158081, "mode": "test", "epoch": 9}
{"loss": 0.2200363278388977, "acc": 0.9176204204559326, "length": 3.8944456577301025, "mode": "train", "epoch": 10}
{"loss": 0.3613243103027344, "acc": 0.880060076713562, "length": 3.9750890731811523, "mode": "test", "epoch": 10}
{"loss": 0.1964409500360489, "acc": 0.925582766532898, "length": 3.8693013191223145, "mode": "train", "epoch": 11}
{"loss": 0.30808931589126587, "acc": 0.8964968919754028, "length": 3.989323854446411, "mode": "test", "epoch": 11}
{"loss": 0.18611222505569458, "acc": 0.9332000613212585, "length": 3.8922300338745117, "mode": "train", "epoch": 12}
{"loss": 0.3324589431285858, "acc": 0.8956183195114136, "length": 3.992882490158081, "mode": "test", "epoch": 12}
{"loss": 0.18301311135292053, "acc": 0.9358513951301575, "length": 3.890533447265625, "mode": "train", "epoch": 13}
{"loss": 0.320085346698761, "acc": 0.8987823128700256, "length": 3.9572954177856445, "mode": "test", "epoch": 13}
{"loss": 0.17506395280361176, "acc": 0.9342551827430725, "length": 3.90510630607605, "mode": "train", "epoch": 14}
{"loss": 0.27008548378944397, "acc": 0.9052548408508301, "length": 3.9786477088928223, "mode": "test", "epoch": 14}
{"loss": 0.16196012496948242, "acc": 0.9420157074928284, "length": 3.922055959701538, "mode": "train", "epoch": 15}
{"loss": 0.2668856680393219, "acc": 0.9082517623901367, "length": 3.9537365436553955, "mode": "test", "epoch": 15}
{"loss": 0.17491541802883148, "acc": 0.9338645339012146, "length": 3.9213080406188965, "mode": "train", "epoch": 16}
{"loss": 0.2816081941127777, "acc": 0.9092526435852051, "length": 3.9715301990509033, "mode": "test", "epoch": 16}
{"loss": 0.16532166302204132, "acc": 0.9406394958496094, "length": 3.9241135120391846, "mode": "train", "epoch": 17}
{"loss": 0.24524416029453278, "acc": 0.9188222885131836, "length": 3.9679715633392334, "mode": "test", "epoch": 17}
{"loss": 0.15456706285476685, "acc": 0.9420360922813416, "length": 3.932960033416748, "mode": "train", "epoch": 18}
{"loss": 0.27024608850479126, "acc": 0.8984876871109009, "length": 3.9608540534973145, "mode": "test", "epoch": 18}
{"loss": 0.15642082691192627, "acc": 0.9424679279327393, "length": 3.919907569885254, "mode": "train", "epoch": 19}
{"loss": 0.24557235836982727, "acc": 0.90887451171875, "length": 3.985765218734741, "mode": "test", "epoch": 19}
{"loss": 0.15075461566448212, "acc": 0.9452221393585205, "length": 3.940232515335083, "mode": "train", "epoch": 20}
{"loss": 0.24073246121406555, "acc": 0.9172652363777161, "length": 3.9501779079437256, "mode": "test", "epoch": 20}
{"loss": 0.14294958114624023, "acc": 0.9490982890129089, "length": 3.9217684268951416, "mode": "train", "epoch": 21}
{"loss": 0.28848567605018616, "acc": 0.9065114259719849, "length": 3.9537365436553955, "mode": "test", "epoch": 21}
{"loss": 0.13822995126247406, "acc": 0.9499800801277161, "length": 3.944061756134033, "mode": "train", "epoch": 22}
{"loss": 0.22585031390190125, "acc": 0.9134175181388855, "length": 3.9644129276275635, "mode": "test", "epoch": 22}
{"loss": 0.13607551157474518, "acc": 0.9465820789337158, "length": 3.9506020545959473, "mode": "train", "epoch": 23}
{"loss": 0.23089994490146637, "acc": 0.9146630764007568, "length": 3.9572954177856445, "mode": "test", "epoch": 23}
{"loss": 0.1401047259569168, "acc": 0.9476083517074585, "length": 3.9501354694366455, "mode": "train", "epoch": 24}
{"loss": 0.2489812672138214, "acc": 0.9149632453918457, "length": 3.9750890731811523, "mode": "test", "epoch": 24}
{"loss": 0.12548993527889252, "acc": 0.9501230716705322, "length": 3.9484574794769287, "mode": "train", "epoch": 25}
{"loss": 0.2328682541847229, "acc": 0.9176267385482788, "length": 3.9572954177856445, "mode": "test", "epoch": 25}
{"loss": 0.1113286018371582, "acc": 0.9615182876586914, "length": 3.9498729705810547, "mode": "train", "epoch": 26}
{"loss": 0.2303916960954666, "acc": 0.913322925567627, "length": 3.9644129276275635, "mode": "test", "epoch": 26}
{"loss": 0.11901324987411499, "acc": 0.955328106880188, "length": 3.951784610748291, "mode": "train", "epoch": 27}
{"loss": 0.2241995930671692, "acc": 0.9151245355606079, "length": 3.9537365436553955, "mode": "test", "epoch": 27}
{"loss": 0.10689560323953629, "acc": 0.9598903656005859, "length": 3.9453296661376953, "mode": "train", "epoch": 28}
{"loss": 0.2690911591053009, "acc": 0.9113933444023132, "length": 3.9786477088928223, "mode": "test", "epoch": 28}
{"loss": 0.10449358075857162, "acc": 0.9622036218643188, "length": 3.9593381881713867, "mode": "train", "epoch": 29}
{"loss": 0.23638057708740234, "acc": 0.9206405282020569, "length": 3.985765218734741, "mode": "test", "epoch": 29}
{"loss": 0.08979703485965729, "acc": 0.9678245782852173, "length": 3.9678306579589844, "mode": "train", "epoch": 30}
{"loss": 0.21403992176055908, "acc": 0.924955427646637, "length": 3.9750890731811523, "mode": "test", "epoch": 30}
{"loss": 0.08712194114923477, "acc": 0.9695810675621033, "length": 3.9678661823272705, "mode": "train", "epoch": 31}
{"loss": 0.205382838845253, "acc": 0.9306161403656006, "length": 3.9786477088928223, "mode": "test", "epoch": 31}
{"loss": 0.07760075479745865, "acc": 0.9732527732849121, "length": 3.972137928009033, "mode": "train", "epoch": 32}
{"loss": 0.18429046869277954, "acc": 0.9366046786308289, "length": 3.982206344604492, "mode": "test", "epoch": 32}
{"loss": 0.06837420910596848, "acc": 0.9734207391738892, "length": 3.976024866104126, "mode": "train", "epoch": 33}
{"loss": 0.15707920491695404, "acc": 0.9475867748260498, "length": 3.989323854446411, "mode": "test", "epoch": 33}
{"loss": 0.06638741493225098, "acc": 0.9741999506950378, "length": 3.9722909927368164, "mode": "train", "epoch": 34}
{"loss": 0.16290275752544403, "acc": 0.9470863342285156, "length": 3.9750890731811523, "mode": "test", "epoch": 34}
{"loss": 0.05973431095480919, "acc": 0.9769006967544556, "length": 3.974910020828247, "mode": "train", "epoch": 35}
{"loss": 0.14134298264980316, "acc": 0.9526692032814026, "length": 4.0, "mode": "test", "epoch": 35}
{"loss": 0.05616338923573494, "acc": 0.9815424084663391, "length": 3.9838342666625977, "mode": "train", "epoch": 36}
{"loss": 0.14170245826244354, "acc": 0.9507617950439453, "length": 3.989323854446411, "mode": "test", "epoch": 36}
{"loss": 0.05514804273843765, "acc": 0.9797613620758057, "length": 3.9787509441375732, "mode": "train", "epoch": 37}
{"loss": 0.1563936024904251, "acc": 0.9501779079437256, "length": 4.0, "mode": "test", "epoch": 37}
{"loss": 0.06225568801164627, "acc": 0.9755563735961914, "length": 3.9831435680389404, "mode": "train", "epoch": 38}
{"loss": 0.14106658101081848, "acc": 0.9501501321792603, "length": 3.9750890731811523, "mode": "test", "epoch": 38}
{"loss": 0.06848791241645813, "acc": 0.9762013554573059, "length": 3.9814205169677734, "mode": "train", "epoch": 39}
{"loss": 0.1598954051733017, "acc": 0.9492771625518799, "length": 3.989323854446411, "mode": "test", "epoch": 39}
{"loss": 0.06051080301403999, "acc": 0.9761130213737488, "length": 3.975573778152466, "mode": "train", "epoch": 40}
{"loss": 0.15164203941822052, "acc": 0.9539312720298767, "length": 3.9786477088928223, "mode": "test", "epoch": 40}
{"loss": 0.04271850362420082, "acc": 0.9838122129440308, "length": 3.97773814201355, "mode": "train", "epoch": 41}
{"loss": 0.09969884902238846, "acc": 0.9683941006660461, "length": 3.992882490158081, "mode": "test", "epoch": 41}
{"loss": 0.03812482953071594, "acc": 0.9865867495536804, "length": 3.9853556156158447, "mode": "train", "epoch": 42}
{"loss": 0.11104946583509445, "acc": 0.9647688269615173, "length": 4.0, "mode": "test", "epoch": 42}
{"loss": 0.03642691671848297, "acc": 0.9870160818099976, "length": 3.9896936416625977, "mode": "train", "epoch": 43}
{"loss": 0.12931473553180695, "acc": 0.9629894495010376, "length": 4.0, "mode": "test", "epoch": 43}
{"loss": 0.03977038711309433, "acc": 0.9848892688751221, "length": 3.9869329929351807, "mode": "train", "epoch": 44}
{"loss": 0.1041407659649849, "acc": 0.9672598242759705, "length": 4.0, "mode": "test", "epoch": 44}
{"loss": 0.032971590757369995, "acc": 0.9870380759239197, "length": 3.990206480026245, "mode": "train", "epoch": 45}
{"loss": 0.08872584253549576, "acc": 0.9715301394462585, "length": 4.0, "mode": "test", "epoch": 45}
{"loss": 0.02803061157464981, "acc": 0.9920127391815186, "length": 3.9949257373809814, "mode": "train", "epoch": 46}
{"loss": 0.10456942766904831, "acc": 0.9715301394462585, "length": 4.0, "mode": "test", "epoch": 46}
{"loss": 0.040472593158483505, "acc": 0.9836088418960571, "length": 3.9938199520111084, "mode": "train", "epoch": 47}
{"loss": 0.10471730679273605, "acc": 0.968505322933197, "length": 4.0, "mode": "test", "epoch": 47}
{"loss": 0.04114440828561783, "acc": 0.9848799109458923, "length": 3.995344638824463, "mode": "train", "epoch": 48}
{"loss": 0.10887955129146576, "acc": 0.9686831831932068, "length": 4.0, "mode": "test", "epoch": 48}
{"loss": 0.03286484628915787, "acc": 0.9877843856811523, "length": 3.99395489692688, "mode": "train", "epoch": 49}
{"loss": 0.0837266817688942, "acc": 0.9706404805183411, "length": 4.0, "mode": "test", "epoch": 49}
{"loss": 0.04177515208721161, "acc": 0.985996663570404, "length": 3.994724988937378, "mode": "train", "epoch": 50}
{"loss": 0.13149972259998322, "acc": 0.9644128084182739, "length": 4.0, "mode": "test", "epoch": 50}
{"loss": 0.034759290516376495, "acc": 0.9904175400733948, "length": 3.9959776401519775, "mode": "train", "epoch": 51}
{"loss": 0.12036684900522232, "acc": 0.9681493043899536, "length": 4.0, "mode": "test", "epoch": 51}
{"loss": 0.024147137999534607, "acc": 0.9919586181640625, "length": 3.9914186000823975, "mode": "train", "epoch": 52}
{"loss": 0.09889833629131317, "acc": 0.969572901725769, "length": 4.0, "mode": "test", "epoch": 52}
{"loss": 0.02616257220506668, "acc": 0.9912682175636292, "length": 3.991429090499878, "mode": "train", "epoch": 53}
{"loss": 0.10159873962402344, "acc": 0.9782918095588684, "length": 4.0, "mode": "test", "epoch": 53}
{"loss": 0.02684735879302025, "acc": 0.9915655255317688, "length": 3.9928832054138184, "mode": "train", "epoch": 54}
{"loss": 0.06570354849100113, "acc": 0.9790036678314209, "length": 4.0, "mode": "test", "epoch": 54}
{"loss": 0.01751222275197506, "acc": 0.9940980076789856, "length": 3.9956581592559814, "mode": "train", "epoch": 55}
{"loss": 0.07522222399711609, "acc": 0.9790036082267761, "length": 4.0, "mode": "test", "epoch": 55}
{"loss": 0.01894185319542885, "acc": 0.9936785101890564, "length": 3.995096445083618, "mode": "train", "epoch": 56}
{"loss": 0.05897785723209381, "acc": 0.982206404209137, "length": 4.0, "mode": "test", "epoch": 56}
{"loss": 0.012953429482877254, "acc": 0.996152400970459, "length": 3.9961509704589844, "mode": "train", "epoch": 57}
{"loss": 0.04773622006177902, "acc": 0.9875443577766418, "length": 4.0, "mode": "test", "epoch": 57}
{"loss": 0.013304496183991432, "acc": 0.9955114722251892, "length": 3.9979140758514404, "mode": "train", "epoch": 58}
{"loss": 0.0808270275592804, "acc": 0.9807829260826111, "length": 4.0, "mode": "test", "epoch": 58}
{"loss": 0.014205653220415115, "acc": 0.9964622855186462, "length": 3.998251438140869, "mode": "train", "epoch": 59}
{"loss": 0.08840449154376984, "acc": 0.9806048274040222, "length": 4.0, "mode": "test", "epoch": 59}
{"loss": 0.019186999648809433, "acc": 0.9938403367996216, "length": 3.9979031085968018, "mode": "train", "epoch": 60}
{"loss": 0.05778335779905319, "acc": 0.9864768981933594, "length": 4.0, "mode": "test", "epoch": 60}
test accuracy: 0.8903124928474426
