# ["--attributes=3", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=64", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.99", "--temperature=1"]
Creating train_ds and val_ds...

Creating test_ds...
{"loss": 0.6999403238296509, "acc": 0.4870428144931793, "length": 3.3671231269836426, "mode": "train", "epoch": 1}
{"loss": 0.6956883072853088, "acc": 0.508695662021637, "length": 1.0, "mode": "test", "epoch": 1}
{"loss": 0.6908683180809021, "acc": 0.5461789965629578, "length": 2.287797689437866, "mode": "train", "epoch": 2}
{"loss": 0.6905748248100281, "acc": 0.5214051008224487, "length": 1.0507246255874634, "mode": "test", "epoch": 2}
{"loss": 0.6675642132759094, "acc": 0.6156489253044128, "length": 2.4749691486358643, "mode": "train", "epoch": 3}
{"loss": 0.6394249796867371, "acc": 0.6679738759994507, "length": 2.2971014976501465, "mode": "test", "epoch": 3}
{"loss": 0.6036604046821594, "acc": 0.725021481513977, "length": 2.852532148361206, "mode": "train", "epoch": 4}
{"loss": 0.5411178469657898, "acc": 0.7654665112495422, "length": 3.1521739959716797, "mode": "test", "epoch": 4}
{"loss": 0.5083097815513611, "acc": 0.7750329971313477, "length": 3.36354398727417, "mode": "train", "epoch": 5}
{"loss": 0.4863966107368469, "acc": 0.7741683721542358, "length": 3.38043475151062, "mode": "test", "epoch": 5}
{"loss": 0.4474323093891144, "acc": 0.8055245280265808, "length": 3.379162311553955, "mode": "train", "epoch": 6}
{"loss": 0.4554878771305084, "acc": 0.8153424859046936, "length": 3.5, "mode": "test", "epoch": 6}
{"loss": 0.3995716869831085, "acc": 0.8351876735687256, "length": 3.4404659271240234, "mode": "train", "epoch": 7}
{"loss": 0.4145306646823883, "acc": 0.832846462726593, "length": 3.5543477535247803, "mode": "test", "epoch": 7}
{"loss": 0.3539949059486389, "acc": 0.8572750091552734, "length": 3.4672045707702637, "mode": "train", "epoch": 8}
{"loss": 0.3869556784629822, "acc": 0.8451540470123291, "length": 3.7210144996643066, "mode": "test", "epoch": 8}
{"loss": 0.3359155058860779, "acc": 0.8588560819625854, "length": 3.5691306591033936, "mode": "train", "epoch": 9}
{"loss": 0.37891390919685364, "acc": 0.8495867252349854, "length": 3.6340579986572266, "mode": "test", "epoch": 9}
{"loss": 0.32497638463974, "acc": 0.8672668933868408, "length": 3.581045150756836, "mode": "train", "epoch": 10}
{"loss": 0.38342729210853577, "acc": 0.8492074608802795, "length": 3.6775362491607666, "mode": "test", "epoch": 10}
{"loss": 0.31875574588775635, "acc": 0.8678163886070251, "length": 3.6190030574798584, "mode": "train", "epoch": 11}
{"loss": 0.36638113856315613, "acc": 0.8334550857543945, "length": 3.67391300201416, "mode": "test", "epoch": 11}
{"loss": 0.3162860572338104, "acc": 0.8689842820167542, "length": 3.628798007965088, "mode": "train", "epoch": 12}
{"loss": 0.3423497676849365, "acc": 0.8532863855361938, "length": 3.681159496307373, "mode": "test", "epoch": 12}
{"loss": 0.305372953414917, "acc": 0.8712959885597229, "length": 3.639394760131836, "mode": "train", "epoch": 13}
{"loss": 0.34172579646110535, "acc": 0.847942054271698, "length": 3.699275255203247, "mode": "test", "epoch": 13}
{"loss": 0.29835158586502075, "acc": 0.8776940703392029, "length": 3.6486167907714844, "mode": "train", "epoch": 14}
{"loss": 0.33132365345954895, "acc": 0.8663716316223145, "length": 3.57608699798584, "mode": "test", "epoch": 14}
{"loss": 0.2977774739265442, "acc": 0.8764103055000305, "length": 3.602346181869507, "mode": "train", "epoch": 15}
{"loss": 0.3535113036632538, "acc": 0.8572859764099121, "length": 3.70652174949646, "mode": "test", "epoch": 15}
{"loss": 0.2948560416698456, "acc": 0.8833173513412476, "length": 3.6240038871765137, "mode": "train", "epoch": 16}
{"loss": 0.3501725196838379, "acc": 0.8489362001419067, "length": 3.6485507488250732, "mode": "test", "epoch": 16}
{"loss": 0.2928018867969513, "acc": 0.8827393054962158, "length": 3.633406162261963, "mode": "train", "epoch": 17}
{"loss": 0.32536622881889343, "acc": 0.8695431351661682, "length": 3.70652174949646, "mode": "test", "epoch": 17}
{"loss": 0.2839425504207611, "acc": 0.8865422606468201, "length": 3.6309072971343994, "mode": "train", "epoch": 18}
{"loss": 0.3231465220451355, "acc": 0.8643676042556763, "length": 3.6485507488250732, "mode": "test", "epoch": 18}
{"loss": 0.2781212031841278, "acc": 0.8872398734092712, "length": 3.6599645614624023, "mode": "train", "epoch": 19}
{"loss": 0.2998431324958801, "acc": 0.8830769658088684, "length": 3.605072498321533, "mode": "test", "epoch": 19}
{"loss": 0.27471521496772766, "acc": 0.8926662802696228, "length": 3.6597793102264404, "mode": "train", "epoch": 20}
{"loss": 0.3093825876712799, "acc": 0.8752038478851318, "length": 3.7282607555389404, "mode": "test", "epoch": 20}
{"loss": 0.2690708339214325, "acc": 0.8910477161407471, "length": 3.72749662399292, "mode": "train", "epoch": 21}
{"loss": 0.297224223613739, "acc": 0.8910354375839233, "length": 3.8514492511749268, "mode": "test", "epoch": 21}
{"loss": 0.2705622613430023, "acc": 0.8911410570144653, "length": 3.7857911586761475, "mode": "train", "epoch": 22}
{"loss": 0.2907920777797699, "acc": 0.8910659551620483, "length": 3.8043477535247803, "mode": "test", "epoch": 22}
{"loss": 0.26226040720939636, "acc": 0.894767701625824, "length": 3.7927932739257812, "mode": "train", "epoch": 23}
{"loss": 0.29259130358695984, "acc": 0.8870018720626831, "length": 3.9021739959716797, "mode": "test", "epoch": 23}
{"loss": 0.26028773188591003, "acc": 0.8960025906562805, "length": 3.8869516849517822, "mode": "train", "epoch": 24}
{"loss": 0.29776260256767273, "acc": 0.8801120519638062, "length": 3.9855072498321533, "mode": "test", "epoch": 24}
{"loss": 0.2576492726802826, "acc": 0.8937694430351257, "length": 3.91591477394104, "mode": "train", "epoch": 25}
{"loss": 0.29652753472328186, "acc": 0.8772045373916626, "length": 3.938405752182007, "mode": "test", "epoch": 25}
{"loss": 0.255533903837204, "acc": 0.8963974714279175, "length": 3.9200198650360107, "mode": "train", "epoch": 26}
{"loss": 0.27920278906822205, "acc": 0.8900124430656433, "length": 3.9601449966430664, "mode": "test", "epoch": 26}
{"loss": 0.256413996219635, "acc": 0.8962418437004089, "length": 3.94447922706604, "mode": "train", "epoch": 27}
{"loss": 0.28061729669570923, "acc": 0.8914854526519775, "length": 4.0, "mode": "test", "epoch": 27}
{"loss": 0.250801146030426, "acc": 0.8998190760612488, "length": 3.959303140640259, "mode": "train", "epoch": 28}
{"loss": 0.28777456283569336, "acc": 0.892753541469574, "length": 4.0, "mode": "test", "epoch": 28}
{"loss": 0.2500385046005249, "acc": 0.8965080976486206, "length": 3.973419427871704, "mode": "train", "epoch": 29}
{"loss": 0.2734743654727936, "acc": 0.893840491771698, "length": 4.0, "mode": "test", "epoch": 29}
{"loss": 0.24724717438220978, "acc": 0.8955694437026978, "length": 3.975965976715088, "mode": "train", "epoch": 30}
{"loss": 0.2730115056037903, "acc": 0.8891305327415466, "length": 4.0, "mode": "test", "epoch": 30}
{"loss": 0.24497327208518982, "acc": 0.9003804326057434, "length": 3.979313850402832, "mode": "train", "epoch": 31}
{"loss": 0.2754022777080536, "acc": 0.8907609581947327, "length": 4.0, "mode": "test", "epoch": 31}
{"loss": 0.2467765212059021, "acc": 0.8996700048446655, "length": 3.9863526821136475, "mode": "train", "epoch": 32}
{"loss": 0.2793174386024475, "acc": 0.8914855718612671, "length": 4.0, "mode": "test", "epoch": 32}
{"loss": 0.2418402135372162, "acc": 0.9044515490531921, "length": 3.984717845916748, "mode": "train", "epoch": 33}
{"loss": 0.28748631477355957, "acc": 0.8914856314659119, "length": 4.0, "mode": "test", "epoch": 33}
{"loss": 0.2459089457988739, "acc": 0.8994668126106262, "length": 3.981335163116455, "mode": "train", "epoch": 34}
{"loss": 0.2691704332828522, "acc": 0.8903985619544983, "length": 4.0, "mode": "test", "epoch": 34}
{"loss": 0.24425674974918365, "acc": 0.9001302719116211, "length": 3.9863150119781494, "mode": "train", "epoch": 35}
{"loss": 0.3021267354488373, "acc": 0.8867752552032471, "length": 4.0, "mode": "test", "epoch": 35}
{"loss": 0.25401100516319275, "acc": 0.8962303996086121, "length": 3.9906482696533203, "mode": "train", "epoch": 36}
{"loss": 0.2858445346355438, "acc": 0.8907608985900879, "length": 4.0, "mode": "test", "epoch": 36}
{"loss": 0.24293252825737, "acc": 0.9036518335342407, "length": 3.991834878921509, "mode": "train", "epoch": 37}
{"loss": 0.26964232325553894, "acc": 0.8918476700782776, "length": 4.0, "mode": "test", "epoch": 37}
{"loss": 0.2410491555929184, "acc": 0.9012091159820557, "length": 3.992748737335205, "mode": "train", "epoch": 38}
{"loss": 0.2809874713420868, "acc": 0.8880434036254883, "length": 4.0, "mode": "test", "epoch": 38}
{"loss": 0.23816627264022827, "acc": 0.9030635952949524, "length": 3.9868459701538086, "mode": "train", "epoch": 39}
{"loss": 0.2801409363746643, "acc": 0.8831523656845093, "length": 4.0, "mode": "test", "epoch": 39}
{"loss": 0.2379290610551834, "acc": 0.9065334796905518, "length": 3.9914562702178955, "mode": "train", "epoch": 40}
{"loss": 0.2903732657432556, "acc": 0.8826087117195129, "length": 4.0, "mode": "test", "epoch": 40}
{"loss": 0.23471860587596893, "acc": 0.9076218008995056, "length": 3.991983652114868, "mode": "train", "epoch": 41}
{"loss": 0.26934894919395447, "acc": 0.8998188972473145, "length": 4.0, "mode": "test", "epoch": 41}
{"loss": 0.2359616458415985, "acc": 0.903952419757843, "length": 3.988532543182373, "mode": "train", "epoch": 42}
{"loss": 0.2719539999961853, "acc": 0.8947463035583496, "length": 4.0, "mode": "test", "epoch": 42}
{"loss": 0.23200994729995728, "acc": 0.906700074672699, "length": 3.997814655303955, "mode": "train", "epoch": 43}
{"loss": 0.2801530361175537, "acc": 0.8980073928833008, "length": 4.0, "mode": "test", "epoch": 43}
{"loss": 0.23250162601470947, "acc": 0.9070225954055786, "length": 3.9983434677124023, "mode": "train", "epoch": 44}
{"loss": 0.28528425097465515, "acc": 0.8914855718612671, "length": 4.0, "mode": "test", "epoch": 44}
{"loss": 0.23042519390583038, "acc": 0.9070201516151428, "length": 3.9899954795837402, "mode": "train", "epoch": 45}
{"loss": 0.2702281177043915, "acc": 0.9005435705184937, "length": 4.0, "mode": "test", "epoch": 45}
{"loss": 0.2328111231327057, "acc": 0.903124988079071, "length": 3.9911117553710938, "mode": "train", "epoch": 46}
{"loss": 0.26498284935951233, "acc": 0.8918478488922119, "length": 4.0, "mode": "test", "epoch": 46}
{"loss": 0.2317863553762436, "acc": 0.9029678702354431, "length": 3.997295379638672, "mode": "train", "epoch": 47}
{"loss": 0.26419344544410706, "acc": 0.8960145711898804, "length": 4.0, "mode": "test", "epoch": 47}
{"loss": 0.22876723110675812, "acc": 0.9086077809333801, "length": 3.9992899894714355, "mode": "train", "epoch": 48}
{"loss": 0.27211305499076843, "acc": 0.897826075553894, "length": 4.0, "mode": "test", "epoch": 48}
{"loss": 0.22930222749710083, "acc": 0.9077563285827637, "length": 3.998978614807129, "mode": "train", "epoch": 49}
{"loss": 0.27444255352020264, "acc": 0.9021738171577454, "length": 4.0, "mode": "test", "epoch": 49}
{"loss": 0.2263760268688202, "acc": 0.9105926156044006, "length": 3.9966518878936768, "mode": "train", "epoch": 50}
{"loss": 0.26428183913230896, "acc": 0.8916667103767395, "length": 4.0, "mode": "test", "epoch": 50}
{"loss": 0.2217724770307541, "acc": 0.9080081582069397, "length": 3.9998323917388916, "mode": "train", "epoch": 51}
{"loss": 0.2647862732410431, "acc": 0.8927536606788635, "length": 4.0, "mode": "test", "epoch": 51}
{"loss": 0.21843303740024567, "acc": 0.9081876277923584, "length": 3.999751091003418, "mode": "train", "epoch": 52}
{"loss": 0.2652845084667206, "acc": 0.9005435109138489, "length": 4.0, "mode": "test", "epoch": 52}
{"loss": 0.21786890923976898, "acc": 0.9100048542022705, "length": 3.9985392093658447, "mode": "train", "epoch": 53}
{"loss": 0.24905967712402344, "acc": 0.9003623127937317, "length": 4.0, "mode": "test", "epoch": 53}
{"loss": 0.2199999839067459, "acc": 0.908674418926239, "length": 3.9987709522247314, "mode": "train", "epoch": 54}
{"loss": 0.267747163772583, "acc": 0.8931160569190979, "length": 4.0, "mode": "test", "epoch": 54}
{"loss": 0.2290235310792923, "acc": 0.9084669947624207, "length": 3.995074510574341, "mode": "train", "epoch": 55}
{"loss": 0.2597120702266693, "acc": 0.9016304016113281, "length": 4.0, "mode": "test", "epoch": 55}
{"loss": 0.21967266499996185, "acc": 0.908846378326416, "length": 3.99703049659729, "mode": "train", "epoch": 56}
{"loss": 0.2564513385295868, "acc": 0.8976449370384216, "length": 4.0, "mode": "test", "epoch": 56}
{"loss": 0.22583582997322083, "acc": 0.9031528830528259, "length": 3.9997105598449707, "mode": "train", "epoch": 57}
{"loss": 0.28111863136291504, "acc": 0.8873189091682434, "length": 4.0, "mode": "test", "epoch": 57}
{"loss": 0.22632034122943878, "acc": 0.9063605070114136, "length": 3.9991776943206787, "mode": "train", "epoch": 58}
{"loss": 0.27437862753868103, "acc": 0.8940218687057495, "length": 4.0, "mode": "test", "epoch": 58}
{"loss": 0.2217838317155838, "acc": 0.9104313254356384, "length": 3.999720811843872, "mode": "train", "epoch": 59}
{"loss": 0.260888934135437, "acc": 0.9003624320030212, "length": 4.0, "mode": "test", "epoch": 59}
{"loss": 0.2171759456396103, "acc": 0.9111530184745789, "length": 3.9989492893218994, "mode": "train", "epoch": 60}
{"loss": 0.26488858461380005, "acc": 0.8929347991943359, "length": 4.0, "mode": "test", "epoch": 60}
test accuracy: 0.7854411602020264
