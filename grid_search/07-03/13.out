# ["--attributes=3", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.97", "--temperature=1.5"]
Creating train_ds and val_ds...

Creating test_ds...
{"loss": 0.6938343048095703, "acc": 0.5390697121620178, "length": 2.9369888305664062, "mode": "train", "epoch": 1}
{"loss": 0.6919960975646973, "acc": 0.5364583134651184, "length": 1.0, "mode": "test", "epoch": 1}
{"loss": 0.6525283455848694, "acc": 0.6286454796791077, "length": 2.284327745437622, "mode": "train", "epoch": 2}
{"loss": 0.5955975651741028, "acc": 0.673225998878479, "length": 3.2083332538604736, "mode": "test", "epoch": 2}
{"loss": 0.5344844460487366, "acc": 0.7493568062782288, "length": 3.0298354625701904, "mode": "train", "epoch": 3}
{"loss": 0.5144446492195129, "acc": 0.7705783247947693, "length": 3.090277671813965, "mode": "test", "epoch": 3}
{"loss": 0.46583032608032227, "acc": 0.8005333542823792, "length": 2.9293465614318848, "mode": "train", "epoch": 4}
{"loss": 0.4571630656719208, "acc": 0.8201768398284912, "length": 3.0763888359069824, "mode": "test", "epoch": 4}
{"loss": 0.4218975603580475, "acc": 0.8251594305038452, "length": 2.952561378479004, "mode": "train", "epoch": 5}
{"loss": 0.43063804507255554, "acc": 0.8179090023040771, "length": 3.163194417953491, "mode": "test", "epoch": 5}
{"loss": 0.3889022171497345, "acc": 0.8358616828918457, "length": 3.057063102722168, "mode": "train", "epoch": 6}
{"loss": 0.42158398032188416, "acc": 0.8278754353523254, "length": 3.288194417953491, "mode": "test", "epoch": 6}
{"loss": 0.3685670495033264, "acc": 0.8442711234092712, "length": 2.9175541400909424, "mode": "train", "epoch": 7}
{"loss": 0.38137760758399963, "acc": 0.8383409976959229, "length": 2.965277671813965, "mode": "test", "epoch": 7}
{"loss": 0.3494090735912323, "acc": 0.8525977730751038, "length": 2.9074416160583496, "mode": "train", "epoch": 8}
{"loss": 0.3754847049713135, "acc": 0.8439832925796509, "length": 2.9201388359069824, "mode": "test", "epoch": 8}
{"loss": 0.33921030163764954, "acc": 0.8546453714370728, "length": 2.9237966537475586, "mode": "train", "epoch": 9}
{"loss": 0.37592068314552307, "acc": 0.8426541090011597, "length": 2.9166667461395264, "mode": "test", "epoch": 9}
{"loss": 0.32272475957870483, "acc": 0.8644334673881531, "length": 3.0218887329101562, "mode": "train", "epoch": 10}
{"loss": 0.3787316083908081, "acc": 0.8369467258453369, "length": 3.2604167461395264, "mode": "test", "epoch": 10}
{"loss": 0.3124808371067047, "acc": 0.8657368421554565, "length": 3.320720911026001, "mode": "train", "epoch": 11}
{"loss": 0.3449968099594116, "acc": 0.8425347208976746, "length": 3.534722328186035, "mode": "test", "epoch": 11}
{"loss": 0.2967199683189392, "acc": 0.8759617209434509, "length": 3.5570526123046875, "mode": "train", "epoch": 12}
{"loss": 0.3728901445865631, "acc": 0.8375867605209351, "length": 3.711805582046509, "mode": "test", "epoch": 12}
{"loss": 0.286880224943161, "acc": 0.8844125866889954, "length": 3.446608543395996, "mode": "train", "epoch": 13}
{"loss": 0.31276148557662964, "acc": 0.8780381679534912, "length": 3.5416667461395264, "mode": "test", "epoch": 13}
{"loss": 0.2562815248966217, "acc": 0.9002237319946289, "length": 3.4927613735198975, "mode": "train", "epoch": 14}
{"loss": 0.3151733875274658, "acc": 0.8829209804534912, "length": 3.4201388359069824, "mode": "test", "epoch": 14}
{"loss": 0.2362520396709442, "acc": 0.9056475758552551, "length": 3.4820492267608643, "mode": "train", "epoch": 15}
{"loss": 0.2959730327129364, "acc": 0.8944987058639526, "length": 3.496527671813965, "mode": "test", "epoch": 15}
{"loss": 0.22610755264759064, "acc": 0.9129133224487305, "length": 3.540907621383667, "mode": "train", "epoch": 16}
{"loss": 0.2907615900039673, "acc": 0.9004177451133728, "length": 3.6041667461395264, "mode": "test", "epoch": 16}
{"loss": 0.2172260582447052, "acc": 0.9189332723617554, "length": 3.5971884727478027, "mode": "train", "epoch": 17}
{"loss": 0.3075942099094391, "acc": 0.8966199159622192, "length": 3.6423611640930176, "mode": "test", "epoch": 17}
{"loss": 0.21651944518089294, "acc": 0.9178128242492676, "length": 3.5689353942871094, "mode": "train", "epoch": 18}
{"loss": 0.2785937190055847, "acc": 0.9076551795005798, "length": 3.472222328186035, "mode": "test", "epoch": 18}
{"loss": 0.21560122072696686, "acc": 0.915346086025238, "length": 3.5719919204711914, "mode": "train", "epoch": 19}
{"loss": 0.2813279926776886, "acc": 0.9090061187744141, "length": 3.527777671813965, "mode": "test", "epoch": 19}
{"loss": 0.20686204731464386, "acc": 0.9197183847427368, "length": 3.550663948059082, "mode": "train", "epoch": 20}
{"loss": 0.27703502774238586, "acc": 0.9131022691726685, "length": 3.444444417953491, "mode": "test", "epoch": 20}
{"loss": 0.2066173553466797, "acc": 0.9195142984390259, "length": 3.5725748538970947, "mode": "train", "epoch": 21}
{"loss": 0.25200143456459045, "acc": 0.9140679240226746, "length": 3.475694417953491, "mode": "test", "epoch": 21}
{"loss": 0.19529332220554352, "acc": 0.9286868572235107, "length": 3.5504355430603027, "mode": "train", "epoch": 22}
{"loss": 0.24905024468898773, "acc": 0.9217393398284912, "length": 3.5, "mode": "test", "epoch": 22}
{"loss": 0.19143198430538177, "acc": 0.9266663789749146, "length": 3.5760886669158936, "mode": "train", "epoch": 23}
{"loss": 0.24146239459514618, "acc": 0.9186198115348816, "length": 3.538194417953491, "mode": "test", "epoch": 23}
{"loss": 0.18613377213478088, "acc": 0.92875736951828, "length": 3.5585649013519287, "mode": "train", "epoch": 24}
{"loss": 0.24976284801959991, "acc": 0.9218262434005737, "length": 3.4826388359069824, "mode": "test", "epoch": 24}
{"loss": 0.19668321311473846, "acc": 0.9217046499252319, "length": 3.602083921432495, "mode": "train", "epoch": 25}
{"loss": 0.27873480319976807, "acc": 0.9063476920127869, "length": 3.5486111640930176, "mode": "test", "epoch": 25}
{"loss": 0.18620996177196503, "acc": 0.9284855127334595, "length": 3.5986263751983643, "mode": "train", "epoch": 26}
{"loss": 0.22979974746704102, "acc": 0.9194715023040771, "length": 3.53125, "mode": "test", "epoch": 26}
{"loss": 0.1745537519454956, "acc": 0.9345617294311523, "length": 3.6000025272369385, "mode": "train", "epoch": 27}
{"loss": 0.2461528480052948, "acc": 0.914393424987793, "length": 3.559027671813965, "mode": "test", "epoch": 27}
{"loss": 0.17252475023269653, "acc": 0.9341428279876709, "length": 3.608696460723877, "mode": "train", "epoch": 28}
{"loss": 0.23584699630737305, "acc": 0.9217122197151184, "length": 3.53125, "mode": "test", "epoch": 28}
{"loss": 0.16882944107055664, "acc": 0.9338994026184082, "length": 3.665627956390381, "mode": "train", "epoch": 29}
{"loss": 0.24186928570270538, "acc": 0.9115613102912903, "length": 3.7395832538604736, "mode": "test", "epoch": 29}
{"loss": 0.1628599315881729, "acc": 0.9339165091514587, "length": 3.6583871841430664, "mode": "train", "epoch": 30}
{"loss": 0.194252148270607, "acc": 0.926513671875, "length": 3.625, "mode": "test", "epoch": 30}
{"loss": 0.15079227089881897, "acc": 0.9387714266777039, "length": 3.6915085315704346, "mode": "train", "epoch": 31}
{"loss": 0.21500800549983978, "acc": 0.9242621660232544, "length": 3.7083332538604736, "mode": "test", "epoch": 31}
{"loss": 0.14574073255062103, "acc": 0.9424932599067688, "length": 3.6784396171569824, "mode": "train", "epoch": 32}
{"loss": 0.19548895955085754, "acc": 0.9261881709098816, "length": 3.71875, "mode": "test", "epoch": 32}
{"loss": 0.14874115586280823, "acc": 0.9407613277435303, "length": 3.6567559242248535, "mode": "train", "epoch": 33}
{"loss": 0.20393310487270355, "acc": 0.9254612326622009, "length": 3.618055582046509, "mode": "test", "epoch": 33}
{"loss": 0.1438131481409073, "acc": 0.9418718218803406, "length": 3.6927318572998047, "mode": "train", "epoch": 34}
{"loss": 0.2228960245847702, "acc": 0.9257921576499939, "length": 3.6041667461395264, "mode": "test", "epoch": 34}
{"loss": 0.14910541474819183, "acc": 0.9405326247215271, "length": 3.68233585357666, "mode": "train", "epoch": 35}
{"loss": 0.19856251776218414, "acc": 0.927159309387207, "length": 3.7326388359069824, "mode": "test", "epoch": 35}
{"loss": 0.14522208273410797, "acc": 0.9427266716957092, "length": 3.7124273777008057, "mode": "train", "epoch": 36}
{"loss": 0.17916138470172882, "acc": 0.9383571147918701, "length": 3.6388888359069824, "mode": "test", "epoch": 36}
{"loss": 0.15402813255786896, "acc": 0.943182647228241, "length": 3.6896729469299316, "mode": "train", "epoch": 37}
{"loss": 0.1805565357208252, "acc": 0.9403102397918701, "length": 3.621527671813965, "mode": "test", "epoch": 37}
{"loss": 0.14723838865756989, "acc": 0.9432902932167053, "length": 3.6843574047088623, "mode": "train", "epoch": 38}
{"loss": 0.1763419210910797, "acc": 0.9392524361610413, "length": 3.6423611640930176, "mode": "test", "epoch": 38}
{"loss": 0.1416219174861908, "acc": 0.945065438747406, "length": 3.6971359252929688, "mode": "train", "epoch": 39}
{"loss": 0.17360244691371918, "acc": 0.9456217885017395, "length": 3.6701388359069824, "mode": "test", "epoch": 39}
{"loss": 0.13370652496814728, "acc": 0.9497435092926025, "length": 3.703049898147583, "mode": "train", "epoch": 40}
{"loss": 0.19628094136714935, "acc": 0.9409506320953369, "length": 3.6423611640930176, "mode": "test", "epoch": 40}
{"loss": 0.13486544787883759, "acc": 0.9458534717559814, "length": 3.7052972316741943, "mode": "train", "epoch": 41}
{"loss": 0.18499760329723358, "acc": 0.9399197101593018, "length": 3.6701388359069824, "mode": "test", "epoch": 41}
{"loss": 0.12785011529922485, "acc": 0.9508697986602783, "length": 3.7168450355529785, "mode": "train", "epoch": 42}
{"loss": 0.17988140881061554, "acc": 0.9439995288848877, "length": 3.6736111640930176, "mode": "test", "epoch": 42}
{"loss": 0.1319308578968048, "acc": 0.9477440714836121, "length": 3.721317768096924, "mode": "train", "epoch": 43}
{"loss": 0.2056238204240799, "acc": 0.9389322996139526, "length": 3.7395832538604736, "mode": "test", "epoch": 43}
{"loss": 0.12380427122116089, "acc": 0.952377200126648, "length": 3.740753412246704, "mode": "train", "epoch": 44}
{"loss": 0.16757477819919586, "acc": 0.9431206583976746, "length": 3.7083332538604736, "mode": "test", "epoch": 44}
{"loss": 0.12634070217609406, "acc": 0.949320375919342, "length": 3.7286739349365234, "mode": "train", "epoch": 45}
{"loss": 0.16626210510730743, "acc": 0.9411730170249939, "length": 3.7361111640930176, "mode": "test", "epoch": 45}
{"loss": 0.12281551957130432, "acc": 0.9493569731712341, "length": 3.707207202911377, "mode": "train", "epoch": 46}
{"loss": 0.17093053460121155, "acc": 0.9403156638145447, "length": 3.7083332538604736, "mode": "test", "epoch": 46}
{"loss": 0.11582034081220627, "acc": 0.9542346000671387, "length": 3.7364048957824707, "mode": "train", "epoch": 47}
{"loss": 0.16983573138713837, "acc": 0.9443575739860535, "length": 3.725694417953491, "mode": "test", "epoch": 47}
{"loss": 0.11151014268398285, "acc": 0.9546207785606384, "length": 3.710599422454834, "mode": "train", "epoch": 48}
{"loss": 0.1543932855129242, "acc": 0.9508192539215088, "length": 3.7048611640930176, "mode": "test", "epoch": 48}
{"loss": 0.10957153141498566, "acc": 0.9568386673927307, "length": 3.729588270187378, "mode": "train", "epoch": 49}
{"loss": 0.1805630922317505, "acc": 0.942784309387207, "length": 3.7013888359069824, "mode": "test", "epoch": 49}
{"loss": 0.11118640005588531, "acc": 0.9557874798774719, "length": 3.7038583755493164, "mode": "train", "epoch": 50}
{"loss": 0.15991248190402985, "acc": 0.9466633200645447, "length": 3.71875, "mode": "test", "epoch": 50}
{"loss": 0.10283268243074417, "acc": 0.959738552570343, "length": 3.713858127593994, "mode": "train", "epoch": 51}
{"loss": 0.14545838534832, "acc": 0.9513835906982422, "length": 3.7013888359069824, "mode": "test", "epoch": 51}
{"loss": 0.11151958256959915, "acc": 0.9567651748657227, "length": 3.718573570251465, "mode": "train", "epoch": 52}
{"loss": 0.1854914128780365, "acc": 0.9421875476837158, "length": 3.7048611640930176, "mode": "test", "epoch": 52}
{"loss": 0.1125711053609848, "acc": 0.9556034803390503, "length": 3.734689712524414, "mode": "train", "epoch": 53}
{"loss": 0.1924993395805359, "acc": 0.939122200012207, "length": 3.7361111640930176, "mode": "test", "epoch": 53}
{"loss": 0.13285332918167114, "acc": 0.9514344930648804, "length": 3.7053427696228027, "mode": "train", "epoch": 54}
{"loss": 0.19101688265800476, "acc": 0.9388781785964966, "length": 3.6111111640930176, "mode": "test", "epoch": 54}
{"loss": 0.11992405354976654, "acc": 0.9532829523086548, "length": 3.6898796558380127, "mode": "train", "epoch": 55}
{"loss": 0.1957007199525833, "acc": 0.9377928972244263, "length": 3.711805582046509, "mode": "test", "epoch": 55}
{"loss": 0.11567244678735733, "acc": 0.9522310495376587, "length": 3.72189998626709, "mode": "train", "epoch": 56}
{"loss": 0.18759530782699585, "acc": 0.9405653476715088, "length": 3.7291667461395264, "mode": "test", "epoch": 56}
{"loss": 0.12037738412618637, "acc": 0.9532000422477722, "length": 3.742443084716797, "mode": "train", "epoch": 57}
{"loss": 0.1598692238330841, "acc": 0.9525554180145264, "length": 3.805555582046509, "mode": "test", "epoch": 57}
{"loss": 0.10048635303974152, "acc": 0.9598143100738525, "length": 3.758755683898926, "mode": "train", "epoch": 58}
{"loss": 0.17198467254638672, "acc": 0.9471950531005859, "length": 3.722222328186035, "mode": "test", "epoch": 58}
{"loss": 0.10414915531873703, "acc": 0.9577977061271667, "length": 3.695574998855591, "mode": "train", "epoch": 59}
{"loss": 0.13874641060829163, "acc": 0.9493815302848816, "length": 3.725694417953491, "mode": "test", "epoch": 59}
{"loss": 0.09803088754415512, "acc": 0.9631211757659912, "length": 3.7394425868988037, "mode": "train", "epoch": 60}
{"loss": 0.15698404610157013, "acc": 0.9481824040412903, "length": 3.7361111640930176, "mode": "test", "epoch": 60}
test accuracy: 0.8708081841468811
