# ["--attributes=5", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.0005", "--hidden_size=256", "--temp_update=0.97", "--temperature=1"]
Creating train_ds and val_ds...

Creating test_ds...
{"loss": 0.7051944732666016, "acc": 0.4871393144130707, "length": 2.336110830307007, "mode": "train", "epoch": 1}
{"loss": 0.6971919536590576, "acc": 0.525699257850647, "length": 1.0, "mode": "test", "epoch": 1}
{"loss": 0.6854110360145569, "acc": 0.5534446835517883, "length": 1.4114651679992676, "mode": "train", "epoch": 2}
{"loss": 0.6390495300292969, "acc": 0.6385558247566223, "length": 2.0734264850616455, "mode": "test", "epoch": 2}
{"loss": 0.6022854447364807, "acc": 0.6828768849372864, "length": 2.269880533218384, "mode": "train", "epoch": 3}
{"loss": 0.5869802236557007, "acc": 0.7236723899841309, "length": 2.139860153198242, "mode": "test", "epoch": 3}
{"loss": 0.5254823565483093, "acc": 0.7566238045692444, "length": 2.6343894004821777, "mode": "train", "epoch": 4}
{"loss": 0.47149166464805603, "acc": 0.7789783477783203, "length": 3.2867133617401123, "mode": "test", "epoch": 4}
{"loss": 0.4469943940639496, "acc": 0.8017470240592957, "length": 3.13384747505188, "mode": "train", "epoch": 5}
{"loss": 0.39385339617729187, "acc": 0.8389870524406433, "length": 3.391608476638794, "mode": "test", "epoch": 5}
{"loss": 0.3927605152130127, "acc": 0.8334223628044128, "length": 3.2581543922424316, "mode": "train", "epoch": 6}
{"loss": 0.37657758593559265, "acc": 0.8407233953475952, "length": 3.360139846801758, "mode": "test", "epoch": 6}
{"loss": 0.366216778755188, "acc": 0.8475198745727539, "length": 3.250243663787842, "mode": "train", "epoch": 7}
{"loss": 0.3323415219783783, "acc": 0.8710456490516663, "length": 3.391608476638794, "mode": "test", "epoch": 7}
{"loss": 0.3510949909687042, "acc": 0.8586921691894531, "length": 3.2282609939575195, "mode": "train", "epoch": 8}
{"loss": 0.3215048611164093, "acc": 0.8694504499435425, "length": 3.3951048851013184, "mode": "test", "epoch": 8}
{"loss": 0.33404985070228577, "acc": 0.8644405603408813, "length": 3.2292520999908447, "mode": "train", "epoch": 9}
{"loss": 0.31315359473228455, "acc": 0.8863457441329956, "length": 3.377622365951538, "mode": "test", "epoch": 9}
{"loss": 0.3196301758289337, "acc": 0.8691818118095398, "length": 3.2312538623809814, "mode": "train", "epoch": 10}
{"loss": 0.3023097515106201, "acc": 0.8793652057647705, "length": 3.3671329021453857, "mode": "test", "epoch": 10}
{"loss": 0.3091123104095459, "acc": 0.8698539137840271, "length": 3.2369556427001953, "mode": "train", "epoch": 11}
{"loss": 0.29945263266563416, "acc": 0.8861790299415588, "length": 3.3426573276519775, "mode": "test", "epoch": 11}
{"loss": 0.3082665503025055, "acc": 0.8727048635482788, "length": 3.226738691329956, "mode": "train", "epoch": 12}
{"loss": 0.2876410186290741, "acc": 0.8796627521514893, "length": 3.3111886978149414, "mode": "test", "epoch": 12}
{"loss": 0.30118680000305176, "acc": 0.8737874627113342, "length": 3.2454710006713867, "mode": "train", "epoch": 13}
{"loss": 0.28580862283706665, "acc": 0.880804181098938, "length": 3.321678400039673, "mode": "test", "epoch": 13}
{"loss": 0.2958284914493561, "acc": 0.8775434494018555, "length": 3.2323858737945557, "mode": "train", "epoch": 14}
{"loss": 0.27928876876831055, "acc": 0.8850065469741821, "length": 3.307692289352417, "mode": "test", "epoch": 14}
{"loss": 0.29139596223831177, "acc": 0.8759331703186035, "length": 3.246833086013794, "mode": "train", "epoch": 15}
{"loss": 0.28299465775489807, "acc": 0.8879523873329163, "length": 3.377622365951538, "mode": "test", "epoch": 15}
{"loss": 0.28865012526512146, "acc": 0.8780814409255981, "length": 3.266162633895874, "mode": "train", "epoch": 16}
{"loss": 0.2732694745063782, "acc": 0.8914372324943542, "length": 3.3111886978149414, "mode": "test", "epoch": 16}
{"loss": 0.28386226296424866, "acc": 0.8808658123016357, "length": 3.2793080806732178, "mode": "train", "epoch": 17}
{"loss": 0.2778938412666321, "acc": 0.8907762169837952, "length": 3.391608476638794, "mode": "test", "epoch": 17}
{"loss": 0.27970239520072937, "acc": 0.8840436339378357, "length": 3.264732837677002, "mode": "train", "epoch": 18}
{"loss": 0.2667398750782013, "acc": 0.8980280756950378, "length": 3.3566434383392334, "mode": "test", "epoch": 18}
{"loss": 0.2727797031402588, "acc": 0.8845483064651489, "length": 3.271512508392334, "mode": "train", "epoch": 19}
{"loss": 0.2764263451099396, "acc": 0.8937576413154602, "length": 3.409090995788574, "mode": "test", "epoch": 19}
{"loss": 0.27549225091934204, "acc": 0.882489025592804, "length": 3.238297939300537, "mode": "train", "epoch": 20}
{"loss": 0.2702144384384155, "acc": 0.9011931419372559, "length": 3.3566434383392334, "mode": "test", "epoch": 20}
{"loss": 0.2688162326812744, "acc": 0.8894786238670349, "length": 3.2751801013946533, "mode": "train", "epoch": 21}
{"loss": 0.2601182162761688, "acc": 0.8933616876602173, "length": 3.3671329021453857, "mode": "test", "epoch": 21}
{"loss": 0.2625885605812073, "acc": 0.8865875601768494, "length": 3.284658908843994, "mode": "train", "epoch": 22}
{"loss": 0.25550058484077454, "acc": 0.9059640169143677, "length": 3.339160919189453, "mode": "test", "epoch": 22}
{"loss": 0.26000717282295227, "acc": 0.8926743268966675, "length": 3.2812774181365967, "mode": "train", "epoch": 23}
{"loss": 0.25278711318969727, "acc": 0.9004942178726196, "length": 3.384615421295166, "mode": "test", "epoch": 23}
{"loss": 0.25729888677597046, "acc": 0.8903782963752747, "length": 3.3055436611175537, "mode": "train", "epoch": 24}
{"loss": 0.2549854815006256, "acc": 0.9009779095649719, "length": 3.377622365951538, "mode": "test", "epoch": 24}
{"loss": 0.24544695019721985, "acc": 0.8995532393455505, "length": 3.30243182182312, "mode": "train", "epoch": 25}
{"loss": 0.26414838433265686, "acc": 0.9014149904251099, "length": 3.377622365951538, "mode": "test", "epoch": 25}
{"loss": 0.2378528118133545, "acc": 0.9033325910568237, "length": 3.31792950630188, "mode": "train", "epoch": 26}
{"loss": 0.23247316479682922, "acc": 0.913992166519165, "length": 3.4020979404449463, "mode": "test", "epoch": 26}
{"loss": 0.24378308653831482, "acc": 0.9002712965011597, "length": 3.3449838161468506, "mode": "train", "epoch": 27}
{"loss": 0.2619754374027252, "acc": 0.8895393013954163, "length": 3.5209789276123047, "mode": "test", "epoch": 27}
{"loss": 0.2513126730918884, "acc": 0.8943846225738525, "length": 3.2878029346466064, "mode": "train", "epoch": 28}
{"loss": 0.2174655646085739, "acc": 0.9165553450584412, "length": 3.37062931060791, "mode": "test", "epoch": 28}
{"loss": 0.2329041063785553, "acc": 0.9049341082572937, "length": 3.3360960483551025, "mode": "train", "epoch": 29}
{"loss": 0.21312087774276733, "acc": 0.9192624688148499, "length": 3.4195804595947266, "mode": "test", "epoch": 29}
{"loss": 0.20893515646457672, "acc": 0.9158363342285156, "length": 3.3133602142333984, "mode": "train", "epoch": 30}
{"loss": 0.20421701669692993, "acc": 0.9203341007232666, "length": 3.35314679145813, "mode": "test", "epoch": 30}
{"loss": 0.20186907052993774, "acc": 0.9198477864265442, "length": 3.3201730251312256, "mode": "train", "epoch": 31}
{"loss": 0.1989816427230835, "acc": 0.9283292293548584, "length": 3.3741259574890137, "mode": "test", "epoch": 31}
{"loss": 0.2019491344690323, "acc": 0.9189332127571106, "length": 3.322235584259033, "mode": "train", "epoch": 32}
{"loss": 0.194974884390831, "acc": 0.9234626889228821, "length": 3.391608476638794, "mode": "test", "epoch": 32}
{"loss": 0.1941831260919571, "acc": 0.9225872755050659, "length": 3.3150887489318848, "mode": "train", "epoch": 33}
{"loss": 0.18717697262763977, "acc": 0.9282804727554321, "length": 3.468531370162964, "mode": "test", "epoch": 33}
{"loss": 0.19126001000404358, "acc": 0.9236432909965515, "length": 3.317476749420166, "mode": "train", "epoch": 34}
{"loss": 0.18590638041496277, "acc": 0.9328809380531311, "length": 3.461538553237915, "mode": "test", "epoch": 34}
{"loss": 0.18786869943141937, "acc": 0.9245927333831787, "length": 3.361151933670044, "mode": "train", "epoch": 35}
{"loss": 0.16649840772151947, "acc": 0.9398928284645081, "length": 3.416083812713623, "mode": "test", "epoch": 35}
{"loss": 0.1784314662218094, "acc": 0.9288603067398071, "length": 3.357414484024048, "mode": "train", "epoch": 36}
{"loss": 0.1573552042245865, "acc": 0.9445684552192688, "length": 3.3951048851013184, "mode": "test", "epoch": 36}
{"loss": 0.17715980112552643, "acc": 0.9306972026824951, "length": 3.3314895629882812, "mode": "train", "epoch": 37}
{"loss": 0.17105214297771454, "acc": 0.9391412138938904, "length": 3.468531370162964, "mode": "test", "epoch": 37}
{"loss": 0.17962338030338287, "acc": 0.9296795725822449, "length": 3.4260382652282715, "mode": "train", "epoch": 38}
{"loss": 0.16565775871276855, "acc": 0.9367802739143372, "length": 3.4720280170440674, "mode": "test", "epoch": 38}
{"loss": 0.17408837378025055, "acc": 0.9351860880851746, "length": 3.4149606227874756, "mode": "train", "epoch": 39}
{"loss": 0.17147810757160187, "acc": 0.9400131106376648, "length": 3.5104894638061523, "mode": "test", "epoch": 39}
{"loss": 0.16225478053092957, "acc": 0.9382611513137817, "length": 3.397322654724121, "mode": "train", "epoch": 40}
{"loss": 0.15185792744159698, "acc": 0.9506722688674927, "length": 3.4405593872070312, "mode": "test", "epoch": 40}
{"loss": 0.16331671178340912, "acc": 0.9381529688835144, "length": 3.4418797492980957, "mode": "train", "epoch": 41}
{"loss": 0.16954518854618073, "acc": 0.9418975114822388, "length": 3.5944056510925293, "mode": "test", "epoch": 41}
{"loss": 0.16102221608161926, "acc": 0.9397845268249512, "length": 3.3805625438690186, "mode": "train", "epoch": 42}
{"loss": 0.15924236178398132, "acc": 0.9501689672470093, "length": 3.4650349617004395, "mode": "test", "epoch": 42}
{"loss": 0.1706518828868866, "acc": 0.9322793483734131, "length": 3.437798261642456, "mode": "train", "epoch": 43}
{"loss": 0.17520315945148468, "acc": 0.934982180595398, "length": 3.416083812713623, "mode": "test", "epoch": 43}
{"loss": 0.15702281892299652, "acc": 0.9418888092041016, "length": 3.4824905395507812, "mode": "train", "epoch": 44}
{"loss": 0.18673624098300934, "acc": 0.9424060583114624, "length": 3.576923131942749, "mode": "test", "epoch": 44}
{"loss": 0.15390175580978394, "acc": 0.9458293914794922, "length": 3.489607095718384, "mode": "train", "epoch": 45}
{"loss": 0.1408803015947342, "acc": 0.9551383852958679, "length": 3.5419580936431885, "mode": "test", "epoch": 45}
{"loss": 0.14210915565490723, "acc": 0.9492855072021484, "length": 3.4729421138763428, "mode": "train", "epoch": 46}
{"loss": 0.13623373210430145, "acc": 0.9598874449729919, "length": 3.6328670978546143, "mode": "test", "epoch": 46}
{"loss": 0.13760559260845184, "acc": 0.9502711296081543, "length": 3.4622511863708496, "mode": "train", "epoch": 47}
{"loss": 0.14583279192447662, "acc": 0.9561949968338013, "length": 3.552447557449341, "mode": "test", "epoch": 47}
{"loss": 0.13084445893764496, "acc": 0.9554306268692017, "length": 3.4756948947906494, "mode": "train", "epoch": 48}
{"loss": 0.13982856273651123, "acc": 0.9616183042526245, "length": 3.4895105361938477, "mode": "test", "epoch": 48}
{"loss": 0.13418564200401306, "acc": 0.9517063498497009, "length": 3.4613053798675537, "mode": "train", "epoch": 49}
{"loss": 0.11114604026079178, "acc": 0.9652561545372009, "length": 3.5559439659118652, "mode": "test", "epoch": 49}
{"loss": 0.1269739866256714, "acc": 0.9557797908782959, "length": 3.4658665657043457, "mode": "train", "epoch": 50}
{"loss": 0.1150742918252945, "acc": 0.9636927247047424, "length": 3.524475574493408, "mode": "test", "epoch": 50}
{"loss": 0.12581156194210052, "acc": 0.9552792310714722, "length": 3.498867988586426, "mode": "train", "epoch": 51}
{"loss": 0.11750352382659912, "acc": 0.9648191928863525, "length": 3.5734264850616455, "mode": "test", "epoch": 51}
{"loss": 0.11544280499219894, "acc": 0.9604108333587646, "length": 3.527919054031372, "mode": "train", "epoch": 52}
{"loss": 0.1364179253578186, "acc": 0.9632819890975952, "length": 3.552447557449341, "mode": "test", "epoch": 52}
{"loss": 0.12815554440021515, "acc": 0.9572885632514954, "length": 3.4975976943969727, "mode": "train", "epoch": 53}
{"loss": 0.1293846070766449, "acc": 0.9618570804595947, "length": 3.6048951148986816, "mode": "test", "epoch": 53}
{"loss": 0.12652137875556946, "acc": 0.9552822709083557, "length": 3.442828416824341, "mode": "train", "epoch": 54}
{"loss": 0.12527890503406525, "acc": 0.9577783942222595, "length": 3.576923131942749, "mode": "test", "epoch": 54}
{"loss": 0.1199379488825798, "acc": 0.959619402885437, "length": 3.4841561317443848, "mode": "train", "epoch": 55}
{"loss": 0.09746939688920975, "acc": 0.9661410450935364, "length": 3.538461446762085, "mode": "test", "epoch": 55}
{"loss": 0.1063435971736908, "acc": 0.9616044759750366, "length": 3.4734559059143066, "mode": "train", "epoch": 56}
{"loss": 0.09891565144062042, "acc": 0.9673506617546082, "length": 3.545454502105713, "mode": "test", "epoch": 56}
{"loss": 0.10835029184818268, "acc": 0.9625251889228821, "length": 3.445322275161743, "mode": "train", "epoch": 57}
{"loss": 0.10477524250745773, "acc": 0.9618116021156311, "length": 3.5279719829559326, "mode": "test", "epoch": 57}
{"loss": 0.10404883325099945, "acc": 0.9633375406265259, "length": 3.4711568355560303, "mode": "train", "epoch": 58}
{"loss": 0.10133419930934906, "acc": 0.9664602279663086, "length": 3.5734264850616455, "mode": "test", "epoch": 58}
{"loss": 0.10575742274522781, "acc": 0.9634760618209839, "length": 3.477233409881592, "mode": "train", "epoch": 59}
{"loss": 0.10679130256175995, "acc": 0.9631279110908508, "length": 3.5489511489868164, "mode": "test", "epoch": 59}
{"loss": 0.10454166680574417, "acc": 0.9627178311347961, "length": 3.465538501739502, "mode": "train", "epoch": 60}
{"loss": 0.08954339474439621, "acc": 0.9710701107978821, "length": 3.5594406127929688, "mode": "test", "epoch": 60}
test accuracy: 0.8114843368530273
