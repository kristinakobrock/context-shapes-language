# ["--attributes=5", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.0005", "--hidden_size=128", "--temp_update=0.99", "--temperature=2"]
Creating train_ds and val_ds...

Creating test_ds...
{"loss": 0.6968515515327454, "acc": 0.5109128952026367, "length": 3.5227136611938477, "mode": "train", "epoch": 1}
{"loss": 0.6856110095977783, "acc": 0.5680723190307617, "length": 1.2049469947814941, "mode": "test", "epoch": 1}
{"loss": 0.6870075464248657, "acc": 0.5527690052986145, "length": 3.2640492916107178, "mode": "train", "epoch": 2}
{"loss": 0.6441767811775208, "acc": 0.677128255367279, "length": 3.724381685256958, "mode": "test", "epoch": 2}
{"loss": 0.6259152293205261, "acc": 0.6852450966835022, "length": 3.6258413791656494, "mode": "train", "epoch": 3}
{"loss": 0.5339921116828918, "acc": 0.7722615599632263, "length": 4.0, "mode": "test", "epoch": 3}
{"loss": 0.5089104771614075, "acc": 0.757931113243103, "length": 3.90964412689209, "mode": "train", "epoch": 4}
{"loss": 0.48964357376098633, "acc": 0.7814487814903259, "length": 4.0, "mode": "test", "epoch": 4}
{"loss": 0.4657455384731293, "acc": 0.7828745245933533, "length": 3.9563374519348145, "mode": "train", "epoch": 5}
{"loss": 0.4666760265827179, "acc": 0.8056536912918091, "length": 4.0, "mode": "test", "epoch": 5}
{"loss": 0.4393773078918457, "acc": 0.8083261847496033, "length": 3.9664957523345947, "mode": "train", "epoch": 6}
{"loss": 0.46769338846206665, "acc": 0.8111308813095093, "length": 4.0, "mode": "test", "epoch": 6}
{"loss": 0.4079627990722656, "acc": 0.814663827419281, "length": 3.9750916957855225, "mode": "train", "epoch": 7}
{"loss": 0.4397002160549164, "acc": 0.8060070276260376, "length": 4.0, "mode": "test", "epoch": 7}
{"loss": 0.37802326679229736, "acc": 0.8335617184638977, "length": 3.9812979698181152, "mode": "train", "epoch": 8}
{"loss": 0.4343225955963135, "acc": 0.818551242351532, "length": 4.0, "mode": "test", "epoch": 8}
{"loss": 0.3551315367221832, "acc": 0.8489962816238403, "length": 3.979161262512207, "mode": "train", "epoch": 9}
{"loss": 0.4192480146884918, "acc": 0.8229683041572571, "length": 4.0, "mode": "test", "epoch": 9}
{"loss": 0.34117740392684937, "acc": 0.854775071144104, "length": 3.9787309169769287, "mode": "train", "epoch": 10}
{"loss": 0.425160676240921, "acc": 0.818374514579773, "length": 4.0, "mode": "test", "epoch": 10}
{"loss": 0.3241029977798462, "acc": 0.8666988611221313, "length": 3.9827044010162354, "mode": "train", "epoch": 11}
{"loss": 0.3939351737499237, "acc": 0.8385159373283386, "length": 4.0, "mode": "test", "epoch": 11}
{"loss": 0.3129752278327942, "acc": 0.8722098469734192, "length": 3.985361099243164, "mode": "train", "epoch": 12}
{"loss": 0.40329891443252563, "acc": 0.8295052647590637, "length": 4.0, "mode": "test", "epoch": 12}
{"loss": 0.3067428469657898, "acc": 0.8704678416252136, "length": 3.9880471229553223, "mode": "train", "epoch": 13}
{"loss": 0.40075865387916565, "acc": 0.8388693332672119, "length": 4.0, "mode": "test", "epoch": 13}
{"loss": 0.30204522609710693, "acc": 0.8771207332611084, "length": 3.989509105682373, "mode": "train", "epoch": 14}
{"loss": 0.40101829171180725, "acc": 0.8395758867263794, "length": 4.0, "mode": "test", "epoch": 14}
{"loss": 0.2909398376941681, "acc": 0.8788472414016724, "length": 3.9916656017303467, "mode": "train", "epoch": 15}
{"loss": 0.3816273510456085, "acc": 0.8461131453514099, "length": 4.0, "mode": "test", "epoch": 15}
{"loss": 0.2834762930870056, "acc": 0.8894148468971252, "length": 3.992856502532959, "mode": "train", "epoch": 16}
{"loss": 0.3921865224838257, "acc": 0.8469964265823364, "length": 4.0, "mode": "test", "epoch": 16}
{"loss": 0.2738416790962219, "acc": 0.886472761631012, "length": 3.9928884506225586, "mode": "train", "epoch": 17}
{"loss": 0.40561461448669434, "acc": 0.8386926054954529, "length": 4.0, "mode": "test", "epoch": 17}
{"loss": 0.2676442563533783, "acc": 0.8872210383415222, "length": 3.994717597961426, "mode": "train", "epoch": 18}
{"loss": 0.40540632605552673, "acc": 0.8477032780647278, "length": 4.0, "mode": "test", "epoch": 18}
{"loss": 0.2623502314090729, "acc": 0.8947760462760925, "length": 3.995358943939209, "mode": "train", "epoch": 19}
{"loss": 0.38266292214393616, "acc": 0.8492932319641113, "length": 4.0, "mode": "test", "epoch": 19}
{"loss": 0.2497897893190384, "acc": 0.8992823362350464, "length": 3.9961326122283936, "mode": "train", "epoch": 20}
{"loss": 0.3735143542289734, "acc": 0.8583037853240967, "length": 4.0, "mode": "test", "epoch": 20}
{"loss": 0.24560163915157318, "acc": 0.9031052589416504, "length": 3.9959347248077393, "mode": "train", "epoch": 21}
{"loss": 0.3397690951824188, "acc": 0.8628975749015808, "length": 4.0, "mode": "test", "epoch": 21}
{"loss": 0.23518505692481995, "acc": 0.9112866520881653, "length": 3.9970085620880127, "mode": "train", "epoch": 22}
{"loss": 0.3260038197040558, "acc": 0.8637808561325073, "length": 4.0, "mode": "test", "epoch": 22}
{"loss": 0.224272683262825, "acc": 0.9143508672714233, "length": 3.9970788955688477, "mode": "train", "epoch": 23}
{"loss": 0.3422631621360779, "acc": 0.862190842628479, "length": 4.0, "mode": "test", "epoch": 23}
{"loss": 0.21563288569450378, "acc": 0.916317343711853, "length": 3.997431755065918, "mode": "train", "epoch": 24}
{"loss": 0.31728899478912354, "acc": 0.8713781237602234, "length": 4.0, "mode": "test", "epoch": 24}
{"loss": 0.2105276733636856, "acc": 0.9152460694313049, "length": 3.9971907138824463, "mode": "train", "epoch": 25}
{"loss": 0.3151301443576813, "acc": 0.8703179955482483, "length": 4.0, "mode": "test", "epoch": 25}
{"loss": 0.21146079897880554, "acc": 0.9167470335960388, "length": 3.9977543354034424, "mode": "train", "epoch": 26}
{"loss": 0.31645020842552185, "acc": 0.8756183981895447, "length": 4.0, "mode": "test", "epoch": 26}
{"loss": 0.20938189327716827, "acc": 0.9181177616119385, "length": 3.9981906414031982, "mode": "train", "epoch": 27}
{"loss": 0.3055354952812195, "acc": 0.884099006652832, "length": 4.0, "mode": "test", "epoch": 27}
{"loss": 0.19851946830749512, "acc": 0.9230008721351624, "length": 3.9977853298187256, "mode": "train", "epoch": 28}
{"loss": 0.30896806716918945, "acc": 0.8745583891868591, "length": 4.0, "mode": "test", "epoch": 28}
{"loss": 0.18988096714019775, "acc": 0.9284278750419617, "length": 3.99769926071167, "mode": "train", "epoch": 29}
{"loss": 0.3006766438484192, "acc": 0.8780921101570129, "length": 4.0, "mode": "test", "epoch": 29}
{"loss": 0.18772651255130768, "acc": 0.9250397682189941, "length": 3.998384714126587, "mode": "train", "epoch": 30}
{"loss": 0.2850889563560486, "acc": 0.8860424757003784, "length": 4.0, "mode": "test", "epoch": 30}
{"loss": 0.1914968192577362, "acc": 0.9254412651062012, "length": 3.998281240463257, "mode": "train", "epoch": 31}
{"loss": 0.3019399046897888, "acc": 0.8858656883239746, "length": 4.0, "mode": "test", "epoch": 31}
{"loss": 0.18515512347221375, "acc": 0.9279782772064209, "length": 3.9980595111846924, "mode": "train", "epoch": 32}
{"loss": 0.28166908025741577, "acc": 0.8871025443077087, "length": 4.0, "mode": "test", "epoch": 32}
{"loss": 0.17715831100940704, "acc": 0.9319533109664917, "length": 3.9987244606018066, "mode": "train", "epoch": 33}
{"loss": 0.26828187704086304, "acc": 0.8886926174163818, "length": 4.0, "mode": "test", "epoch": 33}
{"loss": 0.17211303114891052, "acc": 0.9346688985824585, "length": 3.998845338821411, "mode": "train", "epoch": 34}
{"loss": 0.27677324414253235, "acc": 0.8971732258796692, "length": 4.0, "mode": "test", "epoch": 34}
{"loss": 0.17192374169826508, "acc": 0.9348904490470886, "length": 3.9985954761505127, "mode": "train", "epoch": 35}
{"loss": 0.27944818139076233, "acc": 0.8980566263198853, "length": 4.0, "mode": "test", "epoch": 35}
{"loss": 0.16690614819526672, "acc": 0.9326372146606445, "length": 3.998422861099243, "mode": "train", "epoch": 36}
{"loss": 0.2565295696258545, "acc": 0.9015901684761047, "length": 4.0, "mode": "test", "epoch": 36}
{"loss": 0.16760121285915375, "acc": 0.9351385831832886, "length": 3.9989047050476074, "mode": "train", "epoch": 37}
{"loss": 0.23837073147296906, "acc": 0.9053002595901489, "length": 4.0, "mode": "test", "epoch": 37}
{"loss": 0.15135422348976135, "acc": 0.9444155097007751, "length": 3.9989378452301025, "mode": "train", "epoch": 38}
{"loss": 0.22717952728271484, "acc": 0.916254460811615, "length": 4.0, "mode": "test", "epoch": 38}
{"loss": 0.15169669687747955, "acc": 0.9419872164726257, "length": 3.9988901615142822, "mode": "train", "epoch": 39}
{"loss": 0.2221371829509735, "acc": 0.9102475047111511, "length": 4.0, "mode": "test", "epoch": 39}
{"loss": 0.148539736866951, "acc": 0.9439952969551086, "length": 3.998849868774414, "mode": "train", "epoch": 40}
{"loss": 0.2202116996049881, "acc": 0.9213780760765076, "length": 4.0, "mode": "test", "epoch": 40}
{"loss": 0.1402321606874466, "acc": 0.9468238949775696, "length": 3.998678684234619, "mode": "train", "epoch": 41}
{"loss": 0.24491222202777863, "acc": 0.905123770236969, "length": 4.0, "mode": "test", "epoch": 41}
{"loss": 0.1361413300037384, "acc": 0.9492053389549255, "length": 3.999208688735962, "mode": "train", "epoch": 42}
{"loss": 0.21414297819137573, "acc": 0.9141343235969543, "length": 4.0, "mode": "test", "epoch": 42}
{"loss": 0.13323694467544556, "acc": 0.9526897072792053, "length": 3.999377489089966, "mode": "train", "epoch": 43}
{"loss": 0.207138329744339, "acc": 0.9123675227165222, "length": 4.0, "mode": "test", "epoch": 43}
{"loss": 0.12726452946662903, "acc": 0.9529781937599182, "length": 3.999162197113037, "mode": "train", "epoch": 44}
{"loss": 0.20183797180652618, "acc": 0.920318067073822, "length": 4.0, "mode": "test", "epoch": 44}
{"loss": 0.12721891701221466, "acc": 0.9533848762512207, "length": 3.999021053314209, "mode": "train", "epoch": 45}
{"loss": 0.2013559341430664, "acc": 0.9265018105506897, "length": 4.0, "mode": "test", "epoch": 45}
{"loss": 0.12705379724502563, "acc": 0.9508642554283142, "length": 3.9994869232177734, "mode": "train", "epoch": 46}
{"loss": 0.21197199821472168, "acc": 0.9240282773971558, "length": 4.0, "mode": "test", "epoch": 46}
{"loss": 0.1257418394088745, "acc": 0.9531629085540771, "length": 3.9993419647216797, "mode": "train", "epoch": 47}
{"loss": 0.2033112347126007, "acc": 0.9231448769569397, "length": 4.0, "mode": "test", "epoch": 47}
{"loss": 0.1139356717467308, "acc": 0.9587808847427368, "length": 3.9996066093444824, "mode": "train", "epoch": 48}
{"loss": 0.1864890605211258, "acc": 0.9323321580886841, "length": 4.0, "mode": "test", "epoch": 48}
{"loss": 0.11582206189632416, "acc": 0.9599021077156067, "length": 3.999574661254883, "mode": "train", "epoch": 49}
{"loss": 0.19821305572986603, "acc": 0.923675000667572, "length": 4.0, "mode": "test", "epoch": 49}
{"loss": 0.11504907160997391, "acc": 0.957538366317749, "length": 3.99948787689209, "mode": "train", "epoch": 50}
{"loss": 0.18293727934360504, "acc": 0.9319788813591003, "length": 4.0, "mode": "test", "epoch": 50}
{"loss": 0.12569762766361237, "acc": 0.9544625282287598, "length": 3.999044418334961, "mode": "train", "epoch": 51}
{"loss": 0.19525763392448425, "acc": 0.9279152154922485, "length": 4.0, "mode": "test", "epoch": 51}
{"loss": 0.11881846934556961, "acc": 0.9547685980796814, "length": 3.9996449947357178, "mode": "train", "epoch": 52}
{"loss": 0.19476397335529327, "acc": 0.9242051243782043, "length": 4.0, "mode": "test", "epoch": 52}
{"loss": 0.11285395920276642, "acc": 0.9580684304237366, "length": 3.9995484352111816, "mode": "train", "epoch": 53}
{"loss": 0.1718825250864029, "acc": 0.9316253066062927, "length": 4.0, "mode": "test", "epoch": 53}
{"loss": 0.11324618011713028, "acc": 0.9583068490028381, "length": 3.9993484020233154, "mode": "train", "epoch": 54}
{"loss": 0.17613808810710907, "acc": 0.9392228126525879, "length": 4.0, "mode": "test", "epoch": 54}
{"loss": 0.10300807654857635, "acc": 0.9635492563247681, "length": 3.99937105178833, "mode": "train", "epoch": 55}
{"loss": 0.17511270940303802, "acc": 0.9372792840003967, "length": 4.0, "mode": "test", "epoch": 55}
{"loss": 0.10104750096797943, "acc": 0.9625078439712524, "length": 3.999819755554199, "mode": "train", "epoch": 56}
{"loss": 0.1585662066936493, "acc": 0.9385159015655518, "length": 4.0, "mode": "test", "epoch": 56}
{"loss": 0.10050088167190552, "acc": 0.9638647437095642, "length": 3.999765634536743, "mode": "train", "epoch": 57}
{"loss": 0.17158624529838562, "acc": 0.9409893751144409, "length": 4.0, "mode": "test", "epoch": 57}
{"loss": 0.09903836995363235, "acc": 0.9657492637634277, "length": 3.9997167587280273, "mode": "train", "epoch": 58}
{"loss": 0.16853636503219604, "acc": 0.9348058104515076, "length": 4.0, "mode": "test", "epoch": 58}
{"loss": 0.09802320599555969, "acc": 0.9653372168540955, "length": 3.999455213546753, "mode": "train", "epoch": 59}
{"loss": 0.15556910634040833, "acc": 0.9415193796157837, "length": 4.0, "mode": "test", "epoch": 59}
{"loss": 0.09282750636339188, "acc": 0.966754674911499, "length": 3.999804973602295, "mode": "train", "epoch": 60}
{"loss": 0.16464412212371826, "acc": 0.9436397552490234, "length": 4.0, "mode": "test", "epoch": 60}
test accuracy: 0.8122581243515015
