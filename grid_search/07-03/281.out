# ["--attributes=5", "--values=16", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=128", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.99", "--temperature=2"]
Creating train_ds and val_ds...

Creating test_ds...
{"loss": 0.6938452124595642, "acc": 0.5229131579399109, "length": 3.5271658897399902, "mode": "train", "epoch": 1}
{"loss": 0.6961324214935303, "acc": 0.498263955116272, "length": 1.0, "mode": "test", "epoch": 1}
{"loss": 0.6918125748634338, "acc": 0.5318158864974976, "length": 3.463233709335327, "mode": "train", "epoch": 2}
{"loss": 0.6923679113388062, "acc": 0.5267564058303833, "length": 1.0486111640930176, "mode": "test", "epoch": 2}
{"loss": 0.6869145631790161, "acc": 0.5500701665878296, "length": 3.32572340965271, "mode": "train", "epoch": 3}
{"loss": 0.6837124228477478, "acc": 0.5824991464614868, "length": 1.3680555820465088, "mode": "test", "epoch": 3}
{"loss": 0.6811555027961731, "acc": 0.5769556760787964, "length": 3.1300714015960693, "mode": "train", "epoch": 4}
{"loss": 0.6702551245689392, "acc": 0.6513332724571228, "length": 2.0, "mode": "test", "epoch": 4}
{"loss": 0.6606099009513855, "acc": 0.6490008234977722, "length": 3.266176700592041, "mode": "train", "epoch": 5}
{"loss": 0.6246957778930664, "acc": 0.6937160491943359, "length": 3.5729167461395264, "mode": "test", "epoch": 5}
{"loss": 0.6182979941368103, "acc": 0.7130043506622314, "length": 3.5530405044555664, "mode": "train", "epoch": 6}
{"loss": 0.5720561742782593, "acc": 0.7409722805023193, "length": 4.0, "mode": "test", "epoch": 6}
{"loss": 0.5469187498092651, "acc": 0.7675005197525024, "length": 3.7901804447174072, "mode": "train", "epoch": 7}
{"loss": 0.5195916891098022, "acc": 0.7828124165534973, "length": 4.0, "mode": "test", "epoch": 7}
{"loss": 0.47613397240638733, "acc": 0.7853113412857056, "length": 3.9055747985839844, "mode": "train", "epoch": 8}
{"loss": 0.4965319037437439, "acc": 0.7973958849906921, "length": 4.0, "mode": "test", "epoch": 8}
{"loss": 0.44183623790740967, "acc": 0.802535355091095, "length": 3.9437410831451416, "mode": "train", "epoch": 9}
{"loss": 0.5023901462554932, "acc": 0.7998263835906982, "length": 4.0, "mode": "test", "epoch": 9}
{"loss": 0.4277478754520416, "acc": 0.815595805644989, "length": 3.9490163326263428, "mode": "train", "epoch": 10}
{"loss": 0.47458064556121826, "acc": 0.8052083849906921, "length": 4.0, "mode": "test", "epoch": 10}
{"loss": 0.407602459192276, "acc": 0.818716287612915, "length": 3.9510488510131836, "mode": "train", "epoch": 11}
{"loss": 0.4384744167327881, "acc": 0.8295139074325562, "length": 4.0, "mode": "test", "epoch": 11}
{"loss": 0.3876672685146332, "acc": 0.827373743057251, "length": 3.952744722366333, "mode": "train", "epoch": 12}
{"loss": 0.42807242274284363, "acc": 0.8305554986000061, "length": 4.0, "mode": "test", "epoch": 12}
{"loss": 0.3684568703174591, "acc": 0.8384038209915161, "length": 3.955697774887085, "mode": "train", "epoch": 13}
{"loss": 0.4125579595565796, "acc": 0.840624988079071, "length": 4.0, "mode": "test", "epoch": 13}
{"loss": 0.34844568371772766, "acc": 0.8486600518226624, "length": 3.9601798057556152, "mode": "train", "epoch": 14}
{"loss": 0.41796618700027466, "acc": 0.8421876430511475, "length": 4.0, "mode": "test", "epoch": 14}
{"loss": 0.3254217505455017, "acc": 0.8611540198326111, "length": 3.9671342372894287, "mode": "train", "epoch": 15}
{"loss": 0.4062226414680481, "acc": 0.8407986760139465, "length": 4.0, "mode": "test", "epoch": 15}
{"loss": 0.30638810992240906, "acc": 0.866062343120575, "length": 3.9755642414093018, "mode": "train", "epoch": 16}
{"loss": 0.4067617356777191, "acc": 0.8461804986000061, "length": 4.0, "mode": "test", "epoch": 16}
{"loss": 0.289228618144989, "acc": 0.8771434426307678, "length": 3.9801859855651855, "mode": "train", "epoch": 17}
{"loss": 0.40057703852653503, "acc": 0.8579860925674438, "length": 4.0, "mode": "test", "epoch": 17}
{"loss": 0.26885372400283813, "acc": 0.8877649307250977, "length": 3.98399019241333, "mode": "train", "epoch": 18}
{"loss": 0.3683062195777893, "acc": 0.8600693345069885, "length": 4.0, "mode": "test", "epoch": 18}
{"loss": 0.2506248652935028, "acc": 0.8996482491493225, "length": 3.986985445022583, "mode": "train", "epoch": 19}
{"loss": 0.3859659433364868, "acc": 0.865451455116272, "length": 4.0, "mode": "test", "epoch": 19}
{"loss": 0.23358625173568726, "acc": 0.9099594950675964, "length": 3.9883999824523926, "mode": "train", "epoch": 20}
{"loss": 0.3405866026878357, "acc": 0.8791666030883789, "length": 4.0, "mode": "test", "epoch": 20}
{"loss": 0.21643581986427307, "acc": 0.9181875586509705, "length": 3.9908931255340576, "mode": "train", "epoch": 21}
{"loss": 0.3770431876182556, "acc": 0.8793402314186096, "length": 4.0, "mode": "test", "epoch": 21}
{"loss": 0.20734091103076935, "acc": 0.9268937110900879, "length": 3.992943048477173, "mode": "train", "epoch": 22}
{"loss": 0.38342925906181335, "acc": 0.8734375834465027, "length": 4.0, "mode": "test", "epoch": 22}
{"loss": 0.19642142951488495, "acc": 0.9266122579574585, "length": 3.993950605392456, "mode": "train", "epoch": 23}
{"loss": 0.34297579526901245, "acc": 0.8753471970558167, "length": 4.0, "mode": "test", "epoch": 23}
{"loss": 0.19172604382038116, "acc": 0.9342822432518005, "length": 3.993758201599121, "mode": "train", "epoch": 24}
{"loss": 0.36229032278060913, "acc": 0.8824653029441833, "length": 4.0, "mode": "test", "epoch": 24}
{"loss": 0.1836748868227005, "acc": 0.933529257774353, "length": 3.995701313018799, "mode": "train", "epoch": 25}
{"loss": 0.34131020307540894, "acc": 0.8894097805023193, "length": 4.0, "mode": "test", "epoch": 25}
{"loss": 0.1816905438899994, "acc": 0.9362447261810303, "length": 3.9957594871520996, "mode": "train", "epoch": 26}
{"loss": 0.3403509557247162, "acc": 0.8838542103767395, "length": 4.0, "mode": "test", "epoch": 26}
{"loss": 0.1802070438861847, "acc": 0.934837818145752, "length": 3.9952597618103027, "mode": "train", "epoch": 27}
{"loss": 0.3304164409637451, "acc": 0.8868056535720825, "length": 4.0, "mode": "test", "epoch": 27}
{"loss": 0.17755259573459625, "acc": 0.9402115941047668, "length": 3.9965991973876953, "mode": "train", "epoch": 28}
{"loss": 0.31318944692611694, "acc": 0.8887151479721069, "length": 4.0, "mode": "test", "epoch": 28}
{"loss": 0.178235724568367, "acc": 0.9383568167686462, "length": 3.996936559677124, "mode": "train", "epoch": 29}
{"loss": 0.314917653799057, "acc": 0.894618034362793, "length": 4.0, "mode": "test", "epoch": 29}
{"loss": 0.17594276368618011, "acc": 0.9388378262519836, "length": 3.9970216751098633, "mode": "train", "epoch": 30}
{"loss": 0.29169830679893494, "acc": 0.8946181535720825, "length": 4.0, "mode": "test", "epoch": 30}
{"loss": 0.17091307044029236, "acc": 0.9400021433830261, "length": 3.99721622467041, "mode": "train", "epoch": 31}
{"loss": 0.29440951347351074, "acc": 0.8953125476837158, "length": 4.0, "mode": "test", "epoch": 31}
{"loss": 0.16578549146652222, "acc": 0.9407514333724976, "length": 3.997105121612549, "mode": "train", "epoch": 32}
{"loss": 0.2713022530078888, "acc": 0.8999999165534973, "length": 4.0, "mode": "test", "epoch": 32}
{"loss": 0.16194969415664673, "acc": 0.9406663179397583, "length": 3.998089075088501, "mode": "train", "epoch": 33}
{"loss": 0.2761675715446472, "acc": 0.8921874165534973, "length": 4.0, "mode": "test", "epoch": 33}
{"loss": 0.15806594491004944, "acc": 0.9454248547554016, "length": 3.997910261154175, "mode": "train", "epoch": 34}
{"loss": 0.30241474509239197, "acc": 0.8852431774139404, "length": 4.0, "mode": "test", "epoch": 34}
{"loss": 0.15791845321655273, "acc": 0.9444987177848816, "length": 3.9982473850250244, "mode": "train", "epoch": 35}
{"loss": 0.26473259925842285, "acc": 0.911458432674408, "length": 4.0, "mode": "test", "epoch": 35}
{"loss": 0.15016941726207733, "acc": 0.9487985968589783, "length": 3.998577117919922, "mode": "train", "epoch": 36}
{"loss": 0.2611860930919647, "acc": 0.910590410232544, "length": 4.0, "mode": "test", "epoch": 36}
{"loss": 0.1502557247877121, "acc": 0.94410640001297, "length": 3.9986798763275146, "mode": "train", "epoch": 37}
{"loss": 0.24962317943572998, "acc": 0.9135416746139526, "length": 4.0, "mode": "test", "epoch": 37}
{"loss": 0.14331603050231934, "acc": 0.9482799172401428, "length": 3.9986789226531982, "mode": "train", "epoch": 38}
{"loss": 0.24789297580718994, "acc": 0.9116320013999939, "length": 4.0, "mode": "test", "epoch": 38}
{"loss": 0.1419331431388855, "acc": 0.9500810503959656, "length": 3.9987149238586426, "mode": "train", "epoch": 39}
{"loss": 0.22652769088745117, "acc": 0.9131944179534912, "length": 4.0, "mode": "test", "epoch": 39}
{"loss": 0.1378428339958191, "acc": 0.951761782169342, "length": 3.998720407485962, "mode": "train", "epoch": 40}
{"loss": 0.2390059232711792, "acc": 0.9092013239860535, "length": 4.0, "mode": "test", "epoch": 40}
{"loss": 0.13700786232948303, "acc": 0.9511798024177551, "length": 3.9986367225646973, "mode": "train", "epoch": 41}
{"loss": 0.23262545466423035, "acc": 0.9125000834465027, "length": 4.0, "mode": "test", "epoch": 41}
{"loss": 0.13300655782222748, "acc": 0.9538439512252808, "length": 3.998713493347168, "mode": "train", "epoch": 42}
{"loss": 0.23228204250335693, "acc": 0.9138888120651245, "length": 4.0, "mode": "test", "epoch": 42}
{"loss": 0.13056078553199768, "acc": 0.9551936984062195, "length": 3.9990766048431396, "mode": "train", "epoch": 43}
{"loss": 0.2066306471824646, "acc": 0.9175348281860352, "length": 4.0, "mode": "test", "epoch": 43}
{"loss": 0.12822481989860535, "acc": 0.95565265417099, "length": 3.9989407062530518, "mode": "train", "epoch": 44}
{"loss": 0.20943543314933777, "acc": 0.9194445013999939, "length": 4.0, "mode": "test", "epoch": 44}
{"loss": 0.12024252116680145, "acc": 0.9560103416442871, "length": 3.999204635620117, "mode": "train", "epoch": 45}
{"loss": 0.20212307572364807, "acc": 0.9222221374511719, "length": 4.0, "mode": "test", "epoch": 45}
{"loss": 0.11837819963693619, "acc": 0.9584856629371643, "length": 3.9983694553375244, "mode": "train", "epoch": 46}
{"loss": 0.20395192503929138, "acc": 0.9196180701255798, "length": 4.0, "mode": "test", "epoch": 46}
{"loss": 0.11801991611719131, "acc": 0.9564138054847717, "length": 3.9989824295043945, "mode": "train", "epoch": 47}
{"loss": 0.2143460363149643, "acc": 0.9295138120651245, "length": 4.0, "mode": "test", "epoch": 47}
{"loss": 0.11668125540018082, "acc": 0.9550247192382812, "length": 3.9991214275360107, "mode": "train", "epoch": 48}
{"loss": 0.1657724380493164, "acc": 0.9315972924232483, "length": 4.0, "mode": "test", "epoch": 48}
{"loss": 0.11226387321949005, "acc": 0.9606497287750244, "length": 3.9991443157196045, "mode": "train", "epoch": 49}
{"loss": 0.17526552081108093, "acc": 0.9269096851348877, "length": 4.0, "mode": "test", "epoch": 49}
{"loss": 0.10360237210988998, "acc": 0.9632448554039001, "length": 3.99869441986084, "mode": "train", "epoch": 50}
{"loss": 0.21071910858154297, "acc": 0.9298611879348755, "length": 4.0, "mode": "test", "epoch": 50}
{"loss": 0.10429919511079788, "acc": 0.9614599347114563, "length": 3.998990535736084, "mode": "train", "epoch": 51}
{"loss": 0.1812385618686676, "acc": 0.9375, "length": 4.0, "mode": "test", "epoch": 51}
{"loss": 0.09422606974840164, "acc": 0.9668596386909485, "length": 3.999272584915161, "mode": "train", "epoch": 52}
{"loss": 0.16376394033432007, "acc": 0.9402778148651123, "length": 4.0, "mode": "test", "epoch": 52}
{"loss": 0.0907975360751152, "acc": 0.9685814380645752, "length": 3.9988083839416504, "mode": "train", "epoch": 53}
{"loss": 0.15626470744609833, "acc": 0.947916567325592, "length": 4.0, "mode": "test", "epoch": 53}
{"loss": 0.09010789543390274, "acc": 0.9665680527687073, "length": 3.999138355255127, "mode": "train", "epoch": 54}
{"loss": 0.16191443800926208, "acc": 0.9428820013999939, "length": 4.0, "mode": "test", "epoch": 54}
{"loss": 0.08455140143632889, "acc": 0.9706237316131592, "length": 3.999166965484619, "mode": "train", "epoch": 55}
{"loss": 0.16095083951950073, "acc": 0.9456597566604614, "length": 4.0, "mode": "test", "epoch": 55}
{"loss": 0.08626727014780045, "acc": 0.9708625674247742, "length": 3.9991300106048584, "mode": "train", "epoch": 56}
{"loss": 0.16966430842876434, "acc": 0.9447916746139526, "length": 4.0, "mode": "test", "epoch": 56}
{"loss": 0.07996765524148941, "acc": 0.9717366099357605, "length": 3.9994871616363525, "mode": "train", "epoch": 57}
{"loss": 0.16980069875717163, "acc": 0.943923830986023, "length": 4.0, "mode": "test", "epoch": 57}
{"loss": 0.08409108966588974, "acc": 0.9683113694190979, "length": 3.999420404434204, "mode": "train", "epoch": 58}
{"loss": 0.16497758030891418, "acc": 0.9435763955116272, "length": 4.0, "mode": "test", "epoch": 58}
{"loss": 0.08077479898929596, "acc": 0.96826171875, "length": 3.9996249675750732, "mode": "train", "epoch": 59}
{"loss": 0.16580095887184143, "acc": 0.9477429986000061, "length": 4.0, "mode": "test", "epoch": 59}
{"loss": 0.07642105966806412, "acc": 0.9723122119903564, "length": 3.9994120597839355, "mode": "train", "epoch": 60}
{"loss": 0.1521519124507904, "acc": 0.9451388120651245, "length": 4.0, "mode": "test", "epoch": 60}
test accuracy: 0.802413821220398
