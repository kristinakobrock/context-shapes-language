# ["--attributes=5", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=64", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.99", "--temperature=1"]
Creating train_ds and val_ds...

Creating test_ds...
{"loss": 0.6961576342582703, "acc": 0.5197123885154724, "length": 3.5231266021728516, "mode": "train", "epoch": 1}
{"loss": 0.6884557008743286, "acc": 0.5364384055137634, "length": 1.3917526006698608, "mode": "test", "epoch": 1}
{"loss": 0.6797086596488953, "acc": 0.5690471529960632, "length": 3.3436527252197266, "mode": "train", "epoch": 2}
{"loss": 0.6463438868522644, "acc": 0.6775102019309998, "length": 3.855670213699341, "mode": "test", "epoch": 2}
{"loss": 0.6095567941665649, "acc": 0.6875068545341492, "length": 3.787444591522217, "mode": "train", "epoch": 3}
{"loss": 0.5954112410545349, "acc": 0.6651201248168945, "length": 4.0, "mode": "test", "epoch": 3}
{"loss": 0.5685155391693115, "acc": 0.6937011480331421, "length": 3.9690911769866943, "mode": "train", "epoch": 4}
{"loss": 0.5674104690551758, "acc": 0.6881443858146667, "length": 4.0, "mode": "test", "epoch": 4}
{"loss": 0.5414683818817139, "acc": 0.7387783527374268, "length": 3.970109462738037, "mode": "train", "epoch": 5}
{"loss": 0.5415636301040649, "acc": 0.7226804494857788, "length": 4.0, "mode": "test", "epoch": 5}
{"loss": 0.5112707614898682, "acc": 0.7587282657623291, "length": 3.9750845432281494, "mode": "train", "epoch": 6}
{"loss": 0.49953338503837585, "acc": 0.7486254572868347, "length": 4.0, "mode": "test", "epoch": 6}
{"loss": 0.4790106415748596, "acc": 0.7601940631866455, "length": 3.9866185188293457, "mode": "train", "epoch": 7}
{"loss": 0.49599623680114746, "acc": 0.7702749967575073, "length": 4.0, "mode": "test", "epoch": 7}
{"loss": 0.4636905789375305, "acc": 0.7789621353149414, "length": 3.992600202560425, "mode": "train", "epoch": 8}
{"loss": 0.46703681349754333, "acc": 0.7876288294792175, "length": 4.0, "mode": "test", "epoch": 8}
{"loss": 0.4462635815143585, "acc": 0.8011655211448669, "length": 3.988525390625, "mode": "train", "epoch": 9}
{"loss": 0.45670366287231445, "acc": 0.7905496954917908, "length": 4.0, "mode": "test", "epoch": 9}
{"loss": 0.4262930452823639, "acc": 0.8058996796607971, "length": 3.988481044769287, "mode": "train", "epoch": 10}
{"loss": 0.4291817843914032, "acc": 0.8091065287590027, "length": 4.0, "mode": "test", "epoch": 10}
{"loss": 0.39741405844688416, "acc": 0.8244668841362, "length": 3.986971378326416, "mode": "train", "epoch": 11}
{"loss": 0.40777143836021423, "acc": 0.8261168599128723, "length": 4.0, "mode": "test", "epoch": 11}
{"loss": 0.35921961069107056, "acc": 0.8512158393859863, "length": 3.9900636672973633, "mode": "train", "epoch": 12}
{"loss": 0.3981122672557831, "acc": 0.8261167407035828, "length": 4.0, "mode": "test", "epoch": 12}
{"loss": 0.33486518263816833, "acc": 0.8556956052780151, "length": 3.9946086406707764, "mode": "train", "epoch": 13}
{"loss": 0.3903254270553589, "acc": 0.8367696404457092, "length": 4.0, "mode": "test", "epoch": 13}
{"loss": 0.31874844431877136, "acc": 0.8650711178779602, "length": 3.996985912322998, "mode": "train", "epoch": 14}
{"loss": 0.36494380235671997, "acc": 0.8493127226829529, "length": 4.0, "mode": "test", "epoch": 14}
{"loss": 0.3022591471672058, "acc": 0.8720523118972778, "length": 3.994797468185425, "mode": "train", "epoch": 15}
{"loss": 0.35412833094596863, "acc": 0.8585910797119141, "length": 4.0, "mode": "test", "epoch": 15}
{"loss": 0.28570064902305603, "acc": 0.879514217376709, "length": 3.9975833892822266, "mode": "train", "epoch": 16}
{"loss": 0.3391580283641815, "acc": 0.8585910797119141, "length": 4.0, "mode": "test", "epoch": 16}
{"loss": 0.28248876333236694, "acc": 0.8815096020698547, "length": 3.997187852859497, "mode": "train", "epoch": 17}
{"loss": 0.3375553786754608, "acc": 0.8644331097602844, "length": 4.0, "mode": "test", "epoch": 17}
{"loss": 0.27034202218055725, "acc": 0.8858561515808105, "length": 3.997995138168335, "mode": "train", "epoch": 18}
{"loss": 0.31291642785072327, "acc": 0.8764605522155762, "length": 4.0, "mode": "test", "epoch": 18}
{"loss": 0.25956472754478455, "acc": 0.892836332321167, "length": 3.998671770095825, "mode": "train", "epoch": 19}
{"loss": 0.28653162717819214, "acc": 0.8766324520111084, "length": 4.0, "mode": "test", "epoch": 19}
{"loss": 0.24403680860996246, "acc": 0.8983175158500671, "length": 3.9988315105438232, "mode": "train", "epoch": 20}
{"loss": 0.25237783789634705, "acc": 0.8948452472686768, "length": 4.0, "mode": "test", "epoch": 20}
{"loss": 0.22512224316596985, "acc": 0.9036335945129395, "length": 3.9980735778808594, "mode": "train", "epoch": 21}
{"loss": 0.2526220381259918, "acc": 0.9010308384895325, "length": 4.0, "mode": "test", "epoch": 21}
{"loss": 0.21467074751853943, "acc": 0.9144538044929504, "length": 3.9983301162719727, "mode": "train", "epoch": 22}
{"loss": 0.24158015847206116, "acc": 0.8986254334449768, "length": 4.0, "mode": "test", "epoch": 22}
{"loss": 0.21122609078884125, "acc": 0.9162126779556274, "length": 3.9995040893554688, "mode": "train", "epoch": 23}
{"loss": 0.23743191361427307, "acc": 0.90257728099823, "length": 4.0, "mode": "test", "epoch": 23}
{"loss": 0.20721225440502167, "acc": 0.9155212044715881, "length": 3.9995391368865967, "mode": "train", "epoch": 24}
{"loss": 0.2417832911014557, "acc": 0.9053264260292053, "length": 4.0, "mode": "test", "epoch": 24}
{"loss": 0.20088163018226624, "acc": 0.9184547662734985, "length": 3.999483108520508, "mode": "train", "epoch": 25}
{"loss": 0.24633009731769562, "acc": 0.8984536528587341, "length": 4.0, "mode": "test", "epoch": 25}
{"loss": 0.20110005140304565, "acc": 0.9213968515396118, "length": 3.999678134918213, "mode": "train", "epoch": 26}
{"loss": 0.25026050209999084, "acc": 0.8999999761581421, "length": 4.0, "mode": "test", "epoch": 26}
{"loss": 0.19612756371498108, "acc": 0.9224850535392761, "length": 3.999681234359741, "mode": "train", "epoch": 27}
{"loss": 0.2509515881538391, "acc": 0.9053264856338501, "length": 4.0, "mode": "test", "epoch": 27}
{"loss": 0.19537732005119324, "acc": 0.9216797947883606, "length": 3.999539852142334, "mode": "train", "epoch": 28}
{"loss": 0.24164901673793793, "acc": 0.9111684560775757, "length": 4.0, "mode": "test", "epoch": 28}
{"loss": 0.18921545147895813, "acc": 0.9256489872932434, "length": 3.9995386600494385, "mode": "train", "epoch": 29}
{"loss": 0.22848115861415863, "acc": 0.9149483442306519, "length": 4.0, "mode": "test", "epoch": 29}
{"loss": 0.18398672342300415, "acc": 0.9269763827323914, "length": 3.9997265338897705, "mode": "train", "epoch": 30}
{"loss": 0.2034388780593872, "acc": 0.918900191783905, "length": 4.0, "mode": "test", "epoch": 30}
{"loss": 0.17207679152488708, "acc": 0.9329649209976196, "length": 3.999878168106079, "mode": "train", "epoch": 31}
{"loss": 0.20619209110736847, "acc": 0.9187285304069519, "length": 4.0, "mode": "test", "epoch": 31}
{"loss": 0.16717447340488434, "acc": 0.9345585703849792, "length": 3.9996285438537598, "mode": "train", "epoch": 32}
{"loss": 0.1990339756011963, "acc": 0.9195876717567444, "length": 4.0, "mode": "test", "epoch": 32}
{"loss": 0.16470235586166382, "acc": 0.9361276030540466, "length": 3.999706506729126, "mode": "train", "epoch": 33}
{"loss": 0.18901768326759338, "acc": 0.9274914860725403, "length": 4.0, "mode": "test", "epoch": 33}
{"loss": 0.1643434315919876, "acc": 0.935404360294342, "length": 3.998223304748535, "mode": "train", "epoch": 34}
{"loss": 0.19860605895519257, "acc": 0.9245703816413879, "length": 4.0, "mode": "test", "epoch": 34}
{"loss": 0.16110730171203613, "acc": 0.9362241625785828, "length": 3.9976234436035156, "mode": "train", "epoch": 35}
{"loss": 0.19642257690429688, "acc": 0.92542964220047, "length": 4.0, "mode": "test", "epoch": 35}
{"loss": 0.14684826135635376, "acc": 0.9398695826530457, "length": 3.9998486042022705, "mode": "train", "epoch": 36}
{"loss": 0.18741340935230255, "acc": 0.9329897165298462, "length": 4.0, "mode": "test", "epoch": 36}
{"loss": 0.14702412486076355, "acc": 0.9436638951301575, "length": 3.999809980392456, "mode": "train", "epoch": 37}
{"loss": 0.18687230348587036, "acc": 0.9333333373069763, "length": 4.0, "mode": "test", "epoch": 37}
{"loss": 0.14719100296497345, "acc": 0.9418859481811523, "length": 3.9999547004699707, "mode": "train", "epoch": 38}
{"loss": 0.19009201228618622, "acc": 0.9345360994338989, "length": 4.0, "mode": "test", "epoch": 38}
{"loss": 0.14310696721076965, "acc": 0.9429764747619629, "length": 3.9998691082000732, "mode": "train", "epoch": 39}
{"loss": 0.18136277794837952, "acc": 0.9400344491004944, "length": 4.0, "mode": "test", "epoch": 39}
{"loss": 0.1394817978143692, "acc": 0.947178065776825, "length": 3.999948501586914, "mode": "train", "epoch": 40}
{"loss": 0.16174201667308807, "acc": 0.9353952407836914, "length": 4.0, "mode": "test", "epoch": 40}
{"loss": 0.13572393357753754, "acc": 0.9466598629951477, "length": 3.999905586242676, "mode": "train", "epoch": 41}
{"loss": 0.1945706605911255, "acc": 0.9283505082130432, "length": 4.0, "mode": "test", "epoch": 41}
{"loss": 0.1450227051973343, "acc": 0.9420592784881592, "length": 3.999978542327881, "mode": "train", "epoch": 42}
{"loss": 0.19063447415828705, "acc": 0.9338487982749939, "length": 4.0, "mode": "test", "epoch": 42}
{"loss": 0.1325116753578186, "acc": 0.9485604763031006, "length": 3.999967575073242, "mode": "train", "epoch": 43}
{"loss": 0.1720203459262848, "acc": 0.9379725456237793, "length": 4.0, "mode": "test", "epoch": 43}
{"loss": 0.14966829121112823, "acc": 0.9379167556762695, "length": 3.999971389770508, "mode": "train", "epoch": 44}
{"loss": 0.2117953598499298, "acc": 0.9231959581375122, "length": 4.0, "mode": "test", "epoch": 44}
{"loss": 0.15308555960655212, "acc": 0.9354910254478455, "length": 3.9998533725738525, "mode": "train", "epoch": 45}
{"loss": 0.16508042812347412, "acc": 0.9367697834968567, "length": 4.0, "mode": "test", "epoch": 45}
{"loss": 0.1423662006855011, "acc": 0.9451073408126831, "length": 3.999952793121338, "mode": "train", "epoch": 46}
{"loss": 0.18838374316692352, "acc": 0.9326461553573608, "length": 4.0, "mode": "test", "epoch": 46}
{"loss": 0.1432667225599289, "acc": 0.9441304206848145, "length": 3.9999735355377197, "mode": "train", "epoch": 47}
{"loss": 0.1783122420310974, "acc": 0.9398624300956726, "length": 4.0, "mode": "test", "epoch": 47}
{"loss": 0.13795141875743866, "acc": 0.9475781321525574, "length": 3.9998128414154053, "mode": "train", "epoch": 48}
{"loss": 0.16006051003932953, "acc": 0.9458763003349304, "length": 4.0, "mode": "test", "epoch": 48}
{"loss": 0.12723271548748016, "acc": 0.9493070244789124, "length": 3.9998881816864014, "mode": "train", "epoch": 49}
{"loss": 0.16154618561267853, "acc": 0.9412369728088379, "length": 4.0, "mode": "test", "epoch": 49}
{"loss": 0.1332838237285614, "acc": 0.9498257040977478, "length": 3.9999184608459473, "mode": "train", "epoch": 50}
{"loss": 0.16725394129753113, "acc": 0.9410651326179504, "length": 4.0, "mode": "test", "epoch": 50}
{"loss": 0.12591922283172607, "acc": 0.9521072506904602, "length": 3.999415636062622, "mode": "train", "epoch": 51}
{"loss": 0.16260313987731934, "acc": 0.9438143968582153, "length": 4.0, "mode": "test", "epoch": 51}
{"loss": 0.12470472604036331, "acc": 0.9524719715118408, "length": 3.999913215637207, "mode": "train", "epoch": 52}
{"loss": 0.15971866250038147, "acc": 0.9432990550994873, "length": 4.0, "mode": "test", "epoch": 52}
{"loss": 0.12474197894334793, "acc": 0.9511058330535889, "length": 3.9993021488189697, "mode": "train", "epoch": 53}
{"loss": 0.1714157611131668, "acc": 0.9474226236343384, "length": 4.0, "mode": "test", "epoch": 53}
{"loss": 0.11947184801101685, "acc": 0.9535092115402222, "length": 3.9999842643737793, "mode": "train", "epoch": 54}
{"loss": 0.18896439671516418, "acc": 0.9383162260055542, "length": 4.0, "mode": "test", "epoch": 54}
{"loss": 0.12734177708625793, "acc": 0.9486764669418335, "length": 3.9999938011169434, "mode": "train", "epoch": 55}
{"loss": 0.20138834416866302, "acc": 0.9297250509262085, "length": 4.0, "mode": "test", "epoch": 55}
{"loss": 0.1222398653626442, "acc": 0.9518985152244568, "length": 3.999993324279785, "mode": "train", "epoch": 56}
{"loss": 0.14416936039924622, "acc": 0.9474227428436279, "length": 4.0, "mode": "test", "epoch": 56}
{"loss": 0.1178089827299118, "acc": 0.9550624489784241, "length": 3.9999735355377197, "mode": "train", "epoch": 57}
{"loss": 0.15416814386844635, "acc": 0.94243985414505, "length": 4.0, "mode": "test", "epoch": 57}
{"loss": 0.11595652997493744, "acc": 0.9565964341163635, "length": 3.9993221759796143, "mode": "train", "epoch": 58}
{"loss": 0.1487455666065216, "acc": 0.9484537243843079, "length": 4.0, "mode": "test", "epoch": 58}
{"loss": 0.11359706521034241, "acc": 0.9573644995689392, "length": 3.9999966621398926, "mode": "train", "epoch": 59}
{"loss": 0.13868863880634308, "acc": 0.9487971663475037, "length": 4.0, "mode": "test", "epoch": 59}
{"loss": 0.10913332551717758, "acc": 0.958572506904602, "length": 3.999983310699463, "mode": "train", "epoch": 60}
{"loss": 0.15708041191101074, "acc": 0.9491409063339233, "length": 4.0, "mode": "test", "epoch": 60}
test accuracy: 0.7928571701049805
