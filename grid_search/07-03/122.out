# ["--attributes=3", "--values=16", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=128", "--learning_rate=0.0005", "--hidden_size=128", "--temp_update=0.97", "--temperature=2"]
Creating train_ds and val_ds...

Creating test_ds...
{"loss": 0.7007710933685303, "acc": 0.5128457546234131, "length": 3.5148606300354004, "mode": "train", "epoch": 1}
{"loss": 0.6921517252922058, "acc": 0.5183566212654114, "length": 1.0, "mode": "test", "epoch": 1}
{"loss": 0.6913644671440125, "acc": 0.5245042443275452, "length": 3.5021286010742188, "mode": "train", "epoch": 2}
{"loss": 0.6943050622940063, "acc": 0.4972027838230133, "length": 1.0, "mode": "test", "epoch": 2}
{"loss": 0.6906229853630066, "acc": 0.5246490836143494, "length": 3.4500277042388916, "mode": "train", "epoch": 3}
{"loss": 0.6850376129150391, "acc": 0.557167649269104, "length": 1.185314655303955, "mode": "test", "epoch": 3}
{"loss": 0.6889660954475403, "acc": 0.5394572615623474, "length": 3.4561829566955566, "mode": "train", "epoch": 4}
{"loss": 0.6713301539421082, "acc": 0.624337375164032, "length": 2.0279719829559326, "mode": "test", "epoch": 4}
{"loss": 0.6867174506187439, "acc": 0.5519272685050964, "length": 3.404452323913574, "mode": "train", "epoch": 5}
{"loss": 0.6700589060783386, "acc": 0.5960033535957336, "length": 2.192307710647583, "mode": "test", "epoch": 5}
{"loss": 0.6803701519966125, "acc": 0.5860650539398193, "length": 3.293808698654175, "mode": "train", "epoch": 6}
{"loss": 0.6671556234359741, "acc": 0.6145937442779541, "length": 2.538461446762085, "mode": "test", "epoch": 6}
{"loss": 0.6670516729354858, "acc": 0.610582709312439, "length": 3.242039203643799, "mode": "train", "epoch": 7}
{"loss": 0.6569643616676331, "acc": 0.6419721245765686, "length": 2.7202796936035156, "mode": "test", "epoch": 7}
{"loss": 0.6445398330688477, "acc": 0.6618674993515015, "length": 3.2467284202575684, "mode": "train", "epoch": 8}
{"loss": 0.6130542755126953, "acc": 0.7235060334205627, "length": 3.8426573276519775, "mode": "test", "epoch": 8}
{"loss": 0.6110337972640991, "acc": 0.7143793106079102, "length": 3.466045618057251, "mode": "train", "epoch": 9}
{"loss": 0.5832375884056091, "acc": 0.7222028970718384, "length": 4.0, "mode": "test", "epoch": 9}
{"loss": 0.5728432536125183, "acc": 0.7144483923912048, "length": 3.714709997177124, "mode": "train", "epoch": 10}
{"loss": 0.5704439878463745, "acc": 0.7202798128128052, "length": 4.0, "mode": "test", "epoch": 10}
{"loss": 0.554655909538269, "acc": 0.7065915465354919, "length": 3.8794898986816406, "mode": "train", "epoch": 11}
{"loss": 0.5705912113189697, "acc": 0.7197552919387817, "length": 4.0, "mode": "test", "epoch": 11}
{"loss": 0.5432068109512329, "acc": 0.711321234703064, "length": 3.933410406112671, "mode": "train", "epoch": 12}
{"loss": 0.554969072341919, "acc": 0.7178322076797485, "length": 4.0, "mode": "test", "epoch": 12}
{"loss": 0.5357910990715027, "acc": 0.7105977535247803, "length": 3.9405996799468994, "mode": "train", "epoch": 13}
{"loss": 0.5392121076583862, "acc": 0.7197552919387817, "length": 4.0, "mode": "test", "epoch": 13}
{"loss": 0.5244849324226379, "acc": 0.7213533520698547, "length": 3.948312997817993, "mode": "train", "epoch": 14}
{"loss": 0.535179078578949, "acc": 0.7218531370162964, "length": 4.0, "mode": "test", "epoch": 14}
{"loss": 0.5125993490219116, "acc": 0.7263247966766357, "length": 3.9550952911376953, "mode": "train", "epoch": 15}
{"loss": 0.5267059803009033, "acc": 0.7419580221176147, "length": 4.0, "mode": "test", "epoch": 15}
{"loss": 0.5008063316345215, "acc": 0.7439373135566711, "length": 3.9634897708892822, "mode": "train", "epoch": 16}
{"loss": 0.5126356482505798, "acc": 0.7555944323539734, "length": 4.0, "mode": "test", "epoch": 16}
{"loss": 0.48357662558555603, "acc": 0.7557188868522644, "length": 3.9637959003448486, "mode": "train", "epoch": 17}
{"loss": 0.5059617161750793, "acc": 0.7569929957389832, "length": 4.0, "mode": "test", "epoch": 17}
{"loss": 0.4729667007923126, "acc": 0.766473650932312, "length": 3.9696505069732666, "mode": "train", "epoch": 18}
{"loss": 0.49255990982055664, "acc": 0.7692309021949768, "length": 4.0, "mode": "test", "epoch": 18}
{"loss": 0.4597984552383423, "acc": 0.7725593447685242, "length": 3.971414566040039, "mode": "train", "epoch": 19}
{"loss": 0.48149871826171875, "acc": 0.7729021906852722, "length": 4.0, "mode": "test", "epoch": 19}
{"loss": 0.44594091176986694, "acc": 0.7803237438201904, "length": 3.9824533462524414, "mode": "train", "epoch": 20}
{"loss": 0.4660484790802002, "acc": 0.7739511132240295, "length": 4.0, "mode": "test", "epoch": 20}
{"loss": 0.43526560068130493, "acc": 0.7854470014572144, "length": 3.9822492599487305, "mode": "train", "epoch": 21}
{"loss": 0.451216459274292, "acc": 0.7784963846206665, "length": 4.0, "mode": "test", "epoch": 21}
{"loss": 0.41910746693611145, "acc": 0.800733745098114, "length": 3.982393264770508, "mode": "train", "epoch": 22}
{"loss": 0.44335755705833435, "acc": 0.7951048612594604, "length": 4.0, "mode": "test", "epoch": 22}
{"loss": 0.4057862460613251, "acc": 0.8042095303535461, "length": 3.9808645248413086, "mode": "train", "epoch": 23}
{"loss": 0.414703905582428, "acc": 0.8003496527671814, "length": 4.0, "mode": "test", "epoch": 23}
{"loss": 0.38312828540802, "acc": 0.8175519704818726, "length": 3.9837145805358887, "mode": "train", "epoch": 24}
{"loss": 0.38580983877182007, "acc": 0.8248252868652344, "length": 4.0, "mode": "test", "epoch": 24}
{"loss": 0.36617812514305115, "acc": 0.8334715962409973, "length": 3.9848203659057617, "mode": "train", "epoch": 25}
{"loss": 0.36302265524864197, "acc": 0.8297202587127686, "length": 4.0, "mode": "test", "epoch": 25}
{"loss": 0.3488297760486603, "acc": 0.8444726467132568, "length": 3.9882240295410156, "mode": "train", "epoch": 26}
{"loss": 0.3448004722595215, "acc": 0.8442308306694031, "length": 4.0, "mode": "test", "epoch": 26}
{"loss": 0.33032283186912537, "acc": 0.8554583191871643, "length": 3.9906368255615234, "mode": "train", "epoch": 27}
{"loss": 0.33338814973831177, "acc": 0.8498252630233765, "length": 4.0, "mode": "test", "epoch": 27}
{"loss": 0.32155418395996094, "acc": 0.8625502586364746, "length": 3.994077205657959, "mode": "train", "epoch": 28}
{"loss": 0.3333468437194824, "acc": 0.8479021787643433, "length": 4.0, "mode": "test", "epoch": 28}
{"loss": 0.31196290254592896, "acc": 0.8623144030570984, "length": 3.9918553829193115, "mode": "train", "epoch": 29}
{"loss": 0.3065095543861389, "acc": 0.8634614944458008, "length": 4.0, "mode": "test", "epoch": 29}
{"loss": 0.30082207918167114, "acc": 0.8732624053955078, "length": 3.9933459758758545, "mode": "train", "epoch": 30}
{"loss": 0.29965806007385254, "acc": 0.8692308068275452, "length": 4.0, "mode": "test", "epoch": 30}
{"loss": 0.29186972975730896, "acc": 0.879270076751709, "length": 3.993727207183838, "mode": "train", "epoch": 31}
{"loss": 0.27854499220848083, "acc": 0.8835664987564087, "length": 4.0, "mode": "test", "epoch": 31}
{"loss": 0.27731096744537354, "acc": 0.8889310359954834, "length": 3.9955551624298096, "mode": "train", "epoch": 32}
{"loss": 0.26269668340682983, "acc": 0.8868881464004517, "length": 4.0, "mode": "test", "epoch": 32}
{"loss": 0.2644687592983246, "acc": 0.8970609307289124, "length": 3.996304512023926, "mode": "train", "epoch": 33}
{"loss": 0.24115243554115295, "acc": 0.8889859318733215, "length": 4.0, "mode": "test", "epoch": 33}
{"loss": 0.256072461605072, "acc": 0.8946629762649536, "length": 3.9956037998199463, "mode": "train", "epoch": 34}
{"loss": 0.22756056487560272, "acc": 0.8965035676956177, "length": 4.0, "mode": "test", "epoch": 34}
{"loss": 0.2467929571866989, "acc": 0.9019054770469666, "length": 3.9980263710021973, "mode": "train", "epoch": 35}
{"loss": 0.24189148843288422, "acc": 0.9013985395431519, "length": 4.0, "mode": "test", "epoch": 35}
{"loss": 0.24288754165172577, "acc": 0.9010788202285767, "length": 3.997184991836548, "mode": "train", "epoch": 36}
{"loss": 0.21389850974082947, "acc": 0.9050700664520264, "length": 4.0, "mode": "test", "epoch": 36}
{"loss": 0.2294333577156067, "acc": 0.9086877703666687, "length": 3.997530937194824, "mode": "train", "epoch": 37}
{"loss": 0.2041950225830078, "acc": 0.9234265685081482, "length": 4.0, "mode": "test", "epoch": 37}
{"loss": 0.22572143375873566, "acc": 0.9092328548431396, "length": 3.9989142417907715, "mode": "train", "epoch": 38}
{"loss": 0.19831830263137817, "acc": 0.9131118655204773, "length": 4.0, "mode": "test", "epoch": 38}
{"loss": 0.2154662311077118, "acc": 0.9116449356079102, "length": 3.9995276927948, "mode": "train", "epoch": 39}
{"loss": 0.19578516483306885, "acc": 0.9171327352523804, "length": 4.0, "mode": "test", "epoch": 39}
{"loss": 0.2113655060529709, "acc": 0.9172062873840332, "length": 3.9995028972625732, "mode": "train", "epoch": 40}
{"loss": 0.1901610791683197, "acc": 0.9178321957588196, "length": 4.0, "mode": "test", "epoch": 40}
{"loss": 0.2058069109916687, "acc": 0.919724702835083, "length": 3.999305248260498, "mode": "train", "epoch": 41}
{"loss": 0.1883377730846405, "acc": 0.916258692741394, "length": 4.0, "mode": "test", "epoch": 41}
{"loss": 0.20623047649860382, "acc": 0.9216452240943909, "length": 3.998072385787964, "mode": "train", "epoch": 42}
{"loss": 0.17821109294891357, "acc": 0.926048994064331, "length": 4.0, "mode": "test", "epoch": 42}
{"loss": 0.19928166270256042, "acc": 0.9198963046073914, "length": 3.9993183612823486, "mode": "train", "epoch": 43}
{"loss": 0.1830071061849594, "acc": 0.9227274656295776, "length": 4.0, "mode": "test", "epoch": 43}
{"loss": 0.19725002348423004, "acc": 0.9280152320861816, "length": 3.9978528022766113, "mode": "train", "epoch": 44}
{"loss": 0.18383076786994934, "acc": 0.9192308783531189, "length": 4.0, "mode": "test", "epoch": 44}
{"loss": 0.192440927028656, "acc": 0.9270427823066711, "length": 3.9995734691619873, "mode": "train", "epoch": 45}
{"loss": 0.1692134588956833, "acc": 0.9300700426101685, "length": 4.0, "mode": "test", "epoch": 45}
{"loss": 0.19326411187648773, "acc": 0.9262261390686035, "length": 3.999799966812134, "mode": "train", "epoch": 46}
{"loss": 0.16865681111812592, "acc": 0.9234265089035034, "length": 4.0, "mode": "test", "epoch": 46}
{"loss": 0.19338086247444153, "acc": 0.926344633102417, "length": 3.9997775554656982, "mode": "train", "epoch": 47}
{"loss": 0.1784091293811798, "acc": 0.9241258502006531, "length": 4.0, "mode": "test", "epoch": 47}
{"loss": 0.18997876346111298, "acc": 0.9256992936134338, "length": 3.999790668487549, "mode": "train", "epoch": 48}
{"loss": 0.17577312886714935, "acc": 0.9286712408065796, "length": 4.0, "mode": "test", "epoch": 48}
{"loss": 0.1936757117509842, "acc": 0.926744818687439, "length": 3.998568296432495, "mode": "train", "epoch": 49}
{"loss": 0.18236908316612244, "acc": 0.9300700426101685, "length": 4.0, "mode": "test", "epoch": 49}
{"loss": 0.1839367002248764, "acc": 0.9357903599739075, "length": 3.997497320175171, "mode": "train", "epoch": 50}
{"loss": 0.1628149002790451, "acc": 0.9321677684783936, "length": 4.0, "mode": "test", "epoch": 50}
{"loss": 0.19018490612506866, "acc": 0.9266971945762634, "length": 3.9999630451202393, "mode": "train", "epoch": 51}
{"loss": 0.15604320168495178, "acc": 0.9309439659118652, "length": 4.0, "mode": "test", "epoch": 51}
{"loss": 0.18145282566547394, "acc": 0.9310860633850098, "length": 3.999821901321411, "mode": "train", "epoch": 52}
{"loss": 0.16310134530067444, "acc": 0.9332168698310852, "length": 4.0, "mode": "test", "epoch": 52}
{"loss": 0.17647698521614075, "acc": 0.9326053261756897, "length": 3.9996542930603027, "mode": "train", "epoch": 53}
{"loss": 0.1645115315914154, "acc": 0.9283216595649719, "length": 4.0, "mode": "test", "epoch": 53}
{"loss": 0.17385344207286835, "acc": 0.9328844547271729, "length": 3.9985666275024414, "mode": "train", "epoch": 54}
{"loss": 0.16119475662708282, "acc": 0.9339160919189453, "length": 4.0, "mode": "test", "epoch": 54}
{"loss": 0.17403586208820343, "acc": 0.9362964034080505, "length": 3.999847650527954, "mode": "train", "epoch": 55}
{"loss": 0.16606897115707397, "acc": 0.9337414503097534, "length": 4.0, "mode": "test", "epoch": 55}
{"loss": 0.17523428797721863, "acc": 0.9300847053527832, "length": 3.999300241470337, "mode": "train", "epoch": 56}
{"loss": 0.1565476953983307, "acc": 0.9346153140068054, "length": 4.0, "mode": "test", "epoch": 56}
{"loss": 0.17007245123386383, "acc": 0.934246838092804, "length": 3.9997642040252686, "mode": "train", "epoch": 57}
{"loss": 0.17242959141731262, "acc": 0.9321677684783936, "length": 4.0, "mode": "test", "epoch": 57}
{"loss": 0.16701403260231018, "acc": 0.9363575577735901, "length": 3.9999685287475586, "mode": "train", "epoch": 58}
{"loss": 0.162215918302536, "acc": 0.934615433216095, "length": 4.0, "mode": "test", "epoch": 58}
{"loss": 0.16521918773651123, "acc": 0.9350109696388245, "length": 3.9999544620513916, "mode": "train", "epoch": 59}
{"loss": 0.16111032664775848, "acc": 0.932867169380188, "length": 4.0, "mode": "test", "epoch": 59}
{"loss": 0.16829527914524078, "acc": 0.9390488862991333, "length": 3.999873161315918, "mode": "train", "epoch": 60}
{"loss": 0.15235847234725952, "acc": 0.934615433216095, "length": 4.0, "mode": "test", "epoch": 60}
test accuracy: 0.8405000567436218
