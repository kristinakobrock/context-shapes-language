# ["--attributes=5", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=128", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.99", "--temperature=1"]
Creating train_ds and val_ds...

Creating test_ds...
{"loss": 0.7087447643280029, "acc": 0.49306851625442505, "length": 3.4654123783111572, "mode": "train", "epoch": 1}
{"loss": 0.690102756023407, "acc": 0.503710150718689, "length": 1.0, "mode": "test", "epoch": 1}
{"loss": 0.6952857375144958, "acc": 0.5239284038543701, "length": 3.0015246868133545, "mode": "train", "epoch": 2}
{"loss": 0.6895990371704102, "acc": 0.5102474093437195, "length": 1.0, "mode": "test", "epoch": 2}
{"loss": 0.6918579936027527, "acc": 0.5317586064338684, "length": 1.870933175086975, "mode": "train", "epoch": 3}
{"loss": 0.690884530544281, "acc": 0.5408127903938293, "length": 1.0, "mode": "test", "epoch": 3}
{"loss": 0.6880452632904053, "acc": 0.5487328767776489, "length": 1.501350998878479, "mode": "train", "epoch": 4}
{"loss": 0.6931337118148804, "acc": 0.4901059865951538, "length": 1.0, "mode": "test", "epoch": 4}
{"loss": 0.6770122647285461, "acc": 0.588418185710907, "length": 2.218423843383789, "mode": "train", "epoch": 5}
{"loss": 0.6602420806884766, "acc": 0.6464880704879761, "length": 1.9293286800384521, "mode": "test", "epoch": 5}
{"loss": 0.6550449132919312, "acc": 0.6554715037345886, "length": 2.308558940887451, "mode": "train", "epoch": 6}
{"loss": 0.629186749458313, "acc": 0.7256291508674622, "length": 2.4275617599487305, "mode": "test", "epoch": 6}
{"loss": 0.6155416369438171, "acc": 0.7226259708404541, "length": 2.681471109390259, "mode": "train", "epoch": 7}
{"loss": 0.5751384496688843, "acc": 0.7773281335830688, "length": 3.045936346054077, "mode": "test", "epoch": 7}
{"loss": 0.5535985827445984, "acc": 0.7754875421524048, "length": 3.0392568111419678, "mode": "train", "epoch": 8}
{"loss": 0.5198774337768555, "acc": 0.7991560101509094, "length": 3.332155466079712, "mode": "test", "epoch": 8}
{"loss": 0.4895339906215668, "acc": 0.7999228835105896, "length": 3.2439470291137695, "mode": "train", "epoch": 9}
{"loss": 0.48146483302116394, "acc": 0.8171277642250061, "length": 3.289752721786499, "mode": "test", "epoch": 9}
{"loss": 0.44464364647865295, "acc": 0.820063054561615, "length": 3.2781076431274414, "mode": "train", "epoch": 10}
{"loss": 0.4578568935394287, "acc": 0.8181855082511902, "length": 3.3003532886505127, "mode": "test", "epoch": 10}
{"loss": 0.4252547323703766, "acc": 0.8201723694801331, "length": 3.321500301361084, "mode": "train", "epoch": 11}
{"loss": 0.4472506642341614, "acc": 0.8175882697105408, "length": 3.3957598209381104, "mode": "test", "epoch": 11}
{"loss": 0.415862500667572, "acc": 0.8263088464736938, "length": 3.325773000717163, "mode": "train", "epoch": 12}
{"loss": 0.4363524913787842, "acc": 0.8235260844230652, "length": 3.378091812133789, "mode": "test", "epoch": 12}
{"loss": 0.4083636999130249, "acc": 0.8249273896217346, "length": 3.2897379398345947, "mode": "train", "epoch": 13}
{"loss": 0.42941102385520935, "acc": 0.8292319178581238, "length": 3.3816254138946533, "mode": "test", "epoch": 13}
{"loss": 0.40058013796806335, "acc": 0.830048680305481, "length": 3.3223488330841064, "mode": "train", "epoch": 14}
{"loss": 0.4387529790401459, "acc": 0.8314657807350159, "length": 3.335689067840576, "mode": "test", "epoch": 14}
{"loss": 0.3912038207054138, "acc": 0.8287708759307861, "length": 3.3071560859680176, "mode": "train", "epoch": 15}
{"loss": 0.43250319361686707, "acc": 0.8278172612190247, "length": 3.3568904399871826, "mode": "test", "epoch": 15}
{"loss": 0.38627830147743225, "acc": 0.8348430395126343, "length": 3.338975191116333, "mode": "train", "epoch": 16}
{"loss": 0.42921262979507446, "acc": 0.8296001553535461, "length": 3.3816254138946533, "mode": "test", "epoch": 16}
{"loss": 0.38078442215919495, "acc": 0.833527684211731, "length": 3.3564388751983643, "mode": "train", "epoch": 17}
{"loss": 0.4230806231498718, "acc": 0.8315389752388, "length": 3.275618314743042, "mode": "test", "epoch": 17}
{"loss": 0.37496310472488403, "acc": 0.8378945589065552, "length": 3.337286949157715, "mode": "train", "epoch": 18}
{"loss": 0.41839879751205444, "acc": 0.8307405114173889, "length": 3.360424041748047, "mode": "test", "epoch": 18}
{"loss": 0.3686065971851349, "acc": 0.8396742343902588, "length": 3.3968076705932617, "mode": "train", "epoch": 19}
{"loss": 0.3996451497077942, "acc": 0.8320299386978149, "length": 3.3286218643188477, "mode": "test", "epoch": 19}
{"loss": 0.36678728461265564, "acc": 0.8418775200843811, "length": 3.317155122756958, "mode": "train", "epoch": 20}
{"loss": 0.39490318298339844, "acc": 0.8367531895637512, "length": 3.34628963470459, "mode": "test", "epoch": 20}
{"loss": 0.3573867380619049, "acc": 0.8481642007827759, "length": 3.432121515274048, "mode": "train", "epoch": 21}
{"loss": 0.38431334495544434, "acc": 0.8433815240859985, "length": 3.462897539138794, "mode": "test", "epoch": 21}
{"loss": 0.3527737259864807, "acc": 0.8504272699356079, "length": 3.4390835762023926, "mode": "train", "epoch": 22}
{"loss": 0.37304699420928955, "acc": 0.8467879295349121, "length": 3.332155466079712, "mode": "test", "epoch": 22}
{"loss": 0.3406628668308258, "acc": 0.8573338389396667, "length": 3.3801558017730713, "mode": "train", "epoch": 23}
{"loss": 0.375608891248703, "acc": 0.8475989103317261, "length": 3.4558303356170654, "mode": "test", "epoch": 23}
{"loss": 0.3362516760826111, "acc": 0.8575778603553772, "length": 3.4362473487854004, "mode": "train", "epoch": 24}
{"loss": 0.37222808599472046, "acc": 0.8525701761245728, "length": 3.3674912452697754, "mode": "test", "epoch": 24}
{"loss": 0.3291536271572113, "acc": 0.8632327318191528, "length": 3.444681167602539, "mode": "train", "epoch": 25}
{"loss": 0.3647153079509735, "acc": 0.8590365648269653, "length": 3.416961193084717, "mode": "test", "epoch": 25}
{"loss": 0.3317006230354309, "acc": 0.8654645085334778, "length": 3.3906922340393066, "mode": "train", "epoch": 26}
{"loss": 0.36416739225387573, "acc": 0.8570459485054016, "length": 3.3568904399871826, "mode": "test", "epoch": 26}
{"loss": 0.3225484788417816, "acc": 0.8667385578155518, "length": 3.434641122817993, "mode": "train", "epoch": 27}
{"loss": 0.35887235403060913, "acc": 0.8606140613555908, "length": 3.4134275913238525, "mode": "test", "epoch": 27}
{"loss": 0.32023733854293823, "acc": 0.8664950728416443, "length": 3.453601360321045, "mode": "train", "epoch": 28}
{"loss": 0.36033862829208374, "acc": 0.8589487671852112, "length": 3.378091812133789, "mode": "test", "epoch": 28}
{"loss": 0.3202143609523773, "acc": 0.8689320683479309, "length": 3.430745840072632, "mode": "train", "epoch": 29}
{"loss": 0.3602614998817444, "acc": 0.8588454723358154, "length": 3.4028267860412598, "mode": "test", "epoch": 29}
{"loss": 0.30986344814300537, "acc": 0.872538149356842, "length": 3.4347574710845947, "mode": "train", "epoch": 30}
{"loss": 0.3525598645210266, "acc": 0.8606841564178467, "length": 3.4134275913238525, "mode": "test", "epoch": 30}
{"loss": 0.31178465485572815, "acc": 0.8714593052864075, "length": 3.441737174987793, "mode": "train", "epoch": 31}
{"loss": 0.3449419438838959, "acc": 0.8610249757766724, "length": 3.318021297454834, "mode": "test", "epoch": 31}
{"loss": 0.305513858795166, "acc": 0.8722578287124634, "length": 3.440875291824341, "mode": "train", "epoch": 32}
{"loss": 0.34197694063186646, "acc": 0.8678998947143555, "length": 3.378091812133789, "mode": "test", "epoch": 32}
{"loss": 0.3036218285560608, "acc": 0.8735226392745972, "length": 3.4635608196258545, "mode": "train", "epoch": 33}
{"loss": 0.3519795835018158, "acc": 0.8567522764205933, "length": 3.5724382400512695, "mode": "test", "epoch": 33}
{"loss": 0.2928265929222107, "acc": 0.8768000602722168, "length": 3.4583702087402344, "mode": "train", "epoch": 34}
{"loss": 0.35768985748291016, "acc": 0.8584287166595459, "length": 3.547703266143799, "mode": "test", "epoch": 34}
{"loss": 0.2977994680404663, "acc": 0.8751869797706604, "length": 3.4597082138061523, "mode": "train", "epoch": 35}
{"loss": 0.32130834460258484, "acc": 0.8720581531524658, "length": 3.3533568382263184, "mode": "test", "epoch": 35}
{"loss": 0.290122389793396, "acc": 0.8829684257507324, "length": 3.4478275775909424, "mode": "train", "epoch": 36}
{"loss": 0.32021111249923706, "acc": 0.8775877356529236, "length": 3.4275617599487305, "mode": "test", "epoch": 36}
{"loss": 0.2854723632335663, "acc": 0.8793641328811646, "length": 3.454671621322632, "mode": "train", "epoch": 37}
{"loss": 0.29293093085289, "acc": 0.8766787052154541, "length": 3.4098939895629883, "mode": "test", "epoch": 37}
{"loss": 0.2755815386772156, "acc": 0.8868180513381958, "length": 3.483956813812256, "mode": "train", "epoch": 38}
{"loss": 0.315062552690506, "acc": 0.8691840767860413, "length": 3.448763132095337, "mode": "test", "epoch": 38}
{"loss": 0.26972559094429016, "acc": 0.885796070098877, "length": 3.4567558765411377, "mode": "train", "epoch": 39}
{"loss": 0.281948983669281, "acc": 0.8822476267814636, "length": 3.3992931842803955, "mode": "test", "epoch": 39}
{"loss": 0.2660555839538574, "acc": 0.8922662734985352, "length": 3.43770170211792, "mode": "train", "epoch": 40}
{"loss": 0.275112509727478, "acc": 0.8865737915039062, "length": 3.4098939895629883, "mode": "test", "epoch": 40}
{"loss": 0.2590870261192322, "acc": 0.892225444316864, "length": 3.487185001373291, "mode": "train", "epoch": 41}
{"loss": 0.272502601146698, "acc": 0.8837491273880005, "length": 3.406360387802124, "mode": "test", "epoch": 41}
{"loss": 0.2587927579879761, "acc": 0.8934247493743896, "length": 3.465660333633423, "mode": "train", "epoch": 42}
{"loss": 0.27094709873199463, "acc": 0.8858152031898499, "length": 3.4381625652313232, "mode": "test", "epoch": 42}
{"loss": 0.25135964155197144, "acc": 0.8970970511436462, "length": 3.480954170227051, "mode": "train", "epoch": 43}
{"loss": 0.27504438161849976, "acc": 0.8852200508117676, "length": 3.4381625652313232, "mode": "test", "epoch": 43}
{"loss": 0.2501242756843567, "acc": 0.8957058787345886, "length": 3.511260986328125, "mode": "train", "epoch": 44}
{"loss": 0.26480138301849365, "acc": 0.8886655569076538, "length": 3.416961193084717, "mode": "test", "epoch": 44}
{"loss": 0.2506462037563324, "acc": 0.8996425867080688, "length": 3.5123977661132812, "mode": "train", "epoch": 45}
{"loss": 0.28269296884536743, "acc": 0.8934522867202759, "length": 3.466431140899658, "mode": "test", "epoch": 45}
{"loss": 0.24307183921337128, "acc": 0.9016024470329285, "length": 3.496236801147461, "mode": "train", "epoch": 46}
{"loss": 0.257516473531723, "acc": 0.897139847278595, "length": 3.406360387802124, "mode": "test", "epoch": 46}
{"loss": 0.23904860019683838, "acc": 0.9045244455337524, "length": 3.503934144973755, "mode": "train", "epoch": 47}
{"loss": 0.25886279344558716, "acc": 0.8981590270996094, "length": 3.4452297687530518, "mode": "test", "epoch": 47}
{"loss": 0.23524297773838043, "acc": 0.9058020114898682, "length": 3.5006251335144043, "mode": "train", "epoch": 48}
{"loss": 0.2600700855255127, "acc": 0.8954338431358337, "length": 3.4452297687530518, "mode": "test", "epoch": 48}
{"loss": 0.2293541431427002, "acc": 0.9080137610435486, "length": 3.5098907947540283, "mode": "train", "epoch": 49}
{"loss": 0.2568287253379822, "acc": 0.899661123752594, "length": 3.420494794845581, "mode": "test", "epoch": 49}
{"loss": 0.22969704866409302, "acc": 0.9065371155738831, "length": 3.5167722702026367, "mode": "train", "epoch": 50}
{"loss": 0.2556631863117218, "acc": 0.8973534107208252, "length": 3.4381625652313232, "mode": "test", "epoch": 50}
{"loss": 0.2278393656015396, "acc": 0.9078957438468933, "length": 3.5166923999786377, "mode": "train", "epoch": 51}
{"loss": 0.2481994330883026, "acc": 0.9010132551193237, "length": 3.4982333183288574, "mode": "test", "epoch": 51}
{"loss": 0.2314581573009491, "acc": 0.9070541858673096, "length": 3.526043176651001, "mode": "train", "epoch": 52}
{"loss": 0.2570720613002777, "acc": 0.8893523216247559, "length": 3.466431140899658, "mode": "test", "epoch": 52}
{"loss": 0.22257673740386963, "acc": 0.910273015499115, "length": 3.52585768699646, "mode": "train", "epoch": 53}
{"loss": 0.2457321733236313, "acc": 0.9003421068191528, "length": 3.4381625652313232, "mode": "test", "epoch": 53}
{"loss": 0.21941152215003967, "acc": 0.9138945937156677, "length": 3.5215368270874023, "mode": "train", "epoch": 54}
{"loss": 0.27026504278182983, "acc": 0.9006296992301941, "length": 3.5017666816711426, "mode": "test", "epoch": 54}
{"loss": 0.2178216427564621, "acc": 0.9102458357810974, "length": 3.5347392559051514, "mode": "train", "epoch": 55}
{"loss": 0.26890331506729126, "acc": 0.9025129675865173, "length": 3.508833885192871, "mode": "test", "epoch": 55}
{"loss": 0.2183527648448944, "acc": 0.911902129650116, "length": 3.5823869705200195, "mode": "train", "epoch": 56}
{"loss": 0.27153486013412476, "acc": 0.8955095410346985, "length": 3.491166114807129, "mode": "test", "epoch": 56}
{"loss": 0.22203189134597778, "acc": 0.9098789691925049, "length": 3.557800769805908, "mode": "train", "epoch": 57}
{"loss": 0.28983816504478455, "acc": 0.8905283808708191, "length": 3.5265016555786133, "mode": "test", "epoch": 57}
{"loss": 0.22488518059253693, "acc": 0.9087352156639099, "length": 3.568796157836914, "mode": "train", "epoch": 58}
{"loss": 0.25667107105255127, "acc": 0.8999752402305603, "length": 3.551236867904663, "mode": "test", "epoch": 58}
{"loss": 0.21616347134113312, "acc": 0.913777232170105, "length": 3.6058237552642822, "mode": "train", "epoch": 59}
{"loss": 0.24378828704357147, "acc": 0.9051601886749268, "length": 3.5441696643829346, "mode": "test", "epoch": 59}
{"loss": 0.2136760801076889, "acc": 0.9141621589660645, "length": 3.6286580562591553, "mode": "train", "epoch": 60}
{"loss": 0.23955222964286804, "acc": 0.9057290554046631, "length": 3.5547702312469482, "mode": "test", "epoch": 60}
test accuracy: 0.8838117122650146
