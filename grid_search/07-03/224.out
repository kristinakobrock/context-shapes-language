# ["--attributes=5", "--values=16", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.0005", "--hidden_size=256", "--temp_update=0.97", "--temperature=2"]
Creating train_ds and val_ds...

Creating test_ds...
{"loss": 0.7042577862739563, "acc": 0.5108612179756165, "length": 2.7038161754608154, "mode": "train", "epoch": 1}
{"loss": 0.6972799301147461, "acc": 0.5110921263694763, "length": 1.0, "mode": "test", "epoch": 1}
{"loss": 0.6774992346763611, "acc": 0.5730207562446594, "length": 1.823344349861145, "mode": "train", "epoch": 2}
{"loss": 0.6315504312515259, "acc": 0.6673880219459534, "length": 2.003412961959839, "mode": "test", "epoch": 2}
{"loss": 0.5698039531707764, "acc": 0.7059064507484436, "length": 2.7102644443511963, "mode": "train", "epoch": 3}
{"loss": 0.5184792876243591, "acc": 0.7558341026306152, "length": 3.29351544380188, "mode": "test", "epoch": 3}
{"loss": 0.46829017996788025, "acc": 0.7875603437423706, "length": 3.318591356277466, "mode": "train", "epoch": 4}
{"loss": 0.48564082384109497, "acc": 0.7538257241249084, "length": 3.600682497024536, "mode": "test", "epoch": 4}
{"loss": 0.4165700376033783, "acc": 0.8130181431770325, "length": 3.5061545372009277, "mode": "train", "epoch": 5}
{"loss": 0.42935991287231445, "acc": 0.8099722862243652, "length": 3.5904436111450195, "mode": "test", "epoch": 5}
{"loss": 0.356294184923172, "acc": 0.8502538204193115, "length": 3.483156204223633, "mode": "train", "epoch": 6}
{"loss": 0.43432050943374634, "acc": 0.8405982851982117, "length": 3.6211605072021484, "mode": "test", "epoch": 6}
{"loss": 0.31176134943962097, "acc": 0.8708275556564331, "length": 3.5650792121887207, "mode": "train", "epoch": 7}
{"loss": 0.40568190813064575, "acc": 0.8406431674957275, "length": 3.6109213829040527, "mode": "test", "epoch": 7}
{"loss": 0.28675758838653564, "acc": 0.8806259632110596, "length": 3.535560131072998, "mode": "train", "epoch": 8}
{"loss": 0.397588312625885, "acc": 0.8454917073249817, "length": 3.5904436111450195, "mode": "test", "epoch": 8}
{"loss": 0.27185556292533875, "acc": 0.8908220529556274, "length": 3.536773681640625, "mode": "train", "epoch": 9}
{"loss": 0.38046887516975403, "acc": 0.852012574672699, "length": 3.6143345832824707, "mode": "test", "epoch": 9}
{"loss": 0.254401296377182, "acc": 0.8948167562484741, "length": 3.6075263023376465, "mode": "train", "epoch": 10}
{"loss": 0.36907047033309937, "acc": 0.856245756149292, "length": 3.5665528774261475, "mode": "test", "epoch": 10}
{"loss": 0.2386820763349533, "acc": 0.9038639664649963, "length": 3.660454511642456, "mode": "train", "epoch": 11}
{"loss": 0.34333714842796326, "acc": 0.8738417625427246, "length": 3.784982919692993, "mode": "test", "epoch": 11}
{"loss": 0.23095647990703583, "acc": 0.9101921319961548, "length": 3.729123592376709, "mode": "train", "epoch": 12}
{"loss": 0.3084467053413391, "acc": 0.8818578124046326, "length": 3.7986347675323486, "mode": "test", "epoch": 12}
{"loss": 0.20999611914157867, "acc": 0.9151051044464111, "length": 3.7832319736480713, "mode": "train", "epoch": 13}
{"loss": 0.31815072894096375, "acc": 0.8720029592514038, "length": 3.8839590549468994, "mode": "test", "epoch": 13}
{"loss": 0.20791095495224, "acc": 0.9159709215164185, "length": 3.8334860801696777, "mode": "train", "epoch": 14}
{"loss": 0.2897398769855499, "acc": 0.8934140801429749, "length": 3.863481283187866, "mode": "test", "epoch": 14}
{"loss": 0.19793972373008728, "acc": 0.9170952439308167, "length": 3.789776086807251, "mode": "train", "epoch": 15}
{"loss": 0.2642664611339569, "acc": 0.8955844640731812, "length": 3.873720169067383, "mode": "test", "epoch": 15}
{"loss": 0.17717665433883667, "acc": 0.9292829632759094, "length": 3.834052562713623, "mode": "train", "epoch": 16}
{"loss": 0.27040037512779236, "acc": 0.9083563089370728, "length": 3.8805460929870605, "mode": "test", "epoch": 16}
{"loss": 0.1842341125011444, "acc": 0.9261561632156372, "length": 3.8268446922302246, "mode": "train", "epoch": 17}
{"loss": 0.2500331997871399, "acc": 0.9071671962738037, "length": 3.791808843612671, "mode": "test", "epoch": 17}
{"loss": 0.16586697101593018, "acc": 0.9333557486534119, "length": 3.8530502319335938, "mode": "train", "epoch": 18}
{"loss": 0.23409166932106018, "acc": 0.9152464270591736, "length": 3.8600683212280273, "mode": "test", "epoch": 18}
{"loss": 0.16227851808071136, "acc": 0.9396088719367981, "length": 3.8639020919799805, "mode": "train", "epoch": 19}
{"loss": 0.22741293907165527, "acc": 0.914750337600708, "length": 3.8566553592681885, "mode": "test", "epoch": 19}
{"loss": 0.15635497868061066, "acc": 0.9395068287849426, "length": 3.8746771812438965, "mode": "train", "epoch": 20}
{"loss": 0.20341502130031586, "acc": 0.9303487539291382, "length": 3.8361775875091553, "mode": "test", "epoch": 20}
{"loss": 0.13913576304912567, "acc": 0.9469215869903564, "length": 3.9019551277160645, "mode": "train", "epoch": 21}
{"loss": 0.2036179155111313, "acc": 0.9302741289138794, "length": 3.8498294353485107, "mode": "test", "epoch": 21}
{"loss": 0.12992742657661438, "acc": 0.9511440992355347, "length": 3.9096696376800537, "mode": "train", "epoch": 22}
{"loss": 0.20450983941555023, "acc": 0.9260398745536804, "length": 3.9010238647460938, "mode": "test", "epoch": 22}
{"loss": 0.1312706172466278, "acc": 0.9506757259368896, "length": 3.9503564834594727, "mode": "train", "epoch": 23}
{"loss": 0.18037518858909607, "acc": 0.9439845085144043, "length": 3.948805570602417, "mode": "test", "epoch": 23}
{"loss": 0.12492038309574127, "acc": 0.9506763815879822, "length": 3.959888219833374, "mode": "train", "epoch": 24}
{"loss": 0.18413417041301727, "acc": 0.936934769153595, "length": 3.9385664463043213, "mode": "test", "epoch": 24}
{"loss": 0.115461066365242, "acc": 0.9589871168136597, "length": 3.961333990097046, "mode": "train", "epoch": 25}
{"loss": 0.17608344554901123, "acc": 0.9390571117401123, "length": 3.9385664463043213, "mode": "test", "epoch": 25}
{"loss": 0.12276184558868408, "acc": 0.9528642296791077, "length": 3.964189052581787, "mode": "train", "epoch": 26}
{"loss": 0.1697760671377182, "acc": 0.9411317110061646, "length": 3.9317405223846436, "mode": "test", "epoch": 26}
{"loss": 0.10645820200443268, "acc": 0.962660551071167, "length": 3.965815305709839, "mode": "train", "epoch": 27}
{"loss": 0.1432652324438095, "acc": 0.9507572054862976, "length": 3.9385664463043213, "mode": "test", "epoch": 27}
{"loss": 0.0964588075876236, "acc": 0.9641949534416199, "length": 3.9692633152008057, "mode": "train", "epoch": 28}
{"loss": 0.15271322429180145, "acc": 0.9496479630470276, "length": 3.9556314945220947, "mode": "test", "epoch": 28}
{"loss": 0.09103647619485855, "acc": 0.9676042795181274, "length": 3.968135356903076, "mode": "train", "epoch": 29}
{"loss": 0.12728644907474518, "acc": 0.9575778841972351, "length": 3.9351534843444824, "mode": "test", "epoch": 29}
{"loss": 0.0808277502655983, "acc": 0.9708173871040344, "length": 3.9737892150878906, "mode": "train", "epoch": 30}
{"loss": 0.12652230262756348, "acc": 0.9557113647460938, "length": 3.9590444564819336, "mode": "test", "epoch": 30}
{"loss": 0.08296751976013184, "acc": 0.9697244763374329, "length": 3.97735857963562, "mode": "train", "epoch": 31}
{"loss": 0.11910658329725266, "acc": 0.9604895114898682, "length": 3.9829351902008057, "mode": "test", "epoch": 31}
{"loss": 0.07808959484100342, "acc": 0.9726302623748779, "length": 3.9887466430664062, "mode": "train", "epoch": 32}
{"loss": 0.1350063532590866, "acc": 0.9562766551971436, "length": 3.996587038040161, "mode": "test", "epoch": 32}
{"loss": 0.06951369345188141, "acc": 0.9765043258666992, "length": 3.989048480987549, "mode": "train", "epoch": 33}
{"loss": 0.1268182247877121, "acc": 0.9654917120933533, "length": 3.9829351902008057, "mode": "test", "epoch": 33}
{"loss": 0.07026401907205582, "acc": 0.9755920767784119, "length": 3.992192268371582, "mode": "train", "epoch": 34}
{"loss": 0.13667552173137665, "acc": 0.9585323333740234, "length": 4.0, "mode": "test", "epoch": 34}
{"loss": 0.0625571608543396, "acc": 0.9781242609024048, "length": 3.992363452911377, "mode": "train", "epoch": 35}
{"loss": 0.1641792505979538, "acc": 0.9581910967826843, "length": 4.0, "mode": "test", "epoch": 35}
{"loss": 0.08433780819177628, "acc": 0.9727848172187805, "length": 3.987942934036255, "mode": "train", "epoch": 36}
{"loss": 0.1221890076994896, "acc": 0.9580098986625671, "length": 3.996587038040161, "mode": "test", "epoch": 36}
{"loss": 0.0744226947426796, "acc": 0.9743959903717041, "length": 3.990189552307129, "mode": "train", "epoch": 37}
{"loss": 0.08716685324907303, "acc": 0.9713310599327087, "length": 4.0, "mode": "test", "epoch": 37}
{"loss": 0.06862061470746994, "acc": 0.977469265460968, "length": 3.990467071533203, "mode": "train", "epoch": 38}
{"loss": 0.10568542778491974, "acc": 0.9667234420776367, "length": 4.0, "mode": "test", "epoch": 38}
{"loss": 0.07215335965156555, "acc": 0.9766165614128113, "length": 3.9877727031707764, "mode": "train", "epoch": 39}
{"loss": 0.07891140133142471, "acc": 0.975885272026062, "length": 3.9829351902008057, "mode": "test", "epoch": 39}
{"loss": 0.07172069698572159, "acc": 0.9780916571617126, "length": 3.990123748779297, "mode": "train", "epoch": 40}
{"loss": 0.09981035441160202, "acc": 0.9678594470024109, "length": 3.996587038040161, "mode": "test", "epoch": 40}
{"loss": 0.07596613466739655, "acc": 0.976349413394928, "length": 3.988581657409668, "mode": "train", "epoch": 41}
{"loss": 0.10227294266223907, "acc": 0.969501793384552, "length": 3.996587038040161, "mode": "test", "epoch": 41}
{"loss": 0.06545084714889526, "acc": 0.9785977602005005, "length": 3.9905333518981934, "mode": "train", "epoch": 42}
{"loss": 0.08937440067529678, "acc": 0.9699658155441284, "length": 4.0, "mode": "test", "epoch": 42}
{"loss": 0.04991348832845688, "acc": 0.9847169518470764, "length": 3.994703769683838, "mode": "train", "epoch": 43}
{"loss": 0.06762071698904037, "acc": 0.9791809916496277, "length": 4.0, "mode": "test", "epoch": 43}
{"loss": 0.03938252851366997, "acc": 0.9883182048797607, "length": 3.9969427585601807, "mode": "train", "epoch": 44}
{"loss": 0.0800064206123352, "acc": 0.9716722965240479, "length": 4.0, "mode": "test", "epoch": 44}
{"loss": 0.04253368452191353, "acc": 0.9872506260871887, "length": 3.996793270111084, "mode": "train", "epoch": 45}
{"loss": 0.0740504190325737, "acc": 0.9813991785049438, "length": 4.0, "mode": "test", "epoch": 45}
{"loss": 0.040925174951553345, "acc": 0.9886984825134277, "length": 3.9969260692596436, "mode": "train", "epoch": 46}
{"loss": 0.07977328449487686, "acc": 0.9800342321395874, "length": 4.0, "mode": "test", "epoch": 46}
{"loss": 0.037530817091464996, "acc": 0.9881168007850647, "length": 3.996652841567993, "mode": "train", "epoch": 47}
{"loss": 0.10250478237867355, "acc": 0.9767917394638062, "length": 4.0, "mode": "test", "epoch": 47}
{"loss": 0.06314405798912048, "acc": 0.9826087951660156, "length": 3.9966490268707275, "mode": "train", "epoch": 48}
{"loss": 0.10576572269201279, "acc": 0.9723549485206604, "length": 4.0, "mode": "test", "epoch": 48}
{"loss": 0.08471988141536713, "acc": 0.9710594415664673, "length": 3.9979138374328613, "mode": "train", "epoch": 49}
{"loss": 0.1145525574684143, "acc": 0.9646757245063782, "length": 4.0, "mode": "test", "epoch": 49}
{"loss": 0.06357681751251221, "acc": 0.9782742261886597, "length": 3.999845504760742, "mode": "train", "epoch": 50}
{"loss": 0.09732001274824142, "acc": 0.9730377793312073, "length": 4.0, "mode": "test", "epoch": 50}
{"loss": 0.06336597353219986, "acc": 0.9799191355705261, "length": 3.9986846446990967, "mode": "train", "epoch": 51}
{"loss": 0.11571458727121353, "acc": 0.9605802297592163, "length": 4.0, "mode": "test", "epoch": 51}
{"loss": 0.08402522653341293, "acc": 0.9732064604759216, "length": 3.9977617263793945, "mode": "train", "epoch": 52}
{"loss": 0.14075230062007904, "acc": 0.9658703207969666, "length": 4.0, "mode": "test", "epoch": 52}
{"loss": 0.07235263288021088, "acc": 0.9763281941413879, "length": 3.9993088245391846, "mode": "train", "epoch": 53}
{"loss": 0.07219813019037247, "acc": 0.9784982204437256, "length": 4.0, "mode": "test", "epoch": 53}
{"loss": 0.04366685077548027, "acc": 0.9862463474273682, "length": 3.9995903968811035, "mode": "train", "epoch": 54}
{"loss": 0.08733134716749191, "acc": 0.9718430042266846, "length": 4.0, "mode": "test", "epoch": 54}
{"loss": 0.034630026668310165, "acc": 0.9900464415550232, "length": 3.9986486434936523, "mode": "train", "epoch": 55}
{"loss": 0.08367182314395905, "acc": 0.97713303565979, "length": 4.0, "mode": "test", "epoch": 55}
{"loss": 0.03975116088986397, "acc": 0.9880262613296509, "length": 3.9999401569366455, "mode": "train", "epoch": 56}
{"loss": 0.09250901639461517, "acc": 0.9773038625717163, "length": 4.0, "mode": "test", "epoch": 56}
{"loss": 0.03211281821131706, "acc": 0.9900187849998474, "length": 3.999756336212158, "mode": "train", "epoch": 57}
{"loss": 0.06143916770815849, "acc": 0.9846416115760803, "length": 4.0, "mode": "test", "epoch": 57}
{"loss": 0.025746621191501617, "acc": 0.9929747581481934, "length": 3.9996540546417236, "mode": "train", "epoch": 58}
{"loss": 0.06201880797743797, "acc": 0.9851535558700562, "length": 4.0, "mode": "test", "epoch": 58}
{"loss": 0.04087476804852486, "acc": 0.9876793622970581, "length": 3.999614953994751, "mode": "train", "epoch": 59}
{"loss": 0.05505761504173279, "acc": 0.9909555315971375, "length": 4.0, "mode": "test", "epoch": 59}
{"loss": 0.031128428876399994, "acc": 0.9915504455566406, "length": 3.999462366104126, "mode": "train", "epoch": 60}
{"loss": 0.07036269456148148, "acc": 0.9844710230827332, "length": 4.0, "mode": "test", "epoch": 60}
test accuracy: 0.824444591999054
