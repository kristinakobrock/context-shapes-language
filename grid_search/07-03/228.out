# ["--attributes=5", "--values=16", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.97", "--temperature=1"]
Creating train_ds and val_ds...

Creating test_ds...
{"loss": 0.6942508816719055, "acc": 0.5252814292907715, "length": 3.4092161655426025, "mode": "train", "epoch": 1}
{"loss": 0.6808056235313416, "acc": 0.5758287906646729, "length": 1.737410068511963, "mode": "test", "epoch": 1}
{"loss": 0.6365405917167664, "acc": 0.6519835591316223, "length": 3.3531930446624756, "mode": "train", "epoch": 2}
{"loss": 0.567065417766571, "acc": 0.6985611319541931, "length": 4.0, "mode": "test", "epoch": 2}
{"loss": 0.5172399282455444, "acc": 0.7556689381599426, "length": 3.8928239345550537, "mode": "train", "epoch": 3}
{"loss": 0.44386592507362366, "acc": 0.8163667917251587, "length": 4.0, "mode": "test", "epoch": 3}
{"loss": 0.40565720200538635, "acc": 0.8210471272468567, "length": 3.9852170944213867, "mode": "train", "epoch": 4}
{"loss": 0.37971898913383484, "acc": 0.8303956985473633, "length": 4.0, "mode": "test", "epoch": 4}
{"loss": 0.3756074905395508, "acc": 0.832125723361969, "length": 3.9901821613311768, "mode": "train", "epoch": 5}
{"loss": 0.3611142933368683, "acc": 0.8316546678543091, "length": 4.0, "mode": "test", "epoch": 5}
{"loss": 0.3528125584125519, "acc": 0.8443185091018677, "length": 3.993333339691162, "mode": "train", "epoch": 6}
{"loss": 0.355579674243927, "acc": 0.8406475186347961, "length": 4.0, "mode": "test", "epoch": 6}
{"loss": 0.33482909202575684, "acc": 0.8524875640869141, "length": 3.994472026824951, "mode": "train", "epoch": 7}
{"loss": 0.3320504128932953, "acc": 0.8562950491905212, "length": 4.0, "mode": "test", "epoch": 7}
{"loss": 0.3252469003200531, "acc": 0.8603509664535522, "length": 3.996417760848999, "mode": "train", "epoch": 8}
{"loss": 0.3233899474143982, "acc": 0.8566546440124512, "length": 4.0, "mode": "test", "epoch": 8}
{"loss": 0.31522178649902344, "acc": 0.8652244210243225, "length": 3.9970479011535645, "mode": "train", "epoch": 9}
{"loss": 0.3203561007976532, "acc": 0.8629496693611145, "length": 4.0, "mode": "test", "epoch": 9}
{"loss": 0.3032498359680176, "acc": 0.8635016679763794, "length": 3.998426914215088, "mode": "train", "epoch": 10}
{"loss": 0.31435853242874146, "acc": 0.8658273816108704, "length": 4.0, "mode": "test", "epoch": 10}
{"loss": 0.29357531666755676, "acc": 0.8701216578483582, "length": 3.999089479446411, "mode": "train", "epoch": 11}
{"loss": 0.28760290145874023, "acc": 0.8732014894485474, "length": 4.0, "mode": "test", "epoch": 11}
{"loss": 0.28374847769737244, "acc": 0.8769634962081909, "length": 3.9982492923736572, "mode": "train", "epoch": 12}
{"loss": 0.2840023934841156, "acc": 0.8800360560417175, "length": 4.0, "mode": "test", "epoch": 12}
{"loss": 0.2773342728614807, "acc": 0.8800963163375854, "length": 3.9993531703948975, "mode": "train", "epoch": 13}
{"loss": 0.2647789716720581, "acc": 0.8901079297065735, "length": 4.0, "mode": "test", "epoch": 13}
{"loss": 0.2567667067050934, "acc": 0.8916904926300049, "length": 3.998915433883667, "mode": "train", "epoch": 14}
{"loss": 0.26423725485801697, "acc": 0.8964029550552368, "length": 4.0, "mode": "test", "epoch": 14}
{"loss": 0.24826373159885406, "acc": 0.8953572511672974, "length": 3.9987146854400635, "mode": "train", "epoch": 15}
{"loss": 0.25851568579673767, "acc": 0.9073739647865295, "length": 4.0, "mode": "test", "epoch": 15}
{"loss": 0.2418050467967987, "acc": 0.8995193243026733, "length": 3.9964849948883057, "mode": "train", "epoch": 16}
{"loss": 0.24588163197040558, "acc": 0.9062948822975159, "length": 4.0, "mode": "test", "epoch": 16}
{"loss": 0.21999981999397278, "acc": 0.9105653762817383, "length": 3.9988327026367188, "mode": "train", "epoch": 17}
{"loss": 0.21709731221199036, "acc": 0.9136691689491272, "length": 4.0, "mode": "test", "epoch": 17}
{"loss": 0.2168855518102646, "acc": 0.9135742783546448, "length": 3.9964101314544678, "mode": "train", "epoch": 18}
{"loss": 0.2191297560930252, "acc": 0.9165467023849487, "length": 4.0, "mode": "test", "epoch": 18}
{"loss": 0.20528119802474976, "acc": 0.9174113869667053, "length": 3.9991047382354736, "mode": "train", "epoch": 19}
{"loss": 0.22975288331508636, "acc": 0.9152877926826477, "length": 4.0, "mode": "test", "epoch": 19}
{"loss": 0.19149453938007355, "acc": 0.9243806600570679, "length": 3.9994428157806396, "mode": "train", "epoch": 20}
{"loss": 0.1994813233613968, "acc": 0.9320142865180969, "length": 4.0, "mode": "test", "epoch": 20}
{"loss": 0.19449013471603394, "acc": 0.9251832962036133, "length": 3.9984793663024902, "mode": "train", "epoch": 21}
{"loss": 0.2110595852136612, "acc": 0.9212229251861572, "length": 4.0, "mode": "test", "epoch": 21}
{"loss": 0.19205747544765472, "acc": 0.922199010848999, "length": 3.9962003231048584, "mode": "train", "epoch": 22}
{"loss": 0.18344970047473907, "acc": 0.9327338933944702, "length": 4.0, "mode": "test", "epoch": 22}
{"loss": 0.1760791391134262, "acc": 0.9325892925262451, "length": 3.997757911682129, "mode": "train", "epoch": 23}
{"loss": 0.17986604571342468, "acc": 0.9356115460395813, "length": 4.0, "mode": "test", "epoch": 23}
{"loss": 0.17400848865509033, "acc": 0.9338588118553162, "length": 3.999107599258423, "mode": "train", "epoch": 24}
{"loss": 0.20843015611171722, "acc": 0.9208633303642273, "length": 4.0, "mode": "test", "epoch": 24}
{"loss": 0.1783924102783203, "acc": 0.9289008378982544, "length": 3.9997572898864746, "mode": "train", "epoch": 25}
{"loss": 0.17366261780261993, "acc": 0.9352517127990723, "length": 4.0, "mode": "test", "epoch": 25}
{"loss": 0.17165198922157288, "acc": 0.9304662346839905, "length": 3.9999051094055176, "mode": "train", "epoch": 26}
{"loss": 0.1919393688440323, "acc": 0.928956925868988, "length": 4.0, "mode": "test", "epoch": 26}
{"loss": 0.16701512038707733, "acc": 0.9349396824836731, "length": 3.998856544494629, "mode": "train", "epoch": 27}
{"loss": 0.18147632479667664, "acc": 0.9327337741851807, "length": 4.0, "mode": "test", "epoch": 27}
{"loss": 0.16810815036296844, "acc": 0.9387566447257996, "length": 3.9997472763061523, "mode": "train", "epoch": 28}
{"loss": 0.1688978224992752, "acc": 0.9356114268302917, "length": 4.0, "mode": "test", "epoch": 28}
{"loss": 0.15064358711242676, "acc": 0.9404410123825073, "length": 3.9998817443847656, "mode": "train", "epoch": 29}
{"loss": 0.19025357067584991, "acc": 0.9246403574943542, "length": 4.0, "mode": "test", "epoch": 29}
{"loss": 0.15152865648269653, "acc": 0.9419301152229309, "length": 3.99957013130188, "mode": "train", "epoch": 30}
{"loss": 0.1833566576242447, "acc": 0.9241006970405579, "length": 4.0, "mode": "test", "epoch": 30}
{"loss": 0.16139112412929535, "acc": 0.9384901523590088, "length": 3.997836112976074, "mode": "train", "epoch": 31}
{"loss": 0.19639651477336884, "acc": 0.9257194399833679, "length": 4.0, "mode": "test", "epoch": 31}
{"loss": 0.16258485615253448, "acc": 0.9374969005584717, "length": 3.999886989593506, "mode": "train", "epoch": 32}
{"loss": 0.19022075831890106, "acc": 0.9287770390510559, "length": 4.0, "mode": "test", "epoch": 32}
{"loss": 0.18601937592029572, "acc": 0.9248631000518799, "length": 3.998264789581299, "mode": "train", "epoch": 33}
{"loss": 0.19333167374134064, "acc": 0.9170864224433899, "length": 4.0, "mode": "test", "epoch": 33}
{"loss": 0.17620468139648438, "acc": 0.9299809336662292, "length": 3.9995980262756348, "mode": "train", "epoch": 34}
{"loss": 0.19373548030853271, "acc": 0.9221222996711731, "length": 4.0, "mode": "test", "epoch": 34}
{"loss": 0.15965691208839417, "acc": 0.9327506422996521, "length": 3.9999148845672607, "mode": "train", "epoch": 35}
{"loss": 0.17030909657478333, "acc": 0.9312949180603027, "length": 4.0, "mode": "test", "epoch": 35}
{"loss": 0.14422361552715302, "acc": 0.9450610876083374, "length": 3.9996120929718018, "mode": "train", "epoch": 36}
{"loss": 0.1590421348810196, "acc": 0.9390287399291992, "length": 4.0, "mode": "test", "epoch": 36}
{"loss": 0.13849718868732452, "acc": 0.9452365636825562, "length": 3.9996416568756104, "mode": "train", "epoch": 37}
{"loss": 0.1607929915189743, "acc": 0.9325539469718933, "length": 4.0, "mode": "test", "epoch": 37}
{"loss": 0.1380046308040619, "acc": 0.9436878561973572, "length": 3.999922275543213, "mode": "train", "epoch": 38}
{"loss": 0.15638108551502228, "acc": 0.9442445039749146, "length": 4.0, "mode": "test", "epoch": 38}
{"loss": 0.1489575058221817, "acc": 0.9419459700584412, "length": 3.9999680519104004, "mode": "train", "epoch": 39}
{"loss": 0.1614265888929367, "acc": 0.9368704557418823, "length": 4.0, "mode": "test", "epoch": 39}
{"loss": 0.13717997074127197, "acc": 0.9450715780258179, "length": 3.999974250793457, "mode": "train", "epoch": 40}
{"loss": 0.14536340534687042, "acc": 0.9462229609489441, "length": 4.0, "mode": "test", "epoch": 40}
{"loss": 0.1354282945394516, "acc": 0.9480756521224976, "length": 3.999847888946533, "mode": "train", "epoch": 41}
{"loss": 0.1621330827474594, "acc": 0.9429857134819031, "length": 4.0, "mode": "test", "epoch": 41}
{"loss": 0.13966944813728333, "acc": 0.9448899030685425, "length": 3.9999406337738037, "mode": "train", "epoch": 42}
{"loss": 0.15403598546981812, "acc": 0.9437049627304077, "length": 4.0, "mode": "test", "epoch": 42}
{"loss": 0.13193507492542267, "acc": 0.9466748833656311, "length": 3.9976887702941895, "mode": "train", "epoch": 43}
{"loss": 0.13431879878044128, "acc": 0.9491007328033447, "length": 4.0, "mode": "test", "epoch": 43}
{"loss": 0.11736416071653366, "acc": 0.9537853002548218, "length": 3.9999818801879883, "mode": "train", "epoch": 44}
{"loss": 0.14000968635082245, "acc": 0.9471222758293152, "length": 4.0, "mode": "test", "epoch": 44}
{"loss": 0.12004882097244263, "acc": 0.9520081877708435, "length": 3.997478723526001, "mode": "train", "epoch": 45}
{"loss": 0.16579796373844147, "acc": 0.9442446231842041, "length": 4.0, "mode": "test", "epoch": 45}
{"loss": 0.12268970161676407, "acc": 0.9523429870605469, "length": 3.999962091445923, "mode": "train", "epoch": 46}
{"loss": 0.1606966108083725, "acc": 0.9419066309928894, "length": 4.0, "mode": "test", "epoch": 46}
{"loss": 0.1149449497461319, "acc": 0.9527974724769592, "length": 3.9994378089904785, "mode": "train", "epoch": 47}
{"loss": 0.13638420403003693, "acc": 0.9444246292114258, "length": 4.0, "mode": "test", "epoch": 47}
{"loss": 0.1127178817987442, "acc": 0.9539660811424255, "length": 3.999995231628418, "mode": "train", "epoch": 48}
{"loss": 0.13909848034381866, "acc": 0.9453238248825073, "length": 4.0, "mode": "test", "epoch": 48}
{"loss": 0.11680316179990768, "acc": 0.9532446265220642, "length": 3.999976873397827, "mode": "train", "epoch": 49}
{"loss": 0.13576540350914001, "acc": 0.9473021626472473, "length": 4.0, "mode": "test", "epoch": 49}
{"loss": 0.12171659618616104, "acc": 0.9505528211593628, "length": 3.9986634254455566, "mode": "train", "epoch": 50}
{"loss": 0.1579793393611908, "acc": 0.9444243907928467, "length": 4.0, "mode": "test", "epoch": 50}
{"loss": 0.1167907640337944, "acc": 0.9525008797645569, "length": 3.999126434326172, "mode": "train", "epoch": 51}
{"loss": 0.1494133025407791, "acc": 0.9458632469177246, "length": 4.0, "mode": "test", "epoch": 51}
{"loss": 0.11677008867263794, "acc": 0.9535455107688904, "length": 3.9969282150268555, "mode": "train", "epoch": 52}
{"loss": 0.15656152367591858, "acc": 0.9422662258148193, "length": 4.0, "mode": "test", "epoch": 52}
{"loss": 0.11206426471471786, "acc": 0.955406129360199, "length": 3.9998586177825928, "mode": "train", "epoch": 53}
{"loss": 0.12772563099861145, "acc": 0.9508993029594421, "length": 4.0, "mode": "test", "epoch": 53}
{"loss": 0.10876114666461945, "acc": 0.954565167427063, "length": 3.998216390609741, "mode": "train", "epoch": 54}
{"loss": 0.14300653338432312, "acc": 0.9478416442871094, "length": 4.0, "mode": "test", "epoch": 54}
{"loss": 0.10763677954673767, "acc": 0.9549858570098877, "length": 3.9999632835388184, "mode": "train", "epoch": 55}
{"loss": 0.13271450996398926, "acc": 0.9508993029594421, "length": 4.0, "mode": "test", "epoch": 55}
{"loss": 0.12484545260667801, "acc": 0.949337899684906, "length": 3.9999759197235107, "mode": "train", "epoch": 56}
{"loss": 0.15793460607528687, "acc": 0.944604218006134, "length": 4.0, "mode": "test", "epoch": 56}
{"loss": 0.1162087693810463, "acc": 0.9501177668571472, "length": 3.999941349029541, "mode": "train", "epoch": 57}
{"loss": 0.1253337562084198, "acc": 0.9546762108802795, "length": 4.0, "mode": "test", "epoch": 57}
{"loss": 0.10669852048158646, "acc": 0.9558872580528259, "length": 3.9999449253082275, "mode": "train", "epoch": 58}
{"loss": 0.1655205935239792, "acc": 0.9424460530281067, "length": 4.0, "mode": "test", "epoch": 58}
{"loss": 0.10668683797121048, "acc": 0.9550474882125854, "length": 3.9998998641967773, "mode": "train", "epoch": 59}
{"loss": 0.14144781231880188, "acc": 0.9447840452194214, "length": 4.0, "mode": "test", "epoch": 59}
{"loss": 0.1099458783864975, "acc": 0.9564200043678284, "length": 3.9996695518493652, "mode": "train", "epoch": 60}
{"loss": 0.1180046945810318, "acc": 0.9577339291572571, "length": 4.0, "mode": "test", "epoch": 60}
test accuracy: 0.8840909004211426
