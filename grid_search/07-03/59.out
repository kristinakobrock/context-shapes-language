# ["--attributes=3", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=128", "--learning_rate=0.0005", "--hidden_size=256", "--temp_update=0.99", "--temperature=2"]
Creating train_ds and val_ds...

Creating test_ds...
{"loss": 0.7037985920906067, "acc": 0.5217118859291077, "length": 3.4963667392730713, "mode": "train", "epoch": 1}
{"loss": 0.6877073645591736, "acc": 0.5668941736221313, "length": 1.0, "mode": "test", "epoch": 1}
{"loss": 0.6931717395782471, "acc": 0.5375784635543823, "length": 3.280543565750122, "mode": "train", "epoch": 2}
{"loss": 0.700824499130249, "acc": 0.4602389335632324, "length": 1.0, "mode": "test", "epoch": 2}
{"loss": 0.6875633001327515, "acc": 0.5447721481323242, "length": 2.885707139968872, "mode": "train", "epoch": 3}
{"loss": 0.6901943683624268, "acc": 0.5238909125328064, "length": 1.0, "mode": "test", "epoch": 3}
{"loss": 0.6770646572113037, "acc": 0.578424870967865, "length": 2.698809862136841, "mode": "train", "epoch": 4}
{"loss": 0.6707849502563477, "acc": 0.6346656680107117, "length": 1.6279863119125366, "mode": "test", "epoch": 4}
{"loss": 0.6515812277793884, "acc": 0.6338251829147339, "length": 2.9525508880615234, "mode": "train", "epoch": 5}
{"loss": 0.6056665778160095, "acc": 0.7151476740837097, "length": 3.0716724395751953, "mode": "test", "epoch": 5}
{"loss": 0.6009052991867065, "acc": 0.75614333152771, "length": 3.2769923210144043, "mode": "train", "epoch": 6}
{"loss": 0.5458208322525024, "acc": 0.7610083818435669, "length": 3.549488067626953, "mode": "test", "epoch": 6}
{"loss": 0.5248988270759583, "acc": 0.7985205054283142, "length": 3.4465086460113525, "mode": "train", "epoch": 7}
{"loss": 0.4895356297492981, "acc": 0.7869020104408264, "length": 3.6143345832824707, "mode": "test", "epoch": 7}
{"loss": 0.44967296719551086, "acc": 0.8115110993385315, "length": 3.5009031295776367, "mode": "train", "epoch": 8}
{"loss": 0.47414451837539673, "acc": 0.7831341624259949, "length": 3.6211605072021484, "mode": "test", "epoch": 8}
{"loss": 0.39894917607307434, "acc": 0.8262109756469727, "length": 3.508254289627075, "mode": "train", "epoch": 9}
{"loss": 0.45039913058280945, "acc": 0.808760941028595, "length": 3.573378801345825, "mode": "test", "epoch": 9}
{"loss": 0.35916104912757874, "acc": 0.8449366092681885, "length": 3.5018982887268066, "mode": "train", "epoch": 10}
{"loss": 0.41426634788513184, "acc": 0.8342267870903015, "length": 3.580204725265503, "mode": "test", "epoch": 10}
{"loss": 0.3270251154899597, "acc": 0.8642020225524902, "length": 3.499685525894165, "mode": "train", "epoch": 11}
{"loss": 0.39654308557510376, "acc": 0.8515084981918335, "length": 3.604095458984375, "mode": "test", "epoch": 11}
{"loss": 0.3038489818572998, "acc": 0.8776191473007202, "length": 3.511275291442871, "mode": "train", "epoch": 12}
{"loss": 0.40003570914268494, "acc": 0.8422319889068604, "length": 3.686006784439087, "mode": "test", "epoch": 12}
{"loss": 0.28334712982177734, "acc": 0.8888145685195923, "length": 3.5405678749084473, "mode": "train", "epoch": 13}
{"loss": 0.39122599363327026, "acc": 0.8679471015930176, "length": 3.767918109893799, "mode": "test", "epoch": 13}
{"loss": 0.262908935546875, "acc": 0.8941518068313599, "length": 3.648810625076294, "mode": "train", "epoch": 14}
{"loss": 0.4089808166027069, "acc": 0.8565713167190552, "length": 3.8054606914520264, "mode": "test", "epoch": 14}
{"loss": 0.24787522852420807, "acc": 0.9015458822250366, "length": 3.6601550579071045, "mode": "train", "epoch": 15}
{"loss": 0.38254493474960327, "acc": 0.8643844723701477, "length": 3.8361775875091553, "mode": "test", "epoch": 15}
{"loss": 0.2244955599308014, "acc": 0.9126675128936768, "length": 3.693673610687256, "mode": "train", "epoch": 16}
{"loss": 0.4064950942993164, "acc": 0.8584253191947937, "length": 3.894197940826416, "mode": "test", "epoch": 16}
{"loss": 0.21347086131572723, "acc": 0.9180091023445129, "length": 3.704451560974121, "mode": "train", "epoch": 17}
{"loss": 0.38276106119155884, "acc": 0.860365629196167, "length": 3.870307207107544, "mode": "test", "epoch": 17}
{"loss": 0.2025623619556427, "acc": 0.9214608669281006, "length": 3.743669033050537, "mode": "train", "epoch": 18}
{"loss": 0.37257659435272217, "acc": 0.8682112693786621, "length": 3.897610902786255, "mode": "test", "epoch": 18}
{"loss": 0.19125805795192719, "acc": 0.9252719283103943, "length": 3.7597994804382324, "mode": "train", "epoch": 19}
{"loss": 0.343370258808136, "acc": 0.8858715295791626, "length": 3.819112539291382, "mode": "test", "epoch": 19}
{"loss": 0.18039165437221527, "acc": 0.9347134232521057, "length": 3.7694880962371826, "mode": "train", "epoch": 20}
{"loss": 0.3414090871810913, "acc": 0.8759581446647644, "length": 3.843003511428833, "mode": "test", "epoch": 20}
{"loss": 0.16857953369617462, "acc": 0.9368476867675781, "length": 3.7826881408691406, "mode": "train", "epoch": 21}
{"loss": 0.309386670589447, "acc": 0.8919990062713623, "length": 3.8600683212280273, "mode": "test", "epoch": 21}
{"loss": 0.15578705072402954, "acc": 0.9444452524185181, "length": 3.771758556365967, "mode": "train", "epoch": 22}
{"loss": 0.29124027490615845, "acc": 0.8934886455535889, "length": 3.839590549468994, "mode": "test", "epoch": 22}
{"loss": 0.14594200253486633, "acc": 0.945732593536377, "length": 3.809680461883545, "mode": "train", "epoch": 23}
{"loss": 0.30233868956565857, "acc": 0.9000183939933777, "length": 3.8771331310272217, "mode": "test", "epoch": 23}
{"loss": 0.13785620033740997, "acc": 0.9490380883216858, "length": 3.823582649230957, "mode": "train", "epoch": 24}
{"loss": 0.31332239508628845, "acc": 0.898587167263031, "length": 3.873720169067383, "mode": "test", "epoch": 24}
{"loss": 0.1312667429447174, "acc": 0.9522159695625305, "length": 3.8328495025634766, "mode": "train", "epoch": 25}
{"loss": 0.30889540910720825, "acc": 0.9020113945007324, "length": 3.8805460929870605, "mode": "test", "epoch": 25}
{"loss": 0.12805263698101044, "acc": 0.9549900889396667, "length": 3.809807300567627, "mode": "train", "epoch": 26}
{"loss": 0.3377484083175659, "acc": 0.8951689004898071, "length": 3.8873720169067383, "mode": "test", "epoch": 26}
{"loss": 0.11855164170265198, "acc": 0.9593738317489624, "length": 3.8291661739349365, "mode": "train", "epoch": 27}
{"loss": 0.3152375817298889, "acc": 0.904508650302887, "length": 3.8873720169067383, "mode": "test", "epoch": 27}
{"loss": 0.11984992772340775, "acc": 0.9598637223243713, "length": 3.817227840423584, "mode": "train", "epoch": 28}
{"loss": 0.3032660186290741, "acc": 0.9111078381538391, "length": 3.843003511428833, "mode": "test", "epoch": 28}
{"loss": 0.10772021114826202, "acc": 0.9659358263015747, "length": 3.804070234298706, "mode": "train", "epoch": 29}
{"loss": 0.27921563386917114, "acc": 0.9148833751678467, "length": 3.870307207107544, "mode": "test", "epoch": 29}
{"loss": 0.10842600464820862, "acc": 0.9644213318824768, "length": 3.8203580379486084, "mode": "train", "epoch": 30}
{"loss": 0.28889650106430054, "acc": 0.915982723236084, "length": 3.8873720169067383, "mode": "test", "epoch": 30}
{"loss": 0.10532224923372269, "acc": 0.964561402797699, "length": 3.868784189224243, "mode": "train", "epoch": 31}
{"loss": 0.2774626612663269, "acc": 0.9111491441726685, "length": 3.9112627506256104, "mode": "test", "epoch": 31}
{"loss": 0.1008332148194313, "acc": 0.9650276303291321, "length": 3.8695638179779053, "mode": "train", "epoch": 32}
{"loss": 0.2609201669692993, "acc": 0.9162046909332275, "length": 3.894197940826416, "mode": "test", "epoch": 32}
{"loss": 0.1050650104880333, "acc": 0.9631071090698242, "length": 3.8546597957611084, "mode": "train", "epoch": 33}
{"loss": 0.27577894926071167, "acc": 0.9199893474578857, "length": 3.870307207107544, "mode": "test", "epoch": 33}
{"loss": 0.10084230452775955, "acc": 0.966717004776001, "length": 3.8734145164489746, "mode": "train", "epoch": 34}
{"loss": 0.22064843773841858, "acc": 0.9254217147827148, "length": 3.914675712585449, "mode": "test", "epoch": 34}
{"loss": 0.0972687229514122, "acc": 0.9658505916595459, "length": 3.8709635734558105, "mode": "train", "epoch": 35}
{"loss": 0.28185009956359863, "acc": 0.9209840297698975, "length": 3.9112627506256104, "mode": "test", "epoch": 35}
{"loss": 0.09316661208868027, "acc": 0.9681292772293091, "length": 3.8845694065093994, "mode": "train", "epoch": 36}
{"loss": 0.2780691385269165, "acc": 0.9176492094993591, "length": 3.9317405223846436, "mode": "test", "epoch": 36}
{"loss": 0.08905526995658875, "acc": 0.9713225960731506, "length": 3.8945629596710205, "mode": "train", "epoch": 37}
{"loss": 0.26593953371047974, "acc": 0.9307155013084412, "length": 3.918088674545288, "mode": "test", "epoch": 37}
{"loss": 0.09144265949726105, "acc": 0.9696082472801208, "length": 3.9037203788757324, "mode": "train", "epoch": 38}
{"loss": 0.20418821275234222, "acc": 0.9307599067687988, "length": 3.9351534843444824, "mode": "test", "epoch": 38}
{"loss": 0.09027447551488876, "acc": 0.9705828428268433, "length": 3.9356393814086914, "mode": "train", "epoch": 39}
{"loss": 0.23582451045513153, "acc": 0.931383490562439, "length": 3.94197940826416, "mode": "test", "epoch": 39}
{"loss": 0.09023966640233994, "acc": 0.9692863821983337, "length": 3.9144177436828613, "mode": "train", "epoch": 40}
{"loss": 0.22233562171459198, "acc": 0.9297094941139221, "length": 3.9590444564819336, "mode": "test", "epoch": 40}
{"loss": 0.07929597049951553, "acc": 0.9721894264221191, "length": 3.932614326477051, "mode": "train", "epoch": 41}
{"loss": 0.22967414557933807, "acc": 0.9323359727859497, "length": 3.952218532562256, "mode": "test", "epoch": 41}
{"loss": 0.07863759994506836, "acc": 0.9722864031791687, "length": 3.9439918994903564, "mode": "train", "epoch": 42}
{"loss": 0.21813830733299255, "acc": 0.9382508397102356, "length": 3.96928334236145, "mode": "test", "epoch": 42}
{"loss": 0.08335579931735992, "acc": 0.972534716129303, "length": 3.939103841781616, "mode": "train", "epoch": 43}
{"loss": 0.20347318053245544, "acc": 0.9452401995658875, "length": 3.9556314945220947, "mode": "test", "epoch": 43}
{"loss": 0.07292987406253815, "acc": 0.9745578765869141, "length": 3.91214656829834, "mode": "train", "epoch": 44}
{"loss": 0.18393050134181976, "acc": 0.946496307849884, "length": 3.948805570602417, "mode": "test", "epoch": 44}
{"loss": 0.06991973519325256, "acc": 0.9740750789642334, "length": 3.935906171798706, "mode": "train", "epoch": 45}
{"loss": 0.1681908220052719, "acc": 0.9504572749137878, "length": 3.9931740760803223, "mode": "test", "epoch": 45}
{"loss": 0.06819576025009155, "acc": 0.9773829579353333, "length": 3.948059558868408, "mode": "train", "epoch": 46}
{"loss": 0.1849147081375122, "acc": 0.9454724788665771, "length": 3.9658703804016113, "mode": "test", "epoch": 46}
{"loss": 0.06552662700414658, "acc": 0.9777326583862305, "length": 3.9423248767852783, "mode": "train", "epoch": 47}
{"loss": 0.17729094624519348, "acc": 0.9469510912895203, "length": 3.9556314945220947, "mode": "test", "epoch": 47}
{"loss": 0.06648044288158417, "acc": 0.977728545665741, "length": 3.9194254875183105, "mode": "train", "epoch": 48}
{"loss": 0.14810268580913544, "acc": 0.9542017579078674, "length": 3.9385664463043213, "mode": "test", "epoch": 48}
{"loss": 0.06119722127914429, "acc": 0.9794760346412659, "length": 3.9376351833343506, "mode": "train", "epoch": 49}
{"loss": 0.1734851598739624, "acc": 0.9495901465415955, "length": 3.9556314945220947, "mode": "test", "epoch": 49}
{"loss": 0.06691429764032364, "acc": 0.9766942858695984, "length": 3.9332234859466553, "mode": "train", "epoch": 50}
{"loss": 0.15887418389320374, "acc": 0.9552596807479858, "length": 3.9624574184417725, "mode": "test", "epoch": 50}
{"loss": 0.06443565338850021, "acc": 0.9772613048553467, "length": 3.9396204948425293, "mode": "train", "epoch": 51}
{"loss": 0.1779438704252243, "acc": 0.9562544822692871, "length": 3.952218532562256, "mode": "test", "epoch": 51}
{"loss": 0.055235087871551514, "acc": 0.977925717830658, "length": 3.932199239730835, "mode": "train", "epoch": 52}
{"loss": 0.148824542760849, "acc": 0.959928035736084, "length": 3.9556314945220947, "mode": "test", "epoch": 52}
{"loss": 0.06112994626164436, "acc": 0.9789291620254517, "length": 3.949702501296997, "mode": "train", "epoch": 53}
{"loss": 0.18788540363311768, "acc": 0.9499973058700562, "length": 3.9624574184417725, "mode": "test", "epoch": 53}
{"loss": 0.06467133015394211, "acc": 0.9780130982398987, "length": 3.939086675643921, "mode": "train", "epoch": 54}
{"loss": 0.1679900586605072, "acc": 0.9495546221733093, "length": 3.948805570602417, "mode": "test", "epoch": 54}
{"loss": 0.05411030724644661, "acc": 0.9804559350013733, "length": 3.9314041137695312, "mode": "train", "epoch": 55}
{"loss": 0.14827769994735718, "acc": 0.9557798504829407, "length": 3.96928334236145, "mode": "test", "epoch": 55}
{"loss": 0.056314241141080856, "acc": 0.9808273315429688, "length": 3.9453325271606445, "mode": "train", "epoch": 56}
{"loss": 0.15897710621356964, "acc": 0.9500849843025208, "length": 3.972696304321289, "mode": "test", "epoch": 56}
{"loss": 0.05893845111131668, "acc": 0.9796704649925232, "length": 3.9468932151794434, "mode": "train", "epoch": 57}
{"loss": 0.1345144808292389, "acc": 0.9560872912406921, "length": 3.9863481521606445, "mode": "test", "epoch": 57}
{"loss": 0.05397143214941025, "acc": 0.9825077056884766, "length": 3.949420690536499, "mode": "train", "epoch": 58}
{"loss": 0.12881773710250854, "acc": 0.9592990279197693, "length": 3.9658703804016113, "mode": "test", "epoch": 58}
{"loss": 0.04743585363030434, "acc": 0.9835936427116394, "length": 3.9331839084625244, "mode": "train", "epoch": 59}
{"loss": 0.148962140083313, "acc": 0.9515818357467651, "length": 3.96928334236145, "mode": "test", "epoch": 59}
{"loss": 0.0473836250603199, "acc": 0.983713686466217, "length": 3.9477806091308594, "mode": "train", "epoch": 60}
{"loss": 0.13260391354560852, "acc": 0.9590896964073181, "length": 3.979522228240967, "mode": "test", "epoch": 60}
test accuracy: 0.8569821119308472
