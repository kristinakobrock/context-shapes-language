# ["--attributes=5", "--values=16", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=128", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.99", "--temperature=1.5"]
Creating train_ds and val_ds...

Creating test_ds...
{"loss": 0.6950109601020813, "acc": 0.5183385610580444, "length": 3.5315616130828857, "mode": "train", "epoch": 1}
{"loss": 0.69284987449646, "acc": 0.5113636255264282, "length": 1.0, "mode": "test", "epoch": 1}
{"loss": 0.6905022859573364, "acc": 0.5393638610839844, "length": 3.380711078643799, "mode": "train", "epoch": 2}
{"loss": 0.6911627650260925, "acc": 0.5231766104698181, "length": 1.0419580936431885, "mode": "test", "epoch": 2}
{"loss": 0.6848598718643188, "acc": 0.5391806960105896, "length": 3.1393537521362305, "mode": "train", "epoch": 3}
{"loss": 0.6633632183074951, "acc": 0.6503417491912842, "length": 2.1433565616607666, "mode": "test", "epoch": 3}
{"loss": 0.6634249687194824, "acc": 0.6324670314788818, "length": 3.162182569503784, "mode": "train", "epoch": 4}
{"loss": 0.6177250146865845, "acc": 0.7241051197052002, "length": 3.2867133617401123, "mode": "test", "epoch": 4}
{"loss": 0.612984836101532, "acc": 0.7181655168533325, "length": 3.477365255355835, "mode": "train", "epoch": 5}
{"loss": 0.5658589601516724, "acc": 0.7388548851013184, "length": 3.486013889312744, "mode": "test", "epoch": 5}
{"loss": 0.5492257475852966, "acc": 0.7468820810317993, "length": 3.5423359870910645, "mode": "train", "epoch": 6}
{"loss": 0.5238473415374756, "acc": 0.7489551901817322, "length": 3.8356642723083496, "mode": "test", "epoch": 6}
{"loss": 0.5042191743850708, "acc": 0.7653509974479675, "length": 3.5687246322631836, "mode": "train", "epoch": 7}
{"loss": 0.5013258457183838, "acc": 0.7524476051330566, "length": 4.0, "mode": "test", "epoch": 7}
{"loss": 0.46318185329437256, "acc": 0.781179666519165, "length": 3.7658421993255615, "mode": "train", "epoch": 8}
{"loss": 0.4720817804336548, "acc": 0.7833915948867798, "length": 4.0, "mode": "test", "epoch": 8}
{"loss": 0.43638378381729126, "acc": 0.7996413707733154, "length": 3.893650770187378, "mode": "train", "epoch": 9}
{"loss": 0.47073325514793396, "acc": 0.7751747369766235, "length": 4.0, "mode": "test", "epoch": 9}
{"loss": 0.4197761118412018, "acc": 0.8099064826965332, "length": 3.947284698486328, "mode": "train", "epoch": 10}
{"loss": 0.4755757749080658, "acc": 0.7935315370559692, "length": 4.0, "mode": "test", "epoch": 10}
{"loss": 0.40766748785972595, "acc": 0.8197675943374634, "length": 3.966418981552124, "mode": "train", "epoch": 11}
{"loss": 0.4427533745765686, "acc": 0.7979021668434143, "length": 4.0, "mode": "test", "epoch": 11}
{"loss": 0.39494651556015015, "acc": 0.828380286693573, "length": 3.97355580329895, "mode": "train", "epoch": 12}
{"loss": 0.44317740201950073, "acc": 0.8134615421295166, "length": 4.0, "mode": "test", "epoch": 12}
{"loss": 0.3791965842247009, "acc": 0.8325762748718262, "length": 3.9777042865753174, "mode": "train", "epoch": 13}
{"loss": 0.41671645641326904, "acc": 0.8199302554130554, "length": 4.0, "mode": "test", "epoch": 13}
{"loss": 0.3656357526779175, "acc": 0.8400954604148865, "length": 3.9841196537017822, "mode": "train", "epoch": 14}
{"loss": 0.4016328752040863, "acc": 0.8230769038200378, "length": 4.0, "mode": "test", "epoch": 14}
{"loss": 0.34916621446609497, "acc": 0.8464544415473938, "length": 3.986697196960449, "mode": "train", "epoch": 15}
{"loss": 0.39914461970329285, "acc": 0.818881094455719, "length": 4.0, "mode": "test", "epoch": 15}
{"loss": 0.3408888578414917, "acc": 0.8504269123077393, "length": 3.9843802452087402, "mode": "train", "epoch": 16}
{"loss": 0.4041704833507538, "acc": 0.8234265446662903, "length": 4.0, "mode": "test", "epoch": 16}
{"loss": 0.3309132754802704, "acc": 0.8559920787811279, "length": 3.988957643508911, "mode": "train", "epoch": 17}
{"loss": 0.3848645091056824, "acc": 0.8253495097160339, "length": 4.0, "mode": "test", "epoch": 17}
{"loss": 0.3221815824508667, "acc": 0.8568831086158752, "length": 3.9896252155303955, "mode": "train", "epoch": 18}
{"loss": 0.37955498695373535, "acc": 0.8363636136054993, "length": 4.0, "mode": "test", "epoch": 18}
{"loss": 0.3146750032901764, "acc": 0.8602144122123718, "length": 3.988656997680664, "mode": "train", "epoch": 19}
{"loss": 0.3737471103668213, "acc": 0.8311188220977783, "length": 4.0, "mode": "test", "epoch": 19}
{"loss": 0.3013018071651459, "acc": 0.867835521697998, "length": 3.9866909980773926, "mode": "train", "epoch": 20}
{"loss": 0.36513060331344604, "acc": 0.8493006229400635, "length": 4.0, "mode": "test", "epoch": 20}
{"loss": 0.2982785403728485, "acc": 0.8716914057731628, "length": 3.992389440536499, "mode": "train", "epoch": 21}
{"loss": 0.34002670645713806, "acc": 0.8437064290046692, "length": 4.0, "mode": "test", "epoch": 21}
{"loss": 0.2850346863269806, "acc": 0.8718189597129822, "length": 3.992806911468506, "mode": "train", "epoch": 22}
{"loss": 0.3490605056285858, "acc": 0.8491259217262268, "length": 4.0, "mode": "test", "epoch": 22}
{"loss": 0.27774152159690857, "acc": 0.8772094249725342, "length": 3.9939565658569336, "mode": "train", "epoch": 23}
{"loss": 0.3142208456993103, "acc": 0.8484265804290771, "length": 4.0, "mode": "test", "epoch": 23}
{"loss": 0.26493901014328003, "acc": 0.8852310180664062, "length": 3.994781017303467, "mode": "train", "epoch": 24}
{"loss": 0.3264928460121155, "acc": 0.8547202348709106, "length": 4.0, "mode": "test", "epoch": 24}
{"loss": 0.2632298469543457, "acc": 0.8939014673233032, "length": 3.9957034587860107, "mode": "train", "epoch": 25}
{"loss": 0.3217742443084717, "acc": 0.8555944561958313, "length": 4.0, "mode": "test", "epoch": 25}
{"loss": 0.2513490617275238, "acc": 0.8946291208267212, "length": 3.996856451034546, "mode": "train", "epoch": 26}
{"loss": 0.29643794894218445, "acc": 0.8596153855323792, "length": 4.0, "mode": "test", "epoch": 26}
{"loss": 0.24881285429000854, "acc": 0.8945448398590088, "length": 3.995250701904297, "mode": "train", "epoch": 27}
{"loss": 0.29360488057136536, "acc": 0.867132842540741, "length": 4.0, "mode": "test", "epoch": 27}
{"loss": 0.24000594019889832, "acc": 0.8993753790855408, "length": 3.996798038482666, "mode": "train", "epoch": 28}
{"loss": 0.2896135449409485, "acc": 0.8720281720161438, "length": 4.0, "mode": "test", "epoch": 28}
{"loss": 0.2391706258058548, "acc": 0.9013553261756897, "length": 3.9967970848083496, "mode": "train", "epoch": 29}
{"loss": 0.2854909896850586, "acc": 0.8795455694198608, "length": 4.0, "mode": "test", "epoch": 29}
{"loss": 0.2312566041946411, "acc": 0.9063889384269714, "length": 3.9968442916870117, "mode": "train", "epoch": 30}
{"loss": 0.26754337549209595, "acc": 0.8812935948371887, "length": 4.0, "mode": "test", "epoch": 30}
{"loss": 0.23122383654117584, "acc": 0.9055807590484619, "length": 3.997310161590576, "mode": "train", "epoch": 31}
{"loss": 0.24979496002197266, "acc": 0.8811187744140625, "length": 4.0, "mode": "test", "epoch": 31}
{"loss": 0.22367295622825623, "acc": 0.9084398746490479, "length": 3.9970319271087646, "mode": "train", "epoch": 32}
{"loss": 0.2678588628768921, "acc": 0.8865384459495544, "length": 4.0, "mode": "test", "epoch": 32}
{"loss": 0.224557563662529, "acc": 0.9082251191139221, "length": 3.9979004859924316, "mode": "train", "epoch": 33}
{"loss": 0.24499253928661346, "acc": 0.8966784477233887, "length": 4.0, "mode": "test", "epoch": 33}
{"loss": 0.21838347613811493, "acc": 0.9126015305519104, "length": 3.997313976287842, "mode": "train", "epoch": 34}
{"loss": 0.24946919083595276, "acc": 0.8933566212654114, "length": 4.0, "mode": "test", "epoch": 34}
{"loss": 0.2130414843559265, "acc": 0.9133771061897278, "length": 3.9980220794677734, "mode": "train", "epoch": 35}
{"loss": 0.242592915892601, "acc": 0.9047203660011292, "length": 4.0, "mode": "test", "epoch": 35}
{"loss": 0.2079087197780609, "acc": 0.9170423746109009, "length": 3.997056007385254, "mode": "train", "epoch": 36}
{"loss": 0.2220757007598877, "acc": 0.9089159965515137, "length": 4.0, "mode": "test", "epoch": 36}
{"loss": 0.2096121460199356, "acc": 0.9198145866394043, "length": 3.997955322265625, "mode": "train", "epoch": 37}
{"loss": 0.23071786761283875, "acc": 0.9113638401031494, "length": 4.0, "mode": "test", "epoch": 37}
{"loss": 0.20392128825187683, "acc": 0.9189420938491821, "length": 3.998281240463257, "mode": "train", "epoch": 38}
{"loss": 0.21144358813762665, "acc": 0.9194054007530212, "length": 4.0, "mode": "test", "epoch": 38}
{"loss": 0.20073243975639343, "acc": 0.9214912056922913, "length": 3.997065544128418, "mode": "train", "epoch": 39}
{"loss": 0.21931502223014832, "acc": 0.9204544425010681, "length": 4.0, "mode": "test", "epoch": 39}
{"loss": 0.19383873045444489, "acc": 0.9264965057373047, "length": 3.9984519481658936, "mode": "train", "epoch": 40}
{"loss": 0.24587631225585938, "acc": 0.9152097702026367, "length": 4.0, "mode": "test", "epoch": 40}
{"loss": 0.1825532466173172, "acc": 0.9326398968696594, "length": 3.99869441986084, "mode": "train", "epoch": 41}
{"loss": 0.21620944142341614, "acc": 0.9239510297775269, "length": 4.0, "mode": "test", "epoch": 41}
{"loss": 0.18470197916030884, "acc": 0.9302408695220947, "length": 3.9983878135681152, "mode": "train", "epoch": 42}
{"loss": 0.22192087769508362, "acc": 0.9258741736412048, "length": 4.0, "mode": "test", "epoch": 42}
{"loss": 0.17580457031726837, "acc": 0.9359036684036255, "length": 3.9983761310577393, "mode": "train", "epoch": 43}
{"loss": 0.20605218410491943, "acc": 0.9286713600158691, "length": 4.0, "mode": "test", "epoch": 43}
{"loss": 0.16443869471549988, "acc": 0.9399489760398865, "length": 3.9982082843780518, "mode": "train", "epoch": 44}
{"loss": 0.19205832481384277, "acc": 0.9291957020759583, "length": 4.0, "mode": "test", "epoch": 44}
{"loss": 0.1611839085817337, "acc": 0.9418743252754211, "length": 3.997884511947632, "mode": "train", "epoch": 45}
{"loss": 0.18033993244171143, "acc": 0.9374125003814697, "length": 4.0, "mode": "test", "epoch": 45}
{"loss": 0.15680861473083496, "acc": 0.944344699382782, "length": 3.9984822273254395, "mode": "train", "epoch": 46}
{"loss": 0.19527898728847504, "acc": 0.9388110637664795, "length": 4.0, "mode": "test", "epoch": 46}
{"loss": 0.15475115180015564, "acc": 0.942777693271637, "length": 3.998824119567871, "mode": "train", "epoch": 47}
{"loss": 0.1937108039855957, "acc": 0.9302448034286499, "length": 4.0, "mode": "test", "epoch": 47}
{"loss": 0.15521883964538574, "acc": 0.9423033595085144, "length": 3.998729944229126, "mode": "train", "epoch": 48}
{"loss": 0.1747584044933319, "acc": 0.938636302947998, "length": 4.0, "mode": "test", "epoch": 48}
{"loss": 0.15080541372299194, "acc": 0.9454474449157715, "length": 3.9983630180358887, "mode": "train", "epoch": 49}
{"loss": 0.15989869832992554, "acc": 0.9437062740325928, "length": 4.0, "mode": "test", "epoch": 49}
{"loss": 0.14526686072349548, "acc": 0.9455819129943848, "length": 3.9989616870880127, "mode": "train", "epoch": 50}
{"loss": 0.19836562871932983, "acc": 0.932517409324646, "length": 4.0, "mode": "test", "epoch": 50}
{"loss": 0.1394728273153305, "acc": 0.9510899186134338, "length": 3.9989004135131836, "mode": "train", "epoch": 51}
{"loss": 0.1635597050189972, "acc": 0.942482590675354, "length": 4.0, "mode": "test", "epoch": 51}
{"loss": 0.13721123337745667, "acc": 0.9505029916763306, "length": 3.998903274536133, "mode": "train", "epoch": 52}
{"loss": 0.15679915249347687, "acc": 0.9501748085021973, "length": 4.0, "mode": "test", "epoch": 52}
{"loss": 0.13019618391990662, "acc": 0.954431414604187, "length": 3.9991302490234375, "mode": "train", "epoch": 53}
{"loss": 0.16727888584136963, "acc": 0.9466782212257385, "length": 4.0, "mode": "test", "epoch": 53}
{"loss": 0.13043680787086487, "acc": 0.95220947265625, "length": 3.9993226528167725, "mode": "train", "epoch": 54}
{"loss": 0.15188726782798767, "acc": 0.9524475336074829, "length": 4.0, "mode": "test", "epoch": 54}
{"loss": 0.12249412387609482, "acc": 0.9579953551292419, "length": 3.998819351196289, "mode": "train", "epoch": 55}
{"loss": 0.14545707404613495, "acc": 0.9508739709854126, "length": 4.0, "mode": "test", "epoch": 55}
{"loss": 0.11976531147956848, "acc": 0.955416202545166, "length": 3.998263359069824, "mode": "train", "epoch": 56}
{"loss": 0.146842822432518, "acc": 0.9561189413070679, "length": 4.0, "mode": "test", "epoch": 56}
{"loss": 0.11696600914001465, "acc": 0.956669270992279, "length": 3.9977591037750244, "mode": "train", "epoch": 57}
{"loss": 0.15813502669334412, "acc": 0.947027862071991, "length": 4.0, "mode": "test", "epoch": 57}
{"loss": 0.11357786506414413, "acc": 0.9594051837921143, "length": 3.9989757537841797, "mode": "train", "epoch": 58}
{"loss": 0.13719147443771362, "acc": 0.9583916068077087, "length": 4.0, "mode": "test", "epoch": 58}
{"loss": 0.11256851255893707, "acc": 0.9601743221282959, "length": 3.999323606491089, "mode": "train", "epoch": 59}
{"loss": 0.131814643740654, "acc": 0.9573426246643066, "length": 4.0, "mode": "test", "epoch": 59}
{"loss": 0.10340511053800583, "acc": 0.9628040194511414, "length": 3.999030113220215, "mode": "train", "epoch": 60}
{"loss": 0.1305534541606903, "acc": 0.9603148698806763, "length": 4.0, "mode": "test", "epoch": 60}
test accuracy: 0.848833441734314
