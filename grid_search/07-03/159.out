# ["--attributes=5", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.99", "--temperature=1"]
Creating train_ds and val_ds...

Creating test_ds...
{"loss": 0.6875583529472351, "acc": 0.5603057146072388, "length": 3.4781570434570312, "mode": "train", "epoch": 1}
{"loss": 0.6690276861190796, "acc": 0.5915523767471313, "length": 3.5035970211029053, "mode": "test", "epoch": 1}
{"loss": 0.6099671721458435, "acc": 0.6781760454177856, "length": 3.7270443439483643, "mode": "train", "epoch": 2}
{"loss": 0.6065376400947571, "acc": 0.679316520690918, "length": 4.0, "mode": "test", "epoch": 2}
{"loss": 0.5107340812683105, "acc": 0.7543179392814636, "length": 3.920844078063965, "mode": "train", "epoch": 3}
{"loss": 0.49373626708984375, "acc": 0.7832733392715454, "length": 4.0, "mode": "test", "epoch": 3}
{"loss": 0.4167047441005707, "acc": 0.8172460794448853, "length": 3.9741766452789307, "mode": "train", "epoch": 4}
{"loss": 0.45069870352745056, "acc": 0.8071942329406738, "length": 4.0, "mode": "test", "epoch": 4}
{"loss": 0.38796234130859375, "acc": 0.826045036315918, "length": 3.9895575046539307, "mode": "train", "epoch": 5}
{"loss": 0.42578408122062683, "acc": 0.8111511468887329, "length": 4.0, "mode": "test", "epoch": 5}
{"loss": 0.35527417063713074, "acc": 0.8458420634269714, "length": 3.994166851043701, "mode": "train", "epoch": 6}
{"loss": 0.42435064911842346, "acc": 0.816366970539093, "length": 4.0, "mode": "test", "epoch": 6}
{"loss": 0.3394889831542969, "acc": 0.8535808324813843, "length": 3.993657112121582, "mode": "train", "epoch": 7}
{"loss": 0.3920227587223053, "acc": 0.824999988079071, "length": 4.0, "mode": "test", "epoch": 7}
{"loss": 0.3261291980743408, "acc": 0.8631651401519775, "length": 3.9951930046081543, "mode": "train", "epoch": 8}
{"loss": 0.3888746201992035, "acc": 0.8415467143058777, "length": 4.0, "mode": "test", "epoch": 8}
{"loss": 0.31381967663764954, "acc": 0.8708394765853882, "length": 3.9979536533355713, "mode": "train", "epoch": 9}
{"loss": 0.36636999249458313, "acc": 0.8508993983268738, "length": 4.0, "mode": "test", "epoch": 9}
{"loss": 0.29980596899986267, "acc": 0.8796002268791199, "length": 3.997816324234009, "mode": "train", "epoch": 10}
{"loss": 0.3741517663002014, "acc": 0.8642086982727051, "length": 4.0, "mode": "test", "epoch": 10}
{"loss": 0.2961227595806122, "acc": 0.8801507353782654, "length": 3.997610569000244, "mode": "train", "epoch": 11}
{"loss": 0.3755773901939392, "acc": 0.8548561930656433, "length": 4.0, "mode": "test", "epoch": 11}
{"loss": 0.2874318063259125, "acc": 0.8848962783813477, "length": 3.9979405403137207, "mode": "train", "epoch": 12}
{"loss": 0.34419381618499756, "acc": 0.8656473755836487, "length": 4.0, "mode": "test", "epoch": 12}
{"loss": 0.2810615003108978, "acc": 0.8857418298721313, "length": 3.9985334873199463, "mode": "train", "epoch": 13}
{"loss": 0.3509937822818756, "acc": 0.8620503544807434, "length": 4.0, "mode": "test", "epoch": 13}
{"loss": 0.2752922475337982, "acc": 0.8891697525978088, "length": 3.9976823329925537, "mode": "train", "epoch": 14}
{"loss": 0.3481403887271881, "acc": 0.8723021149635315, "length": 4.0, "mode": "test", "epoch": 14}
{"loss": 0.26805272698402405, "acc": 0.8914994597434998, "length": 3.998030424118042, "mode": "train", "epoch": 15}
{"loss": 0.3524937033653259, "acc": 0.8638489842414856, "length": 4.0, "mode": "test", "epoch": 15}
{"loss": 0.2532758116722107, "acc": 0.8975953459739685, "length": 3.997750997543335, "mode": "train", "epoch": 16}
{"loss": 0.32191014289855957, "acc": 0.8818345665931702, "length": 4.0, "mode": "test", "epoch": 16}
{"loss": 0.2401972860097885, "acc": 0.9070799350738525, "length": 3.9991343021392822, "mode": "train", "epoch": 17}
{"loss": 0.316250205039978, "acc": 0.8757194876670837, "length": 4.0, "mode": "test", "epoch": 17}
{"loss": 0.23118390142917633, "acc": 0.9107372760772705, "length": 3.998080253601074, "mode": "train", "epoch": 18}
{"loss": 0.2932027578353882, "acc": 0.8913669586181641, "length": 4.0, "mode": "test", "epoch": 18}
{"loss": 0.22831816971302032, "acc": 0.9104980230331421, "length": 3.99782395362854, "mode": "train", "epoch": 19}
{"loss": 0.28696301579475403, "acc": 0.8991007208824158, "length": 4.0, "mode": "test", "epoch": 19}
{"loss": 0.21890795230865479, "acc": 0.9181339740753174, "length": 3.998671531677246, "mode": "train", "epoch": 20}
{"loss": 0.2894267439842224, "acc": 0.8910071849822998, "length": 4.0, "mode": "test", "epoch": 20}
{"loss": 0.21921907365322113, "acc": 0.9173298478126526, "length": 3.998241424560547, "mode": "train", "epoch": 21}
{"loss": 0.2763388752937317, "acc": 0.9028777480125427, "length": 4.0, "mode": "test", "epoch": 21}
{"loss": 0.21166959404945374, "acc": 0.9183035492897034, "length": 3.997882843017578, "mode": "train", "epoch": 22}
{"loss": 0.2722165286540985, "acc": 0.8962229490280151, "length": 4.0, "mode": "test", "epoch": 22}
{"loss": 0.20825281739234924, "acc": 0.9181947112083435, "length": 3.9986791610717773, "mode": "train", "epoch": 23}
{"loss": 0.26469409465789795, "acc": 0.9008992910385132, "length": 4.0, "mode": "test", "epoch": 23}
{"loss": 0.21150735020637512, "acc": 0.9193130731582642, "length": 3.9973292350769043, "mode": "train", "epoch": 24}
{"loss": 0.267665296792984, "acc": 0.8958632946014404, "length": 4.0, "mode": "test", "epoch": 24}
{"loss": 0.20586159825325012, "acc": 0.9163996577262878, "length": 3.998806953430176, "mode": "train", "epoch": 25}
{"loss": 0.27762410044670105, "acc": 0.8994602560997009, "length": 4.0, "mode": "test", "epoch": 25}
{"loss": 0.20264875888824463, "acc": 0.9212026000022888, "length": 3.998352289199829, "mode": "train", "epoch": 26}
{"loss": 0.2581615447998047, "acc": 0.9059353470802307, "length": 4.0, "mode": "test", "epoch": 26}
{"loss": 0.1872093677520752, "acc": 0.9282920360565186, "length": 3.9987359046936035, "mode": "train", "epoch": 27}
{"loss": 0.23535485565662384, "acc": 0.9115108847618103, "length": 4.0, "mode": "test", "epoch": 27}
{"loss": 0.18766839802265167, "acc": 0.9297860860824585, "length": 3.9974277019500732, "mode": "train", "epoch": 28}
{"loss": 0.23747587203979492, "acc": 0.9093524813652039, "length": 4.0, "mode": "test", "epoch": 28}
{"loss": 0.18807193636894226, "acc": 0.9277010560035706, "length": 3.999439239501953, "mode": "train", "epoch": 29}
{"loss": 0.22774532437324524, "acc": 0.910791277885437, "length": 4.0, "mode": "test", "epoch": 29}
{"loss": 0.19138483703136444, "acc": 0.9257815480232239, "length": 3.9985618591308594, "mode": "train", "epoch": 30}
{"loss": 0.2339819222688675, "acc": 0.9149281978607178, "length": 4.0, "mode": "test", "epoch": 30}
{"loss": 0.18072761595249176, "acc": 0.9326263070106506, "length": 3.9994921684265137, "mode": "train", "epoch": 31}
{"loss": 0.22665636241436005, "acc": 0.9122302532196045, "length": 4.0, "mode": "test", "epoch": 31}
{"loss": 0.176361083984375, "acc": 0.9329859614372253, "length": 3.9995596408843994, "mode": "train", "epoch": 32}
{"loss": 0.22327320277690887, "acc": 0.9154677391052246, "length": 4.0, "mode": "test", "epoch": 32}
{"loss": 0.1762761026620865, "acc": 0.9335286617279053, "length": 3.999603748321533, "mode": "train", "epoch": 33}
{"loss": 0.2135757952928543, "acc": 0.9160072207450867, "length": 4.0, "mode": "test", "epoch": 33}
{"loss": 0.17454786598682404, "acc": 0.9296257495880127, "length": 3.9997880458831787, "mode": "train", "epoch": 34}
{"loss": 0.22556498646736145, "acc": 0.9176259636878967, "length": 4.0, "mode": "test", "epoch": 34}
{"loss": 0.1749659776687622, "acc": 0.9357516765594482, "length": 3.9996838569641113, "mode": "train", "epoch": 35}
{"loss": 0.20859107375144958, "acc": 0.9208633303642273, "length": 4.0, "mode": "test", "epoch": 35}
{"loss": 0.1657843440771103, "acc": 0.9340636730194092, "length": 3.999431610107422, "mode": "train", "epoch": 36}
{"loss": 0.22502994537353516, "acc": 0.915647566318512, "length": 4.0, "mode": "test", "epoch": 36}
{"loss": 0.16125933825969696, "acc": 0.9367164969444275, "length": 3.999739408493042, "mode": "train", "epoch": 37}
{"loss": 0.23086145520210266, "acc": 0.9154675602912903, "length": 4.0, "mode": "test", "epoch": 37}
{"loss": 0.1540973037481308, "acc": 0.9403800964355469, "length": 3.9997737407684326, "mode": "train", "epoch": 38}
{"loss": 0.21096298098564148, "acc": 0.9276978373527527, "length": 4.0, "mode": "test", "epoch": 38}
{"loss": 0.16142289340496063, "acc": 0.9380273818969727, "length": 3.9992878437042236, "mode": "train", "epoch": 39}
{"loss": 0.2047935277223587, "acc": 0.9269784688949585, "length": 4.0, "mode": "test", "epoch": 39}
{"loss": 0.1415339857339859, "acc": 0.9469334483146667, "length": 3.9998533725738525, "mode": "train", "epoch": 40}
{"loss": 0.19705325365066528, "acc": 0.9309352040290833, "length": 4.0, "mode": "test", "epoch": 40}
{"loss": 0.14681795239448547, "acc": 0.9424862265586853, "length": 3.9998342990875244, "mode": "train", "epoch": 41}
{"loss": 0.2196233719587326, "acc": 0.9183453917503357, "length": 4.0, "mode": "test", "epoch": 41}
{"loss": 0.14763759076595306, "acc": 0.9447177648544312, "length": 3.997580051422119, "mode": "train", "epoch": 42}
{"loss": 0.20560868084430695, "acc": 0.9300359487533569, "length": 4.0, "mode": "test", "epoch": 42}
{"loss": 0.13701540231704712, "acc": 0.945608377456665, "length": 3.9995787143707275, "mode": "train", "epoch": 43}
{"loss": 0.21144433319568634, "acc": 0.9392085671424866, "length": 4.0, "mode": "test", "epoch": 43}
{"loss": 0.1399768590927124, "acc": 0.9474617838859558, "length": 3.999474048614502, "mode": "train", "epoch": 44}
{"loss": 0.2225489318370819, "acc": 0.9287771582603455, "length": 4.0, "mode": "test", "epoch": 44}
{"loss": 0.14323292672634125, "acc": 0.9454898238182068, "length": 3.999833106994629, "mode": "train", "epoch": 45}
{"loss": 0.20343701541423798, "acc": 0.9232015013694763, "length": 4.0, "mode": "test", "epoch": 45}
{"loss": 0.1231805831193924, "acc": 0.9533624053001404, "length": 3.999842643737793, "mode": "train", "epoch": 46}
{"loss": 0.18819518387317657, "acc": 0.9374099969863892, "length": 4.0, "mode": "test", "epoch": 46}
{"loss": 0.12328975647687912, "acc": 0.9565457105636597, "length": 3.9998204708099365, "mode": "train", "epoch": 47}
{"loss": 0.1952570229768753, "acc": 0.9388487935066223, "length": 4.0, "mode": "test", "epoch": 47}
{"loss": 0.11557039618492126, "acc": 0.9584130048751831, "length": 3.999971628189087, "mode": "train", "epoch": 48}
{"loss": 0.20215879380702972, "acc": 0.939748227596283, "length": 4.0, "mode": "test", "epoch": 48}
{"loss": 0.11602836102247238, "acc": 0.9583507180213928, "length": 3.9999003410339355, "mode": "train", "epoch": 49}
{"loss": 0.19443723559379578, "acc": 0.9411871433258057, "length": 4.0, "mode": "test", "epoch": 49}
{"loss": 0.12536245584487915, "acc": 0.9560086727142334, "length": 3.9999642372131348, "mode": "train", "epoch": 50}
{"loss": 0.19199343025684357, "acc": 0.9374101161956787, "length": 4.0, "mode": "test", "epoch": 50}
{"loss": 0.11974464356899261, "acc": 0.9552876949310303, "length": 3.9999630451202393, "mode": "train", "epoch": 51}
{"loss": 0.2078825980424881, "acc": 0.9372301697731018, "length": 4.0, "mode": "test", "epoch": 51}
{"loss": 0.11123642325401306, "acc": 0.9596055150032043, "length": 3.9991374015808105, "mode": "train", "epoch": 52}
{"loss": 0.1708318293094635, "acc": 0.9363309144973755, "length": 4.0, "mode": "test", "epoch": 52}
{"loss": 0.11354611814022064, "acc": 0.9564900994300842, "length": 3.999990701675415, "mode": "train", "epoch": 53}
{"loss": 0.1957416981458664, "acc": 0.9309353232383728, "length": 4.0, "mode": "test", "epoch": 53}
{"loss": 0.1284886747598648, "acc": 0.9553483724594116, "length": 3.9999852180480957, "mode": "train", "epoch": 54}
{"loss": 0.21793068945407867, "acc": 0.9334532618522644, "length": 4.0, "mode": "test", "epoch": 54}
{"loss": 0.1129525825381279, "acc": 0.9594935774803162, "length": 3.9999349117279053, "mode": "train", "epoch": 55}
{"loss": 0.1890924870967865, "acc": 0.9428056478500366, "length": 4.0, "mode": "test", "epoch": 55}
{"loss": 0.11960341781377792, "acc": 0.9550431966781616, "length": 3.9996790885925293, "mode": "train", "epoch": 56}
{"loss": 0.20466911792755127, "acc": 0.9384891986846924, "length": 4.0, "mode": "test", "epoch": 56}
{"loss": 0.11383101344108582, "acc": 0.9616539478302002, "length": 3.9997594356536865, "mode": "train", "epoch": 57}
{"loss": 0.20163795351982117, "acc": 0.9374099969863892, "length": 4.0, "mode": "test", "epoch": 57}
{"loss": 0.11382140964269638, "acc": 0.9609972834587097, "length": 3.999955892562866, "mode": "train", "epoch": 58}
{"loss": 0.20950661599636078, "acc": 0.9339929223060608, "length": 4.0, "mode": "test", "epoch": 58}
{"loss": 0.1397799253463745, "acc": 0.9452517628669739, "length": 3.999979257583618, "mode": "train", "epoch": 59}
{"loss": 0.177778422832489, "acc": 0.938309371471405, "length": 4.0, "mode": "test", "epoch": 59}
{"loss": 0.12081258744001389, "acc": 0.9533560872077942, "length": 3.9997847080230713, "mode": "train", "epoch": 60}
{"loss": 0.1980191320180893, "acc": 0.9366907477378845, "length": 4.0, "mode": "test", "epoch": 60}
test accuracy: 0.7924243211746216
