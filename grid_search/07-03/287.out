# ["--attributes=5", "--values=16", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=128", "--learning_rate=0.001", "--hidden_size=256", "--temp_update=0.99", "--temperature=2"]
Creating train_ds and val_ds...

Creating test_ds...
{"loss": 0.7132235765457153, "acc": 0.5177304744720459, "length": 3.3476107120513916, "mode": "train", "epoch": 1}
{"loss": 0.7026122808456421, "acc": 0.5081271529197693, "length": 1.0, "mode": "test", "epoch": 1}
{"loss": 0.6939241290092468, "acc": 0.5282434821128845, "length": 1.9153443574905396, "mode": "train", "epoch": 2}
{"loss": 0.698508620262146, "acc": 0.5174911618232727, "length": 1.0, "mode": "test", "epoch": 2}
{"loss": 0.6881457567214966, "acc": 0.5404492020606995, "length": 1.2431514263153076, "mode": "train", "epoch": 3}
{"loss": 0.6986052989959717, "acc": 0.5160776972770691, "length": 1.0, "mode": "test", "epoch": 3}
{"loss": 0.6707708239555359, "acc": 0.5899777412414551, "length": 1.8895344734191895, "mode": "train", "epoch": 4}
{"loss": 0.6261880397796631, "acc": 0.6681628823280334, "length": 2.770318031311035, "mode": "test", "epoch": 4}
{"loss": 0.6077537536621094, "acc": 0.6850974559783936, "length": 3.003591537475586, "mode": "train", "epoch": 5}
{"loss": 0.5483965873718262, "acc": 0.7495250105857849, "length": 3.321554660797119, "mode": "test", "epoch": 5}
{"loss": 0.5281395316123962, "acc": 0.7439093589782715, "length": 3.1048812866210938, "mode": "train", "epoch": 6}
{"loss": 0.5151461958885193, "acc": 0.7534059882164001, "length": 2.9187278747558594, "mode": "test", "epoch": 6}
{"loss": 0.48215094208717346, "acc": 0.7647126913070679, "length": 2.987334728240967, "mode": "train", "epoch": 7}
{"loss": 0.49407458305358887, "acc": 0.7909765839576721, "length": 3.0671377182006836, "mode": "test", "epoch": 7}
{"loss": 0.45845040678977966, "acc": 0.789114773273468, "length": 3.0223309993743896, "mode": "train", "epoch": 8}
{"loss": 0.48156118392944336, "acc": 0.7763329148292542, "length": 3.116607666015625, "mode": "test", "epoch": 8}
{"loss": 0.43403708934783936, "acc": 0.7910649180412292, "length": 3.0374014377593994, "mode": "train", "epoch": 9}
{"loss": 0.44813451170921326, "acc": 0.809381365776062, "length": 3.261484146118164, "mode": "test", "epoch": 9}
{"loss": 0.4121449589729309, "acc": 0.8249240517616272, "length": 3.2675044536590576, "mode": "train", "epoch": 10}
{"loss": 0.4384543299674988, "acc": 0.8184318542480469, "length": 3.3710248470306396, "mode": "test", "epoch": 10}
{"loss": 0.3893626034259796, "acc": 0.831825852394104, "length": 3.2691354751586914, "mode": "train", "epoch": 11}
{"loss": 0.4523380398750305, "acc": 0.8032257556915283, "length": 3.360424041748047, "mode": "test", "epoch": 11}
{"loss": 0.37829387187957764, "acc": 0.8378444910049438, "length": 3.2306671142578125, "mode": "train", "epoch": 12}
{"loss": 0.4279789328575134, "acc": 0.827472984790802, "length": 3.4699647426605225, "mode": "test", "epoch": 12}
{"loss": 0.3619116544723511, "acc": 0.8450604677200317, "length": 3.2639341354370117, "mode": "train", "epoch": 13}
{"loss": 0.42342501878738403, "acc": 0.8260423541069031, "length": 3.6325087547302246, "mode": "test", "epoch": 13}
{"loss": 0.3513021767139435, "acc": 0.8493486642837524, "length": 3.2949531078338623, "mode": "train", "epoch": 14}
{"loss": 0.40144968032836914, "acc": 0.8414816856384277, "length": 3.466431140899658, "mode": "test", "epoch": 14}
{"loss": 0.3392639458179474, "acc": 0.8555524945259094, "length": 3.338592529296875, "mode": "train", "epoch": 15}
{"loss": 0.3812151849269867, "acc": 0.8488448262214661, "length": 3.5441696643829346, "mode": "test", "epoch": 15}
{"loss": 0.32070350646972656, "acc": 0.861417829990387, "length": 3.3516175746917725, "mode": "train", "epoch": 16}
{"loss": 0.3892078995704651, "acc": 0.8575714826583862, "length": 3.6325087547302246, "mode": "test", "epoch": 16}
{"loss": 0.3118666112422943, "acc": 0.8660798072814941, "length": 3.4124491214752197, "mode": "train", "epoch": 17}
{"loss": 0.3632165193557739, "acc": 0.8594023585319519, "length": 3.5724382400512695, "mode": "test", "epoch": 17}
{"loss": 0.29782891273498535, "acc": 0.8728188872337341, "length": 3.4129083156585693, "mode": "train", "epoch": 18}
{"loss": 0.3376888036727905, "acc": 0.8651445508003235, "length": 3.5689046382904053, "mode": "test", "epoch": 18}
{"loss": 0.2871093153953552, "acc": 0.8807469606399536, "length": 3.467327833175659, "mode": "train", "epoch": 19}
{"loss": 0.3544861972332001, "acc": 0.8399105072021484, "length": 3.7137808799743652, "mode": "test", "epoch": 19}
{"loss": 0.280046284198761, "acc": 0.885493278503418, "length": 3.4925451278686523, "mode": "train", "epoch": 20}
{"loss": 0.31281226873397827, "acc": 0.8822456002235413, "length": 3.5547702312469482, "mode": "test", "epoch": 20}
{"loss": 0.25777238607406616, "acc": 0.8978610634803772, "length": 3.511157274246216, "mode": "train", "epoch": 21}
{"loss": 0.3012745976448059, "acc": 0.8899722099304199, "length": 3.6431095600128174, "mode": "test", "epoch": 21}
{"loss": 0.26118847727775574, "acc": 0.8949652910232544, "length": 3.565589666366577, "mode": "train", "epoch": 22}
{"loss": 0.2999575734138489, "acc": 0.8943418264389038, "length": 3.6466431617736816, "mode": "test", "epoch": 22}
{"loss": 0.255365788936615, "acc": 0.9024975299835205, "length": 3.518739938735962, "mode": "train", "epoch": 23}
{"loss": 0.291256844997406, "acc": 0.8836496472358704, "length": 3.6183745861053467, "mode": "test", "epoch": 23}
{"loss": 0.23649343848228455, "acc": 0.9085822105407715, "length": 3.551926612854004, "mode": "train", "epoch": 24}
{"loss": 0.28293201327323914, "acc": 0.8883350491523743, "length": 3.664310932159424, "mode": "test", "epoch": 24}
{"loss": 0.23468589782714844, "acc": 0.9105151295661926, "length": 3.620037317276001, "mode": "train", "epoch": 25}
{"loss": 0.28021523356437683, "acc": 0.8988852500915527, "length": 3.65371036529541, "mode": "test", "epoch": 25}
{"loss": 0.2203725278377533, "acc": 0.9188984036445618, "length": 3.581073760986328, "mode": "train", "epoch": 26}
{"loss": 0.26539522409439087, "acc": 0.906122088432312, "length": 3.6289751529693604, "mode": "test", "epoch": 26}
{"loss": 0.2156427651643753, "acc": 0.9164072275161743, "length": 3.648306131362915, "mode": "train", "epoch": 27}
{"loss": 0.25940078496932983, "acc": 0.9046544432640076, "length": 3.724381685256958, "mode": "test", "epoch": 27}
{"loss": 0.20770375430583954, "acc": 0.922417402267456, "length": 3.671363353729248, "mode": "train", "epoch": 28}
{"loss": 0.24229298532009125, "acc": 0.9102023839950562, "length": 3.575971841812134, "mode": "test", "epoch": 28}
{"loss": 0.1991971880197525, "acc": 0.9288363456726074, "length": 3.7054059505462646, "mode": "train", "epoch": 29}
{"loss": 0.2616584002971649, "acc": 0.9049909114837646, "length": 3.795053005218506, "mode": "test", "epoch": 29}
{"loss": 0.18867962062358856, "acc": 0.929916262626648, "length": 3.7790074348449707, "mode": "train", "epoch": 30}
{"loss": 0.24207007884979248, "acc": 0.9159729480743408, "length": 3.7314486503601074, "mode": "test", "epoch": 30}
{"loss": 0.17686881124973297, "acc": 0.9307560920715332, "length": 3.7611913681030273, "mode": "train", "epoch": 31}
{"loss": 0.23615430295467377, "acc": 0.9217386841773987, "length": 3.7773852348327637, "mode": "test", "epoch": 31}
{"loss": 0.16443811357021332, "acc": 0.936781644821167, "length": 3.7827353477478027, "mode": "train", "epoch": 32}
{"loss": 0.2023295760154724, "acc": 0.9234514832496643, "length": 3.809187173843384, "mode": "test", "epoch": 32}
{"loss": 0.1622120589017868, "acc": 0.9359041452407837, "length": 3.7792177200317383, "mode": "train", "epoch": 33}
{"loss": 0.19949446618556976, "acc": 0.9272439479827881, "length": 3.795053005218506, "mode": "test", "epoch": 33}
{"loss": 0.14806216955184937, "acc": 0.943946361541748, "length": 3.8405187129974365, "mode": "train", "epoch": 34}
{"loss": 0.20518653094768524, "acc": 0.9311522245407104, "length": 3.869257926940918, "mode": "test", "epoch": 34}
{"loss": 0.12650169432163239, "acc": 0.9520227909088135, "length": 3.8451895713806152, "mode": "train", "epoch": 35}
{"loss": 0.16737374663352966, "acc": 0.9435502290725708, "length": 3.851590156555176, "mode": "test", "epoch": 35}
{"loss": 0.12248827517032623, "acc": 0.951555073261261, "length": 3.8685810565948486, "mode": "train", "epoch": 36}
{"loss": 0.1913008689880371, "acc": 0.9334949851036072, "length": 3.8798587322235107, "mode": "test", "epoch": 36}
{"loss": 0.11646080762147903, "acc": 0.953669548034668, "length": 3.867581844329834, "mode": "train", "epoch": 37}
{"loss": 0.15089571475982666, "acc": 0.952722430229187, "length": 3.851590156555176, "mode": "test", "epoch": 37}
{"loss": 0.1071719378232956, "acc": 0.9603915810585022, "length": 3.8743624687194824, "mode": "train", "epoch": 38}
{"loss": 0.1543341726064682, "acc": 0.9415298104286194, "length": 3.9045937061309814, "mode": "test", "epoch": 38}
{"loss": 0.09769617021083832, "acc": 0.9636165499687195, "length": 3.8910183906555176, "mode": "train", "epoch": 39}
{"loss": 0.1675596833229065, "acc": 0.9486663937568665, "length": 3.8939929008483887, "mode": "test", "epoch": 39}
{"loss": 0.09160082787275314, "acc": 0.967210054397583, "length": 3.9000909328460693, "mode": "train", "epoch": 40}
{"loss": 0.14358428120613098, "acc": 0.9561364054679871, "length": 3.939929246902466, "mode": "test", "epoch": 40}
{"loss": 0.08351002633571625, "acc": 0.9698897004127502, "length": 3.9446518421173096, "mode": "train", "epoch": 41}
{"loss": 0.13511553406715393, "acc": 0.9591385722160339, "length": 3.9611308574676514, "mode": "test", "epoch": 41}
{"loss": 0.08578639477491379, "acc": 0.9688789248466492, "length": 3.9414849281311035, "mode": "train", "epoch": 42}
{"loss": 0.1578601598739624, "acc": 0.9486511945724487, "length": 3.939929246902466, "mode": "test", "epoch": 42}
{"loss": 0.07833287864923477, "acc": 0.9722949266433716, "length": 3.941465377807617, "mode": "train", "epoch": 43}
{"loss": 0.1413995623588562, "acc": 0.9549630880355835, "length": 3.94346284866333, "mode": "test", "epoch": 43}
{"loss": 0.07413282245397568, "acc": 0.9729058146476746, "length": 3.933661460876465, "mode": "train", "epoch": 44}
{"loss": 0.13760678470134735, "acc": 0.9610442519187927, "length": 3.9222614765167236, "mode": "test", "epoch": 44}
{"loss": 0.06487821787595749, "acc": 0.9780104756355286, "length": 3.939650058746338, "mode": "train", "epoch": 45}
{"loss": 0.118630550801754, "acc": 0.9658865332603455, "length": 3.94346284866333, "mode": "test", "epoch": 45}
{"loss": 0.062033090740442276, "acc": 0.9791530966758728, "length": 3.960724115371704, "mode": "train", "epoch": 46}
{"loss": 0.11628662794828415, "acc": 0.9560865163803101, "length": 3.957597255706787, "mode": "test", "epoch": 46}
{"loss": 0.057292141020298004, "acc": 0.9802994132041931, "length": 3.9733593463897705, "mode": "train", "epoch": 47}
{"loss": 0.10103040933609009, "acc": 0.9695689082145691, "length": 3.9469964504241943, "mode": "test", "epoch": 47}
{"loss": 0.05123044550418854, "acc": 0.9829828143119812, "length": 3.970018148422241, "mode": "train", "epoch": 48}
{"loss": 0.10506460070610046, "acc": 0.9713900685310364, "length": 3.94346284866333, "mode": "test", "epoch": 48}
{"loss": 0.053532492369413376, "acc": 0.9813581109046936, "length": 3.9697933197021484, "mode": "train", "epoch": 49}
{"loss": 0.10848334431648254, "acc": 0.9725798964500427, "length": 3.968197822570801, "mode": "test", "epoch": 49}
{"loss": 0.05079329386353493, "acc": 0.9821179509162903, "length": 3.979221820831299, "mode": "train", "epoch": 50}
{"loss": 0.09686162322759628, "acc": 0.9706231355667114, "length": 3.9964663982391357, "mode": "test", "epoch": 50}
{"loss": 0.046310149133205414, "acc": 0.9836664795875549, "length": 3.9808452129364014, "mode": "train", "epoch": 51}
{"loss": 0.09494495391845703, "acc": 0.9699646830558777, "length": 4.0, "mode": "test", "epoch": 51}
{"loss": 0.04609467089176178, "acc": 0.9843119978904724, "length": 3.9845829010009766, "mode": "train", "epoch": 52}
{"loss": 0.09840723872184753, "acc": 0.9694345593452454, "length": 4.0, "mode": "test", "epoch": 52}
{"loss": 0.03943461924791336, "acc": 0.9869924783706665, "length": 3.9859323501586914, "mode": "train", "epoch": 53}
{"loss": 0.11602294445037842, "acc": 0.9697674512863159, "length": 3.9964663982391357, "mode": "test", "epoch": 53}
{"loss": 0.03674508258700371, "acc": 0.9875971674919128, "length": 3.9836480617523193, "mode": "train", "epoch": 54}
{"loss": 0.07227087020874023, "acc": 0.9799027442932129, "length": 3.9787986278533936, "mode": "test", "epoch": 54}
{"loss": 0.04295501485466957, "acc": 0.9876540303230286, "length": 3.981687545776367, "mode": "train", "epoch": 55}
{"loss": 0.09026849269866943, "acc": 0.9737465977668762, "length": 3.9893991947174072, "mode": "test", "epoch": 55}
{"loss": 0.03189314156770706, "acc": 0.9902651309967041, "length": 3.986827850341797, "mode": "train", "epoch": 56}
{"loss": 0.10772664844989777, "acc": 0.9738515019416809, "length": 4.0, "mode": "test", "epoch": 56}
{"loss": 0.03383708745241165, "acc": 0.9887140393257141, "length": 3.991473436355591, "mode": "train", "epoch": 57}
{"loss": 0.10203111171722412, "acc": 0.9754044413566589, "length": 3.9964663982391357, "mode": "test", "epoch": 57}
{"loss": 0.03539023920893669, "acc": 0.9882697463035583, "length": 3.9901819229125977, "mode": "train", "epoch": 58}
{"loss": 0.11471050977706909, "acc": 0.9724380970001221, "length": 4.0, "mode": "test", "epoch": 58}
{"loss": 0.041974689811468124, "acc": 0.9863112568855286, "length": 3.993400812149048, "mode": "train", "epoch": 59}
{"loss": 0.10453839600086212, "acc": 0.9779151678085327, "length": 4.0, "mode": "test", "epoch": 59}
{"loss": 0.033081140369176865, "acc": 0.9904301762580872, "length": 3.9932687282562256, "mode": "train", "epoch": 60}
{"loss": 0.12132197618484497, "acc": 0.972261369228363, "length": 4.0, "mode": "test", "epoch": 60}
test accuracy: 0.7930646538734436
