# ["--attributes=3", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=128", "--learning_rate=0.001", "--hidden_size=256", "--temp_update=0.97", "--temperature=2"]
Creating train_ds and val_ds...

Creating test_ds...
{"loss": 0.7266124486923218, "acc": 0.5019196271896362, "length": 3.366976499557495, "mode": "train", "epoch": 1}
{"loss": 0.6935001611709595, "acc": 0.5019230246543884, "length": 1.0, "mode": "test", "epoch": 1}
{"loss": 0.7006152272224426, "acc": 0.5155668258666992, "length": 1.7863513231277466, "mode": "train", "epoch": 2}
{"loss": 0.6964892148971558, "acc": 0.5162587761878967, "length": 1.0, "mode": "test", "epoch": 2}
{"loss": 0.6947237253189087, "acc": 0.516562819480896, "length": 1.0652523040771484, "mode": "train", "epoch": 3}
{"loss": 0.693767249584198, "acc": 0.5325174927711487, "length": 1.0, "mode": "test", "epoch": 3}
{"loss": 0.6931251287460327, "acc": 0.5112537741661072, "length": 1.0234248638153076, "mode": "train", "epoch": 4}
{"loss": 0.692363440990448, "acc": 0.5375874042510986, "length": 1.0, "mode": "test", "epoch": 4}
{"loss": 0.6920061707496643, "acc": 0.5262812376022339, "length": 1.0149565935134888, "mode": "train", "epoch": 5}
{"loss": 0.6937307119369507, "acc": 0.4893355965614319, "length": 1.0, "mode": "test", "epoch": 5}
{"loss": 0.6925196051597595, "acc": 0.5147345066070557, "length": 1.0108494758605957, "mode": "train", "epoch": 6}
{"loss": 0.6906353235244751, "acc": 0.5437062978744507, "length": 1.0, "mode": "test", "epoch": 6}
{"loss": 0.6908898949623108, "acc": 0.526137113571167, "length": 1.0095624923706055, "mode": "train", "epoch": 7}
{"loss": 0.6919929385185242, "acc": 0.5298951268196106, "length": 1.0, "mode": "test", "epoch": 7}
{"loss": 0.6916967034339905, "acc": 0.5268895030021667, "length": 1.0080897808074951, "mode": "train", "epoch": 8}
{"loss": 0.690962016582489, "acc": 0.5326922535896301, "length": 1.0, "mode": "test", "epoch": 8}
{"loss": 0.6932790279388428, "acc": 0.5197675824165344, "length": 1.0078951120376587, "mode": "train", "epoch": 9}
{"loss": 0.6923516988754272, "acc": 0.5104894638061523, "length": 1.0, "mode": "test", "epoch": 9}
{"loss": 0.6912370324134827, "acc": 0.5244603753089905, "length": 1.008273959159851, "mode": "train", "epoch": 10}
{"loss": 0.6912425756454468, "acc": 0.5305944681167603, "length": 1.0, "mode": "test", "epoch": 10}
{"loss": 0.6918542385101318, "acc": 0.5238122344017029, "length": 1.0110691785812378, "mode": "train", "epoch": 11}
{"loss": 0.6902433633804321, "acc": 0.5379370450973511, "length": 1.0, "mode": "test", "epoch": 11}
{"loss": 0.6893828511238098, "acc": 0.5303813219070435, "length": 1.0383143424987793, "mode": "train", "epoch": 12}
{"loss": 0.6933967471122742, "acc": 0.5229020714759827, "length": 1.0, "mode": "test", "epoch": 12}
{"loss": 0.6744229793548584, "acc": 0.5749695897102356, "length": 1.465282917022705, "mode": "train", "epoch": 13}
{"loss": 0.6279998421669006, "acc": 0.6712554097175598, "length": 2.437062978744507, "mode": "test", "epoch": 13}
{"loss": 0.6176720857620239, "acc": 0.6625203490257263, "length": 2.2667853832244873, "mode": "train", "epoch": 14}
{"loss": 0.5894278883934021, "acc": 0.6760428547859192, "length": 2.552447557449341, "mode": "test", "epoch": 14}
{"loss": 0.5874390006065369, "acc": 0.6736060976982117, "length": 2.3132283687591553, "mode": "train", "epoch": 15}
{"loss": 0.5940864086151123, "acc": 0.6933006048202515, "length": 2.5104894638061523, "mode": "test", "epoch": 15}
{"loss": 0.5770496726036072, "acc": 0.6870914101600647, "length": 2.2915472984313965, "mode": "train", "epoch": 16}
{"loss": 0.5775316953659058, "acc": 0.6972755193710327, "length": 2.447552442550659, "mode": "test", "epoch": 16}
{"loss": 0.5692550539970398, "acc": 0.7027029991149902, "length": 2.308586597442627, "mode": "train", "epoch": 17}
{"loss": 0.5765443444252014, "acc": 0.70362389087677, "length": 2.3951048851013184, "mode": "test", "epoch": 17}
{"loss": 0.5628229379653931, "acc": 0.7032926678657532, "length": 2.4016642570495605, "mode": "train", "epoch": 18}
{"loss": 0.5656431913375854, "acc": 0.724663257598877, "length": 2.437062978744507, "mode": "test", "epoch": 18}
{"loss": 0.5517867207527161, "acc": 0.720349907875061, "length": 2.505481481552124, "mode": "train", "epoch": 19}
{"loss": 0.5431100130081177, "acc": 0.7342093586921692, "length": 2.793706178665161, "mode": "test", "epoch": 19}
{"loss": 0.5311879515647888, "acc": 0.7379040122032166, "length": 2.6345105171203613, "mode": "train", "epoch": 20}
{"loss": 0.5328646898269653, "acc": 0.7423500418663025, "length": 2.814685344696045, "mode": "test", "epoch": 20}
{"loss": 0.49526387453079224, "acc": 0.7632120847702026, "length": 2.7471697330474854, "mode": "train", "epoch": 21}
{"loss": 0.5113257765769958, "acc": 0.7733907699584961, "length": 2.699300765991211, "mode": "test", "epoch": 21}
{"loss": 0.4689999520778656, "acc": 0.7876763939857483, "length": 2.7120261192321777, "mode": "train", "epoch": 22}
{"loss": 0.48569178581237793, "acc": 0.788013219833374, "length": 2.562937021255493, "mode": "test", "epoch": 22}
{"loss": 0.4538355767726898, "acc": 0.7959657907485962, "length": 2.6561906337738037, "mode": "train", "epoch": 23}
{"loss": 0.47203442454338074, "acc": 0.792495608329773, "length": 2.531468629837036, "mode": "test", "epoch": 23}
{"loss": 0.4466392397880554, "acc": 0.795632004737854, "length": 2.6457431316375732, "mode": "train", "epoch": 24}
{"loss": 0.4718223810195923, "acc": 0.793310821056366, "length": 2.6363637447357178, "mode": "test", "epoch": 24}
{"loss": 0.4406365752220154, "acc": 0.7983480095863342, "length": 2.674013614654541, "mode": "train", "epoch": 25}
{"loss": 0.4650663137435913, "acc": 0.795314371585846, "length": 2.6748251914978027, "mode": "test", "epoch": 25}
{"loss": 0.4260202944278717, "acc": 0.806811511516571, "length": 2.9854636192321777, "mode": "train", "epoch": 26}
{"loss": 0.4312443435192108, "acc": 0.8147705793380737, "length": 3.1188812255859375, "mode": "test", "epoch": 26}
{"loss": 0.401034951210022, "acc": 0.8181583881378174, "length": 3.3170061111450195, "mode": "train", "epoch": 27}
{"loss": 0.4021984338760376, "acc": 0.830010712146759, "length": 3.3811187744140625, "mode": "test", "epoch": 27}
{"loss": 0.37894925475120544, "acc": 0.8319693803787231, "length": 3.5754759311676025, "mode": "train", "epoch": 28}
{"loss": 0.3830146789550781, "acc": 0.8308513164520264, "length": 3.6643357276916504, "mode": "test", "epoch": 28}
{"loss": 0.3560456335544586, "acc": 0.8363623023033142, "length": 3.64734148979187, "mode": "train", "epoch": 29}
{"loss": 0.3529418408870697, "acc": 0.8423210978507996, "length": 3.6748251914978027, "mode": "test", "epoch": 29}
{"loss": 0.339657723903656, "acc": 0.8511824011802673, "length": 3.601890802383423, "mode": "train", "epoch": 30}
{"loss": 0.3463871479034424, "acc": 0.8392962217330933, "length": 3.639860153198242, "mode": "test", "epoch": 30}
{"loss": 0.32596683502197266, "acc": 0.8547188639640808, "length": 3.657881498336792, "mode": "train", "epoch": 31}
{"loss": 0.33754295110702515, "acc": 0.8429034352302551, "length": 3.723776340484619, "mode": "test", "epoch": 31}
{"loss": 0.32564496994018555, "acc": 0.8564804792404175, "length": 3.620206117630005, "mode": "train", "epoch": 32}
{"loss": 0.3336968421936035, "acc": 0.8385912775993347, "length": 3.7342658042907715, "mode": "test", "epoch": 32}
{"loss": 0.31462517380714417, "acc": 0.8618852496147156, "length": 3.6627187728881836, "mode": "train", "epoch": 33}
{"loss": 0.3186243176460266, "acc": 0.8553552627563477, "length": 3.615384578704834, "mode": "test", "epoch": 33}
{"loss": 0.3055393397808075, "acc": 0.8670624494552612, "length": 3.677694082260132, "mode": "train", "epoch": 34}
{"loss": 0.30160874128341675, "acc": 0.8717390298843384, "length": 3.6818182468414307, "mode": "test", "epoch": 34}
{"loss": 0.28814393281936646, "acc": 0.8743587732315063, "length": 3.6705119609832764, "mode": "train", "epoch": 35}
{"loss": 0.29894566535949707, "acc": 0.8623569011688232, "length": 3.783216714859009, "mode": "test", "epoch": 35}
{"loss": 0.2753567099571228, "acc": 0.8833348751068115, "length": 3.7900288105010986, "mode": "train", "epoch": 36}
{"loss": 0.2880905866622925, "acc": 0.8811424970626831, "length": 3.6888113021850586, "mode": "test", "epoch": 36}
{"loss": 0.2674739360809326, "acc": 0.8904460668563843, "length": 3.696881055831909, "mode": "train", "epoch": 37}
{"loss": 0.26878806948661804, "acc": 0.8960510492324829, "length": 3.6958041191101074, "mode": "test", "epoch": 37}
{"loss": 0.25066015124320984, "acc": 0.8997887969017029, "length": 3.7877259254455566, "mode": "train", "epoch": 38}
{"loss": 0.2591571807861328, "acc": 0.8957267999649048, "length": 3.744755268096924, "mode": "test", "epoch": 38}
{"loss": 0.24530208110809326, "acc": 0.9021587371826172, "length": 3.778198003768921, "mode": "train", "epoch": 39}
{"loss": 0.24561314284801483, "acc": 0.9060760736465454, "length": 3.7412588596343994, "mode": "test", "epoch": 39}
{"loss": 0.230348601937294, "acc": 0.9110365509986877, "length": 3.8164331912994385, "mode": "train", "epoch": 40}
{"loss": 0.25294142961502075, "acc": 0.9034283757209778, "length": 3.8566434383392334, "mode": "test", "epoch": 40}
{"loss": 0.22169966995716095, "acc": 0.9131068587303162, "length": 3.849712610244751, "mode": "train", "epoch": 41}
{"loss": 0.2312462031841278, "acc": 0.9039546847343445, "length": 3.8636362552642822, "mode": "test", "epoch": 41}
{"loss": 0.22193104028701782, "acc": 0.9149694442749023, "length": 3.8474032878875732, "mode": "train", "epoch": 42}
{"loss": 0.2512921690940857, "acc": 0.9171110391616821, "length": 3.8636362552642822, "mode": "test", "epoch": 42}
{"loss": 0.2205032855272293, "acc": 0.9194650650024414, "length": 3.833036422729492, "mode": "train", "epoch": 43}
{"loss": 0.23519623279571533, "acc": 0.9160969257354736, "length": 3.7902097702026367, "mode": "test", "epoch": 43}
{"loss": 0.20604009926319122, "acc": 0.920526385307312, "length": 3.826279878616333, "mode": "train", "epoch": 44}
{"loss": 0.23690170049667358, "acc": 0.9097594022750854, "length": 3.839160919189453, "mode": "test", "epoch": 44}
{"loss": 0.2035365253686905, "acc": 0.9199488759040833, "length": 3.8191983699798584, "mode": "train", "epoch": 45}
{"loss": 0.23514091968536377, "acc": 0.9053354263305664, "length": 3.7867133617401123, "mode": "test", "epoch": 45}
{"loss": 0.20385047793388367, "acc": 0.9223291873931885, "length": 3.801023006439209, "mode": "train", "epoch": 46}
{"loss": 0.24141526222229004, "acc": 0.9156468510627747, "length": 3.832167863845825, "mode": "test", "epoch": 46}
{"loss": 0.19593611359596252, "acc": 0.928480327129364, "length": 3.8149609565734863, "mode": "train", "epoch": 47}
{"loss": 0.24564766883850098, "acc": 0.9119686484336853, "length": 3.860139846801758, "mode": "test", "epoch": 47}
{"loss": 0.2001250684261322, "acc": 0.9249597191810608, "length": 3.830315113067627, "mode": "train", "epoch": 48}
{"loss": 0.22097182273864746, "acc": 0.918532133102417, "length": 3.8286712169647217, "mode": "test", "epoch": 48}
{"loss": 0.19548772275447845, "acc": 0.9281615018844604, "length": 3.831298351287842, "mode": "train", "epoch": 49}
{"loss": 0.21946953237056732, "acc": 0.9211035370826721, "length": 3.8496503829956055, "mode": "test", "epoch": 49}
{"loss": 0.18787343800067902, "acc": 0.9310709834098816, "length": 3.84036922454834, "mode": "train", "epoch": 50}
{"loss": 0.2169075459241867, "acc": 0.9289063215255737, "length": 3.8356642723083496, "mode": "test", "epoch": 50}
{"loss": 0.1815371811389923, "acc": 0.9343161582946777, "length": 3.824244976043701, "mode": "train", "epoch": 51}
{"loss": 0.21520867943763733, "acc": 0.9293100833892822, "length": 3.8566434383392334, "mode": "test", "epoch": 51}
{"loss": 0.1753406822681427, "acc": 0.9361271262168884, "length": 3.8717236518859863, "mode": "train", "epoch": 52}
{"loss": 0.2037116140127182, "acc": 0.9328545928001404, "length": 3.8671329021453857, "mode": "test", "epoch": 52}
{"loss": 0.17261837422847748, "acc": 0.935909628868103, "length": 3.8521087169647217, "mode": "train", "epoch": 53}
{"loss": 0.20596709847450256, "acc": 0.9265981912612915, "length": 3.821678400039673, "mode": "test", "epoch": 53}
{"loss": 0.16671434044837952, "acc": 0.9365161657333374, "length": 3.8428854942321777, "mode": "train", "epoch": 54}
{"loss": 0.1951461136341095, "acc": 0.9316298365592957, "length": 3.9020979404449463, "mode": "test", "epoch": 54}
{"loss": 0.1685335785150528, "acc": 0.9410389065742493, "length": 3.8937058448791504, "mode": "train", "epoch": 55}
{"loss": 0.19681189954280853, "acc": 0.9328659176826477, "length": 3.923076868057251, "mode": "test", "epoch": 55}
{"loss": 0.16350480914115906, "acc": 0.9393745064735413, "length": 3.8960864543914795, "mode": "train", "epoch": 56}
{"loss": 0.19532410800457, "acc": 0.9344068169593811, "length": 3.8811187744140625, "mode": "test", "epoch": 56}
{"loss": 0.16107839345932007, "acc": 0.940928041934967, "length": 3.882132053375244, "mode": "train", "epoch": 57}
{"loss": 0.18616020679473877, "acc": 0.9348126649856567, "length": 3.916083812713623, "mode": "test", "epoch": 57}
{"loss": 0.15405258536338806, "acc": 0.9430477023124695, "length": 3.9048378467559814, "mode": "train", "epoch": 58}
{"loss": 0.20008060336112976, "acc": 0.9367959499359131, "length": 3.916083812713623, "mode": "test", "epoch": 58}
{"loss": 0.16012096405029297, "acc": 0.9436343312263489, "length": 3.9121270179748535, "mode": "train", "epoch": 59}
{"loss": 0.19438448548316956, "acc": 0.9336908459663391, "length": 3.9125874042510986, "mode": "test", "epoch": 59}
{"loss": 0.15429067611694336, "acc": 0.9426685571670532, "length": 3.901536464691162, "mode": "train", "epoch": 60}
{"loss": 0.233185812830925, "acc": 0.9354532957077026, "length": 3.9125874042510986, "mode": "test", "epoch": 60}
test accuracy: 0.8374564051628113
