# ["--attributes=3", "--values=16", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=128", "--learning_rate=0.001", "--hidden_size=256", "--temp_update=0.97", "--temperature=1"]
Creating train_ds and val_ds...

Creating test_ds...
{"loss": 0.7205585241317749, "acc": 0.516830563545227, "length": 3.374037981033325, "mode": "train", "epoch": 1}
{"loss": 0.6955897212028503, "acc": 0.4993007183074951, "length": 1.0, "mode": "test", "epoch": 1}
{"loss": 0.6993539929389954, "acc": 0.4982134997844696, "length": 1.5007781982421875, "mode": "train", "epoch": 2}
{"loss": 0.6972500681877136, "acc": 0.488636314868927, "length": 1.0, "mode": "test", "epoch": 2}
{"loss": 0.6937223076820374, "acc": 0.5099442005157471, "length": 1.0109022855758667, "mode": "train", "epoch": 3}
{"loss": 0.6901862621307373, "acc": 0.5360140204429626, "length": 1.0, "mode": "test", "epoch": 3}
{"loss": 0.6923065781593323, "acc": 0.5245058536529541, "length": 1.0033221244812012, "mode": "train", "epoch": 4}
{"loss": 0.6874401569366455, "acc": 0.5456293821334839, "length": 1.0, "mode": "test", "epoch": 4}
{"loss": 0.6915830373764038, "acc": 0.5335731506347656, "length": 1.0045185089111328, "mode": "train", "epoch": 5}
{"loss": 0.6911747455596924, "acc": 0.512762188911438, "length": 1.0, "mode": "test", "epoch": 5}
{"loss": 0.6857945919036865, "acc": 0.5441215634346008, "length": 1.1122004985809326, "mode": "train", "epoch": 6}
{"loss": 0.6654707789421082, "acc": 0.6012570858001709, "length": 1.5664335489273071, "mode": "test", "epoch": 6}
{"loss": 0.6492563486099243, "acc": 0.6311414837837219, "length": 2.1616969108581543, "mode": "train", "epoch": 7}
{"loss": 0.6157380938529968, "acc": 0.6861565113067627, "length": 2.237762212753296, "mode": "test", "epoch": 7}
{"loss": 0.5999658703804016, "acc": 0.6882391571998596, "length": 2.298196315765381, "mode": "train", "epoch": 8}
{"loss": 0.5940446257591248, "acc": 0.6900956034660339, "length": 2.35314679145813, "mode": "test", "epoch": 8}
{"loss": 0.5796837210655212, "acc": 0.7003554701805115, "length": 2.2353341579437256, "mode": "train", "epoch": 9}
{"loss": 0.5783474445343018, "acc": 0.7199783325195312, "length": 2.3951048851013184, "mode": "test", "epoch": 9}
{"loss": 0.5488736629486084, "acc": 0.7149777412414551, "length": 2.2864246368408203, "mode": "train", "epoch": 10}
{"loss": 0.5403580665588379, "acc": 0.7471358776092529, "length": 2.552447557449341, "mode": "test", "epoch": 10}
{"loss": 0.5117090344429016, "acc": 0.7545076608657837, "length": 2.587082624435425, "mode": "train", "epoch": 11}
{"loss": 0.49417611956596375, "acc": 0.8002967834472656, "length": 2.793706178665161, "mode": "test", "epoch": 11}
{"loss": 0.4663586914539337, "acc": 0.7848396301269531, "length": 2.8769848346710205, "mode": "train", "epoch": 12}
{"loss": 0.46893060207366943, "acc": 0.7935304045677185, "length": 3.1713287830352783, "mode": "test", "epoch": 12}
{"loss": 0.42643973231315613, "acc": 0.8127333521842957, "length": 3.0922107696533203, "mode": "train", "epoch": 13}
{"loss": 0.44819483160972595, "acc": 0.8083847761154175, "length": 3.244755268096924, "mode": "test", "epoch": 13}
{"loss": 0.41469842195510864, "acc": 0.8154100775718689, "length": 3.0360822677612305, "mode": "train", "epoch": 14}
{"loss": 0.4403870105743408, "acc": 0.8109462857246399, "length": 3.255244731903076, "mode": "test", "epoch": 14}
{"loss": 0.4010353684425354, "acc": 0.8179587721824646, "length": 3.087956190109253, "mode": "train", "epoch": 15}
{"loss": 0.43312668800354004, "acc": 0.8190044164657593, "length": 3.1818182468414307, "mode": "test", "epoch": 15}
{"loss": 0.39387500286102295, "acc": 0.8217331171035767, "length": 3.110621929168701, "mode": "train", "epoch": 16}
{"loss": 0.4508967101573944, "acc": 0.7987741827964783, "length": 3.255244731903076, "mode": "test", "epoch": 16}
{"loss": 0.3922041356563568, "acc": 0.8300028443336487, "length": 3.038541555404663, "mode": "train", "epoch": 17}
{"loss": 0.42388129234313965, "acc": 0.8187925815582275, "length": 3.1188812255859375, "mode": "test", "epoch": 17}
{"loss": 0.37721529603004456, "acc": 0.8422669172286987, "length": 3.1342856884002686, "mode": "train", "epoch": 18}
{"loss": 0.41184002161026, "acc": 0.8220964074134827, "length": 3.3181817531585693, "mode": "test", "epoch": 18}
{"loss": 0.3633469343185425, "acc": 0.8443930745124817, "length": 3.302626609802246, "mode": "train", "epoch": 19}
{"loss": 0.42486095428466797, "acc": 0.8301344513893127, "length": 3.475524425506592, "mode": "test", "epoch": 19}
{"loss": 0.3520125150680542, "acc": 0.8537938594818115, "length": 3.2506277561187744, "mode": "train", "epoch": 20}
{"loss": 0.36888954043388367, "acc": 0.8393784761428833, "length": 3.2867133617401123, "mode": "test", "epoch": 20}
{"loss": 0.3311309814453125, "acc": 0.8635743260383606, "length": 3.224609851837158, "mode": "train", "epoch": 21}
{"loss": 0.3744312524795532, "acc": 0.8414239883422852, "length": 3.2902097702026367, "mode": "test", "epoch": 21}
{"loss": 0.32176804542541504, "acc": 0.8713548183441162, "length": 3.2320573329925537, "mode": "train", "epoch": 22}
{"loss": 0.34908217191696167, "acc": 0.8519045114517212, "length": 3.293706178665161, "mode": "test", "epoch": 22}
{"loss": 0.30492034554481506, "acc": 0.8749558329582214, "length": 3.2097654342651367, "mode": "train", "epoch": 23}
{"loss": 0.34785521030426025, "acc": 0.8516327142715454, "length": 3.1748251914978027, "mode": "test", "epoch": 23}
{"loss": 0.30418241024017334, "acc": 0.8747029900550842, "length": 3.182067394256592, "mode": "train", "epoch": 24}
{"loss": 0.3249775767326355, "acc": 0.8589784502983093, "length": 3.1888113021850586, "mode": "test", "epoch": 24}
{"loss": 0.2928852438926697, "acc": 0.8795414566993713, "length": 3.2187955379486084, "mode": "train", "epoch": 25}
{"loss": 0.3320603370666504, "acc": 0.8553216457366943, "length": 3.199300765991211, "mode": "test", "epoch": 25}
{"loss": 0.2959795594215393, "acc": 0.878471851348877, "length": 3.18788743019104, "mode": "train", "epoch": 26}
{"loss": 0.318645715713501, "acc": 0.8686287999153137, "length": 3.1958041191101074, "mode": "test", "epoch": 26}
{"loss": 0.28711867332458496, "acc": 0.8830066323280334, "length": 3.235614061355591, "mode": "train", "epoch": 27}
{"loss": 0.3174102306365967, "acc": 0.8672248721122742, "length": 3.1958041191101074, "mode": "test", "epoch": 27}
{"loss": 0.2831079065799713, "acc": 0.8824318647384644, "length": 3.211409091949463, "mode": "train", "epoch": 28}
{"loss": 0.326961487531662, "acc": 0.8650158643722534, "length": 3.216783285140991, "mode": "test", "epoch": 28}
{"loss": 0.27692827582359314, "acc": 0.885989785194397, "length": 3.2033536434173584, "mode": "train", "epoch": 29}
{"loss": 0.31388676166534424, "acc": 0.8686476349830627, "length": 3.216783285140991, "mode": "test", "epoch": 29}
{"loss": 0.27583980560302734, "acc": 0.8876802921295166, "length": 3.1973159313201904, "mode": "train", "epoch": 30}
{"loss": 0.31860628724098206, "acc": 0.8622009754180908, "length": 3.2272727489471436, "mode": "test", "epoch": 30}
{"loss": 0.277830570936203, "acc": 0.8833673000335693, "length": 3.2301485538482666, "mode": "train", "epoch": 31}
{"loss": 0.3193483054637909, "acc": 0.87107914686203, "length": 3.2272727489471436, "mode": "test", "epoch": 31}
{"loss": 0.27608412504196167, "acc": 0.8881372213363647, "length": 3.2080676555633545, "mode": "train", "epoch": 32}
{"loss": 0.3229404091835022, "acc": 0.8715047836303711, "length": 3.2202796936035156, "mode": "test", "epoch": 32}
{"loss": 0.26633697748184204, "acc": 0.889747679233551, "length": 3.2210404872894287, "mode": "train", "epoch": 33}
{"loss": 0.3230009078979492, "acc": 0.8739224672317505, "length": 3.244755268096924, "mode": "test", "epoch": 33}
{"loss": 0.26215463876724243, "acc": 0.8910711407661438, "length": 3.2300281524658203, "mode": "train", "epoch": 34}
{"loss": 0.3130221366882324, "acc": 0.8682547807693481, "length": 3.2272727489471436, "mode": "test", "epoch": 34}
{"loss": 0.26357516646385193, "acc": 0.8927608132362366, "length": 3.2075114250183105, "mode": "train", "epoch": 35}
{"loss": 0.3072303235530853, "acc": 0.8785498142242432, "length": 3.216783285140991, "mode": "test", "epoch": 35}
{"loss": 0.2585256099700928, "acc": 0.8982824087142944, "length": 3.2461349964141846, "mode": "train", "epoch": 36}
{"loss": 0.3040558695793152, "acc": 0.8822652697563171, "length": 3.237762212753296, "mode": "test", "epoch": 36}
{"loss": 0.25677192211151123, "acc": 0.8967459797859192, "length": 3.219111680984497, "mode": "train", "epoch": 37}
{"loss": 0.3208397626876831, "acc": 0.8777471780776978, "length": 3.269230842590332, "mode": "test", "epoch": 37}
{"loss": 0.25522109866142273, "acc": 0.9002081751823425, "length": 3.2642500400543213, "mode": "train", "epoch": 38}
{"loss": 0.313233882188797, "acc": 0.8843597173690796, "length": 3.262237787246704, "mode": "test", "epoch": 38}
{"loss": 0.25873005390167236, "acc": 0.8955570459365845, "length": 3.29219126701355, "mode": "train", "epoch": 39}
{"loss": 0.3060997426509857, "acc": 0.8839027881622314, "length": 3.2657341957092285, "mode": "test", "epoch": 39}
{"loss": 0.2530301809310913, "acc": 0.8998710513114929, "length": 3.2555477619171143, "mode": "train", "epoch": 40}
{"loss": 0.305958092212677, "acc": 0.8849014639854431, "length": 3.2727272510528564, "mode": "test", "epoch": 40}
{"loss": 0.2503626346588135, "acc": 0.9031615257263184, "length": 3.3234074115753174, "mode": "train", "epoch": 41}
{"loss": 0.3184373378753662, "acc": 0.8831169605255127, "length": 3.3286712169647217, "mode": "test", "epoch": 41}
{"loss": 0.2504439055919647, "acc": 0.9007061719894409, "length": 3.337674856185913, "mode": "train", "epoch": 42}
{"loss": 0.3166083097457886, "acc": 0.8900287747383118, "length": 3.377622365951538, "mode": "test", "epoch": 42}
{"loss": 0.2532479465007782, "acc": 0.9035241007804871, "length": 3.383448839187622, "mode": "train", "epoch": 43}
{"loss": 0.2929428219795227, "acc": 0.8882943987846375, "length": 3.3496503829956055, "mode": "test", "epoch": 43}
{"loss": 0.24354705214500427, "acc": 0.9068603515625, "length": 3.369288206100464, "mode": "train", "epoch": 44}
{"loss": 0.3144688010215759, "acc": 0.896216630935669, "length": 3.3671329021453857, "mode": "test", "epoch": 44}
{"loss": 0.244953915476799, "acc": 0.9063835740089417, "length": 3.355971574783325, "mode": "train", "epoch": 45}
{"loss": 0.27552518248558044, "acc": 0.9003044962882996, "length": 3.346153736114502, "mode": "test", "epoch": 45}
{"loss": 0.23344430327415466, "acc": 0.9097594022750854, "length": 3.32494854927063, "mode": "train", "epoch": 46}
{"loss": 0.2811982035636902, "acc": 0.8992785215377808, "length": 3.3426573276519775, "mode": "test", "epoch": 46}
{"loss": 0.2313547432422638, "acc": 0.9113616347312927, "length": 3.3128042221069336, "mode": "train", "epoch": 47}
{"loss": 0.28117606043815613, "acc": 0.8929937481880188, "length": 3.3636362552642822, "mode": "test", "epoch": 47}
{"loss": 0.22950197756290436, "acc": 0.9112172722816467, "length": 3.3543941974639893, "mode": "train", "epoch": 48}
{"loss": 0.27268272638320923, "acc": 0.9003100395202637, "length": 3.37062931060791, "mode": "test", "epoch": 48}
{"loss": 0.23090852797031403, "acc": 0.9118534922599792, "length": 3.37960147857666, "mode": "train", "epoch": 49}
{"loss": 0.27057212591171265, "acc": 0.9053971171379089, "length": 3.3426573276519775, "mode": "test", "epoch": 49}
{"loss": 0.23282527923583984, "acc": 0.9110132455825806, "length": 3.324662208557129, "mode": "train", "epoch": 50}
{"loss": 0.2842789590358734, "acc": 0.8990201354026794, "length": 3.3426573276519775, "mode": "test", "epoch": 50}
{"loss": 0.22322532534599304, "acc": 0.911575973033905, "length": 3.3597757816314697, "mode": "train", "epoch": 51}
{"loss": 0.27367961406707764, "acc": 0.899023711681366, "length": 3.3671329021453857, "mode": "test", "epoch": 51}
{"loss": 0.2189018875360489, "acc": 0.9132145047187805, "length": 3.3460946083068848, "mode": "train", "epoch": 52}
{"loss": 0.2792764902114868, "acc": 0.9027003645896912, "length": 3.346153736114502, "mode": "test", "epoch": 52}
{"loss": 0.21860000491142273, "acc": 0.9162866473197937, "length": 3.325444221496582, "mode": "train", "epoch": 53}
{"loss": 0.27275320887565613, "acc": 0.9077829122543335, "length": 3.3426573276519775, "mode": "test", "epoch": 53}
{"loss": 0.23910404741764069, "acc": 0.9068529009819031, "length": 3.3273234367370605, "mode": "train", "epoch": 54}
{"loss": 0.3041638731956482, "acc": 0.8891252875328064, "length": 3.377622365951538, "mode": "test", "epoch": 54}
{"loss": 0.23853540420532227, "acc": 0.9027029275894165, "length": 3.35552716255188, "mode": "train", "epoch": 55}
{"loss": 0.33012351393699646, "acc": 0.8880594968795776, "length": 3.332167863845825, "mode": "test", "epoch": 55}
{"loss": 0.2334619015455246, "acc": 0.9060364365577698, "length": 3.2935707569122314, "mode": "train", "epoch": 56}
{"loss": 0.3035188317298889, "acc": 0.8749931454658508, "length": 3.3356642723083496, "mode": "test", "epoch": 56}
{"loss": 0.227993443608284, "acc": 0.9053567051887512, "length": 3.3627541065216064, "mode": "train", "epoch": 57}
{"loss": 0.2993496060371399, "acc": 0.8940949440002441, "length": 3.3496503829956055, "mode": "test", "epoch": 57}
{"loss": 0.22354453802108765, "acc": 0.9111643433570862, "length": 3.3387985229492188, "mode": "train", "epoch": 58}
{"loss": 0.2845524251461029, "acc": 0.8923864364624023, "length": 3.384615421295166, "mode": "test", "epoch": 58}
{"loss": 0.22422683238983154, "acc": 0.9115821719169617, "length": 3.3886878490448, "mode": "train", "epoch": 59}
{"loss": 0.28328174352645874, "acc": 0.8898807168006897, "length": 3.377622365951538, "mode": "test", "epoch": 59}
{"loss": 0.20950552821159363, "acc": 0.9158472418785095, "length": 3.404243230819702, "mode": "train", "epoch": 60}
{"loss": 0.27960526943206787, "acc": 0.9030511975288391, "length": 3.4020979404449463, "mode": "test", "epoch": 60}
test accuracy: 0.8264780640602112
