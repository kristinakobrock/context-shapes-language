# ["--attributes=5", "--values=16", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=128", "--learning_rate=0.001", "--hidden_size=256", "--temp_update=0.99", "--temperature=1"]
Creating train_ds and val_ds...

Creating test_ds...
{"loss": 0.7146257758140564, "acc": 0.5237976908683777, "length": 3.1648566722869873, "mode": "train", "epoch": 1}
{"loss": 0.702122688293457, "acc": 0.5059440732002258, "length": 1.0, "mode": "test", "epoch": 1}
{"loss": 0.6965802311897278, "acc": 0.5161362290382385, "length": 1.2230840921401978, "mode": "train", "epoch": 2}
{"loss": 0.6962865591049194, "acc": 0.5534964203834534, "length": 1.0, "mode": "test", "epoch": 2}
{"loss": 0.6900175213813782, "acc": 0.5262313485145569, "length": 1.0027680397033691, "mode": "train", "epoch": 3}
{"loss": 0.6944403052330017, "acc": 0.5236014127731323, "length": 1.0, "mode": "test", "epoch": 3}
{"loss": 0.6904972791671753, "acc": 0.5300354957580566, "length": 1.0004942417144775, "mode": "train", "epoch": 4}
{"loss": 0.6952390670776367, "acc": 0.5513985753059387, "length": 1.0, "mode": "test", "epoch": 4}
{"loss": 0.6893999576568604, "acc": 0.5274006128311157, "length": 1.000279188156128, "mode": "train", "epoch": 5}
{"loss": 0.6928576231002808, "acc": 0.5318182706832886, "length": 1.0, "mode": "test", "epoch": 5}
{"loss": 0.6883866786956787, "acc": 0.5406227111816406, "length": 1.000891089439392, "mode": "train", "epoch": 6}
{"loss": 0.691173255443573, "acc": 0.524125874042511, "length": 1.0, "mode": "test", "epoch": 6}
{"loss": 0.69047611951828, "acc": 0.5204914808273315, "length": 1.0001704692840576, "mode": "train", "epoch": 7}
{"loss": 0.6942359805107117, "acc": 0.5321678519248962, "length": 1.0, "mode": "test", "epoch": 7}
{"loss": 0.6893650889396667, "acc": 0.5323163866996765, "length": 1.0010769367218018, "mode": "train", "epoch": 8}
{"loss": 0.6922401189804077, "acc": 0.5227271914482117, "length": 1.0, "mode": "test", "epoch": 8}
{"loss": 0.6876562833786011, "acc": 0.5317328572273254, "length": 1.000099539756775, "mode": "train", "epoch": 9}
{"loss": 0.6933059096336365, "acc": 0.5288462042808533, "length": 1.0, "mode": "test", "epoch": 9}
{"loss": 0.6876582503318787, "acc": 0.528043270111084, "length": 1.000514268875122, "mode": "train", "epoch": 10}
{"loss": 0.6912260055541992, "acc": 0.5279721617698669, "length": 1.0, "mode": "test", "epoch": 10}
{"loss": 0.6871576905250549, "acc": 0.5270652770996094, "length": 1.0006242990493774, "mode": "train", "epoch": 11}
{"loss": 0.6898016929626465, "acc": 0.5272727608680725, "length": 1.0, "mode": "test", "epoch": 11}
{"loss": 0.6873700618743896, "acc": 0.5352473855018616, "length": 1.000110149383545, "mode": "train", "epoch": 12}
{"loss": 0.6928281188011169, "acc": 0.5458040833473206, "length": 1.0, "mode": "test", "epoch": 12}
{"loss": 0.6872336864471436, "acc": 0.5333136320114136, "length": 1.000123381614685, "mode": "train", "epoch": 13}
{"loss": 0.690582275390625, "acc": 0.5270978808403015, "length": 1.0, "mode": "test", "epoch": 13}
{"loss": 0.6869246363639832, "acc": 0.5289234519004822, "length": 1.0002230405807495, "mode": "train", "epoch": 14}
{"loss": 0.6903254389762878, "acc": 0.5368881225585938, "length": 1.0, "mode": "test", "epoch": 14}
{"loss": 0.6870489716529846, "acc": 0.5320262908935547, "length": 1.000135898590088, "mode": "train", "epoch": 15}
{"loss": 0.6903972029685974, "acc": 0.5486013293266296, "length": 1.0, "mode": "test", "epoch": 15}
{"loss": 0.6884221434593201, "acc": 0.5330802798271179, "length": 1.0002367496490479, "mode": "train", "epoch": 16}
{"loss": 0.6899772882461548, "acc": 0.5395104289054871, "length": 1.0, "mode": "test", "epoch": 16}
{"loss": 0.6876599788665771, "acc": 0.5213697552680969, "length": 1.0000977516174316, "mode": "train", "epoch": 17}
{"loss": 0.688321590423584, "acc": 0.5202797651290894, "length": 1.0, "mode": "test", "epoch": 17}
{"loss": 0.6877647042274475, "acc": 0.5338408350944519, "length": 1.000171422958374, "mode": "train", "epoch": 18}
{"loss": 0.6945923566818237, "acc": 0.5384615659713745, "length": 1.0, "mode": "test", "epoch": 18}
{"loss": 0.6873368620872498, "acc": 0.5348363518714905, "length": 1.000108003616333, "mode": "train", "epoch": 19}
{"loss": 0.6894649267196655, "acc": 0.52395099401474, "length": 1.0, "mode": "test", "epoch": 19}
{"loss": 0.68683260679245, "acc": 0.525826096534729, "length": 1.000423550605774, "mode": "train", "epoch": 20}
{"loss": 0.6874517202377319, "acc": 0.5326923131942749, "length": 1.0, "mode": "test", "epoch": 20}
{"loss": 0.687003493309021, "acc": 0.5283939838409424, "length": 1.0001546144485474, "mode": "train", "epoch": 21}
{"loss": 0.6902120113372803, "acc": 0.5346153974533081, "length": 1.0, "mode": "test", "epoch": 21}
{"loss": 0.6875941753387451, "acc": 0.5290982723236084, "length": 1.0000942945480347, "mode": "train", "epoch": 22}
{"loss": 0.6896860003471375, "acc": 0.5325174927711487, "length": 1.0, "mode": "test", "epoch": 22}
{"loss": 0.6871730089187622, "acc": 0.5377042889595032, "length": 1.000246524810791, "mode": "train", "epoch": 23}
{"loss": 0.6896724700927734, "acc": 0.5437062382698059, "length": 1.0, "mode": "test", "epoch": 23}
{"loss": 0.6891065239906311, "acc": 0.517389714717865, "length": 1.0001899003982544, "mode": "train", "epoch": 24}
{"loss": 0.6889738440513611, "acc": 0.5402097105979919, "length": 1.0, "mode": "test", "epoch": 24}
{"loss": 0.6861283183097839, "acc": 0.5406250357627869, "length": 1.0005321502685547, "mode": "train", "epoch": 25}
{"loss": 0.6884374618530273, "acc": 0.543181836605072, "length": 1.0, "mode": "test", "epoch": 25}
{"loss": 0.6851335167884827, "acc": 0.5399242639541626, "length": 1.0011900663375854, "mode": "train", "epoch": 26}
{"loss": 0.6878902316093445, "acc": 0.5361888408660889, "length": 1.0, "mode": "test", "epoch": 26}
{"loss": 0.6852479577064514, "acc": 0.5315750241279602, "length": 1.002934455871582, "mode": "train", "epoch": 27}
{"loss": 0.6873841285705566, "acc": 0.538811206817627, "length": 1.0, "mode": "test", "epoch": 27}
{"loss": 0.6851651668548584, "acc": 0.5372952222824097, "length": 1.0069682598114014, "mode": "train", "epoch": 28}
{"loss": 0.686804473400116, "acc": 0.543181836605072, "length": 1.0, "mode": "test", "epoch": 28}
{"loss": 0.677772581577301, "acc": 0.5659176707267761, "length": 1.2744206190109253, "mode": "train", "epoch": 29}
{"loss": 0.6461577415466309, "acc": 0.6747623085975647, "length": 2.3426573276519775, "mode": "test", "epoch": 29}
{"loss": 0.627580463886261, "acc": 0.6724742650985718, "length": 2.227235794067383, "mode": "train", "epoch": 30}
{"loss": 0.6018008589744568, "acc": 0.6832902431488037, "length": 2.493006944656372, "mode": "test", "epoch": 30}
{"loss": 0.5963258743286133, "acc": 0.6948989629745483, "length": 2.3298213481903076, "mode": "train", "epoch": 31}
{"loss": 0.5857044458389282, "acc": 0.6974114775657654, "length": 2.1818182468414307, "mode": "test", "epoch": 31}
{"loss": 0.5770080089569092, "acc": 0.706666111946106, "length": 2.1794419288635254, "mode": "train", "epoch": 32}
{"loss": 0.5733426809310913, "acc": 0.7205818891525269, "length": 2.552447557449341, "mode": "test", "epoch": 32}
{"loss": 0.560084879398346, "acc": 0.7277320027351379, "length": 2.4738049507141113, "mode": "train", "epoch": 33}
{"loss": 0.5456852316856384, "acc": 0.7525330781936646, "length": 2.667832136154175, "mode": "test", "epoch": 33}
{"loss": 0.5404483675956726, "acc": 0.7465410232543945, "length": 2.789870500564575, "mode": "train", "epoch": 34}
{"loss": 0.5429460406303406, "acc": 0.7443372011184692, "length": 2.8356642723083496, "mode": "test", "epoch": 34}
{"loss": 0.5187990665435791, "acc": 0.7627056837081909, "length": 2.971364736557007, "mode": "train", "epoch": 35}
{"loss": 0.5101456642150879, "acc": 0.773429811000824, "length": 3.0349650382995605, "mode": "test", "epoch": 35}
{"loss": 0.5014545321464539, "acc": 0.7753394246101379, "length": 3.1000163555145264, "mode": "train", "epoch": 36}
{"loss": 0.48619768023490906, "acc": 0.7997549176216125, "length": 3.045454502105713, "mode": "test", "epoch": 36}
{"loss": 0.47451251745224, "acc": 0.793475329875946, "length": 3.162369728088379, "mode": "train", "epoch": 37}
{"loss": 0.452562153339386, "acc": 0.8166166543960571, "length": 3.1503496170043945, "mode": "test", "epoch": 37}
{"loss": 0.4456118047237396, "acc": 0.8078224658966064, "length": 3.2189645767211914, "mode": "train", "epoch": 38}
{"loss": 0.4257214069366455, "acc": 0.8044047951698303, "length": 3.1818182468414307, "mode": "test", "epoch": 38}
{"loss": 0.4160727560520172, "acc": 0.811532735824585, "length": 3.208092212677002, "mode": "train", "epoch": 39}
{"loss": 0.41326701641082764, "acc": 0.8159685730934143, "length": 3.1503496170043945, "mode": "test", "epoch": 39}
{"loss": 0.3952246606349945, "acc": 0.8372558355331421, "length": 3.2340087890625, "mode": "train", "epoch": 40}
{"loss": 0.3739192485809326, "acc": 0.8492751717567444, "length": 3.160839080810547, "mode": "test", "epoch": 40}
{"loss": 0.374544233083725, "acc": 0.8438102006912231, "length": 3.290466547012329, "mode": "train", "epoch": 41}
{"loss": 0.3650009036064148, "acc": 0.8497050404548645, "length": 3.2027971744537354, "mode": "test", "epoch": 41}
{"loss": 0.3681977093219757, "acc": 0.8429304361343384, "length": 3.3529443740844727, "mode": "train", "epoch": 42}
{"loss": 0.3434792459011078, "acc": 0.8547216057777405, "length": 3.269230842590332, "mode": "test", "epoch": 42}
{"loss": 0.3580993711948395, "acc": 0.8500198125839233, "length": 3.3774843215942383, "mode": "train", "epoch": 43}
{"loss": 0.3328782021999359, "acc": 0.8642022013664246, "length": 3.3636362552642822, "mode": "test", "epoch": 43}
{"loss": 0.3538447320461273, "acc": 0.8493306636810303, "length": 3.5169553756713867, "mode": "train", "epoch": 44}
{"loss": 0.3312709331512451, "acc": 0.8635597229003906, "length": 3.4335663318634033, "mode": "test", "epoch": 44}
{"loss": 0.35105058550834656, "acc": 0.8547785878181458, "length": 3.556028366088867, "mode": "train", "epoch": 45}
{"loss": 0.31407639384269714, "acc": 0.8701545596122742, "length": 3.4965035915374756, "mode": "test", "epoch": 45}
{"loss": 0.34386375546455383, "acc": 0.8580813407897949, "length": 3.569587230682373, "mode": "train", "epoch": 46}
{"loss": 0.31710875034332275, "acc": 0.8671448230743408, "length": 3.506993055343628, "mode": "test", "epoch": 46}
{"loss": 0.33544355630874634, "acc": 0.8633220791816711, "length": 3.5209174156188965, "mode": "train", "epoch": 47}
{"loss": 0.3055168390274048, "acc": 0.8761040568351746, "length": 3.5594406127929688, "mode": "test", "epoch": 47}
{"loss": 0.32616597414016724, "acc": 0.8679482340812683, "length": 3.6527099609375, "mode": "train", "epoch": 48}
{"loss": 0.315623015165329, "acc": 0.8712456822395325, "length": 3.6433565616607666, "mode": "test", "epoch": 48}
{"loss": 0.3251096308231354, "acc": 0.8674280643463135, "length": 3.654478073120117, "mode": "train", "epoch": 49}
{"loss": 0.31109780073165894, "acc": 0.8775936961174011, "length": 3.7132866382598877, "mode": "test", "epoch": 49}
{"loss": 0.32474565505981445, "acc": 0.8677588105201721, "length": 3.635373592376709, "mode": "train", "epoch": 50}
{"loss": 0.30911535024642944, "acc": 0.8752970695495605, "length": 3.615384578704834, "mode": "test", "epoch": 50}
{"loss": 0.325669527053833, "acc": 0.8680979609489441, "length": 3.7654783725738525, "mode": "train", "epoch": 51}
{"loss": 0.2957429587841034, "acc": 0.8777318000793457, "length": 3.8741259574890137, "mode": "test", "epoch": 51}
{"loss": 0.3159901201725006, "acc": 0.8718777894973755, "length": 3.8205926418304443, "mode": "train", "epoch": 52}
{"loss": 0.31241267919540405, "acc": 0.8808498978614807, "length": 3.8356642723083496, "mode": "test", "epoch": 52}
{"loss": 0.3119796812534332, "acc": 0.8702899813652039, "length": 3.761674165725708, "mode": "train", "epoch": 53}
{"loss": 0.30922645330429077, "acc": 0.8787316679954529, "length": 3.800699234008789, "mode": "test", "epoch": 53}
{"loss": 0.31987014412879944, "acc": 0.8684664964675903, "length": 3.815115213394165, "mode": "train", "epoch": 54}
{"loss": 0.2953008711338043, "acc": 0.8790374994277954, "length": 3.8671329021453857, "mode": "test", "epoch": 54}
{"loss": 0.31569114327430725, "acc": 0.8694128394126892, "length": 3.846078872680664, "mode": "train", "epoch": 55}
{"loss": 0.2992527484893799, "acc": 0.8824355006217957, "length": 3.8951048851013184, "mode": "test", "epoch": 55}
{"loss": 0.3126603960990906, "acc": 0.8757661581039429, "length": 3.853327512741089, "mode": "train", "epoch": 56}
{"loss": 0.29882490634918213, "acc": 0.8732694387435913, "length": 3.9650349617004395, "mode": "test", "epoch": 56}
{"loss": 0.29550090432167053, "acc": 0.8754700422286987, "length": 3.9705779552459717, "mode": "train", "epoch": 57}
{"loss": 0.2684148848056793, "acc": 0.8882865905761719, "length": 4.0, "mode": "test", "epoch": 57}
{"loss": 0.29167312383651733, "acc": 0.877329409122467, "length": 3.9910969734191895, "mode": "train", "epoch": 58}
{"loss": 0.29039138555526733, "acc": 0.881118893623352, "length": 4.0, "mode": "test", "epoch": 58}
{"loss": 0.2850106358528137, "acc": 0.8793025016784668, "length": 3.9951558113098145, "mode": "train", "epoch": 59}
{"loss": 0.2855810225009918, "acc": 0.8867131471633911, "length": 4.0, "mode": "test", "epoch": 59}
{"loss": 0.2815765142440796, "acc": 0.8834751844406128, "length": 3.9936797618865967, "mode": "train", "epoch": 60}
{"loss": 0.2602943181991577, "acc": 0.8917831778526306, "length": 4.0, "mode": "test", "epoch": 60}
test accuracy: 0.6935001015663147
