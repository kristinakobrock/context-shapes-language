# ["--attributes=5", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=128", "--learning_rate=0.0005", "--hidden_size=128", "--temp_update=0.99", "--temperature=1"]
Creating train_ds and val_ds...

Creating test_ds...
{"loss": 0.6977066397666931, "acc": 0.5056362748146057, "length": 3.5539653301239014, "mode": "train", "epoch": 1}
{"loss": 0.6831997632980347, "acc": 0.5359787344932556, "length": 1.9510489702224731, "mode": "test", "epoch": 1}
{"loss": 0.692491888999939, "acc": 0.5238716006278992, "length": 3.526109218597412, "mode": "train", "epoch": 2}
{"loss": 0.679673433303833, "acc": 0.575705885887146, "length": 2.062937021255493, "mode": "test", "epoch": 2}
{"loss": 0.6911129355430603, "acc": 0.5218414664268494, "length": 3.4990015029907227, "mode": "train", "epoch": 3}
{"loss": 0.6786324381828308, "acc": 0.574043333530426, "length": 1.9860140085220337, "mode": "test", "epoch": 3}
{"loss": 0.689010500907898, "acc": 0.529273271560669, "length": 3.430803060531616, "mode": "train", "epoch": 4}
{"loss": 0.6705222129821777, "acc": 0.6374836564064026, "length": 2.1748251914978027, "mode": "test", "epoch": 4}
{"loss": 0.6837708353996277, "acc": 0.5610854625701904, "length": 3.3682374954223633, "mode": "train", "epoch": 5}
{"loss": 0.6588985323905945, "acc": 0.6494720578193665, "length": 2.552447557449341, "mode": "test", "epoch": 5}
{"loss": 0.6695001721382141, "acc": 0.5952885746955872, "length": 3.2972755432128906, "mode": "train", "epoch": 6}
{"loss": 0.6408023834228516, "acc": 0.6868242621421814, "length": 3.0, "mode": "test", "epoch": 6}
{"loss": 0.6424305438995361, "acc": 0.6670531034469604, "length": 3.27805233001709, "mode": "train", "epoch": 7}
{"loss": 0.613937497138977, "acc": 0.682059109210968, "length": 3.2587411403656006, "mode": "test", "epoch": 7}
{"loss": 0.6074569821357727, "acc": 0.6945735812187195, "length": 3.374493360519409, "mode": "train", "epoch": 8}
{"loss": 0.5839264392852783, "acc": 0.7081500291824341, "length": 3.6573426723480225, "mode": "test", "epoch": 8}
{"loss": 0.5701278448104858, "acc": 0.7007301449775696, "length": 3.555037021636963, "mode": "train", "epoch": 9}
{"loss": 0.5532797574996948, "acc": 0.7335773706436157, "length": 3.6818182468414307, "mode": "test", "epoch": 9}
{"loss": 0.5415933728218079, "acc": 0.7184102535247803, "length": 3.553685188293457, "mode": "train", "epoch": 10}
{"loss": 0.5237774848937988, "acc": 0.7634444832801819, "length": 3.608391523361206, "mode": "test", "epoch": 10}
{"loss": 0.5115823149681091, "acc": 0.7637538313865662, "length": 3.604825496673584, "mode": "train", "epoch": 11}
{"loss": 0.48793351650238037, "acc": 0.7867699265480042, "length": 3.716783285140991, "mode": "test", "epoch": 11}
{"loss": 0.48363274335861206, "acc": 0.7804986834526062, "length": 3.680225133895874, "mode": "train", "epoch": 12}
{"loss": 0.47237738966941833, "acc": 0.7937560677528381, "length": 3.8111886978149414, "mode": "test", "epoch": 12}
{"loss": 0.4516487717628479, "acc": 0.7958779335021973, "length": 3.7433605194091797, "mode": "train", "epoch": 13}
{"loss": 0.42726022005081177, "acc": 0.8112213015556335, "length": 3.860139846801758, "mode": "test", "epoch": 13}
{"loss": 0.434378057718277, "acc": 0.8089210391044617, "length": 3.7364253997802734, "mode": "train", "epoch": 14}
{"loss": 0.4156651496887207, "acc": 0.8158388733863831, "length": 3.7132866382598877, "mode": "test", "epoch": 14}
{"loss": 0.4167720377445221, "acc": 0.8144378066062927, "length": 3.696038007736206, "mode": "train", "epoch": 15}
{"loss": 0.39939412474632263, "acc": 0.800117015838623, "length": 3.716783285140991, "mode": "test", "epoch": 15}
{"loss": 0.40865543484687805, "acc": 0.8170114755630493, "length": 3.736921787261963, "mode": "train", "epoch": 16}
{"loss": 0.39730843901634216, "acc": 0.8056780695915222, "length": 3.706293821334839, "mode": "test", "epoch": 16}
{"loss": 0.3968760073184967, "acc": 0.8234274387359619, "length": 3.745504856109619, "mode": "train", "epoch": 17}
{"loss": 0.3931264877319336, "acc": 0.808082103729248, "length": 3.6328670978546143, "mode": "test", "epoch": 17}
{"loss": 0.3852117359638214, "acc": 0.8289119005203247, "length": 3.672081470489502, "mode": "train", "epoch": 18}
{"loss": 0.3766469359397888, "acc": 0.8267359733581543, "length": 3.5944056510925293, "mode": "test", "epoch": 18}
{"loss": 0.37838441133499146, "acc": 0.8344331979751587, "length": 3.677320957183838, "mode": "train", "epoch": 19}
{"loss": 0.3642084300518036, "acc": 0.8313437104225159, "length": 3.6048951148986816, "mode": "test", "epoch": 19}
{"loss": 0.36885371804237366, "acc": 0.8443679213523865, "length": 3.6541588306427, "mode": "train", "epoch": 20}
{"loss": 0.36456918716430664, "acc": 0.829846978187561, "length": 3.562937021255493, "mode": "test", "epoch": 20}
{"loss": 0.36506322026252747, "acc": 0.8486315011978149, "length": 3.634247064590454, "mode": "train", "epoch": 21}
{"loss": 0.35992497205734253, "acc": 0.8344789743423462, "length": 3.6573426723480225, "mode": "test", "epoch": 21}
{"loss": 0.3558448255062103, "acc": 0.8506129384040833, "length": 3.7044949531555176, "mode": "train", "epoch": 22}
{"loss": 0.35900503396987915, "acc": 0.8339262008666992, "length": 3.7132866382598877, "mode": "test", "epoch": 22}
{"loss": 0.34504950046539307, "acc": 0.8536697626113892, "length": 3.7670938968658447, "mode": "train", "epoch": 23}
{"loss": 0.347591370344162, "acc": 0.8455331325531006, "length": 3.7587411403656006, "mode": "test", "epoch": 23}
{"loss": 0.34175631403923035, "acc": 0.8561375737190247, "length": 3.770538568496704, "mode": "train", "epoch": 24}
{"loss": 0.3565015196800232, "acc": 0.8375037312507629, "length": 3.7657341957092285, "mode": "test", "epoch": 24}
{"loss": 0.3403703570365906, "acc": 0.8603426814079285, "length": 3.7736833095550537, "mode": "train", "epoch": 25}
{"loss": 0.3426935076713562, "acc": 0.8469594120979309, "length": 3.7797203063964844, "mode": "test", "epoch": 25}
{"loss": 0.3271940350532532, "acc": 0.8648097515106201, "length": 3.7964627742767334, "mode": "train", "epoch": 26}
{"loss": 0.3468322157859802, "acc": 0.8439286351203918, "length": 3.814685344696045, "mode": "test", "epoch": 26}
{"loss": 0.3266245424747467, "acc": 0.8671877980232239, "length": 3.8141872882843018, "mode": "train", "epoch": 27}
{"loss": 0.34535717964172363, "acc": 0.845748782157898, "length": 3.762237787246704, "mode": "test", "epoch": 27}
{"loss": 0.3233054280281067, "acc": 0.8662799000740051, "length": 3.7946972846984863, "mode": "train", "epoch": 28}
{"loss": 0.3407213091850281, "acc": 0.8466032147407532, "length": 3.7972028255462646, "mode": "test", "epoch": 28}
{"loss": 0.3178773820400238, "acc": 0.8711156249046326, "length": 3.8064610958099365, "mode": "train", "epoch": 29}
{"loss": 0.32773447036743164, "acc": 0.8522301912307739, "length": 3.7517483234405518, "mode": "test", "epoch": 29}
{"loss": 0.31781578063964844, "acc": 0.8727442026138306, "length": 3.7698869705200195, "mode": "train", "epoch": 30}
{"loss": 0.3273908495903015, "acc": 0.8475398421287537, "length": 3.7587411403656006, "mode": "test", "epoch": 30}
{"loss": 0.30682188272476196, "acc": 0.8731575012207031, "length": 3.787594795227051, "mode": "train", "epoch": 31}
{"loss": 0.322310209274292, "acc": 0.8563721179962158, "length": 3.769230842590332, "mode": "test", "epoch": 31}
{"loss": 0.3110801577568054, "acc": 0.8716450929641724, "length": 3.758167028427124, "mode": "train", "epoch": 32}
{"loss": 0.314732164144516, "acc": 0.8593695759773254, "length": 3.7587411403656006, "mode": "test", "epoch": 32}
{"loss": 0.30757802724838257, "acc": 0.8714621067047119, "length": 3.776479482650757, "mode": "train", "epoch": 33}
{"loss": 0.316018283367157, "acc": 0.8594931960105896, "length": 3.776223659515381, "mode": "test", "epoch": 33}
{"loss": 0.3008037805557251, "acc": 0.8775287866592407, "length": 3.7832467555999756, "mode": "train", "epoch": 34}
{"loss": 0.30504852533340454, "acc": 0.8627932667732239, "length": 3.7342658042907715, "mode": "test", "epoch": 34}
{"loss": 0.2960274815559387, "acc": 0.8798229098320007, "length": 3.7526354789733887, "mode": "train", "epoch": 35}
{"loss": 0.30428385734558105, "acc": 0.8683668375015259, "length": 3.7272727489471436, "mode": "test", "epoch": 35}
{"loss": 0.29459038376808167, "acc": 0.8794537782669067, "length": 3.733365058898926, "mode": "train", "epoch": 36}
{"loss": 0.30047088861465454, "acc": 0.8723248243331909, "length": 3.7412588596343994, "mode": "test", "epoch": 36}
{"loss": 0.28955671191215515, "acc": 0.8835492730140686, "length": 3.7565038204193115, "mode": "train", "epoch": 37}
{"loss": 0.28886231780052185, "acc": 0.8707355260848999, "length": 3.776223659515381, "mode": "test", "epoch": 37}
{"loss": 0.28623196482658386, "acc": 0.881462037563324, "length": 3.8113930225372314, "mode": "train", "epoch": 38}
{"loss": 0.29000067710876465, "acc": 0.8797791600227356, "length": 3.762237787246704, "mode": "test", "epoch": 38}
{"loss": 0.28320997953414917, "acc": 0.8886291980743408, "length": 3.7623178958892822, "mode": "train", "epoch": 39}
{"loss": 0.28581440448760986, "acc": 0.8751909732818604, "length": 3.7587411403656006, "mode": "test", "epoch": 39}
{"loss": 0.27868372201919556, "acc": 0.8874395489692688, "length": 3.7816483974456787, "mode": "train", "epoch": 40}
{"loss": 0.28700101375579834, "acc": 0.8725364804267883, "length": 3.723776340484619, "mode": "test", "epoch": 40}
{"loss": 0.2683725357055664, "acc": 0.89046710729599, "length": 3.7377941608428955, "mode": "train", "epoch": 41}
{"loss": 0.2805536985397339, "acc": 0.8742451667785645, "length": 3.7202796936035156, "mode": "test", "epoch": 41}
{"loss": 0.26503145694732666, "acc": 0.8909053206443787, "length": 3.7427868843078613, "mode": "train", "epoch": 42}
{"loss": 0.28180521726608276, "acc": 0.8748462200164795, "length": 3.730769157409668, "mode": "test", "epoch": 42}
{"loss": 0.26376157999038696, "acc": 0.8948694467544556, "length": 3.7619926929473877, "mode": "train", "epoch": 43}
{"loss": 0.2575943171977997, "acc": 0.8919490575790405, "length": 3.678321599960327, "mode": "test", "epoch": 43}
{"loss": 0.2548389434814453, "acc": 0.8976732492446899, "length": 3.7364230155944824, "mode": "train", "epoch": 44}
{"loss": 0.25511449575424194, "acc": 0.8922868967056274, "length": 3.667832136154175, "mode": "test", "epoch": 44}
{"loss": 0.2566002607345581, "acc": 0.8982659578323364, "length": 3.7323577404022217, "mode": "train", "epoch": 45}
{"loss": 0.2531524896621704, "acc": 0.8929527401924133, "length": 3.699300765991211, "mode": "test", "epoch": 45}
{"loss": 0.2507368326187134, "acc": 0.9007155299186707, "length": 3.767076015472412, "mode": "train", "epoch": 46}
{"loss": 0.2531963586807251, "acc": 0.893611490726471, "length": 3.6958041191101074, "mode": "test", "epoch": 46}
{"loss": 0.24110347032546997, "acc": 0.9043712615966797, "length": 3.735553503036499, "mode": "train", "epoch": 47}
{"loss": 0.24868324398994446, "acc": 0.8973844051361084, "length": 3.692307710647583, "mode": "test", "epoch": 47}
{"loss": 0.24075324833393097, "acc": 0.9042409658432007, "length": 3.7537214756011963, "mode": "train", "epoch": 48}
{"loss": 0.24864426255226135, "acc": 0.902565598487854, "length": 3.7272727489471436, "mode": "test", "epoch": 48}
{"loss": 0.2329137921333313, "acc": 0.9094157814979553, "length": 3.7502694129943848, "mode": "train", "epoch": 49}
{"loss": 0.23763495683670044, "acc": 0.8993589878082275, "length": 3.699300765991211, "mode": "test", "epoch": 49}
{"loss": 0.22915509343147278, "acc": 0.911701500415802, "length": 3.770322322845459, "mode": "train", "epoch": 50}
{"loss": 0.24027328193187714, "acc": 0.9057472944259644, "length": 3.723776340484619, "mode": "test", "epoch": 50}
{"loss": 0.22633366286754608, "acc": 0.9106726050376892, "length": 3.748459577560425, "mode": "train", "epoch": 51}
{"loss": 0.23952583968639374, "acc": 0.9097010493278503, "length": 3.6958041191101074, "mode": "test", "epoch": 51}
{"loss": 0.21625947952270508, "acc": 0.9187428951263428, "length": 3.730907917022705, "mode": "train", "epoch": 52}
{"loss": 0.24150680005550385, "acc": 0.9056814908981323, "length": 3.7272727489471436, "mode": "test", "epoch": 52}
{"loss": 0.2200053185224533, "acc": 0.916567325592041, "length": 3.7576637268066406, "mode": "train", "epoch": 53}
{"loss": 0.2200717329978943, "acc": 0.91258305311203, "length": 3.678321599960327, "mode": "test", "epoch": 53}
{"loss": 0.21164537966251373, "acc": 0.9208714962005615, "length": 3.7401535511016846, "mode": "train", "epoch": 54}
{"loss": 0.2309781014919281, "acc": 0.9121059775352478, "length": 3.7482516765594482, "mode": "test", "epoch": 54}
{"loss": 0.21088996529579163, "acc": 0.9185250997543335, "length": 3.7726097106933594, "mode": "train", "epoch": 55}
{"loss": 0.22550980746746063, "acc": 0.9117388129234314, "length": 3.716783285140991, "mode": "test", "epoch": 55}
{"loss": 0.20682941377162933, "acc": 0.9191275835037231, "length": 3.73679518699646, "mode": "train", "epoch": 56}
{"loss": 0.21139149367809296, "acc": 0.9154848456382751, "length": 3.723776340484619, "mode": "test", "epoch": 56}
{"loss": 0.20594434440135956, "acc": 0.9220056533813477, "length": 3.7298943996429443, "mode": "train", "epoch": 57}
{"loss": 0.21995675563812256, "acc": 0.9172665476799011, "length": 3.7202796936035156, "mode": "test", "epoch": 57}
{"loss": 0.1979110985994339, "acc": 0.9240466952323914, "length": 3.7553839683532715, "mode": "train", "epoch": 58}
{"loss": 0.21070989966392517, "acc": 0.9185168743133545, "length": 3.667832136154175, "mode": "test", "epoch": 58}
{"loss": 0.20068220794200897, "acc": 0.923204243183136, "length": 3.684645414352417, "mode": "train", "epoch": 59}
{"loss": 0.21171292662620544, "acc": 0.9192684292793274, "length": 3.6643357276916504, "mode": "test", "epoch": 59}
{"loss": 0.19778357446193695, "acc": 0.9256546497344971, "length": 3.754741907119751, "mode": "train", "epoch": 60}
{"loss": 0.2091781347990036, "acc": 0.9297782778739929, "length": 3.7097902297973633, "mode": "test", "epoch": 60}
test accuracy: 0.8335728049278259
