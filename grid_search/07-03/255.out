# ["--attributes=5", "--values=16", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=64", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.99", "--temperature=1"]
Creating train_ds and val_ds...

Creating test_ds...
{"loss": 0.6969894170761108, "acc": 0.5099412798881531, "length": 3.29524302482605, "mode": "train", "epoch": 1}
{"loss": 0.6925615668296814, "acc": 0.5309440493583679, "length": 1.0, "mode": "test", "epoch": 1}
{"loss": 0.6810397505760193, "acc": 0.5726735591888428, "length": 2.518040180206299, "mode": "train", "epoch": 2}
{"loss": 0.6490620374679565, "acc": 0.6917559504508972, "length": 2.2902097702026367, "mode": "test", "epoch": 2}
{"loss": 0.6170372366905212, "acc": 0.6915532350540161, "length": 3.0228919982910156, "mode": "train", "epoch": 3}
{"loss": 0.5664563179016113, "acc": 0.7132216691970825, "length": 3.6363637447357178, "mode": "test", "epoch": 3}
{"loss": 0.5369271039962769, "acc": 0.7373322248458862, "length": 3.287567377090454, "mode": "train", "epoch": 4}
{"loss": 0.5188911557197571, "acc": 0.7740388512611389, "length": 2.744755268096924, "mode": "test", "epoch": 4}
{"loss": 0.49054932594299316, "acc": 0.7792624235153198, "length": 2.993619680404663, "mode": "train", "epoch": 5}
{"loss": 0.47825631499290466, "acc": 0.7928616404533386, "length": 2.8811187744140625, "mode": "test", "epoch": 5}
{"loss": 0.4640949070453644, "acc": 0.7890914678573608, "length": 2.9317469596862793, "mode": "train", "epoch": 6}
{"loss": 0.4561554491519928, "acc": 0.7964128255844116, "length": 2.8741259574890137, "mode": "test", "epoch": 6}
{"loss": 0.43764960765838623, "acc": 0.8026605248451233, "length": 3.1403422355651855, "mode": "train", "epoch": 7}
{"loss": 0.43520647287368774, "acc": 0.8172540068626404, "length": 3.2482516765594482, "mode": "test", "epoch": 7}
{"loss": 0.4182811677455902, "acc": 0.8162667155265808, "length": 3.370983362197876, "mode": "train", "epoch": 8}
{"loss": 0.4177522361278534, "acc": 0.8167695999145508, "length": 3.3426573276519775, "mode": "test", "epoch": 8}
{"loss": 0.388835608959198, "acc": 0.8278594613075256, "length": 3.48246693611145, "mode": "train", "epoch": 9}
{"loss": 0.4008024334907532, "acc": 0.8297432065010071, "length": 3.4020979404449463, "mode": "test", "epoch": 9}
{"loss": 0.3721650242805481, "acc": 0.8409868478775024, "length": 3.4928982257843018, "mode": "train", "epoch": 10}
{"loss": 0.3724577724933624, "acc": 0.8378852009773254, "length": 3.4195804595947266, "mode": "test", "epoch": 10}
{"loss": 0.3557133376598358, "acc": 0.8475874066352844, "length": 3.6019816398620605, "mode": "train", "epoch": 11}
{"loss": 0.3457663357257843, "acc": 0.8529462814331055, "length": 3.6118881702423096, "mode": "test", "epoch": 11}
{"loss": 0.33654168248176575, "acc": 0.8591477870941162, "length": 3.6263694763183594, "mode": "train", "epoch": 12}
{"loss": 0.3371692895889282, "acc": 0.8559490442276001, "length": 3.6118881702423096, "mode": "test", "epoch": 12}
{"loss": 0.32980817556381226, "acc": 0.8592410683631897, "length": 3.652280569076538, "mode": "train", "epoch": 13}
{"loss": 0.3295937180519104, "acc": 0.8461709022521973, "length": 3.5594406127929688, "mode": "test", "epoch": 13}
{"loss": 0.3206569254398346, "acc": 0.8634207844734192, "length": 3.5618369579315186, "mode": "train", "epoch": 14}
{"loss": 0.32304853200912476, "acc": 0.8567714691162109, "length": 3.5979020595550537, "mode": "test", "epoch": 14}
{"loss": 0.31537097692489624, "acc": 0.8679161071777344, "length": 3.5152413845062256, "mode": "train", "epoch": 15}
{"loss": 0.3158138394355774, "acc": 0.8729377388954163, "length": 3.506993055343628, "mode": "test", "epoch": 15}
{"loss": 0.3037669062614441, "acc": 0.8671953082084656, "length": 3.547131061553955, "mode": "train", "epoch": 16}
{"loss": 0.31727638840675354, "acc": 0.8689916729927063, "length": 3.384615421295166, "mode": "test", "epoch": 16}
{"loss": 0.2992872893810272, "acc": 0.8742152452468872, "length": 3.5292820930480957, "mode": "train", "epoch": 17}
{"loss": 0.3002719581127167, "acc": 0.8721096515655518, "length": 3.5559439659118652, "mode": "test", "epoch": 17}
{"loss": 0.290274441242218, "acc": 0.8764473795890808, "length": 3.5603222846984863, "mode": "train", "epoch": 18}
{"loss": 0.2963242530822754, "acc": 0.8773801326751709, "length": 3.4650349617004395, "mode": "test", "epoch": 18}
{"loss": 0.2873811721801758, "acc": 0.8768598437309265, "length": 3.5338847637176514, "mode": "train", "epoch": 19}
{"loss": 0.30204445123672485, "acc": 0.8689120411872864, "length": 3.4580419063568115, "mode": "test", "epoch": 19}
{"loss": 0.2835732400417328, "acc": 0.8750733137130737, "length": 3.55718731880188, "mode": "train", "epoch": 20}
{"loss": 0.28808194398880005, "acc": 0.8795292377471924, "length": 3.5, "mode": "test", "epoch": 20}
{"loss": 0.28120675683021545, "acc": 0.8772557973861694, "length": 3.529029607772827, "mode": "train", "epoch": 21}
{"loss": 0.3010413348674774, "acc": 0.8717114329338074, "length": 3.4720280170440674, "mode": "test", "epoch": 21}
{"loss": 0.2886260449886322, "acc": 0.8780491948127747, "length": 3.531342029571533, "mode": "train", "epoch": 22}
{"loss": 0.29590556025505066, "acc": 0.8736782670021057, "length": 3.468531370162964, "mode": "test", "epoch": 22}
{"loss": 0.2846554219722748, "acc": 0.8777958154678345, "length": 3.5331978797912598, "mode": "train", "epoch": 23}
{"loss": 0.28868311643600464, "acc": 0.8705286383628845, "length": 3.493006944656372, "mode": "test", "epoch": 23}
{"loss": 0.2700367569923401, "acc": 0.876684308052063, "length": 3.5325069427490234, "mode": "train", "epoch": 24}
{"loss": 0.29204675555229187, "acc": 0.8726997375488281, "length": 3.4965035915374756, "mode": "test", "epoch": 24}
{"loss": 0.2742944359779358, "acc": 0.8783660531044006, "length": 3.545483350753784, "mode": "train", "epoch": 25}
{"loss": 0.28650155663490295, "acc": 0.8690083026885986, "length": 3.486013889312744, "mode": "test", "epoch": 25}
{"loss": 0.2746138870716095, "acc": 0.87774258852005, "length": 3.5354723930358887, "mode": "train", "epoch": 26}
{"loss": 0.28318774700164795, "acc": 0.8764484524726868, "length": 3.454545497894287, "mode": "test", "epoch": 26}
{"loss": 0.26791083812713623, "acc": 0.8780323266983032, "length": 3.5354084968566895, "mode": "train", "epoch": 27}
{"loss": 0.28356048464775085, "acc": 0.878017008304596, "length": 3.5, "mode": "test", "epoch": 27}
{"loss": 0.26843830943107605, "acc": 0.8801841139793396, "length": 3.5462114810943604, "mode": "train", "epoch": 28}
{"loss": 0.29499828815460205, "acc": 0.8690518736839294, "length": 3.493006944656372, "mode": "test", "epoch": 28}
{"loss": 0.2689321041107178, "acc": 0.8783450722694397, "length": 3.577376365661621, "mode": "train", "epoch": 29}
{"loss": 0.2828550636768341, "acc": 0.8722098469734192, "length": 3.4440560340881348, "mode": "test", "epoch": 29}
{"loss": 0.26375600695610046, "acc": 0.8790428042411804, "length": 3.5300512313842773, "mode": "train", "epoch": 30}
{"loss": 0.2892833352088928, "acc": 0.8729234337806702, "length": 3.506993055343628, "mode": "test", "epoch": 30}
{"loss": 0.2628805339336395, "acc": 0.8799057006835938, "length": 3.5406203269958496, "mode": "train", "epoch": 31}
{"loss": 0.28827446699142456, "acc": 0.8811749815940857, "length": 3.461538553237915, "mode": "test", "epoch": 31}
{"loss": 0.2639157176017761, "acc": 0.8800597786903381, "length": 3.533812999725342, "mode": "train", "epoch": 32}
{"loss": 0.2794419229030609, "acc": 0.8709405660629272, "length": 3.4510488510131836, "mode": "test", "epoch": 32}
{"loss": 0.25231635570526123, "acc": 0.8831401467323303, "length": 3.533834457397461, "mode": "train", "epoch": 33}
{"loss": 0.28853246569633484, "acc": 0.8780866265296936, "length": 3.513986110687256, "mode": "test", "epoch": 33}
{"loss": 0.25669944286346436, "acc": 0.879573404788971, "length": 3.566706418991089, "mode": "train", "epoch": 34}
{"loss": 0.28620463609695435, "acc": 0.874101996421814, "length": 3.5104894638061523, "mode": "test", "epoch": 34}
{"loss": 0.25433114171028137, "acc": 0.8835653066635132, "length": 3.582737922668457, "mode": "train", "epoch": 35}
{"loss": 0.2728096842765808, "acc": 0.8741305470466614, "length": 3.552447557449341, "mode": "test", "epoch": 35}
{"loss": 0.2578524351119995, "acc": 0.8857455253601074, "length": 3.5743539333343506, "mode": "train", "epoch": 36}
{"loss": 0.26756811141967773, "acc": 0.8759405016899109, "length": 3.4790210723876953, "mode": "test", "epoch": 36}
{"loss": 0.24673253297805786, "acc": 0.8903743028640747, "length": 3.5400233268737793, "mode": "train", "epoch": 37}
{"loss": 0.2733020782470703, "acc": 0.8844512104988098, "length": 3.576923131942749, "mode": "test", "epoch": 37}
{"loss": 0.2475055605173111, "acc": 0.8888565301895142, "length": 3.6205050945281982, "mode": "train", "epoch": 38}
{"loss": 0.27705827355384827, "acc": 0.874987781047821, "length": 3.590909004211426, "mode": "test", "epoch": 38}
{"loss": 0.2502913475036621, "acc": 0.8843988180160522, "length": 3.6266069412231445, "mode": "train", "epoch": 39}
{"loss": 0.288400262594223, "acc": 0.8837447166442871, "length": 3.5979020595550537, "mode": "test", "epoch": 39}
{"loss": 0.24575701355934143, "acc": 0.8937988877296448, "length": 3.6130998134613037, "mode": "train", "epoch": 40}
{"loss": 0.2870115339756012, "acc": 0.8784918189048767, "length": 3.4790210723876953, "mode": "test", "epoch": 40}
{"loss": 0.2462344765663147, "acc": 0.8894857168197632, "length": 3.5867514610290527, "mode": "train", "epoch": 41}
{"loss": 0.283873975276947, "acc": 0.8759065866470337, "length": 3.5279719829559326, "mode": "test", "epoch": 41}
{"loss": 0.2525408864021301, "acc": 0.8859230875968933, "length": 3.6538257598876953, "mode": "train", "epoch": 42}
{"loss": 0.2798535227775574, "acc": 0.8801546096801758, "length": 3.615384578704834, "mode": "test", "epoch": 42}
{"loss": 0.24386240541934967, "acc": 0.8928050994873047, "length": 3.6622438430786133, "mode": "train", "epoch": 43}
{"loss": 0.26962921023368835, "acc": 0.8850173354148865, "length": 3.5979020595550537, "mode": "test", "epoch": 43}
{"loss": 0.25714021921157837, "acc": 0.8865565061569214, "length": 3.7463791370391846, "mode": "train", "epoch": 44}
{"loss": 0.2790282368659973, "acc": 0.8842839002609253, "length": 3.7342658042907715, "mode": "test", "epoch": 44}
{"loss": 0.2471485137939453, "acc": 0.8894653916358948, "length": 3.6602182388305664, "mode": "train", "epoch": 45}
{"loss": 0.2790851891040802, "acc": 0.8853052258491516, "length": 3.562937021255493, "mode": "test", "epoch": 45}
{"loss": 0.2410600334405899, "acc": 0.8974258899688721, "length": 3.6771695613861084, "mode": "train", "epoch": 46}
{"loss": 0.260966032743454, "acc": 0.8860980272293091, "length": 3.6048951148986816, "mode": "test", "epoch": 46}
{"loss": 0.22747597098350525, "acc": 0.8986221551895142, "length": 3.710911273956299, "mode": "train", "epoch": 47}
{"loss": 0.2550975978374481, "acc": 0.900192379951477, "length": 3.692307710647583, "mode": "test", "epoch": 47}
{"loss": 0.231245219707489, "acc": 0.8958088159561157, "length": 3.7810261249542236, "mode": "train", "epoch": 48}
{"loss": 0.2638532817363739, "acc": 0.880066454410553, "length": 3.8181817531585693, "mode": "test", "epoch": 48}
{"loss": 0.22658300399780273, "acc": 0.896375298500061, "length": 3.7680044174194336, "mode": "train", "epoch": 49}
{"loss": 0.24873042106628418, "acc": 0.8930036425590515, "length": 3.7342658042907715, "mode": "test", "epoch": 49}
{"loss": 0.22690491378307343, "acc": 0.9038623571395874, "length": 3.7696709632873535, "mode": "train", "epoch": 50}
{"loss": 0.2545989155769348, "acc": 0.8948032259941101, "length": 3.730769157409668, "mode": "test", "epoch": 50}
{"loss": 0.2212047278881073, "acc": 0.9033023118972778, "length": 3.769911527633667, "mode": "train", "epoch": 51}
{"loss": 0.26711857318878174, "acc": 0.8930747509002686, "length": 3.7867133617401123, "mode": "test", "epoch": 51}
{"loss": 0.22491055727005005, "acc": 0.9028428792953491, "length": 3.7591392993927, "mode": "train", "epoch": 52}
{"loss": 0.2586786150932312, "acc": 0.8973376154899597, "length": 3.653846263885498, "mode": "test", "epoch": 52}
{"loss": 0.2243395298719406, "acc": 0.9015153646469116, "length": 3.710881471633911, "mode": "train", "epoch": 53}
{"loss": 0.25145676732063293, "acc": 0.9001526832580566, "length": 3.716783285140991, "mode": "test", "epoch": 53}
{"loss": 0.21762804687023163, "acc": 0.905531644821167, "length": 3.7658286094665527, "mode": "train", "epoch": 54}
{"loss": 0.2661740481853485, "acc": 0.8966624736785889, "length": 3.699300765991211, "mode": "test", "epoch": 54}
{"loss": 0.21953925490379333, "acc": 0.9069620966911316, "length": 3.7581095695495605, "mode": "train", "epoch": 55}
{"loss": 0.25226420164108276, "acc": 0.9031573534011841, "length": 3.7342658042907715, "mode": "test", "epoch": 55}
{"loss": 0.21523518860340118, "acc": 0.9057201147079468, "length": 3.761381149291992, "mode": "train", "epoch": 56}
{"loss": 0.25134986639022827, "acc": 0.8975363969802856, "length": 3.6748251914978027, "mode": "test", "epoch": 56}
{"loss": 0.2067786157131195, "acc": 0.908882737159729, "length": 3.7343695163726807, "mode": "train", "epoch": 57}
{"loss": 0.26341184973716736, "acc": 0.9019360542297363, "length": 3.7097902297973633, "mode": "test", "epoch": 57}
{"loss": 0.21640701591968536, "acc": 0.9061642289161682, "length": 3.742264986038208, "mode": "train", "epoch": 58}
{"loss": 0.24752824008464813, "acc": 0.8995095491409302, "length": 3.762237787246704, "mode": "test", "epoch": 58}
{"loss": 0.21371573209762573, "acc": 0.9129427671432495, "length": 3.8152928352355957, "mode": "train", "epoch": 59}
{"loss": 0.23031626641750336, "acc": 0.9083254337310791, "length": 3.7517483234405518, "mode": "test", "epoch": 59}
{"loss": 0.20401467382907867, "acc": 0.9150895476341248, "length": 3.727752923965454, "mode": "train", "epoch": 60}
{"loss": 0.23015515506267548, "acc": 0.9161555171012878, "length": 3.692307710647583, "mode": "test", "epoch": 60}
test accuracy: 0.8182554841041565
