# ["--attributes=5", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--hidden_size=256", "--temp_update=0.99", "--temperature=2"]
Creating train_ds and val_ds...

Creating test_ds...
{"loss": 0.7020844221115112, "acc": 0.521626889705658, "length": 1.9385985136032104, "mode": "train", "epoch": 1}
{"loss": 0.6985405087471008, "acc": 0.5235395431518555, "length": 1.0, "mode": "test", "epoch": 1}
{"loss": 0.6559790372848511, "acc": 0.5972684621810913, "length": 1.548000693321228, "mode": "train", "epoch": 2}
{"loss": 0.5962069630622864, "acc": 0.6658074855804443, "length": 1.824742317199707, "mode": "test", "epoch": 2}
{"loss": 0.5743932723999023, "acc": 0.6838572025299072, "length": 1.8507797718048096, "mode": "train", "epoch": 3}
{"loss": 0.5766465067863464, "acc": 0.672514021396637, "length": 1.7800687551498413, "mode": "test", "epoch": 3}
{"loss": 0.5301523208618164, "acc": 0.7250624895095825, "length": 2.274867057800293, "mode": "train", "epoch": 4}
{"loss": 0.5281175374984741, "acc": 0.7315936088562012, "length": 2.7938144207000732, "mode": "test", "epoch": 4}
{"loss": 0.4537678062915802, "acc": 0.7947254776954651, "length": 2.905996799468994, "mode": "train", "epoch": 5}
{"loss": 0.40808650851249695, "acc": 0.8230132460594177, "length": 3.5154638290405273, "mode": "test", "epoch": 5}
{"loss": 0.37007537484169006, "acc": 0.8478538393974304, "length": 3.2618091106414795, "mode": "train", "epoch": 6}
{"loss": 0.41054925322532654, "acc": 0.8211984634399414, "length": 3.4432990550994873, "mode": "test", "epoch": 6}
{"loss": 0.34264856576919556, "acc": 0.8630042672157288, "length": 3.1651551723480225, "mode": "train", "epoch": 7}
{"loss": 0.36215487122535706, "acc": 0.8495060801506042, "length": 3.477663278579712, "mode": "test", "epoch": 7}
{"loss": 0.30564939975738525, "acc": 0.8751901984214783, "length": 3.151395320892334, "mode": "train", "epoch": 8}
{"loss": 0.3658962547779083, "acc": 0.851927638053894, "length": 3.302405595779419, "mode": "test", "epoch": 8}
{"loss": 0.28508955240249634, "acc": 0.8832283020019531, "length": 3.0977907180786133, "mode": "train", "epoch": 9}
{"loss": 0.3250754773616791, "acc": 0.8633161187171936, "length": 3.3917524814605713, "mode": "test", "epoch": 9}
{"loss": 0.2631796598434448, "acc": 0.8899347186088562, "length": 3.30385422706604, "mode": "train", "epoch": 10}
{"loss": 0.34680259227752686, "acc": 0.8613671660423279, "length": 3.4879724979400635, "mode": "test", "epoch": 10}
{"loss": 0.23851612210273743, "acc": 0.9011608958244324, "length": 3.377441883087158, "mode": "train", "epoch": 11}
{"loss": 0.3437178134918213, "acc": 0.8769813179969788, "length": 3.6151201725006104, "mode": "test", "epoch": 11}
{"loss": 0.20337797701358795, "acc": 0.922950029373169, "length": 3.533601999282837, "mode": "train", "epoch": 12}
{"loss": 0.30499398708343506, "acc": 0.8925955295562744, "length": 3.8316152095794678, "mode": "test", "epoch": 12}
{"loss": 0.17634348571300507, "acc": 0.9302657246589661, "length": 3.597043752670288, "mode": "train", "epoch": 13}
{"loss": 0.2981323003768921, "acc": 0.9060406684875488, "length": 3.8831615447998047, "mode": "test", "epoch": 13}
{"loss": 0.15303532779216766, "acc": 0.9445769786834717, "length": 3.7262799739837646, "mode": "train", "epoch": 14}
{"loss": 0.23926737904548645, "acc": 0.9075869917869568, "length": 3.8591065406799316, "mode": "test", "epoch": 14}
{"loss": 0.13401082158088684, "acc": 0.9515718817710876, "length": 3.7367382049560547, "mode": "train", "epoch": 15}
{"loss": 0.21689581871032715, "acc": 0.9195070862770081, "length": 3.84879732131958, "mode": "test", "epoch": 15}
{"loss": 0.12936270236968994, "acc": 0.9520459175109863, "length": 3.7919414043426514, "mode": "train", "epoch": 16}
{"loss": 0.24676363170146942, "acc": 0.9140731692314148, "length": 3.92439866065979, "mode": "test", "epoch": 16}
{"loss": 0.12346893548965454, "acc": 0.9554517269134521, "length": 3.8274669647216797, "mode": "train", "epoch": 17}
{"loss": 0.1745752990245819, "acc": 0.9320446848869324, "length": 3.931271553039551, "mode": "test", "epoch": 17}
{"loss": 0.10236706584692001, "acc": 0.9671016931533813, "length": 3.823535203933716, "mode": "train", "epoch": 18}
{"loss": 0.1675885170698166, "acc": 0.9478791356086731, "length": 3.9621992111206055, "mode": "test", "epoch": 18}
{"loss": 0.08165854215621948, "acc": 0.9724310636520386, "length": 3.9000942707061768, "mode": "train", "epoch": 19}
{"loss": 0.12498895078897476, "acc": 0.9592138528823853, "length": 3.972508668899536, "mode": "test", "epoch": 19}
{"loss": 0.06683213263750076, "acc": 0.9765776991844177, "length": 3.9068236351013184, "mode": "train", "epoch": 20}
{"loss": 0.13072745501995087, "acc": 0.9635738730430603, "length": 3.9931271076202393, "mode": "test", "epoch": 20}
{"loss": 0.05589815229177475, "acc": 0.9821659922599792, "length": 3.930717945098877, "mode": "train", "epoch": 21}
{"loss": 0.0919935330748558, "acc": 0.9671820402145386, "length": 4.0, "mode": "test", "epoch": 21}
{"loss": 0.05792433023452759, "acc": 0.9791471362113953, "length": 3.9628727436065674, "mode": "train", "epoch": 22}
{"loss": 0.10048495978116989, "acc": 0.9659793972969055, "length": 4.0, "mode": "test", "epoch": 22}
{"loss": 0.05050588399171829, "acc": 0.9832341074943542, "length": 3.939030647277832, "mode": "train", "epoch": 23}
{"loss": 0.07458653301000595, "acc": 0.9673540592193604, "length": 4.0, "mode": "test", "epoch": 23}
{"loss": 0.04229738563299179, "acc": 0.9866095185279846, "length": 3.951612949371338, "mode": "train", "epoch": 24}
{"loss": 0.05735160782933235, "acc": 0.9807559847831726, "length": 4.0, "mode": "test", "epoch": 24}
{"loss": 0.03463788330554962, "acc": 0.9890015721321106, "length": 3.9502806663513184, "mode": "train", "epoch": 25}
{"loss": 0.09181878715753555, "acc": 0.9711339473724365, "length": 4.0, "mode": "test", "epoch": 25}
{"loss": 0.04272947460412979, "acc": 0.9853829145431519, "length": 3.95750093460083, "mode": "train", "epoch": 26}
{"loss": 0.08802371472120285, "acc": 0.9719930291175842, "length": 4.0, "mode": "test", "epoch": 26}
{"loss": 0.03296858072280884, "acc": 0.9895790815353394, "length": 3.9428653717041016, "mode": "train", "epoch": 27}
{"loss": 0.07021939009428024, "acc": 0.9802243709564209, "length": 3.9931271076202393, "mode": "test", "epoch": 27}
{"loss": 0.027409709990024567, "acc": 0.9905561804771423, "length": 3.950334310531616, "mode": "train", "epoch": 28}
{"loss": 0.02941444329917431, "acc": 0.9879832863807678, "length": 3.9896907806396484, "mode": "test", "epoch": 28}
{"loss": 0.020337512716650963, "acc": 0.9947482943534851, "length": 3.9472482204437256, "mode": "train", "epoch": 29}
{"loss": 0.04746086522936821, "acc": 0.9883160591125488, "length": 4.0, "mode": "test", "epoch": 29}
{"loss": 0.01761249080300331, "acc": 0.9951713681221008, "length": 3.964200496673584, "mode": "train", "epoch": 30}
{"loss": 0.051851537078619, "acc": 0.9798110127449036, "length": 3.9896907806396484, "mode": "test", "epoch": 30}
{"loss": 0.015096944756805897, "acc": 0.9969663619995117, "length": 3.9536941051483154, "mode": "train", "epoch": 31}
{"loss": 0.059271227568387985, "acc": 0.9823024272918701, "length": 4.0, "mode": "test", "epoch": 31}
{"loss": 0.014959124848246574, "acc": 0.9955931305885315, "length": 3.961977005004883, "mode": "train", "epoch": 32}
{"loss": 0.030046170577406883, "acc": 0.9878005981445312, "length": 4.0, "mode": "test", "epoch": 32}
{"loss": 0.013370401225984097, "acc": 0.9968023896217346, "length": 3.9725563526153564, "mode": "train", "epoch": 33}
{"loss": 0.042205940932035446, "acc": 0.9889069199562073, "length": 3.996563673019409, "mode": "test", "epoch": 33}
{"loss": 0.008705221116542816, "acc": 0.9982882738113403, "length": 3.9718565940856934, "mode": "train", "epoch": 34}
{"loss": 0.019834885373711586, "acc": 0.9929015636444092, "length": 3.996563673019409, "mode": "test", "epoch": 34}
{"loss": 0.00794238317757845, "acc": 0.9985938668251038, "length": 3.972015619277954, "mode": "train", "epoch": 35}
{"loss": 0.019184177741408348, "acc": 0.9936425685882568, "length": 4.0, "mode": "test", "epoch": 35}
{"loss": 0.010475059039890766, "acc": 0.9973195791244507, "length": 3.9760990142822266, "mode": "train", "epoch": 36}
{"loss": 0.0667828619480133, "acc": 0.9843642115592957, "length": 4.0, "mode": "test", "epoch": 36}
{"loss": 0.015378768555819988, "acc": 0.9962890148162842, "length": 3.9760582447052, "mode": "train", "epoch": 37}
{"loss": 0.053597163408994675, "acc": 0.986603319644928, "length": 3.9931271076202393, "mode": "test", "epoch": 37}
{"loss": 0.02067996934056282, "acc": 0.993710458278656, "length": 3.971173048019409, "mode": "train", "epoch": 38}
{"loss": 0.04476786404848099, "acc": 0.9919244647026062, "length": 4.0, "mode": "test", "epoch": 38}
{"loss": 0.016280196607112885, "acc": 0.9956372380256653, "length": 3.9753479957580566, "mode": "train", "epoch": 39}
{"loss": 0.05377010628581047, "acc": 0.9893308877944946, "length": 3.9931271076202393, "mode": "test", "epoch": 39}
{"loss": 0.03265182301402092, "acc": 0.9895867109298706, "length": 3.9743869304656982, "mode": "train", "epoch": 40}
{"loss": 0.11017671972513199, "acc": 0.9756013751029968, "length": 4.0, "mode": "test", "epoch": 40}
{"loss": 0.035210512578487396, "acc": 0.9890187978744507, "length": 3.9769794940948486, "mode": "train", "epoch": 41}
{"loss": 0.05073288083076477, "acc": 0.9898626208305359, "length": 4.0, "mode": "test", "epoch": 41}
{"loss": 0.02207157388329506, "acc": 0.9932093620300293, "length": 3.9731550216674805, "mode": "train", "epoch": 42}
{"loss": 0.10722871124744415, "acc": 0.9804124236106873, "length": 4.0, "mode": "test", "epoch": 42}
{"loss": 0.021930132061243057, "acc": 0.9939298033714294, "length": 3.967987537384033, "mode": "train", "epoch": 43}
{"loss": 0.05693282559514046, "acc": 0.9860395193099976, "length": 3.996563673019409, "mode": "test", "epoch": 43}
{"loss": 0.01770058646798134, "acc": 0.9941896200180054, "length": 3.969757556915283, "mode": "train", "epoch": 44}
{"loss": 0.026383643969893456, "acc": 0.9937821626663208, "length": 3.9896907806396484, "mode": "test", "epoch": 44}
{"loss": 0.00776940630748868, "acc": 0.9983282685279846, "length": 3.962993621826172, "mode": "train", "epoch": 45}
{"loss": 0.02675914205610752, "acc": 0.995360791683197, "length": 3.9896907806396484, "mode": "test", "epoch": 45}
{"loss": 0.0061622862704098225, "acc": 0.9989207983016968, "length": 3.973557233810425, "mode": "train", "epoch": 46}
{"loss": 0.02949463203549385, "acc": 0.9898301959037781, "length": 3.9931271076202393, "mode": "test", "epoch": 46}
{"loss": 0.006758927367627621, "acc": 0.9976763725280762, "length": 3.9786155223846436, "mode": "train", "epoch": 47}
{"loss": 0.04114145040512085, "acc": 0.9924399256706238, "length": 4.0, "mode": "test", "epoch": 47}
{"loss": 0.007353220134973526, "acc": 0.9983448386192322, "length": 3.974691867828369, "mode": "train", "epoch": 48}
{"loss": 0.03858082368969917, "acc": 0.9926115870475769, "length": 4.0, "mode": "test", "epoch": 48}
{"loss": 0.012193175964057446, "acc": 0.9984102845191956, "length": 3.9785194396972656, "mode": "train", "epoch": 49}
{"loss": 0.0447295717895031, "acc": 0.991065263748169, "length": 4.0, "mode": "test", "epoch": 49}
{"loss": 0.021054688841104507, "acc": 0.9942387342453003, "length": 3.977609634399414, "mode": "train", "epoch": 50}
{"loss": 0.08294445276260376, "acc": 0.9829897284507751, "length": 4.0, "mode": "test", "epoch": 50}
{"loss": 0.0560159906744957, "acc": 0.9850441813468933, "length": 3.970355987548828, "mode": "train", "epoch": 51}
{"loss": 0.09108870476484299, "acc": 0.9817386269569397, "length": 3.9862542152404785, "mode": "test", "epoch": 51}
{"loss": 0.024773461744189262, "acc": 0.9917556047439575, "length": 3.975484848022461, "mode": "train", "epoch": 52}
{"loss": 0.05740403011441231, "acc": 0.9857388734817505, "length": 4.0, "mode": "test", "epoch": 52}
{"loss": 0.022528821602463722, "acc": 0.9930040240287781, "length": 3.9816150665283203, "mode": "train", "epoch": 53}
{"loss": 0.040524303913116455, "acc": 0.9943299293518066, "length": 4.0, "mode": "test", "epoch": 53}
{"loss": 0.012465347535908222, "acc": 0.9975282549858093, "length": 3.9786832332611084, "mode": "train", "epoch": 54}
{"loss": 0.03249368071556091, "acc": 0.9943621158599854, "length": 3.9931271076202393, "mode": "test", "epoch": 54}
{"loss": 0.01215344574302435, "acc": 0.9956840872764587, "length": 3.9732236862182617, "mode": "train", "epoch": 55}
{"loss": 0.01753445528447628, "acc": 0.99574214220047, "length": 3.9896907806396484, "mode": "test", "epoch": 55}
{"loss": 0.02452145330607891, "acc": 0.9933889508247375, "length": 3.9569332599639893, "mode": "train", "epoch": 56}
{"loss": 0.16499662399291992, "acc": 0.9765087962150574, "length": 3.9587628841400146, "mode": "test", "epoch": 56}
{"loss": 0.019617835059762, "acc": 0.996694803237915, "length": 3.9682276248931885, "mode": "train", "epoch": 57}
{"loss": 0.030720073729753494, "acc": 0.9917848706245422, "length": 3.9896907806396484, "mode": "test", "epoch": 57}
{"loss": 0.012574211694300175, "acc": 0.9971428513526917, "length": 3.9694480895996094, "mode": "train", "epoch": 58}
{"loss": 0.06410498917102814, "acc": 0.9891752600669861, "length": 3.996563673019409, "mode": "test", "epoch": 58}
{"loss": 0.015439544804394245, "acc": 0.9958531260490417, "length": 3.9720311164855957, "mode": "train", "epoch": 59}
{"loss": 0.03961067646741867, "acc": 0.9914842247962952, "length": 3.9931271076202393, "mode": "test", "epoch": 59}
{"loss": 0.006778350565582514, "acc": 0.9977657794952393, "length": 3.9777958393096924, "mode": "train", "epoch": 60}
{"loss": 0.04249707981944084, "acc": 0.9908933639526367, "length": 3.996563673019409, "mode": "test", "epoch": 60}
test accuracy: 0.9001786112785339
