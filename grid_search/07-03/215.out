# ["--attributes=5", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=128", "--learning_rate=0.001", "--hidden_size=256", "--temp_update=0.99", "--temperature=2"]
Creating train_ds and val_ds...

Creating test_ds...
{"loss": 0.7160914540290833, "acc": 0.5277354121208191, "length": 3.3748998641967773, "mode": "train", "epoch": 1}
{"loss": 0.6995849609375, "acc": 0.5211538672447205, "length": 1.0, "mode": "test", "epoch": 1}
{"loss": 0.6954567432403564, "acc": 0.5305252075195312, "length": 1.858903169631958, "mode": "train", "epoch": 2}
{"loss": 0.6897666454315186, "acc": 0.567132830619812, "length": 1.0, "mode": "test", "epoch": 2}
{"loss": 0.690477192401886, "acc": 0.5322229862213135, "length": 1.117945909500122, "mode": "train", "epoch": 3}
{"loss": 0.6906415820121765, "acc": 0.5234265923500061, "length": 1.0, "mode": "test", "epoch": 3}
{"loss": 0.6874303221702576, "acc": 0.5275456309318542, "length": 1.097955346107483, "mode": "train", "epoch": 4}
{"loss": 0.6873903274536133, "acc": 0.5576923489570618, "length": 1.0, "mode": "test", "epoch": 4}
{"loss": 0.678671658039093, "acc": 0.5737057328224182, "length": 1.398122787475586, "mode": "train", "epoch": 5}
{"loss": 0.6508540511131287, "acc": 0.6062639355659485, "length": 1.923076868057251, "mode": "test", "epoch": 5}
{"loss": 0.63261878490448, "acc": 0.675432562828064, "length": 2.334157705307007, "mode": "train", "epoch": 6}
{"loss": 0.570406436920166, "acc": 0.7625574469566345, "length": 2.7202796936035156, "mode": "test", "epoch": 6}
{"loss": 0.5496849417686462, "acc": 0.7558908462524414, "length": 2.709141492843628, "mode": "train", "epoch": 7}
{"loss": 0.5061134099960327, "acc": 0.7708183526992798, "length": 3.0664336681365967, "mode": "test", "epoch": 7}
{"loss": 0.48080161213874817, "acc": 0.7830682396888733, "length": 2.874244213104248, "mode": "train", "epoch": 8}
{"loss": 0.4721006751060486, "acc": 0.8141904473304749, "length": 3.1818182468414307, "mode": "test", "epoch": 8}
{"loss": 0.4507185220718384, "acc": 0.808866024017334, "length": 3.0098071098327637, "mode": "train", "epoch": 9}
{"loss": 0.4546351432800293, "acc": 0.825075089931488, "length": 3.2132866382598877, "mode": "test", "epoch": 9}
{"loss": 0.42105695605278015, "acc": 0.8162732720375061, "length": 3.1726648807525635, "mode": "train", "epoch": 10}
{"loss": 0.43731689453125, "acc": 0.8303108215332031, "length": 3.307692289352417, "mode": "test", "epoch": 10}
{"loss": 0.39956748485565186, "acc": 0.8312765955924988, "length": 3.128448724746704, "mode": "train", "epoch": 11}
{"loss": 0.4391835927963257, "acc": 0.8212876915931702, "length": 3.2972028255462646, "mode": "test", "epoch": 11}
{"loss": 0.38050371408462524, "acc": 0.8360487222671509, "length": 3.1646780967712402, "mode": "train", "epoch": 12}
{"loss": 0.4333874583244324, "acc": 0.8350732922554016, "length": 3.2657341957092285, "mode": "test", "epoch": 12}
{"loss": 0.37219294905662537, "acc": 0.8445010185241699, "length": 3.129032850265503, "mode": "train", "epoch": 13}
{"loss": 0.4219830632209778, "acc": 0.8307282328605652, "length": 3.276223659515381, "mode": "test", "epoch": 13}
{"loss": 0.358719140291214, "acc": 0.848617672920227, "length": 3.1305737495422363, "mode": "train", "epoch": 14}
{"loss": 0.41403186321258545, "acc": 0.8349040746688843, "length": 3.3286712169647217, "mode": "test", "epoch": 14}
{"loss": 0.3455828130245209, "acc": 0.8597244620323181, "length": 3.2543270587921143, "mode": "train", "epoch": 15}
{"loss": 0.3798617720603943, "acc": 0.8510110378265381, "length": 3.4265735149383545, "mode": "test", "epoch": 15}
{"loss": 0.33147892355918884, "acc": 0.8634930849075317, "length": 3.411991596221924, "mode": "train", "epoch": 16}
{"loss": 0.3899514079093933, "acc": 0.8390653729438782, "length": 3.5279719829559326, "mode": "test", "epoch": 16}
{"loss": 0.31840217113494873, "acc": 0.8701513409614563, "length": 3.4839298725128174, "mode": "train", "epoch": 17}
{"loss": 0.3654361367225647, "acc": 0.8571563959121704, "length": 3.7482516765594482, "mode": "test", "epoch": 17}
{"loss": 0.30663010478019714, "acc": 0.8769124746322632, "length": 3.5790538787841797, "mode": "train", "epoch": 18}
{"loss": 0.3576074540615082, "acc": 0.8734656572341919, "length": 3.769230842590332, "mode": "test", "epoch": 18}
{"loss": 0.29071417450904846, "acc": 0.8801760673522949, "length": 3.609797716140747, "mode": "train", "epoch": 19}
{"loss": 0.3677499294281006, "acc": 0.8586670160293579, "length": 3.7482516765594482, "mode": "test", "epoch": 19}
{"loss": 0.2735813558101654, "acc": 0.8911986947059631, "length": 3.699061155319214, "mode": "train", "epoch": 20}
{"loss": 0.37095993757247925, "acc": 0.8744418025016785, "length": 3.8951048851013184, "mode": "test", "epoch": 20}
{"loss": 0.260025292634964, "acc": 0.8986392021179199, "length": 3.722926378250122, "mode": "train", "epoch": 21}
{"loss": 0.3464429974555969, "acc": 0.8724197149276733, "length": 3.8951048851013184, "mode": "test", "epoch": 21}
{"loss": 0.24141283333301544, "acc": 0.9058411717414856, "length": 3.7871716022491455, "mode": "train", "epoch": 22}
{"loss": 0.31805968284606934, "acc": 0.8826121687889099, "length": 3.9265735149383545, "mode": "test", "epoch": 22}
{"loss": 0.22427470982074738, "acc": 0.9179967641830444, "length": 3.7660417556762695, "mode": "train", "epoch": 23}
{"loss": 0.2925989627838135, "acc": 0.8915440440177917, "length": 3.916083812713623, "mode": "test", "epoch": 23}
{"loss": 0.20963814854621887, "acc": 0.921197772026062, "length": 3.7811195850372314, "mode": "train", "epoch": 24}
{"loss": 0.27205342054367065, "acc": 0.8964741230010986, "length": 3.9790210723876953, "mode": "test", "epoch": 24}
{"loss": 0.19470351934432983, "acc": 0.9275602102279663, "length": 3.846325159072876, "mode": "train", "epoch": 25}
{"loss": 0.2699909210205078, "acc": 0.9076308608055115, "length": 3.9895105361938477, "mode": "test", "epoch": 25}
{"loss": 0.18926748633384705, "acc": 0.9298394322395325, "length": 3.8868556022644043, "mode": "train", "epoch": 26}
{"loss": 0.2577698230743408, "acc": 0.9098858833312988, "length": 3.9790210723876953, "mode": "test", "epoch": 26}
{"loss": 0.181923046708107, "acc": 0.931918203830719, "length": 3.9177544116973877, "mode": "train", "epoch": 27}
{"loss": 0.24795755743980408, "acc": 0.919843852519989, "length": 3.9895105361938477, "mode": "test", "epoch": 27}
{"loss": 0.18511977791786194, "acc": 0.9300519824028015, "length": 3.938175916671753, "mode": "train", "epoch": 28}
{"loss": 0.2150716781616211, "acc": 0.922028124332428, "length": 4.0, "mode": "test", "epoch": 28}
{"loss": 0.16268175840377808, "acc": 0.9406240582466125, "length": 3.937558889389038, "mode": "train", "epoch": 29}
{"loss": 0.1950996220111847, "acc": 0.9351398944854736, "length": 4.0, "mode": "test", "epoch": 29}
{"loss": 0.15708224475383759, "acc": 0.9413405656814575, "length": 3.950484275817871, "mode": "train", "epoch": 30}
{"loss": 0.22376887500286102, "acc": 0.9241258502006531, "length": 4.0, "mode": "test", "epoch": 30}
{"loss": 0.15067286789417267, "acc": 0.943393349647522, "length": 3.970618963241577, "mode": "train", "epoch": 31}
{"loss": 0.18422746658325195, "acc": 0.9360140562057495, "length": 4.0, "mode": "test", "epoch": 31}
{"loss": 0.145609050989151, "acc": 0.9461379051208496, "length": 3.980164051055908, "mode": "train", "epoch": 32}
{"loss": 0.18339574337005615, "acc": 0.9419581294059753, "length": 4.0, "mode": "test", "epoch": 32}
{"loss": 0.13625824451446533, "acc": 0.9518916010856628, "length": 3.982135534286499, "mode": "train", "epoch": 33}
{"loss": 0.15947158634662628, "acc": 0.9438812732696533, "length": 4.0, "mode": "test", "epoch": 33}
{"loss": 0.1298641413450241, "acc": 0.9535275101661682, "length": 3.9851677417755127, "mode": "train", "epoch": 34}
{"loss": 0.19551455974578857, "acc": 0.9360140562057495, "length": 4.0, "mode": "test", "epoch": 34}
{"loss": 0.12761592864990234, "acc": 0.9544061422348022, "length": 3.9901013374328613, "mode": "train", "epoch": 35}
{"loss": 0.1703512966632843, "acc": 0.9347901344299316, "length": 4.0, "mode": "test", "epoch": 35}
{"loss": 0.12153153121471405, "acc": 0.9586551189422607, "length": 3.989332914352417, "mode": "train", "epoch": 36}
{"loss": 0.16602733731269836, "acc": 0.9499999284744263, "length": 4.0, "mode": "test", "epoch": 36}
{"loss": 0.12012859433889389, "acc": 0.9579504728317261, "length": 3.9909582138061523, "mode": "train", "epoch": 37}
{"loss": 0.18492452800273895, "acc": 0.9405595660209656, "length": 4.0, "mode": "test", "epoch": 37}
{"loss": 0.11959370225667953, "acc": 0.9584587812423706, "length": 3.9933674335479736, "mode": "train", "epoch": 38}
{"loss": 0.15722951292991638, "acc": 0.951398491859436, "length": 4.0, "mode": "test", "epoch": 38}
{"loss": 0.11324195563793182, "acc": 0.958138644695282, "length": 3.994262218475342, "mode": "train", "epoch": 39}
{"loss": 0.1672368049621582, "acc": 0.9517483115196228, "length": 4.0, "mode": "test", "epoch": 39}
{"loss": 0.10885952413082123, "acc": 0.9599741101264954, "length": 3.9929983615875244, "mode": "train", "epoch": 40}
{"loss": 0.13175038993358612, "acc": 0.953321635723114, "length": 4.0, "mode": "test", "epoch": 40}
{"loss": 0.10136160999536514, "acc": 0.9625236988067627, "length": 3.9938015937805176, "mode": "train", "epoch": 41}
{"loss": 0.14689603447914124, "acc": 0.9564684629440308, "length": 4.0, "mode": "test", "epoch": 41}
{"loss": 0.09713824093341827, "acc": 0.9648571610450745, "length": 3.9949162006378174, "mode": "train", "epoch": 42}
{"loss": 0.13558036088943481, "acc": 0.9585663080215454, "length": 4.0, "mode": "test", "epoch": 42}
{"loss": 0.09487072378396988, "acc": 0.9675386548042297, "length": 3.99678111076355, "mode": "train", "epoch": 43}
{"loss": 0.15386225283145905, "acc": 0.9541957974433899, "length": 4.0, "mode": "test", "epoch": 43}
{"loss": 0.09079938381910324, "acc": 0.9679678082466125, "length": 3.9972972869873047, "mode": "train", "epoch": 44}
{"loss": 0.13368570804595947, "acc": 0.9578672051429749, "length": 4.0, "mode": "test", "epoch": 44}
{"loss": 0.0873379036784172, "acc": 0.969211757183075, "length": 3.9978957176208496, "mode": "train", "epoch": 45}
{"loss": 0.16336986422538757, "acc": 0.9575175046920776, "length": 4.0, "mode": "test", "epoch": 45}
{"loss": 0.08875084668397903, "acc": 0.9691573977470398, "length": 3.997879981994629, "mode": "train", "epoch": 46}
{"loss": 0.1301916092634201, "acc": 0.9601399898529053, "length": 4.0, "mode": "test", "epoch": 46}
{"loss": 0.08791472762823105, "acc": 0.967991292476654, "length": 3.998009204864502, "mode": "train", "epoch": 47}
{"loss": 0.14044411480426788, "acc": 0.9620630145072937, "length": 4.0, "mode": "test", "epoch": 47}
{"loss": 0.08575870841741562, "acc": 0.9678160548210144, "length": 3.9981465339660645, "mode": "train", "epoch": 48}
{"loss": 0.1879972219467163, "acc": 0.958391547203064, "length": 4.0, "mode": "test", "epoch": 48}
{"loss": 0.08136694878339767, "acc": 0.9746588468551636, "length": 3.9981906414031982, "mode": "train", "epoch": 49}
{"loss": 0.17154113948345184, "acc": 0.9624127149581909, "length": 4.0, "mode": "test", "epoch": 49}
{"loss": 0.07527579367160797, "acc": 0.9752112030982971, "length": 3.998910427093506, "mode": "train", "epoch": 50}
{"loss": 0.16040274500846863, "acc": 0.9587411880493164, "length": 4.0, "mode": "test", "epoch": 50}
{"loss": 0.07715856283903122, "acc": 0.9747999906539917, "length": 3.999040126800537, "mode": "train", "epoch": 51}
{"loss": 0.16448771953582764, "acc": 0.9617133736610413, "length": 4.0, "mode": "test", "epoch": 51}
{"loss": 0.07843195647001266, "acc": 0.974035382270813, "length": 3.998896598815918, "mode": "train", "epoch": 52}
{"loss": 0.1903330534696579, "acc": 0.9500000476837158, "length": 4.0, "mode": "test", "epoch": 52}
{"loss": 0.06799129396677017, "acc": 0.9774199724197388, "length": 3.9987666606903076, "mode": "train", "epoch": 53}
{"loss": 0.18087828159332275, "acc": 0.962762176990509, "length": 4.0, "mode": "test", "epoch": 53}
{"loss": 0.0654083639383316, "acc": 0.9766833782196045, "length": 3.999403953552246, "mode": "train", "epoch": 54}
{"loss": 0.15536776185035706, "acc": 0.9650348424911499, "length": 4.0, "mode": "test", "epoch": 54}
{"loss": 0.0612308531999588, "acc": 0.9818872213363647, "length": 3.9989612102508545, "mode": "train", "epoch": 55}
{"loss": 0.13372938334941864, "acc": 0.9594404101371765, "length": 4.0, "mode": "test", "epoch": 55}
{"loss": 0.0630708783864975, "acc": 0.9796605706214905, "length": 3.9992759227752686, "mode": "train", "epoch": 56}
{"loss": 0.15771424770355225, "acc": 0.9622377157211304, "length": 4.0, "mode": "test", "epoch": 56}
{"loss": 0.0696975439786911, "acc": 0.9758651256561279, "length": 3.9995129108428955, "mode": "train", "epoch": 57}
{"loss": 0.16276907920837402, "acc": 0.9618880152702332, "length": 4.0, "mode": "test", "epoch": 57}
{"loss": 0.060426801443099976, "acc": 0.9790054559707642, "length": 3.9988107681274414, "mode": "train", "epoch": 58}
{"loss": 0.15464475750923157, "acc": 0.9594404101371765, "length": 4.0, "mode": "test", "epoch": 58}
{"loss": 0.05543596297502518, "acc": 0.9809616804122925, "length": 3.9996089935302734, "mode": "train", "epoch": 59}
{"loss": 0.1508975327014923, "acc": 0.96293705701828, "length": 4.0, "mode": "test", "epoch": 59}
{"loss": 0.05003552883863449, "acc": 0.9837649464607239, "length": 3.999333381652832, "mode": "train", "epoch": 60}
{"loss": 0.14181804656982422, "acc": 0.9643357396125793, "length": 4.0, "mode": "test", "epoch": 60}
test accuracy: 0.8171666860580444
