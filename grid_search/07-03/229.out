# ["--attributes=5", "--values=16", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.97", "--temperature=1.5"]
Creating train_ds and val_ds...

Creating test_ds...
{"loss": 0.697665274143219, "acc": 0.5140449404716492, "length": 2.6045618057250977, "mode": "train", "epoch": 1}
{"loss": 0.6942024230957031, "acc": 0.5045139789581299, "length": 1.0, "mode": "test", "epoch": 1}
{"loss": 0.6591282486915588, "acc": 0.6219195127487183, "length": 2.095935344696045, "mode": "train", "epoch": 2}
{"loss": 0.5932922959327698, "acc": 0.7182888388633728, "length": 2.3611111640930176, "mode": "test", "epoch": 2}
{"loss": 0.5477761030197144, "acc": 0.7392582297325134, "length": 3.1858839988708496, "mode": "train", "epoch": 3}
{"loss": 0.507351279258728, "acc": 0.7694987654685974, "length": 3.659722328186035, "mode": "test", "epoch": 3}
{"loss": 0.4856339991092682, "acc": 0.7694841027259827, "length": 3.395672082901001, "mode": "train", "epoch": 4}
{"loss": 0.4783264696598053, "acc": 0.7907660007476807, "length": 3.694444417953491, "mode": "test", "epoch": 4}
{"loss": 0.43918395042419434, "acc": 0.8044355511665344, "length": 3.4391791820526123, "mode": "train", "epoch": 5}
{"loss": 0.44209790229797363, "acc": 0.8177952170372009, "length": 3.788194417953491, "mode": "test", "epoch": 5}
{"loss": 0.42262589931488037, "acc": 0.817322850227356, "length": 3.3754847049713135, "mode": "train", "epoch": 6}
{"loss": 0.4151860475540161, "acc": 0.8297688961029053, "length": 3.618055582046509, "mode": "test", "epoch": 6}
{"loss": 0.40021613240242004, "acc": 0.828815221786499, "length": 3.370844602584839, "mode": "train", "epoch": 7}
{"loss": 0.3875408172607422, "acc": 0.8388835191726685, "length": 3.5104167461395264, "mode": "test", "epoch": 7}
{"loss": 0.3788380026817322, "acc": 0.8377049565315247, "length": 3.3835480213165283, "mode": "train", "epoch": 8}
{"loss": 0.3831859827041626, "acc": 0.8489528298377991, "length": 3.5208332538604736, "mode": "test", "epoch": 8}
{"loss": 0.36618196964263916, "acc": 0.844192385673523, "length": 3.5649914741516113, "mode": "train", "epoch": 9}
{"loss": 0.36183932423591614, "acc": 0.842198371887207, "length": 3.631944417953491, "mode": "test", "epoch": 9}
{"loss": 0.34720978140830994, "acc": 0.851904571056366, "length": 3.6371421813964844, "mode": "train", "epoch": 10}
{"loss": 0.34756845235824585, "acc": 0.8554416298866272, "length": 3.6666667461395264, "mode": "test", "epoch": 10}
{"loss": 0.3281095325946808, "acc": 0.8614276647567749, "length": 3.6571455001831055, "mode": "train", "epoch": 11}
{"loss": 0.3452911078929901, "acc": 0.8580567240715027, "length": 3.753472328186035, "mode": "test", "epoch": 11}
{"loss": 0.3174985945224762, "acc": 0.8665786385536194, "length": 3.7074875831604004, "mode": "train", "epoch": 12}
{"loss": 0.326925665140152, "acc": 0.8604112267494202, "length": 3.631944417953491, "mode": "test", "epoch": 12}
{"loss": 0.3060520589351654, "acc": 0.8723324537277222, "length": 3.6696817874908447, "mode": "train", "epoch": 13}
{"loss": 0.3204542398452759, "acc": 0.8675564527511597, "length": 3.6875, "mode": "test", "epoch": 13}
{"loss": 0.2813243567943573, "acc": 0.8844515085220337, "length": 3.708782434463501, "mode": "train", "epoch": 14}
{"loss": 0.2988336980342865, "acc": 0.8848415613174438, "length": 3.7013888359069824, "mode": "test", "epoch": 14}
{"loss": 0.27116259932518005, "acc": 0.8920623660087585, "length": 3.7262327671051025, "mode": "train", "epoch": 15}
{"loss": 0.3135395348072052, "acc": 0.8762369751930237, "length": 3.6979167461395264, "mode": "test", "epoch": 15}
{"loss": 0.26287341117858887, "acc": 0.8919157385826111, "length": 3.726191520690918, "mode": "train", "epoch": 16}
{"loss": 0.29517605900764465, "acc": 0.8779025077819824, "length": 3.684027671813965, "mode": "test", "epoch": 16}
{"loss": 0.2523519694805145, "acc": 0.9021458029747009, "length": 3.744800090789795, "mode": "train", "epoch": 17}
{"loss": 0.2653425335884094, "acc": 0.9020506739616394, "length": 3.6979167461395264, "mode": "test", "epoch": 17}
{"loss": 0.2445080280303955, "acc": 0.9054010510444641, "length": 3.706038236618042, "mode": "train", "epoch": 18}
{"loss": 0.2752910852432251, "acc": 0.8941569924354553, "length": 3.7916667461395264, "mode": "test", "epoch": 18}
{"loss": 0.23856399953365326, "acc": 0.9074318408966064, "length": 3.75665545463562, "mode": "train", "epoch": 19}
{"loss": 0.26032987236976624, "acc": 0.9055772423744202, "length": 3.694444417953491, "mode": "test", "epoch": 19}
{"loss": 0.2235735058784485, "acc": 0.9158927202224731, "length": 3.7581400871276855, "mode": "train", "epoch": 20}
{"loss": 0.24031516909599304, "acc": 0.9161674976348877, "length": 3.715277671813965, "mode": "test", "epoch": 20}
{"loss": 0.21549548208713531, "acc": 0.9193398952484131, "length": 3.7754523754119873, "mode": "train", "epoch": 21}
{"loss": 0.22102567553520203, "acc": 0.9175781607627869, "length": 3.788194417953491, "mode": "test", "epoch": 21}
{"loss": 0.20289041101932526, "acc": 0.922538161277771, "length": 3.80757737159729, "mode": "train", "epoch": 22}
{"loss": 0.2115657478570938, "acc": 0.9243327379226685, "length": 3.8298611640930176, "mode": "test", "epoch": 22}
{"loss": 0.19223925471305847, "acc": 0.9309932589530945, "length": 3.8375871181488037, "mode": "train", "epoch": 23}
{"loss": 0.21144840121269226, "acc": 0.9335666298866272, "length": 3.8229167461395264, "mode": "test", "epoch": 23}
{"loss": 0.18826600909233093, "acc": 0.9303737282752991, "length": 3.80562162399292, "mode": "train", "epoch": 24}
{"loss": 0.20045490562915802, "acc": 0.9371798634529114, "length": 3.840277671813965, "mode": "test", "epoch": 24}
{"loss": 0.19121025502681732, "acc": 0.9317507147789001, "length": 3.814251184463501, "mode": "train", "epoch": 25}
{"loss": 0.19846244156360626, "acc": 0.9338813424110413, "length": 3.819444417953491, "mode": "test", "epoch": 25}
{"loss": 0.18496477603912354, "acc": 0.9350491166114807, "length": 3.827882766723633, "mode": "train", "epoch": 26}
{"loss": 0.19235625863075256, "acc": 0.9347819089889526, "length": 3.8576388359069824, "mode": "test", "epoch": 26}
{"loss": 0.16990059614181519, "acc": 0.9404669404029846, "length": 3.8631787300109863, "mode": "train", "epoch": 27}
{"loss": 0.17653308808803558, "acc": 0.9449977874755859, "length": 3.871527671813965, "mode": "test", "epoch": 27}
{"loss": 0.16137456893920898, "acc": 0.9438683986663818, "length": 3.8765571117401123, "mode": "train", "epoch": 28}
{"loss": 0.1800984889268875, "acc": 0.9458171129226685, "length": 3.8923611640930176, "mode": "test", "epoch": 28}
{"loss": 0.16287709772586823, "acc": 0.9448747038841248, "length": 3.8604564666748047, "mode": "train", "epoch": 29}
{"loss": 0.18608148396015167, "acc": 0.9436686635017395, "length": 3.8923611640930176, "mode": "test", "epoch": 29}
{"loss": 0.16711533069610596, "acc": 0.9411670565605164, "length": 3.8906781673431396, "mode": "train", "epoch": 30}
{"loss": 0.1815028190612793, "acc": 0.9456868767738342, "length": 3.878472328186035, "mode": "test", "epoch": 30}
{"loss": 0.17926432192325592, "acc": 0.9365977048873901, "length": 3.916001796722412, "mode": "train", "epoch": 31}
{"loss": 0.17524684965610504, "acc": 0.9437987804412842, "length": 3.9166667461395264, "mode": "test", "epoch": 31}
{"loss": 0.16103726625442505, "acc": 0.9422475099563599, "length": 3.8623862266540527, "mode": "train", "epoch": 32}
{"loss": 0.18300268054008484, "acc": 0.9401801228523254, "length": 3.8958332538604736, "mode": "test", "epoch": 32}
{"loss": 0.15173998475074768, "acc": 0.9483053684234619, "length": 3.889113664627075, "mode": "train", "epoch": 33}
{"loss": 0.16353145241737366, "acc": 0.9493327736854553, "length": 3.9548611640930176, "mode": "test", "epoch": 33}
{"loss": 0.1446492224931717, "acc": 0.9492353796958923, "length": 3.950241804122925, "mode": "train", "epoch": 34}
{"loss": 0.1519811749458313, "acc": 0.9503635764122009, "length": 3.9548611640930176, "mode": "test", "epoch": 34}
{"loss": 0.1453174650669098, "acc": 0.9496960043907166, "length": 3.956028699874878, "mode": "train", "epoch": 35}
{"loss": 0.17655500769615173, "acc": 0.9448513388633728, "length": 3.9548611640930176, "mode": "test", "epoch": 35}
{"loss": 0.14888036251068115, "acc": 0.9488393068313599, "length": 3.9438059329986572, "mode": "train", "epoch": 36}
{"loss": 0.14715811610221863, "acc": 0.9546440839767456, "length": 3.944444417953491, "mode": "test", "epoch": 36}
{"loss": 0.14791585505008698, "acc": 0.9479139447212219, "length": 3.911961317062378, "mode": "train", "epoch": 37}
{"loss": 0.1606614589691162, "acc": 0.9520779848098755, "length": 3.902777671813965, "mode": "test", "epoch": 37}
{"loss": 0.1369173675775528, "acc": 0.9543131589889526, "length": 3.847656011581421, "mode": "train", "epoch": 38}
{"loss": 0.1585482507944107, "acc": 0.9510852098464966, "length": 3.8263888359069824, "mode": "test", "epoch": 38}
{"loss": 0.13092224299907684, "acc": 0.9546546339988708, "length": 3.868410587310791, "mode": "train", "epoch": 39}
{"loss": 0.14004750549793243, "acc": 0.9550889134407043, "length": 3.899305582046509, "mode": "test", "epoch": 39}
{"loss": 0.1463768035173416, "acc": 0.9470608234405518, "length": 3.889009714126587, "mode": "train", "epoch": 40}
{"loss": 0.15687716007232666, "acc": 0.948236882686615, "length": 3.871527671813965, "mode": "test", "epoch": 40}
{"loss": 0.14428278803825378, "acc": 0.9492625594139099, "length": 3.883213996887207, "mode": "train", "epoch": 41}
{"loss": 0.15529701113700867, "acc": 0.9538629055023193, "length": 3.8958332538604736, "mode": "test", "epoch": 41}
{"loss": 0.14077194035053253, "acc": 0.9512807726860046, "length": 3.896573305130005, "mode": "train", "epoch": 42}
{"loss": 0.16153527796268463, "acc": 0.9502713084220886, "length": 3.930555582046509, "mode": "test", "epoch": 42}
{"loss": 0.13430117070674896, "acc": 0.9531955122947693, "length": 3.90201473236084, "mode": "train", "epoch": 43}
{"loss": 0.17226696014404297, "acc": 0.953287661075592, "length": 3.8958332538604736, "mode": "test", "epoch": 43}
{"loss": 0.1358359158039093, "acc": 0.9551420211791992, "length": 3.9069302082061768, "mode": "train", "epoch": 44}
{"loss": 0.16424596309661865, "acc": 0.9533637166023254, "length": 3.9479167461395264, "mode": "test", "epoch": 44}
{"loss": 0.12675350904464722, "acc": 0.9564717411994934, "length": 3.9129855632781982, "mode": "train", "epoch": 45}
{"loss": 0.1539129763841629, "acc": 0.9544921517372131, "length": 3.902777671813965, "mode": "test", "epoch": 45}
{"loss": 0.12285470217466354, "acc": 0.9601256251335144, "length": 3.890333890914917, "mode": "train", "epoch": 46}
{"loss": 0.14922209084033966, "acc": 0.9565537571907043, "length": 3.8958332538604736, "mode": "test", "epoch": 46}
{"loss": 0.12779207527637482, "acc": 0.9555251002311707, "length": 3.880082845687866, "mode": "train", "epoch": 47}
{"loss": 0.13654132187366486, "acc": 0.9522894620895386, "length": 3.8958332538604736, "mode": "test", "epoch": 47}
{"loss": 0.1241619661450386, "acc": 0.9572485685348511, "length": 3.8850505352020264, "mode": "train", "epoch": 48}
{"loss": 0.12258853018283844, "acc": 0.9592013955116272, "length": 3.8611111640930176, "mode": "test", "epoch": 48}
{"loss": 0.13018390536308289, "acc": 0.9549915790557861, "length": 3.878443717956543, "mode": "train", "epoch": 49}
{"loss": 0.12725691497325897, "acc": 0.9608452916145325, "length": 3.8645832538604736, "mode": "test", "epoch": 49}
{"loss": 0.11428680270910263, "acc": 0.9624088406562805, "length": 3.8879454135894775, "mode": "train", "epoch": 50}
{"loss": 0.12942712008953094, "acc": 0.9609538316726685, "length": 3.8854167461395264, "mode": "test", "epoch": 50}
{"loss": 0.1251487284898758, "acc": 0.9555225968360901, "length": 3.869708299636841, "mode": "train", "epoch": 51}
{"loss": 0.14468829333782196, "acc": 0.9572102427482605, "length": 3.90625, "mode": "test", "epoch": 51}
{"loss": 0.1265067756175995, "acc": 0.9563952684402466, "length": 3.901794195175171, "mode": "train", "epoch": 52}
{"loss": 0.16530655324459076, "acc": 0.9514594674110413, "length": 3.878472328186035, "mode": "test", "epoch": 52}
{"loss": 0.11823399364948273, "acc": 0.9602759480476379, "length": 3.877978801727295, "mode": "train", "epoch": 53}
{"loss": 0.1276228278875351, "acc": 0.9624132513999939, "length": 3.8888888359069824, "mode": "test", "epoch": 53}
{"loss": 0.1132093071937561, "acc": 0.9606279134750366, "length": 3.882829189300537, "mode": "train", "epoch": 54}
{"loss": 0.13522812724113464, "acc": 0.9554199576377869, "length": 3.8576388359069824, "mode": "test", "epoch": 54}
{"loss": 0.10703922808170319, "acc": 0.9658426642417908, "length": 3.879464864730835, "mode": "train", "epoch": 55}
{"loss": 0.14805646240711212, "acc": 0.9583496451377869, "length": 3.8923611640930176, "mode": "test", "epoch": 55}
{"loss": 0.10235623270273209, "acc": 0.9654927849769592, "length": 3.882732629776001, "mode": "train", "epoch": 56}
{"loss": 0.13667230308055878, "acc": 0.9612087607383728, "length": 3.881944417953491, "mode": "test", "epoch": 56}
{"loss": 0.10304322093725204, "acc": 0.9653705358505249, "length": 3.88561749458313, "mode": "train", "epoch": 57}
{"loss": 0.13505426049232483, "acc": 0.9615016579627991, "length": 3.881944417953491, "mode": "test", "epoch": 57}
{"loss": 0.1204414963722229, "acc": 0.9612714052200317, "length": 3.8938121795654297, "mode": "train", "epoch": 58}
{"loss": 0.16076163947582245, "acc": 0.9558919072151184, "length": 3.881944417953491, "mode": "test", "epoch": 58}
{"loss": 0.10718373209238052, "acc": 0.9640102982521057, "length": 3.8771169185638428, "mode": "train", "epoch": 59}
{"loss": 0.1332368403673172, "acc": 0.9614530205726624, "length": 3.899305582046509, "mode": "test", "epoch": 59}
{"loss": 0.10757195949554443, "acc": 0.9659463763237, "length": 3.8816912174224854, "mode": "train", "epoch": 60}
{"loss": 0.1505746692419052, "acc": 0.9605035781860352, "length": 3.8923611640930176, "mode": "test", "epoch": 60}
test accuracy: 0.8170096278190613
