# ["--attributes=5", "--values=16", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--hidden_size=256", "--temp_update=0.97", "--temperature=2"]
Creating train_ds and val_ds...

Creating test_ds...
{"loss": 0.7061232328414917, "acc": 0.5114293694496155, "length": 1.8532484769821167, "mode": "train", "epoch": 1}
{"loss": 0.6857976317405701, "acc": 0.5297250747680664, "length": 1.0, "mode": "test", "epoch": 1}
{"loss": 0.6904237270355225, "acc": 0.5288127660751343, "length": 1.1417163610458374, "mode": "train", "epoch": 2}
{"loss": 0.6568650603294373, "acc": 0.6179875731468201, "length": 1.5910652875900269, "mode": "test", "epoch": 2}
{"loss": 0.5593509674072266, "acc": 0.7262568473815918, "length": 2.6439828872680664, "mode": "train", "epoch": 3}
{"loss": 0.5124979615211487, "acc": 0.7785653471946716, "length": 3.0412371158599854, "mode": "test", "epoch": 3}
{"loss": 0.475797176361084, "acc": 0.7932330965995789, "length": 2.9781172275543213, "mode": "train", "epoch": 4}
{"loss": 0.4496398866176605, "acc": 0.8123925924301147, "length": 3.0927834510803223, "mode": "test", "epoch": 4}
{"loss": 0.3974248468875885, "acc": 0.830822765827179, "length": 3.067209243774414, "mode": "train", "epoch": 5}
{"loss": 0.40141698718070984, "acc": 0.8395457863807678, "length": 3.030927896499634, "mode": "test", "epoch": 5}
{"loss": 0.35415175557136536, "acc": 0.8589587807655334, "length": 3.1276915073394775, "mode": "train", "epoch": 6}
{"loss": 0.38317716121673584, "acc": 0.8470844626426697, "length": 3.051546335220337, "mode": "test", "epoch": 6}
{"loss": 0.3248874545097351, "acc": 0.8700613379478455, "length": 3.301497459411621, "mode": "train", "epoch": 7}
{"loss": 0.3728707730770111, "acc": 0.8525665998458862, "length": 3.2061855792999268, "mode": "test", "epoch": 7}
{"loss": 0.29828062653541565, "acc": 0.8797772526741028, "length": 3.469759225845337, "mode": "train", "epoch": 8}
{"loss": 0.35254764556884766, "acc": 0.8542633056640625, "length": 3.6907217502593994, "mode": "test", "epoch": 8}
{"loss": 0.2938796579837799, "acc": 0.8804787397384644, "length": 3.625333547592163, "mode": "train", "epoch": 9}
{"loss": 0.3846800625324249, "acc": 0.8587306141853333, "length": 3.8659794330596924, "mode": "test", "epoch": 9}
{"loss": 0.27850598096847534, "acc": 0.8845875263214111, "length": 3.7163360118865967, "mode": "train", "epoch": 10}
{"loss": 0.303913414478302, "acc": 0.8762457966804504, "length": 3.8797249794006348, "mode": "test", "epoch": 10}
{"loss": 0.23404362797737122, "acc": 0.9085267782211304, "length": 3.808790445327759, "mode": "train", "epoch": 11}
{"loss": 0.27405664324760437, "acc": 0.8904047608375549, "length": 3.972508668899536, "mode": "test", "epoch": 11}
{"loss": 0.22085854411125183, "acc": 0.9145885705947876, "length": 3.9371020793914795, "mode": "train", "epoch": 12}
{"loss": 0.26220938563346863, "acc": 0.8979381918907166, "length": 4.0, "mode": "test", "epoch": 12}
{"loss": 0.19564953446388245, "acc": 0.926220715045929, "length": 3.983212471008301, "mode": "train", "epoch": 13}
{"loss": 0.24129746854305267, "acc": 0.9187284111976624, "length": 4.0, "mode": "test", "epoch": 13}
{"loss": 0.1888228803873062, "acc": 0.9308415055274963, "length": 3.990464448928833, "mode": "train", "epoch": 14}
{"loss": 0.2302275002002716, "acc": 0.9230241775512695, "length": 4.0, "mode": "test", "epoch": 14}
{"loss": 0.16884633898735046, "acc": 0.9397794008255005, "length": 3.9921696186065674, "mode": "train", "epoch": 15}
{"loss": 0.24321101605892181, "acc": 0.918900191783905, "length": 4.0, "mode": "test", "epoch": 15}
{"loss": 0.15151447057724, "acc": 0.9469497799873352, "length": 3.993422031402588, "mode": "train", "epoch": 16}
{"loss": 0.1836097687482834, "acc": 0.9378006458282471, "length": 4.0, "mode": "test", "epoch": 16}
{"loss": 0.14208170771598816, "acc": 0.9460395574569702, "length": 3.996049642562866, "mode": "train", "epoch": 17}
{"loss": 0.1813686341047287, "acc": 0.9357389211654663, "length": 4.0, "mode": "test", "epoch": 17}
{"loss": 0.12453093379735947, "acc": 0.9590071439743042, "length": 3.997164249420166, "mode": "train", "epoch": 18}
{"loss": 0.169725701212883, "acc": 0.9429553151130676, "length": 4.0, "mode": "test", "epoch": 18}
{"loss": 0.12511515617370605, "acc": 0.9577261209487915, "length": 3.996846914291382, "mode": "train", "epoch": 19}
{"loss": 0.13640795648097992, "acc": 0.9482817053794861, "length": 4.0, "mode": "test", "epoch": 19}
{"loss": 0.11999046802520752, "acc": 0.9555243253707886, "length": 3.9955837726593018, "mode": "train", "epoch": 20}
{"loss": 0.134359210729599, "acc": 0.9503437280654907, "length": 4.0, "mode": "test", "epoch": 20}
{"loss": 0.10906107723712921, "acc": 0.956192135810852, "length": 3.997781753540039, "mode": "train", "epoch": 21}
{"loss": 0.14503607153892517, "acc": 0.9496563673019409, "length": 4.0, "mode": "test", "epoch": 21}
{"loss": 0.0958908423781395, "acc": 0.9652378559112549, "length": 3.9991648197174072, "mode": "train", "epoch": 22}
{"loss": 0.1201556846499443, "acc": 0.953264594078064, "length": 4.0, "mode": "test", "epoch": 22}
{"loss": 0.10473230481147766, "acc": 0.9648351073265076, "length": 3.999342918395996, "mode": "train", "epoch": 23}
{"loss": 0.09981133788824081, "acc": 0.9570446610450745, "length": 4.0, "mode": "test", "epoch": 23}
{"loss": 0.10517220944166183, "acc": 0.959876537322998, "length": 3.9985451698303223, "mode": "train", "epoch": 24}
{"loss": 0.13939809799194336, "acc": 0.9517181515693665, "length": 4.0, "mode": "test", "epoch": 24}
{"loss": 0.09462454169988632, "acc": 0.9674584269523621, "length": 3.998655319213867, "mode": "train", "epoch": 25}
{"loss": 0.14374707639217377, "acc": 0.9603093266487122, "length": 4.0, "mode": "test", "epoch": 25}
{"loss": 0.08423858135938644, "acc": 0.9699591398239136, "length": 3.999591827392578, "mode": "train", "epoch": 26}
{"loss": 0.07382893562316895, "acc": 0.9697594046592712, "length": 4.0, "mode": "test", "epoch": 26}
{"loss": 0.06828965991735458, "acc": 0.973904013633728, "length": 3.997272253036499, "mode": "train", "epoch": 27}
{"loss": 0.07229670137166977, "acc": 0.9709622859954834, "length": 4.0, "mode": "test", "epoch": 27}
{"loss": 0.06227826327085495, "acc": 0.9772093296051025, "length": 3.9996466636657715, "mode": "train", "epoch": 28}
{"loss": 0.08086234331130981, "acc": 0.9699312448501587, "length": 4.0, "mode": "test", "epoch": 28}
{"loss": 0.06373170018196106, "acc": 0.9772109389305115, "length": 3.9995288848876953, "mode": "train", "epoch": 29}
{"loss": 0.06766512244939804, "acc": 0.9719931483268738, "length": 4.0, "mode": "test", "epoch": 29}
{"loss": 0.058176398277282715, "acc": 0.9793326258659363, "length": 3.9996650218963623, "mode": "train", "epoch": 30}
{"loss": 0.11037031561136246, "acc": 0.9639175534248352, "length": 4.0, "mode": "test", "epoch": 30}
{"loss": 0.059522081166505814, "acc": 0.9776251912117004, "length": 3.9988789558410645, "mode": "train", "epoch": 31}
{"loss": 0.14344215393066406, "acc": 0.9627147316932678, "length": 4.0, "mode": "test", "epoch": 31}
{"loss": 0.06360840052366257, "acc": 0.977270781993866, "length": 3.9998960494995117, "mode": "train", "epoch": 32}
{"loss": 0.06848187744617462, "acc": 0.9723367094993591, "length": 4.0, "mode": "test", "epoch": 32}
{"loss": 0.06811627745628357, "acc": 0.9783061742782593, "length": 3.998867988586426, "mode": "train", "epoch": 33}
{"loss": 0.08694617450237274, "acc": 0.9659793972969055, "length": 4.0, "mode": "test", "epoch": 33}
{"loss": 0.06873393803834915, "acc": 0.9771571159362793, "length": 3.99995756149292, "mode": "train", "epoch": 34}
{"loss": 0.0898507758975029, "acc": 0.9661511778831482, "length": 4.0, "mode": "test", "epoch": 34}
{"loss": 0.05856847018003464, "acc": 0.9797464609146118, "length": 3.9999585151672363, "mode": "train", "epoch": 35}
{"loss": 0.08162745088338852, "acc": 0.9713058471679688, "length": 4.0, "mode": "test", "epoch": 35}
{"loss": 0.062117964029312134, "acc": 0.9800246953964233, "length": 3.9994566440582275, "mode": "train", "epoch": 36}
{"loss": 0.09992368519306183, "acc": 0.963230311870575, "length": 4.0, "mode": "test", "epoch": 36}
{"loss": 0.06273813545703888, "acc": 0.9787685871124268, "length": 3.9999730587005615, "mode": "train", "epoch": 37}
{"loss": 0.07158735394477844, "acc": 0.969072163105011, "length": 4.0, "mode": "test", "epoch": 37}
{"loss": 0.04576984420418739, "acc": 0.9823926687240601, "length": 3.999953269958496, "mode": "train", "epoch": 38}
{"loss": 0.10993444174528122, "acc": 0.9664948582649231, "length": 4.0, "mode": "test", "epoch": 38}
{"loss": 0.0386224240064621, "acc": 0.985730767250061, "length": 3.99998140335083, "mode": "train", "epoch": 39}
{"loss": 0.09556829184293747, "acc": 0.9652921557426453, "length": 4.0, "mode": "test", "epoch": 39}
{"loss": 0.04978952556848526, "acc": 0.9826807379722595, "length": 3.999948501586914, "mode": "train", "epoch": 40}
{"loss": 0.09325838834047318, "acc": 0.9704467058181763, "length": 4.0, "mode": "test", "epoch": 40}
{"loss": 0.04708070680499077, "acc": 0.9829685688018799, "length": 3.9999747276306152, "mode": "train", "epoch": 41}
{"loss": 0.06993044167757034, "acc": 0.9786942005157471, "length": 4.0, "mode": "test", "epoch": 41}
{"loss": 0.040262117981910706, "acc": 0.9846374988555908, "length": 3.999974250793457, "mode": "train", "epoch": 42}
{"loss": 0.07447212189435959, "acc": 0.9766322374343872, "length": 4.0, "mode": "test", "epoch": 42}
{"loss": 0.05407379940152168, "acc": 0.9823359847068787, "length": 3.999997138977051, "mode": "train", "epoch": 43}
{"loss": 0.11925046890974045, "acc": 0.9694157242774963, "length": 4.0, "mode": "test", "epoch": 43}
{"loss": 0.06531240046024323, "acc": 0.9768124222755432, "length": 3.99999737739563, "mode": "train", "epoch": 44}
{"loss": 0.08296255022287369, "acc": 0.9762885570526123, "length": 4.0, "mode": "test", "epoch": 44}
{"loss": 0.07615356892347336, "acc": 0.9726697206497192, "length": 3.9999985694885254, "mode": "train", "epoch": 45}
{"loss": 0.08175336569547653, "acc": 0.9711339473724365, "length": 4.0, "mode": "test", "epoch": 45}
{"loss": 0.047391172498464584, "acc": 0.9827387928962708, "length": 3.999997138977051, "mode": "train", "epoch": 46}
{"loss": 0.05120556429028511, "acc": 0.9768041372299194, "length": 4.0, "mode": "test", "epoch": 46}
{"loss": 0.03362865373492241, "acc": 0.9862484335899353, "length": 3.9999990463256836, "mode": "train", "epoch": 47}
{"loss": 0.08133843541145325, "acc": 0.9752578139305115, "length": 4.0, "mode": "test", "epoch": 47}
{"loss": 0.03415817394852638, "acc": 0.9870541095733643, "length": 3.9999988079071045, "mode": "train", "epoch": 48}
{"loss": 0.03379584476351738, "acc": 0.9857388734817505, "length": 4.0, "mode": "test", "epoch": 48}
{"loss": 0.025833098217844963, "acc": 0.9905062317848206, "length": 3.999995231628418, "mode": "train", "epoch": 49}
{"loss": 0.05339721962809563, "acc": 0.9805842041969299, "length": 4.0, "mode": "test", "epoch": 49}
{"loss": 0.0235125832259655, "acc": 0.9907365441322327, "length": 3.999999523162842, "mode": "train", "epoch": 50}
{"loss": 0.04261600598692894, "acc": 0.9845361113548279, "length": 4.0, "mode": "test", "epoch": 50}
{"loss": 0.020988086238503456, "acc": 0.9907938241958618, "length": 3.9999916553497314, "mode": "train", "epoch": 51}
{"loss": 0.036664798855781555, "acc": 0.9862542748451233, "length": 4.0, "mode": "test", "epoch": 51}
{"loss": 0.01989022269845009, "acc": 0.9913693070411682, "length": 3.999997138977051, "mode": "train", "epoch": 52}
{"loss": 0.03108997642993927, "acc": 0.988487958908081, "length": 4.0, "mode": "test", "epoch": 52}
{"loss": 0.02034154161810875, "acc": 0.9925201535224915, "length": 4.0, "mode": "train", "epoch": 53}
{"loss": 0.03409859165549278, "acc": 0.9876289367675781, "length": 4.0, "mode": "test", "epoch": 53}
{"loss": 0.019836915656924248, "acc": 0.9922899007797241, "length": 3.999999761581421, "mode": "train", "epoch": 54}
{"loss": 0.04704469069838524, "acc": 0.9807559847831726, "length": 4.0, "mode": "test", "epoch": 54}
{"loss": 0.028239957988262177, "acc": 0.9899308681488037, "length": 3.9999983310699463, "mode": "train", "epoch": 55}
{"loss": 0.04874005913734436, "acc": 0.9826459884643555, "length": 4.0, "mode": "test", "epoch": 55}
{"loss": 0.037445127964019775, "acc": 0.9887227416038513, "length": 3.999999523162842, "mode": "train", "epoch": 56}
{"loss": 0.04836070165038109, "acc": 0.9829897284507751, "length": 4.0, "mode": "test", "epoch": 56}
{"loss": 0.020860908553004265, "acc": 0.9918296337127686, "length": 3.9999947547912598, "mode": "train", "epoch": 57}
{"loss": 0.03165486827492714, "acc": 0.9886597394943237, "length": 4.0, "mode": "test", "epoch": 57}
{"loss": 0.020603399723768234, "acc": 0.9903337359428406, "length": 3.999997854232788, "mode": "train", "epoch": 58}
{"loss": 0.024332096800208092, "acc": 0.9896907210350037, "length": 4.0, "mode": "test", "epoch": 58}
{"loss": 0.023679276928305626, "acc": 0.9910241365432739, "length": 3.999995470046997, "mode": "train", "epoch": 59}
{"loss": 0.03003043867647648, "acc": 0.987285315990448, "length": 4.0, "mode": "test", "epoch": 59}
{"loss": 0.020526641979813576, "acc": 0.9920570850372314, "length": 3.999898910522461, "mode": "train", "epoch": 60}
{"loss": 0.03355902060866356, "acc": 0.9883161783218384, "length": 4.0, "mode": "test", "epoch": 60}
test accuracy: 0.8583928346633911
