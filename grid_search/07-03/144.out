# ["--attributes=5", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.0005", "--hidden_size=128", "--temp_update=0.97", "--temperature=1"]
Creating train_ds and val_ds...

Creating test_ds...
{"loss": 0.6940923929214478, "acc": 0.5298618078231812, "length": 3.3218305110931396, "mode": "train", "epoch": 1}
{"loss": 0.692597508430481, "acc": 0.535231351852417, "length": 1.0, "mode": "test", "epoch": 1}
{"loss": 0.6848464012145996, "acc": 0.5642342567443848, "length": 2.5604772567749023, "mode": "train", "epoch": 2}
{"loss": 0.6875495314598083, "acc": 0.5806806683540344, "length": 1.1459075212478638, "mode": "test", "epoch": 2}
{"loss": 0.6531562209129333, "acc": 0.6346828937530518, "length": 2.603349208831787, "mode": "train", "epoch": 3}
{"loss": 0.6056588292121887, "acc": 0.7331533432006836, "length": 2.754448413848877, "mode": "test", "epoch": 3}
{"loss": 0.5590403079986572, "acc": 0.7389717102050781, "length": 3.0261313915252686, "mode": "train", "epoch": 4}
{"loss": 0.503302812576294, "acc": 0.7821125984191895, "length": 3.010676145553589, "mode": "test", "epoch": 4}
{"loss": 0.4993442893028259, "acc": 0.7688024640083313, "length": 3.0602052211761475, "mode": "train", "epoch": 5}
{"loss": 0.49177706241607666, "acc": 0.7892407178878784, "length": 3.014234781265259, "mode": "test", "epoch": 5}
{"loss": 0.4771617650985718, "acc": 0.7857111692428589, "length": 3.202270746231079, "mode": "train", "epoch": 6}
{"loss": 0.46148163080215454, "acc": 0.7952580451965332, "length": 3.3772242069244385, "mode": "test", "epoch": 6}
{"loss": 0.44548705220222473, "acc": 0.8021577596664429, "length": 3.3729746341705322, "mode": "train", "epoch": 7}
{"loss": 0.4343678653240204, "acc": 0.8082216382026672, "length": 3.587188720703125, "mode": "test", "epoch": 7}
{"loss": 0.41704481840133667, "acc": 0.8148533701896667, "length": 3.564795970916748, "mode": "train", "epoch": 8}
{"loss": 0.4113878607749939, "acc": 0.8172473311424255, "length": 3.7117438316345215, "mode": "test", "epoch": 8}
{"loss": 0.3969314694404602, "acc": 0.8150851726531982, "length": 3.653228998184204, "mode": "train", "epoch": 9}
{"loss": 0.3923572599887848, "acc": 0.8227284550666809, "length": 3.846975088119507, "mode": "test", "epoch": 9}
{"loss": 0.3859773874282837, "acc": 0.823419451713562, "length": 3.72969126701355, "mode": "train", "epoch": 10}
{"loss": 0.38099753856658936, "acc": 0.8344212770462036, "length": 3.854092597961426, "mode": "test", "epoch": 10}
{"loss": 0.3757915496826172, "acc": 0.8337907195091248, "length": 3.8047327995300293, "mode": "train", "epoch": 11}
{"loss": 0.37352195382118225, "acc": 0.830959677696228, "length": 3.9501779079437256, "mode": "test", "epoch": 11}
{"loss": 0.3612379729747772, "acc": 0.8329464197158813, "length": 3.8106555938720703, "mode": "train", "epoch": 12}
{"loss": 0.3489817678928375, "acc": 0.8411464095115662, "length": 3.9395017623901367, "mode": "test", "epoch": 12}
{"loss": 0.34344130754470825, "acc": 0.853394627571106, "length": 3.8632850646972656, "mode": "train", "epoch": 13}
{"loss": 0.3327591121196747, "acc": 0.8555688261985779, "length": 3.9679715633392334, "mode": "test", "epoch": 13}
{"loss": 0.33406636118888855, "acc": 0.8540932536125183, "length": 3.882525682449341, "mode": "train", "epoch": 14}
{"loss": 0.32906702160835266, "acc": 0.8630667328834534, "length": 3.9786477088928223, "mode": "test", "epoch": 14}
{"loss": 0.317958265542984, "acc": 0.8637539744377136, "length": 3.9268853664398193, "mode": "train", "epoch": 15}
{"loss": 0.31149306893348694, "acc": 0.865202784538269, "length": 3.9715301990509033, "mode": "test", "epoch": 15}
{"loss": 0.3111833333969116, "acc": 0.865030825138092, "length": 3.9166653156280518, "mode": "train", "epoch": 16}
{"loss": 0.3061178922653198, "acc": 0.8683269619941711, "length": 3.9750890731811523, "mode": "test", "epoch": 16}
{"loss": 0.29002124071121216, "acc": 0.875210165977478, "length": 3.938828706741333, "mode": "train", "epoch": 17}
{"loss": 0.2974883019924164, "acc": 0.8762395977973938, "length": 3.9786477088928223, "mode": "test", "epoch": 17}
{"loss": 0.28570929169654846, "acc": 0.8764836192131042, "length": 3.952131509780884, "mode": "train", "epoch": 18}
{"loss": 0.2857101559638977, "acc": 0.8871325254440308, "length": 3.9786477088928223, "mode": "test", "epoch": 18}
{"loss": 0.2760940194129944, "acc": 0.8837199807167053, "length": 3.9640281200408936, "mode": "train", "epoch": 19}
{"loss": 0.2803893983364105, "acc": 0.8829181790351868, "length": 4.0, "mode": "test", "epoch": 19}
{"loss": 0.25792622566223145, "acc": 0.8977232575416565, "length": 3.9675910472869873, "mode": "train", "epoch": 20}
{"loss": 0.2642306983470917, "acc": 0.8938320875167847, "length": 3.9786477088928223, "mode": "test", "epoch": 20}
{"loss": 0.2518754303455353, "acc": 0.8998082876205444, "length": 3.9623639583587646, "mode": "train", "epoch": 21}
{"loss": 0.26659128069877625, "acc": 0.8956788182258606, "length": 3.982206344604492, "mode": "test", "epoch": 21}
{"loss": 0.248772993683815, "acc": 0.9023402333259583, "length": 3.9632163047790527, "mode": "train", "epoch": 22}
{"loss": 0.24913644790649414, "acc": 0.9097867012023926, "length": 3.989323854446411, "mode": "test", "epoch": 22}
{"loss": 0.23583248257637024, "acc": 0.9112488627433777, "length": 3.970099925994873, "mode": "train", "epoch": 23}
{"loss": 0.2375798523426056, "acc": 0.9114601612091064, "length": 3.99644136428833, "mode": "test", "epoch": 23}
{"loss": 0.2170451283454895, "acc": 0.9192475080490112, "length": 3.9769105911254883, "mode": "train", "epoch": 24}
{"loss": 0.22819672524929047, "acc": 0.921174168586731, "length": 4.0, "mode": "test", "epoch": 24}
{"loss": 0.2224854677915573, "acc": 0.9151265025138855, "length": 3.9914402961730957, "mode": "train", "epoch": 25}
{"loss": 0.2372933179140091, "acc": 0.9165481925010681, "length": 4.0, "mode": "test", "epoch": 25}
{"loss": 0.21983098983764648, "acc": 0.917762815952301, "length": 3.9915037155151367, "mode": "train", "epoch": 26}
{"loss": 0.2309468537569046, "acc": 0.9222418665885925, "length": 4.0, "mode": "test", "epoch": 26}
{"loss": 0.214006707072258, "acc": 0.9189509153366089, "length": 3.9922914505004883, "mode": "train", "epoch": 27}
{"loss": 0.22991354763507843, "acc": 0.9106761813163757, "length": 4.0, "mode": "test", "epoch": 27}
{"loss": 0.19483663141727448, "acc": 0.9274051785469055, "length": 3.99802565574646, "mode": "train", "epoch": 28}
{"loss": 0.21297159790992737, "acc": 0.9241992235183716, "length": 4.0, "mode": "test", "epoch": 28}
{"loss": 0.18643918633460999, "acc": 0.9318576455116272, "length": 3.9949166774749756, "mode": "train", "epoch": 29}
{"loss": 0.2067219316959381, "acc": 0.9234874248504639, "length": 4.0, "mode": "test", "epoch": 29}
{"loss": 0.19152499735355377, "acc": 0.934495210647583, "length": 3.9955129623413086, "mode": "train", "epoch": 30}
{"loss": 0.22110123932361603, "acc": 0.9199289083480835, "length": 4.0, "mode": "test", "epoch": 30}
{"loss": 0.17827299237251282, "acc": 0.9327389001846313, "length": 3.9936389923095703, "mode": "train", "epoch": 31}
{"loss": 0.19837971031665802, "acc": 0.9254449009895325, "length": 4.0, "mode": "test", "epoch": 31}
{"loss": 0.17159125208854675, "acc": 0.9356741905212402, "length": 3.9967007637023926, "mode": "train", "epoch": 32}
{"loss": 0.21718263626098633, "acc": 0.9275800585746765, "length": 4.0, "mode": "test", "epoch": 32}
{"loss": 0.17405545711517334, "acc": 0.9386768937110901, "length": 3.9974541664123535, "mode": "train", "epoch": 33}
{"loss": 0.20055699348449707, "acc": 0.9314947724342346, "length": 4.0, "mode": "test", "epoch": 33}
{"loss": 0.16214600205421448, "acc": 0.9420927166938782, "length": 3.9949045181274414, "mode": "train", "epoch": 34}
{"loss": 0.18204696476459503, "acc": 0.9391459822654724, "length": 4.0, "mode": "test", "epoch": 34}
{"loss": 0.15873216092586517, "acc": 0.9425930380821228, "length": 3.999441623687744, "mode": "train", "epoch": 35}
{"loss": 0.1817336082458496, "acc": 0.9329182505607605, "length": 4.0, "mode": "test", "epoch": 35}
{"loss": 0.15843629837036133, "acc": 0.9459890723228455, "length": 3.9993786811828613, "mode": "train", "epoch": 36}
{"loss": 0.17780762910842896, "acc": 0.9418148994445801, "length": 4.0, "mode": "test", "epoch": 36}
{"loss": 0.14514315128326416, "acc": 0.9480688571929932, "length": 3.997098207473755, "mode": "train", "epoch": 37}
{"loss": 0.17641544342041016, "acc": 0.9391459822654724, "length": 4.0, "mode": "test", "epoch": 37}
{"loss": 0.14866428077220917, "acc": 0.9520005583763123, "length": 3.998227834701538, "mode": "train", "epoch": 38}
{"loss": 0.17860999703407288, "acc": 0.9396798610687256, "length": 4.0, "mode": "test", "epoch": 38}
{"loss": 0.2143729031085968, "acc": 0.9218665361404419, "length": 3.9998743534088135, "mode": "train", "epoch": 39}
{"loss": 0.18680502474308014, "acc": 0.9286477565765381, "length": 4.0, "mode": "test", "epoch": 39}
{"loss": 0.16173134744167328, "acc": 0.9404327273368835, "length": 3.999311923980713, "mode": "train", "epoch": 40}
{"loss": 0.18730293214321136, "acc": 0.9322064518928528, "length": 4.0, "mode": "test", "epoch": 40}
{"loss": 0.15510587394237518, "acc": 0.9436072707176208, "length": 3.999699592590332, "mode": "train", "epoch": 41}
{"loss": 0.19990795850753784, "acc": 0.935943067073822, "length": 4.0, "mode": "test", "epoch": 41}
{"loss": 0.14014838635921478, "acc": 0.9484743475914001, "length": 3.996696710586548, "mode": "train", "epoch": 42}
{"loss": 0.17300806939601898, "acc": 0.9412811398506165, "length": 4.0, "mode": "test", "epoch": 42}
{"loss": 0.13895797729492188, "acc": 0.9528006315231323, "length": 3.997357130050659, "mode": "train", "epoch": 43}
{"loss": 0.17402276396751404, "acc": 0.9412811398506165, "length": 4.0, "mode": "test", "epoch": 43}
{"loss": 0.129111185669899, "acc": 0.9558873176574707, "length": 3.9995734691619873, "mode": "train", "epoch": 44}
{"loss": 0.17798930406570435, "acc": 0.9419928193092346, "length": 4.0, "mode": "test", "epoch": 44}
{"loss": 0.12324957549571991, "acc": 0.9573803544044495, "length": 3.999748945236206, "mode": "train", "epoch": 45}
{"loss": 0.16609342396259308, "acc": 0.9427046179771423, "length": 4.0, "mode": "test", "epoch": 45}
{"loss": 0.13158120214939117, "acc": 0.9572955369949341, "length": 3.9991307258605957, "mode": "train", "epoch": 46}
{"loss": 0.1702086627483368, "acc": 0.9448398351669312, "length": 4.0, "mode": "test", "epoch": 46}
{"loss": 0.12277377396821976, "acc": 0.9580363035202026, "length": 3.9997668266296387, "mode": "train", "epoch": 47}
{"loss": 0.17142021656036377, "acc": 0.9457295536994934, "length": 4.0, "mode": "test", "epoch": 47}
{"loss": 0.12167368829250336, "acc": 0.9580801725387573, "length": 3.9978277683258057, "mode": "train", "epoch": 48}
{"loss": 0.16519664227962494, "acc": 0.9446618556976318, "length": 4.0, "mode": "test", "epoch": 48}
{"loss": 0.11407186090946198, "acc": 0.9619652628898621, "length": 3.999290943145752, "mode": "train", "epoch": 49}
{"loss": 0.16191285848617554, "acc": 0.9418148994445801, "length": 4.0, "mode": "test", "epoch": 49}
{"loss": 0.1260424554347992, "acc": 0.9592202305793762, "length": 3.999501943588257, "mode": "train", "epoch": 50}
{"loss": 0.1763833910226822, "acc": 0.946085512638092, "length": 4.0, "mode": "test", "epoch": 50}
{"loss": 0.11919303238391876, "acc": 0.9577421545982361, "length": 3.999870538711548, "mode": "train", "epoch": 51}
{"loss": 0.17214523255825043, "acc": 0.9453736543655396, "length": 4.0, "mode": "test", "epoch": 51}
{"loss": 0.11504597216844559, "acc": 0.9586795568466187, "length": 3.998905897140503, "mode": "train", "epoch": 52}
{"loss": 0.16614921391010284, "acc": 0.942348837852478, "length": 4.0, "mode": "test", "epoch": 52}
{"loss": 0.11346115916967392, "acc": 0.9604839086532593, "length": 3.99991512298584, "mode": "train", "epoch": 53}
{"loss": 0.15754765272140503, "acc": 0.9483984708786011, "length": 4.0, "mode": "test", "epoch": 53}
{"loss": 0.1218162402510643, "acc": 0.9593995213508606, "length": 3.9982316493988037, "mode": "train", "epoch": 54}
{"loss": 0.14777107536792755, "acc": 0.9528470039367676, "length": 4.0, "mode": "test", "epoch": 54}
{"loss": 0.1078515574336052, "acc": 0.9629309177398682, "length": 3.9999685287475586, "mode": "train", "epoch": 55}
{"loss": 0.15864260494709015, "acc": 0.9462634325027466, "length": 4.0, "mode": "test", "epoch": 55}
{"loss": 0.1064891442656517, "acc": 0.9619767665863037, "length": 3.9999566078186035, "mode": "train", "epoch": 56}
{"loss": 0.16316790878772736, "acc": 0.946263313293457, "length": 4.0, "mode": "test", "epoch": 56}
{"loss": 0.11022312939167023, "acc": 0.9634035229682922, "length": 3.9999020099639893, "mode": "train", "epoch": 57}
{"loss": 0.15154114365577698, "acc": 0.9491102695465088, "length": 4.0, "mode": "test", "epoch": 57}
{"loss": 0.09859846532344818, "acc": 0.9645319581031799, "length": 3.9998393058776855, "mode": "train", "epoch": 58}
{"loss": 0.16963651776313782, "acc": 0.9464412331581116, "length": 4.0, "mode": "test", "epoch": 58}
{"loss": 0.09895779192447662, "acc": 0.9639225602149963, "length": 3.9987597465515137, "mode": "train", "epoch": 59}
{"loss": 0.15392249822616577, "acc": 0.9498221278190613, "length": 4.0, "mode": "test", "epoch": 59}
{"loss": 0.10307956486940384, "acc": 0.9638677835464478, "length": 3.9998154640197754, "mode": "train", "epoch": 60}
{"loss": 0.1553996205329895, "acc": 0.9460854530334473, "length": 4.0, "mode": "test", "epoch": 60}
test accuracy: 0.8043749928474426
