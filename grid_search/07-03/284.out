# ["--attributes=5", "--values=16", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=128", "--learning_rate=0.001", "--hidden_size=256", "--temp_update=0.97", "--temperature=2"]
Creating train_ds and val_ds...

Creating test_ds...
{"loss": 0.7260046601295471, "acc": 0.5031799674034119, "length": 3.3055074214935303, "mode": "train", "epoch": 1}
{"loss": 0.7011181712150574, "acc": 0.5, "length": 1.0, "mode": "test", "epoch": 1}
{"loss": 0.6960671544075012, "acc": 0.5219280123710632, "length": 1.601514458656311, "mode": "train", "epoch": 2}
{"loss": 0.6967031955718994, "acc": 0.4857650697231293, "length": 1.0, "mode": "test", "epoch": 2}
{"loss": 0.6933313608169556, "acc": 0.5100544095039368, "length": 1.0469635725021362, "mode": "train", "epoch": 3}
{"loss": 0.6983630657196045, "acc": 0.4807829260826111, "length": 1.0, "mode": "test", "epoch": 3}
{"loss": 0.6925122141838074, "acc": 0.5230197310447693, "length": 1.0213261842727661, "mode": "train", "epoch": 4}
{"loss": 0.6974193453788757, "acc": 0.4601424038410187, "length": 1.0, "mode": "test", "epoch": 4}
{"loss": 0.6922027468681335, "acc": 0.5153193473815918, "length": 1.0143171548843384, "mode": "train", "epoch": 5}
{"loss": 0.6957446932792664, "acc": 0.4619216024875641, "length": 1.0, "mode": "test", "epoch": 5}
{"loss": 0.6918132305145264, "acc": 0.5264906883239746, "length": 1.0110294818878174, "mode": "train", "epoch": 6}
{"loss": 0.695288360118866, "acc": 0.48772236704826355, "length": 1.0, "mode": "test", "epoch": 6}
{"loss": 0.6923297047615051, "acc": 0.5300384759902954, "length": 1.0125869512557983, "mode": "train", "epoch": 7}
{"loss": 0.6968631148338318, "acc": 0.4747331142425537, "length": 1.0, "mode": "test", "epoch": 7}
{"loss": 0.6897308230400085, "acc": 0.5339373350143433, "length": 1.0432740449905396, "mode": "train", "epoch": 8}
{"loss": 0.6931778788566589, "acc": 0.5163700580596924, "length": 1.0, "mode": "test", "epoch": 8}
{"loss": 0.6663119196891785, "acc": 0.5612446665763855, "length": 1.6297053098678589, "mode": "train", "epoch": 9}
{"loss": 0.6282657384872437, "acc": 0.6809269785881042, "length": 2.1067614555358887, "mode": "test", "epoch": 9}
{"loss": 0.6022790670394897, "acc": 0.6827923059463501, "length": 2.2245872020721436, "mode": "train", "epoch": 10}
{"loss": 0.5895439386367798, "acc": 0.7169784307479858, "length": 2.0676157474517822, "mode": "test", "epoch": 10}
{"loss": 0.5782785415649414, "acc": 0.704356849193573, "length": 2.172337293624878, "mode": "train", "epoch": 11}
{"loss": 0.5709636211395264, "acc": 0.7143258452415466, "length": 2.4412810802459717, "mode": "test", "epoch": 11}
{"loss": 0.5471646189689636, "acc": 0.7257968783378601, "length": 2.409907817840576, "mode": "train", "epoch": 12}
{"loss": 0.5260442495346069, "acc": 0.7563957571983337, "length": 2.580071210861206, "mode": "test", "epoch": 12}
{"loss": 0.5106453895568848, "acc": 0.7608885765075684, "length": 2.6473827362060547, "mode": "train", "epoch": 13}
{"loss": 0.49362310767173767, "acc": 0.7829689979553223, "length": 2.7829182147979736, "mode": "test", "epoch": 13}
{"loss": 0.4895268976688385, "acc": 0.7681459188461304, "length": 2.8353922367095947, "mode": "train", "epoch": 14}
{"loss": 0.48037952184677124, "acc": 0.7964192032814026, "length": 2.72953724861145, "mode": "test", "epoch": 14}
{"loss": 0.47657158970832825, "acc": 0.7775714993476868, "length": 2.768850088119507, "mode": "train", "epoch": 15}
{"loss": 0.4675602614879608, "acc": 0.7932608723640442, "length": 2.836298942565918, "mode": "test", "epoch": 15}
{"loss": 0.46857646107673645, "acc": 0.7806023359298706, "length": 2.7203121185302734, "mode": "train", "epoch": 16}
{"loss": 0.4783267378807068, "acc": 0.7859424948692322, "length": 2.654804229736328, "mode": "test", "epoch": 16}
{"loss": 0.46448278427124023, "acc": 0.7808919548988342, "length": 2.7727184295654297, "mode": "train", "epoch": 17}
{"loss": 0.4581979215145111, "acc": 0.7980315089225769, "length": 2.846975088119507, "mode": "test", "epoch": 17}
{"loss": 0.4609917402267456, "acc": 0.7940644025802612, "length": 2.7760214805603027, "mode": "train", "epoch": 18}
{"loss": 0.481381356716156, "acc": 0.7972199320793152, "length": 2.8042705059051514, "mode": "test", "epoch": 18}
{"loss": 0.4522826671600342, "acc": 0.7921902537345886, "length": 2.752291202545166, "mode": "train", "epoch": 19}
{"loss": 0.47265538573265076, "acc": 0.8020663857460022, "length": 2.7829182147979736, "mode": "test", "epoch": 19}
{"loss": 0.44889119267463684, "acc": 0.7916351556777954, "length": 2.806412696838379, "mode": "train", "epoch": 20}
{"loss": 0.46284931898117065, "acc": 0.8015194535255432, "length": 2.8576512336730957, "mode": "test", "epoch": 20}
{"loss": 0.4402585029602051, "acc": 0.8003767132759094, "length": 2.8074593544006348, "mode": "train", "epoch": 21}
{"loss": 0.4621241092681885, "acc": 0.7952567934989929, "length": 2.7829182147979736, "mode": "test", "epoch": 21}
{"loss": 0.44181716442108154, "acc": 0.7962221503257751, "length": 2.7509055137634277, "mode": "train", "epoch": 22}
{"loss": 0.46733713150024414, "acc": 0.8041808605194092, "length": 2.761565923690796, "mode": "test", "epoch": 22}
{"loss": 0.43866175413131714, "acc": 0.8014922142028809, "length": 2.7693214416503906, "mode": "train", "epoch": 23}
{"loss": 0.4623219966888428, "acc": 0.8062413334846497, "length": 2.7971529960632324, "mode": "test", "epoch": 23}
{"loss": 0.4328064024448395, "acc": 0.8076145648956299, "length": 2.7298572063446045, "mode": "train", "epoch": 24}
{"loss": 0.4575690031051636, "acc": 0.8085217475891113, "length": 2.7010676860809326, "mode": "test", "epoch": 24}
{"loss": 0.42829301953315735, "acc": 0.8091785907745361, "length": 2.7434239387512207, "mode": "train", "epoch": 25}
{"loss": 0.4527765214443207, "acc": 0.8071281313896179, "length": 2.7722420692443848, "mode": "test", "epoch": 25}
{"loss": 0.42512398958206177, "acc": 0.8076455593109131, "length": 2.8057310581207275, "mode": "train", "epoch": 26}
{"loss": 0.4606121778488159, "acc": 0.8050140738487244, "length": 2.647686719894409, "mode": "test", "epoch": 26}
{"loss": 0.421157568693161, "acc": 0.8111892938613892, "length": 2.8200392723083496, "mode": "train", "epoch": 27}
{"loss": 0.4453605115413666, "acc": 0.8067382574081421, "length": 2.733096122741699, "mode": "test", "epoch": 27}
{"loss": 0.41205355525016785, "acc": 0.8145891427993774, "length": 2.8302743434906006, "mode": "train", "epoch": 28}
{"loss": 0.42718368768692017, "acc": 0.8145546913146973, "length": 2.6939501762390137, "mode": "test", "epoch": 28}
{"loss": 0.4055110216140747, "acc": 0.8168558478355408, "length": 2.7889420986175537, "mode": "train", "epoch": 29}
{"loss": 0.42197924852371216, "acc": 0.822066068649292, "length": 2.661921739578247, "mode": "test", "epoch": 29}
{"loss": 0.40052393078804016, "acc": 0.8229789733886719, "length": 2.8346359729766846, "mode": "train", "epoch": 30}
{"loss": 0.4109830856323242, "acc": 0.8241972327232361, "length": 2.6298933029174805, "mode": "test", "epoch": 30}
{"loss": 0.3965837359428406, "acc": 0.8230499625205994, "length": 2.8321940898895264, "mode": "train", "epoch": 31}
{"loss": 0.3953426480293274, "acc": 0.826000988483429, "length": 2.72953724861145, "mode": "test", "epoch": 31}
{"loss": 0.3901589512825012, "acc": 0.8264868259429932, "length": 2.8783793449401855, "mode": "train", "epoch": 32}
{"loss": 0.3895280361175537, "acc": 0.8296710252761841, "length": 2.72953724861145, "mode": "test", "epoch": 32}
{"loss": 0.3834966719150543, "acc": 0.8332279324531555, "length": 2.9208624362945557, "mode": "train", "epoch": 33}
{"loss": 0.3874410092830658, "acc": 0.8341100811958313, "length": 2.829181432723999, "mode": "test", "epoch": 33}
{"loss": 0.3802588880062103, "acc": 0.8380487561225891, "length": 2.9114744663238525, "mode": "train", "epoch": 34}
{"loss": 0.3914310932159424, "acc": 0.8358767032623291, "length": 2.8683273792266846, "mode": "test", "epoch": 34}
{"loss": 0.3748190104961395, "acc": 0.8358013033866882, "length": 2.9594533443450928, "mode": "train", "epoch": 35}
{"loss": 0.3882219195365906, "acc": 0.8357921242713928, "length": 2.900355815887451, "mode": "test", "epoch": 35}
{"loss": 0.3724871575832367, "acc": 0.836647093296051, "length": 2.9363913536071777, "mode": "train", "epoch": 36}
{"loss": 0.37702855467796326, "acc": 0.8421318531036377, "length": 2.825622797012329, "mode": "test", "epoch": 36}
{"loss": 0.3671737611293793, "acc": 0.8420674800872803, "length": 2.947418451309204, "mode": "train", "epoch": 37}
{"loss": 0.3735508322715759, "acc": 0.8451770544052124, "length": 2.7686831951141357, "mode": "test", "epoch": 37}
{"loss": 0.3635009229183197, "acc": 0.8413136005401611, "length": 2.9158148765563965, "mode": "train", "epoch": 38}
{"loss": 0.36998221278190613, "acc": 0.8405398726463318, "length": 2.7829182147979736, "mode": "test", "epoch": 38}
{"loss": 0.3612016439437866, "acc": 0.8467414379119873, "length": 2.837975025177002, "mode": "train", "epoch": 39}
{"loss": 0.3592202663421631, "acc": 0.8482507467269897, "length": 2.6405694484710693, "mode": "test", "epoch": 39}
{"loss": 0.3559032380580902, "acc": 0.8482363820075989, "length": 2.8423562049865723, "mode": "train", "epoch": 40}
{"loss": 0.36595720052719116, "acc": 0.8495315909385681, "length": 2.669039249420166, "mode": "test", "epoch": 40}
{"loss": 0.34866973757743835, "acc": 0.8514054417610168, "length": 2.85593581199646, "mode": "train", "epoch": 41}
{"loss": 0.3560819625854492, "acc": 0.8494535088539124, "length": 2.658363103866577, "mode": "test", "epoch": 41}
{"loss": 0.34787723422050476, "acc": 0.8516055941581726, "length": 2.7960922718048096, "mode": "train", "epoch": 42}
{"loss": 0.36956673860549927, "acc": 0.8520707488059998, "length": 2.7117438316345215, "mode": "test", "epoch": 42}
{"loss": 0.34181496500968933, "acc": 0.8555664420127869, "length": 2.9033360481262207, "mode": "train", "epoch": 43}
{"loss": 0.3533535897731781, "acc": 0.8559808135032654, "length": 2.81850528717041, "mode": "test", "epoch": 43}
{"loss": 0.346236914396286, "acc": 0.8544493913650513, "length": 2.949540853500366, "mode": "train", "epoch": 44}
{"loss": 0.36579030752182007, "acc": 0.8479129076004028, "length": 2.925266981124878, "mode": "test", "epoch": 44}
{"loss": 0.33371609449386597, "acc": 0.8598039746284485, "length": 3.1256425380706787, "mode": "train", "epoch": 45}
{"loss": 0.3396567106246948, "acc": 0.8666151165962219, "length": 3.2028470039367676, "mode": "test", "epoch": 45}
{"loss": 0.3209666907787323, "acc": 0.8671433329582214, "length": 3.2259223461151123, "mode": "train", "epoch": 46}
{"loss": 0.3340279459953308, "acc": 0.8647753000259399, "length": 3.2775800228118896, "mode": "test", "epoch": 46}
{"loss": 0.3176213800907135, "acc": 0.870422899723053, "length": 3.2319207191467285, "mode": "train", "epoch": 47}
{"loss": 0.34240660071372986, "acc": 0.8682990670204163, "length": 3.1387901306152344, "mode": "test", "epoch": 47}
{"loss": 0.31836000084877014, "acc": 0.8657035827636719, "length": 3.152385711669922, "mode": "train", "epoch": 48}
{"loss": 0.32069772481918335, "acc": 0.882256269454956, "length": 3.2135231494903564, "mode": "test", "epoch": 48}
{"loss": 0.3067067265510559, "acc": 0.8717225193977356, "length": 3.2183496952056885, "mode": "train", "epoch": 49}
{"loss": 0.31262290477752686, "acc": 0.8675892949104309, "length": 3.163701057434082, "mode": "test", "epoch": 49}
{"loss": 0.3012222349643707, "acc": 0.873723566532135, "length": 3.205787181854248, "mode": "train", "epoch": 50}
{"loss": 0.3167003095149994, "acc": 0.8696016669273376, "length": 3.263345241546631, "mode": "test", "epoch": 50}
{"loss": 0.29662665724754333, "acc": 0.8751553893089294, "length": 3.2159416675567627, "mode": "train", "epoch": 51}
{"loss": 0.30347561836242676, "acc": 0.8755154609680176, "length": 3.2028470039367676, "mode": "test", "epoch": 51}
{"loss": 0.2855590283870697, "acc": 0.8830928802490234, "length": 3.229217290878296, "mode": "train", "epoch": 52}
{"loss": 0.30035024881362915, "acc": 0.8839102983474731, "length": 3.174377202987671, "mode": "test", "epoch": 52}
{"loss": 0.2800917625427246, "acc": 0.8864170908927917, "length": 3.215343475341797, "mode": "train", "epoch": 53}
{"loss": 0.2887774407863617, "acc": 0.8857531547546387, "length": 3.1352312564849854, "mode": "test", "epoch": 53}
{"loss": 0.2764514684677124, "acc": 0.8897319436073303, "length": 3.1853301525115967, "mode": "train", "epoch": 54}
{"loss": 0.2855905294418335, "acc": 0.888309895992279, "length": 3.1281139850616455, "mode": "test", "epoch": 54}
{"loss": 0.2702008783817291, "acc": 0.893139660358429, "length": 3.22733998298645, "mode": "train", "epoch": 55}
{"loss": 0.27072545886039734, "acc": 0.8940338492393494, "length": 3.099644184112549, "mode": "test", "epoch": 55}
{"loss": 0.26324599981307983, "acc": 0.8962982296943665, "length": 3.156668186187744, "mode": "train", "epoch": 56}
{"loss": 0.2701173424720764, "acc": 0.8883147239685059, "length": 3.0391459465026855, "mode": "test", "epoch": 56}
{"loss": 0.25268083810806274, "acc": 0.9017839431762695, "length": 3.181774854660034, "mode": "train", "epoch": 57}
{"loss": 0.26131802797317505, "acc": 0.8956728577613831, "length": 3.081850528717041, "mode": "test", "epoch": 57}
{"loss": 0.2460710108280182, "acc": 0.9036006331443787, "length": 3.1936206817626953, "mode": "train", "epoch": 58}
{"loss": 0.26246294379234314, "acc": 0.8906906843185425, "length": 3.252669095993042, "mode": "test", "epoch": 58}
{"loss": 0.2515720725059509, "acc": 0.9025999903678894, "length": 3.3185298442840576, "mode": "train", "epoch": 59}
{"loss": 0.24712876975536346, "acc": 0.9077332615852356, "length": 3.2206406593322754, "mode": "test", "epoch": 59}
{"loss": 0.24416014552116394, "acc": 0.9024016857147217, "length": 3.290339469909668, "mode": "train", "epoch": 60}
{"loss": 0.2612918019294739, "acc": 0.8971460461616516, "length": 3.170818567276001, "mode": "test", "epoch": 60}
test accuracy: 0.7641491293907166
