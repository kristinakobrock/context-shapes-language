# ["--attributes=5", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=64", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.97", "--temperature=2"]
Creating train_ds and val_ds...

Creating test_ds...
{"loss": 0.7019029855728149, "acc": 0.5010515451431274, "length": 3.5222041606903076, "mode": "train", "epoch": 1}
{"loss": 0.6883084177970886, "acc": 0.5384891629219055, "length": 1.0, "mode": "test", "epoch": 1}
{"loss": 0.690356433391571, "acc": 0.5325990319252014, "length": 3.2217955589294434, "mode": "train", "epoch": 2}
{"loss": 0.6826564073562622, "acc": 0.5786030292510986, "length": 1.2913669347763062, "mode": "test", "epoch": 2}
{"loss": 0.6699777841567993, "acc": 0.6087228059768677, "length": 3.167915105819702, "mode": "train", "epoch": 3}
{"loss": 0.6142788529396057, "acc": 0.7098994851112366, "length": 3.773381233215332, "mode": "test", "epoch": 3}
{"loss": 0.5961436629295349, "acc": 0.7207156419754028, "length": 3.681915760040283, "mode": "train", "epoch": 4}
{"loss": 0.5749749541282654, "acc": 0.7446043491363525, "length": 4.0, "mode": "test", "epoch": 4}
{"loss": 0.5212489366531372, "acc": 0.762418806552887, "length": 3.8870608806610107, "mode": "train", "epoch": 5}
{"loss": 0.5147518515586853, "acc": 0.7717626690864563, "length": 4.0, "mode": "test", "epoch": 5}
{"loss": 0.47085627913475037, "acc": 0.7974704504013062, "length": 3.933065891265869, "mode": "train", "epoch": 6}
{"loss": 0.4771299362182617, "acc": 0.7895683646202087, "length": 4.0, "mode": "test", "epoch": 6}
{"loss": 0.4263390302658081, "acc": 0.8187695145606995, "length": 3.9510066509246826, "mode": "train", "epoch": 7}
{"loss": 0.43887731432914734, "acc": 0.8055754899978638, "length": 4.0, "mode": "test", "epoch": 7}
{"loss": 0.37834131717681885, "acc": 0.8415944576263428, "length": 3.974128484725952, "mode": "train", "epoch": 8}
{"loss": 0.4253796637058258, "acc": 0.8264389038085938, "length": 4.0, "mode": "test", "epoch": 8}
{"loss": 0.35261070728302, "acc": 0.8497019410133362, "length": 3.985989809036255, "mode": "train", "epoch": 9}
{"loss": 0.40397173166275024, "acc": 0.8176259398460388, "length": 4.0, "mode": "test", "epoch": 9}
{"loss": 0.34163805842399597, "acc": 0.8543374538421631, "length": 3.9903757572174072, "mode": "train", "epoch": 10}
{"loss": 0.374922513961792, "acc": 0.8372302055358887, "length": 4.0, "mode": "test", "epoch": 10}
{"loss": 0.3331853449344635, "acc": 0.8593793511390686, "length": 3.991898536682129, "mode": "train", "epoch": 11}
{"loss": 0.34705889225006104, "acc": 0.8543165922164917, "length": 4.0, "mode": "test", "epoch": 11}
{"loss": 0.31908127665519714, "acc": 0.8656145334243774, "length": 3.9936776161193848, "mode": "train", "epoch": 12}
{"loss": 0.34324318170547485, "acc": 0.8577338457107544, "length": 4.0, "mode": "test", "epoch": 12}
{"loss": 0.3084821403026581, "acc": 0.8716675639152527, "length": 3.9931817054748535, "mode": "train", "epoch": 13}
{"loss": 0.3462960422039032, "acc": 0.853237509727478, "length": 4.0, "mode": "test", "epoch": 13}
{"loss": 0.29854661226272583, "acc": 0.8707029819488525, "length": 3.9969725608825684, "mode": "train", "epoch": 14}
{"loss": 0.3285699486732483, "acc": 0.8665467500686646, "length": 4.0, "mode": "test", "epoch": 14}
{"loss": 0.28131812810897827, "acc": 0.8844566941261292, "length": 3.9972786903381348, "mode": "train", "epoch": 15}
{"loss": 0.3327206075191498, "acc": 0.8649281859397888, "length": 4.0, "mode": "test", "epoch": 15}
{"loss": 0.2651674747467041, "acc": 0.8909893035888672, "length": 3.9967243671417236, "mode": "train", "epoch": 16}
{"loss": 0.3242450952529907, "acc": 0.8591726422309875, "length": 4.0, "mode": "test", "epoch": 16}
{"loss": 0.26026850938796997, "acc": 0.8926331400871277, "length": 3.997279167175293, "mode": "train", "epoch": 17}
{"loss": 0.29426491260528564, "acc": 0.8794965147972107, "length": 4.0, "mode": "test", "epoch": 17}
{"loss": 0.24570278823375702, "acc": 0.8997885584831238, "length": 3.998110771179199, "mode": "train", "epoch": 18}
{"loss": 0.29778534173965454, "acc": 0.8805753588676453, "length": 4.0, "mode": "test", "epoch": 18}
{"loss": 0.22979989647865295, "acc": 0.9045337438583374, "length": 3.998199701309204, "mode": "train", "epoch": 19}
{"loss": 0.28114640712738037, "acc": 0.8859713077545166, "length": 4.0, "mode": "test", "epoch": 19}
{"loss": 0.2203400880098343, "acc": 0.9095210433006287, "length": 3.998257637023926, "mode": "train", "epoch": 20}
{"loss": 0.2822236716747284, "acc": 0.8904677033424377, "length": 4.0, "mode": "test", "epoch": 20}
{"loss": 0.21154959499835968, "acc": 0.9159010648727417, "length": 3.9985313415527344, "mode": "train", "epoch": 21}
{"loss": 0.2692548334598541, "acc": 0.8917266726493835, "length": 4.0, "mode": "test", "epoch": 21}
{"loss": 0.2030487358570099, "acc": 0.9176965355873108, "length": 3.9986038208007812, "mode": "train", "epoch": 22}
{"loss": 0.2551753520965576, "acc": 0.896043062210083, "length": 4.0, "mode": "test", "epoch": 22}
{"loss": 0.20069141685962677, "acc": 0.9216160178184509, "length": 3.9991395473480225, "mode": "train", "epoch": 23}
{"loss": 0.2659132182598114, "acc": 0.8922662138938904, "length": 4.0, "mode": "test", "epoch": 23}
{"loss": 0.19897085428237915, "acc": 0.9181994199752808, "length": 3.9994893074035645, "mode": "train", "epoch": 24}
{"loss": 0.258223295211792, "acc": 0.9008991718292236, "length": 4.0, "mode": "test", "epoch": 24}
{"loss": 0.18583880364894867, "acc": 0.9246834516525269, "length": 3.999359130859375, "mode": "train", "epoch": 25}
{"loss": 0.2558495104312897, "acc": 0.901259183883667, "length": 4.0, "mode": "test", "epoch": 25}
{"loss": 0.18673008680343628, "acc": 0.9288891553878784, "length": 3.9993133544921875, "mode": "train", "epoch": 26}
{"loss": 0.2263781577348709, "acc": 0.9174460172653198, "length": 4.0, "mode": "test", "epoch": 26}
{"loss": 0.18562549352645874, "acc": 0.9270285964012146, "length": 3.9994540214538574, "mode": "train", "epoch": 27}
{"loss": 0.23703093826770782, "acc": 0.9109712839126587, "length": 4.0, "mode": "test", "epoch": 27}
{"loss": 0.1792730689048767, "acc": 0.9273970723152161, "length": 3.9997262954711914, "mode": "train", "epoch": 28}
{"loss": 0.23388230800628662, "acc": 0.9116905927658081, "length": 4.0, "mode": "test", "epoch": 28}
{"loss": 0.17514283955097198, "acc": 0.9313521981239319, "length": 3.999479055404663, "mode": "train", "epoch": 29}
{"loss": 0.22595500946044922, "acc": 0.9199639558792114, "length": 4.0, "mode": "test", "epoch": 29}
{"loss": 0.17592781782150269, "acc": 0.9355542659759521, "length": 3.9992642402648926, "mode": "train", "epoch": 30}
{"loss": 0.22760199010372162, "acc": 0.923920750617981, "length": 4.0, "mode": "test", "epoch": 30}
{"loss": 0.1774856597185135, "acc": 0.9312470555305481, "length": 3.9998207092285156, "mode": "train", "epoch": 31}
{"loss": 0.20070408284664154, "acc": 0.9232014417648315, "length": 4.0, "mode": "test", "epoch": 31}
{"loss": 0.16816994547843933, "acc": 0.9373136758804321, "length": 3.999739170074463, "mode": "train", "epoch": 32}
{"loss": 0.22592292726039886, "acc": 0.9242805242538452, "length": 4.0, "mode": "test", "epoch": 32}
{"loss": 0.17452172935009003, "acc": 0.9323276877403259, "length": 3.9997270107269287, "mode": "train", "epoch": 33}
{"loss": 0.20512492954730988, "acc": 0.9282374978065491, "length": 4.0, "mode": "test", "epoch": 33}
{"loss": 0.16036176681518555, "acc": 0.9411030411720276, "length": 3.999868631362915, "mode": "train", "epoch": 34}
{"loss": 0.18669891357421875, "acc": 0.933633029460907, "length": 4.0, "mode": "test", "epoch": 34}
{"loss": 0.1570546180009842, "acc": 0.9403132796287537, "length": 3.9995875358581543, "mode": "train", "epoch": 35}
{"loss": 0.19596432149410248, "acc": 0.9250000715255737, "length": 4.0, "mode": "test", "epoch": 35}
{"loss": 0.14994847774505615, "acc": 0.9463328719139099, "length": 3.9999537467956543, "mode": "train", "epoch": 36}
{"loss": 0.17223015427589417, "acc": 0.9402877688407898, "length": 4.0, "mode": "test", "epoch": 36}
{"loss": 0.1500096321105957, "acc": 0.9426050186157227, "length": 3.9998743534088135, "mode": "train", "epoch": 37}
{"loss": 0.18814967572689056, "acc": 0.9314748644828796, "length": 4.0, "mode": "test", "epoch": 37}
{"loss": 0.15212975442409515, "acc": 0.9426677227020264, "length": 3.9999797344207764, "mode": "train", "epoch": 38}
{"loss": 0.18362687528133392, "acc": 0.9366905093193054, "length": 4.0, "mode": "test", "epoch": 38}
{"loss": 0.1573769599199295, "acc": 0.9415245652198792, "length": 3.999924898147583, "mode": "train", "epoch": 39}
{"loss": 0.1877102106809616, "acc": 0.9392086267471313, "length": 4.0, "mode": "test", "epoch": 39}
{"loss": 0.15090441703796387, "acc": 0.947054922580719, "length": 3.9999890327453613, "mode": "train", "epoch": 40}
{"loss": 0.18437205255031586, "acc": 0.9356114268302917, "length": 4.0, "mode": "test", "epoch": 40}
{"loss": 0.14696235954761505, "acc": 0.9441813230514526, "length": 3.9984421730041504, "mode": "train", "epoch": 41}
{"loss": 0.16946636140346527, "acc": 0.9426259398460388, "length": 4.0, "mode": "test", "epoch": 41}
{"loss": 0.14412234723567963, "acc": 0.9478772878646851, "length": 3.9987897872924805, "mode": "train", "epoch": 42}
{"loss": 0.17269930243492126, "acc": 0.940827488899231, "length": 4.0, "mode": "test", "epoch": 42}
{"loss": 0.13470372557640076, "acc": 0.9523529410362244, "length": 3.99879789352417, "mode": "train", "epoch": 43}
{"loss": 0.15664753317832947, "acc": 0.9500001072883606, "length": 4.0, "mode": "test", "epoch": 43}
{"loss": 0.12922413647174835, "acc": 0.9539632201194763, "length": 3.9979233741760254, "mode": "train", "epoch": 44}
{"loss": 0.151268869638443, "acc": 0.9507194757461548, "length": 4.0, "mode": "test", "epoch": 44}
{"loss": 0.1348671019077301, "acc": 0.9527617692947388, "length": 3.9998865127563477, "mode": "train", "epoch": 45}
{"loss": 0.16325168311595917, "acc": 0.9410071969032288, "length": 4.0, "mode": "test", "epoch": 45}
{"loss": 0.13184204697608948, "acc": 0.9528154134750366, "length": 3.9996249675750732, "mode": "train", "epoch": 46}
{"loss": 0.16492274403572083, "acc": 0.9498201012611389, "length": 4.0, "mode": "test", "epoch": 46}
{"loss": 0.12061930447816849, "acc": 0.9570302367210388, "length": 3.9999547004699707, "mode": "train", "epoch": 47}
{"loss": 0.17941966652870178, "acc": 0.9435252547264099, "length": 4.0, "mode": "test", "epoch": 47}
{"loss": 0.12217854708433151, "acc": 0.9556471109390259, "length": 3.9999241828918457, "mode": "train", "epoch": 48}
{"loss": 0.17309395968914032, "acc": 0.9406474828720093, "length": 4.0, "mode": "test", "epoch": 48}
{"loss": 0.12033853679895401, "acc": 0.9562472701072693, "length": 3.9998927116394043, "mode": "train", "epoch": 49}
{"loss": 0.16144810616970062, "acc": 0.9498201012611389, "length": 4.0, "mode": "test", "epoch": 49}
{"loss": 0.120221808552742, "acc": 0.9587138295173645, "length": 3.9999961853027344, "mode": "train", "epoch": 50}
{"loss": 0.1761603057384491, "acc": 0.943705141544342, "length": 4.0, "mode": "test", "epoch": 50}
{"loss": 0.12190274894237518, "acc": 0.9563699960708618, "length": 3.999995231628418, "mode": "train", "epoch": 51}
{"loss": 0.15116152167320251, "acc": 0.946402907371521, "length": 4.0, "mode": "test", "epoch": 51}
{"loss": 0.12084966897964478, "acc": 0.9561894536018372, "length": 3.999983549118042, "mode": "train", "epoch": 52}
{"loss": 0.14549285173416138, "acc": 0.9473020434379578, "length": 4.0, "mode": "test", "epoch": 52}
{"loss": 0.11586825549602509, "acc": 0.9591946005821228, "length": 3.9999983310699463, "mode": "train", "epoch": 53}
{"loss": 0.16386093199253082, "acc": 0.9498201012611389, "length": 4.0, "mode": "test", "epoch": 53}
{"loss": 0.10835888981819153, "acc": 0.9615370035171509, "length": 3.9999570846557617, "mode": "train", "epoch": 54}
{"loss": 0.16002574563026428, "acc": 0.9498202204704285, "length": 4.0, "mode": "test", "epoch": 54}
{"loss": 0.10850788652896881, "acc": 0.964175283908844, "length": 3.999760866165161, "mode": "train", "epoch": 55}
{"loss": 0.1398204118013382, "acc": 0.9505395889282227, "length": 4.0, "mode": "test", "epoch": 55}
{"loss": 0.10669179260730743, "acc": 0.9629035592079163, "length": 3.9991276264190674, "mode": "train", "epoch": 56}
{"loss": 0.15098656713962555, "acc": 0.9489208459854126, "length": 4.0, "mode": "test", "epoch": 56}
{"loss": 0.10401946306228638, "acc": 0.9634013772010803, "length": 3.999997138977051, "mode": "train", "epoch": 57}
{"loss": 0.15092819929122925, "acc": 0.9473021626472473, "length": 4.0, "mode": "test", "epoch": 57}
{"loss": 0.10957928001880646, "acc": 0.9614776372909546, "length": 3.999850273132324, "mode": "train", "epoch": 58}
{"loss": 0.15727947652339935, "acc": 0.9474819898605347, "length": 4.0, "mode": "test", "epoch": 58}
{"loss": 0.10187070816755295, "acc": 0.9621992707252502, "length": 3.9999847412109375, "mode": "train", "epoch": 59}
{"loss": 0.15696410834789276, "acc": 0.9510791301727295, "length": 4.0, "mode": "test", "epoch": 59}
{"loss": 0.10618342459201813, "acc": 0.9603344202041626, "length": 3.9999208450317383, "mode": "train", "epoch": 60}
{"loss": 0.1478966474533081, "acc": 0.9482013583183289, "length": 4.0, "mode": "test", "epoch": 60}
test accuracy: 0.8877273201942444
