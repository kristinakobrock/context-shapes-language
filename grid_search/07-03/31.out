# ["--attributes=3", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=64", "--learning_rate=0.0005", "--hidden_size=256", "--temp_update=0.97", "--temperature=1.5"]
Creating train_ds and val_ds...

Creating test_ds...
{"loss": 0.7015249729156494, "acc": 0.511069655418396, "length": 3.3659749031066895, "mode": "train", "epoch": 1}
{"loss": 0.697390615940094, "acc": 0.5176677107810974, "length": 1.0, "mode": "test", "epoch": 1}
{"loss": 0.6931727528572083, "acc": 0.5213630199432373, "length": 2.162287473678589, "mode": "train", "epoch": 2}
{"loss": 0.6913036704063416, "acc": 0.5119727849960327, "length": 1.0388692617416382, "mode": "test", "epoch": 2}
{"loss": 0.6521672606468201, "acc": 0.6287462115287781, "length": 2.079802989959717, "mode": "train", "epoch": 3}
{"loss": 0.6207912564277649, "acc": 0.6822888851165771, "length": 1.9469964504241943, "mode": "test", "epoch": 3}
{"loss": 0.5876988172531128, "acc": 0.7027088403701782, "length": 2.2416341304779053, "mode": "train", "epoch": 4}
{"loss": 0.5603222250938416, "acc": 0.7400153875350952, "length": 2.289752721786499, "mode": "test", "epoch": 4}
{"loss": 0.5322878360748291, "acc": 0.7513406872749329, "length": 2.454655885696411, "mode": "train", "epoch": 5}
{"loss": 0.5233771204948425, "acc": 0.756273627281189, "length": 2.4734983444213867, "mode": "test", "epoch": 5}
{"loss": 0.47635093331336975, "acc": 0.7897598743438721, "length": 2.7967162132263184, "mode": "train", "epoch": 6}
{"loss": 0.4507980942726135, "acc": 0.7928548455238342, "length": 3.2367491722106934, "mode": "test", "epoch": 6}
{"loss": 0.41321271657943726, "acc": 0.824537992477417, "length": 3.2645535469055176, "mode": "train", "epoch": 7}
{"loss": 0.42005711793899536, "acc": 0.8250484466552734, "length": 3.650176763534546, "mode": "test", "epoch": 7}
{"loss": 0.365731418132782, "acc": 0.8463568687438965, "length": 3.4633805751800537, "mode": "train", "epoch": 8}
{"loss": 0.42266541719436646, "acc": 0.8439045548439026, "length": 3.9045937061309814, "mode": "test", "epoch": 8}
{"loss": 0.3297807276248932, "acc": 0.8677564859390259, "length": 3.6412951946258545, "mode": "train", "epoch": 9}
{"loss": 0.3846820890903473, "acc": 0.8507426381111145, "length": 3.79858660697937, "mode": "test", "epoch": 9}
{"loss": 0.2939222753047943, "acc": 0.8891774415969849, "length": 3.7212836742401123, "mode": "train", "epoch": 10}
{"loss": 0.38101866841316223, "acc": 0.8515238761901855, "length": 3.840989351272583, "mode": "test", "epoch": 10}
{"loss": 0.28120937943458557, "acc": 0.8857355117797852, "length": 3.6649575233459473, "mode": "train", "epoch": 11}
{"loss": 0.3987552225589752, "acc": 0.8447273969650269, "length": 3.8727915287017822, "mode": "test", "epoch": 11}
{"loss": 0.2674194574356079, "acc": 0.8954083919525146, "length": 3.6205313205718994, "mode": "train", "epoch": 12}
{"loss": 0.35426732897758484, "acc": 0.8503588438034058, "length": 3.88692569732666, "mode": "test", "epoch": 12}
{"loss": 0.2569129168987274, "acc": 0.9007381796836853, "length": 3.7052414417266846, "mode": "train", "epoch": 13}
{"loss": 0.30877071619033813, "acc": 0.8825695514678955, "length": 3.883392333984375, "mode": "test", "epoch": 13}
{"loss": 0.2309989333152771, "acc": 0.9087285399436951, "length": 3.7398457527160645, "mode": "train", "epoch": 14}
{"loss": 0.3046896159648895, "acc": 0.8839828968048096, "length": 3.7915194034576416, "mode": "test", "epoch": 14}
{"loss": 0.21936790645122528, "acc": 0.9170836210250854, "length": 3.6926071643829346, "mode": "train", "epoch": 15}
{"loss": 0.30022183060646057, "acc": 0.8781386613845825, "length": 3.8904592990875244, "mode": "test", "epoch": 15}
{"loss": 0.20529943704605103, "acc": 0.9222211837768555, "length": 3.7720673084259033, "mode": "train", "epoch": 16}
{"loss": 0.27509188652038574, "acc": 0.8908872604370117, "length": 3.8374557495117188, "mode": "test", "epoch": 16}
{"loss": 0.20130103826522827, "acc": 0.9267436265945435, "length": 3.7840449810028076, "mode": "train", "epoch": 17}
{"loss": 0.2458585500717163, "acc": 0.8987659811973572, "length": 3.88692569732666, "mode": "test", "epoch": 17}
{"loss": 0.18526825308799744, "acc": 0.9303344488143921, "length": 3.832432746887207, "mode": "train", "epoch": 18}
{"loss": 0.23855631053447723, "acc": 0.9096041321754456, "length": 3.9045937061309814, "mode": "test", "epoch": 18}
{"loss": 0.1810794174671173, "acc": 0.9335117936134338, "length": 3.852802276611328, "mode": "train", "epoch": 19}
{"loss": 0.2125951051712036, "acc": 0.9183109998703003, "length": 3.8763251304626465, "mode": "test", "epoch": 19}
{"loss": 0.1744290143251419, "acc": 0.9339796304702759, "length": 3.8248491287231445, "mode": "train", "epoch": 20}
{"loss": 0.2082372009754181, "acc": 0.9265955090522766, "length": 3.8445229530334473, "mode": "test", "epoch": 20}
{"loss": 0.1569763720035553, "acc": 0.9392710328102112, "length": 3.85638427734375, "mode": "train", "epoch": 21}
{"loss": 0.18036650121212006, "acc": 0.9340714812278748, "length": 3.8939929008483887, "mode": "test", "epoch": 21}
{"loss": 0.15330806374549866, "acc": 0.9422830939292908, "length": 3.8563332557678223, "mode": "train", "epoch": 22}
{"loss": 0.16810618340969086, "acc": 0.9457212090492249, "length": 3.883392333984375, "mode": "test", "epoch": 22}
{"loss": 0.14857298135757446, "acc": 0.9447175860404968, "length": 3.860370397567749, "mode": "train", "epoch": 23}
{"loss": 0.14197398722171783, "acc": 0.9536440968513489, "length": 3.897526502609253, "mode": "test", "epoch": 23}
{"loss": 0.13163959980010986, "acc": 0.9516571164131165, "length": 3.8912620544433594, "mode": "train", "epoch": 24}
{"loss": 0.1678493469953537, "acc": 0.9411411881446838, "length": 3.901060104370117, "mode": "test", "epoch": 24}
{"loss": 0.12650758028030396, "acc": 0.9521768093109131, "length": 3.857940673828125, "mode": "train", "epoch": 25}
{"loss": 0.13768678903579712, "acc": 0.9564045071601868, "length": 3.869257926940918, "mode": "test", "epoch": 25}
{"loss": 0.12505006790161133, "acc": 0.9544285535812378, "length": 3.876631498336792, "mode": "train", "epoch": 26}
{"loss": 0.1445900946855545, "acc": 0.9566006660461426, "length": 3.8727915287017822, "mode": "test", "epoch": 26}
{"loss": 0.11218811571598053, "acc": 0.9594708681106567, "length": 3.8678970336914062, "mode": "train", "epoch": 27}
{"loss": 0.11253621429204941, "acc": 0.9626269936561584, "length": 3.8586573600769043, "mode": "test", "epoch": 27}
{"loss": 0.1067076250910759, "acc": 0.9609361290931702, "length": 3.8884522914886475, "mode": "train", "epoch": 28}
{"loss": 0.10247226059436798, "acc": 0.9688522219657898, "length": 3.915194272994995, "mode": "test", "epoch": 28}
{"loss": 0.10091709345579147, "acc": 0.9637161493301392, "length": 3.9091382026672363, "mode": "train", "epoch": 29}
{"loss": 0.12905903160572052, "acc": 0.9652246236801147, "length": 3.9328622817993164, "mode": "test", "epoch": 29}
{"loss": 0.10090116411447525, "acc": 0.9627358317375183, "length": 3.8833987712860107, "mode": "train", "epoch": 30}
{"loss": 0.09757091104984283, "acc": 0.9733242988586426, "length": 3.8763251304626465, "mode": "test", "epoch": 30}
{"loss": 0.07995875924825668, "acc": 0.972179651260376, "length": 3.880652904510498, "mode": "train", "epoch": 31}
{"loss": 0.0816342681646347, "acc": 0.9740061163902283, "length": 3.8727915287017822, "mode": "test", "epoch": 31}
{"loss": 0.07572872936725616, "acc": 0.973233163356781, "length": 3.886312246322632, "mode": "train", "epoch": 32}
{"loss": 0.10132322460412979, "acc": 0.9704174399375916, "length": 3.968197822570801, "mode": "test", "epoch": 32}
{"loss": 0.07226797193288803, "acc": 0.9754324555397034, "length": 3.9437148571014404, "mode": "train", "epoch": 33}
{"loss": 0.09808946400880814, "acc": 0.9670245051383972, "length": 3.939929246902466, "mode": "test", "epoch": 33}
{"loss": 0.08406690508127213, "acc": 0.9725838303565979, "length": 3.9023633003234863, "mode": "train", "epoch": 34}
{"loss": 0.08792512863874435, "acc": 0.9695643782615662, "length": 3.925795078277588, "mode": "test", "epoch": 34}
{"loss": 0.07613520324230194, "acc": 0.9748880863189697, "length": 3.928947925567627, "mode": "train", "epoch": 35}
{"loss": 0.08906950801610947, "acc": 0.9716818332672119, "length": 3.9328622817993164, "mode": "test", "epoch": 35}
{"loss": 0.08546601235866547, "acc": 0.9717836976051331, "length": 3.9182379245758057, "mode": "train", "epoch": 36}
{"loss": 0.07569914311170578, "acc": 0.9790012240409851, "length": 3.897526502609253, "mode": "test", "epoch": 36}
{"loss": 0.08058963716030121, "acc": 0.9742609858512878, "length": 3.8960165977478027, "mode": "train", "epoch": 37}
{"loss": 0.07463468611240387, "acc": 0.9767645597457886, "length": 3.901060104370117, "mode": "test", "epoch": 37}
{"loss": 0.06644576787948608, "acc": 0.9767459630966187, "length": 3.924628257751465, "mode": "train", "epoch": 38}
{"loss": 0.10055162757635117, "acc": 0.9697383046150208, "length": 3.9363956451416016, "mode": "test", "epoch": 38}
{"loss": 0.0630008801817894, "acc": 0.9764046669006348, "length": 3.9234983921051025, "mode": "train", "epoch": 39}
{"loss": 0.06093400716781616, "acc": 0.98492431640625, "length": 3.94346284866333, "mode": "test", "epoch": 39}
{"loss": 0.0597987100481987, "acc": 0.9813276529312134, "length": 3.943145275115967, "mode": "train", "epoch": 40}
{"loss": 0.08220918476581573, "acc": 0.9755438566207886, "length": 3.9469964504241943, "mode": "test", "epoch": 40}
{"loss": 0.07129357010126114, "acc": 0.9774976968765259, "length": 3.9190220832824707, "mode": "train", "epoch": 41}
{"loss": 0.10770678520202637, "acc": 0.9713973999023438, "length": 3.9505300521850586, "mode": "test", "epoch": 41}
{"loss": 0.06732654571533203, "acc": 0.9772780537605286, "length": 3.9417314529418945, "mode": "train", "epoch": 42}
{"loss": 0.07954265177249908, "acc": 0.975582480430603, "length": 3.94346284866333, "mode": "test", "epoch": 42}
{"loss": 0.06060215085744858, "acc": 0.9788128137588501, "length": 3.946672201156616, "mode": "train", "epoch": 43}
{"loss": 0.07414010167121887, "acc": 0.9796101450920105, "length": 3.968197822570801, "mode": "test", "epoch": 43}
{"loss": 0.0518764965236187, "acc": 0.9805586934089661, "length": 3.966092586517334, "mode": "train", "epoch": 44}
{"loss": 0.09237895160913467, "acc": 0.9757481217384338, "length": 3.94346284866333, "mode": "test", "epoch": 44}
{"loss": 0.05980851128697395, "acc": 0.9819605946540833, "length": 3.9397430419921875, "mode": "train", "epoch": 45}
{"loss": 0.0756259337067604, "acc": 0.9757921099662781, "length": 3.929328680038452, "mode": "test", "epoch": 45}
{"loss": 0.04788907244801521, "acc": 0.9826120138168335, "length": 3.9364819526672363, "mode": "train", "epoch": 46}
{"loss": 0.06389427930116653, "acc": 0.9802672863006592, "length": 3.925795078277588, "mode": "test", "epoch": 46}
{"loss": 0.06810320168733597, "acc": 0.9788690209388733, "length": 3.941260576248169, "mode": "train", "epoch": 47}
{"loss": 0.09390272200107574, "acc": 0.9753368496894836, "length": 3.954063653945923, "mode": "test", "epoch": 47}
{"loss": 0.06315542757511139, "acc": 0.9809249043464661, "length": 3.922091007232666, "mode": "train", "epoch": 48}
{"loss": 0.07516021281480789, "acc": 0.9782712459564209, "length": 3.929328680038452, "mode": "test", "epoch": 48}
{"loss": 0.05906061828136444, "acc": 0.9824735522270203, "length": 3.93581485748291, "mode": "train", "epoch": 49}
{"loss": 0.07817782461643219, "acc": 0.9756293892860413, "length": 3.9505300521850586, "mode": "test", "epoch": 49}
{"loss": 0.04608094319701195, "acc": 0.9880101084709167, "length": 3.9482107162475586, "mode": "train", "epoch": 50}
{"loss": 0.07155323773622513, "acc": 0.9762726426124573, "length": 3.954063653945923, "mode": "test", "epoch": 50}
{"loss": 0.060708362609148026, "acc": 0.9771967530250549, "length": 3.959947109222412, "mode": "train", "epoch": 51}
{"loss": 0.08121421933174133, "acc": 0.9766674041748047, "length": 3.9469964504241943, "mode": "test", "epoch": 51}
{"loss": 0.05919703096151352, "acc": 0.9803217649459839, "length": 3.9544460773468018, "mode": "train", "epoch": 52}
{"loss": 0.07888853549957275, "acc": 0.9812554121017456, "length": 3.94346284866333, "mode": "test", "epoch": 52}
{"loss": 0.054848093539476395, "acc": 0.9835706353187561, "length": 3.930213451385498, "mode": "train", "epoch": 53}
{"loss": 0.08894889801740646, "acc": 0.977288544178009, "length": 3.9187278747558594, "mode": "test", "epoch": 53}
{"loss": 0.04011746868491173, "acc": 0.9879239201545715, "length": 3.9137675762176514, "mode": "train", "epoch": 54}
{"loss": 0.06103077158331871, "acc": 0.9840217232704163, "length": 3.939929246902466, "mode": "test", "epoch": 54}
{"loss": 0.03826894611120224, "acc": 0.9882050156593323, "length": 3.946573495864868, "mode": "train", "epoch": 55}
{"loss": 0.07691957801580429, "acc": 0.9814929962158203, "length": 3.9646642208099365, "mode": "test", "epoch": 55}
{"loss": 0.04055763781070709, "acc": 0.987959086894989, "length": 3.968229055404663, "mode": "train", "epoch": 56}
{"loss": 0.046441029757261276, "acc": 0.9903932213783264, "length": 3.971731424331665, "mode": "test", "epoch": 56}
{"loss": 0.0429341122508049, "acc": 0.9869350790977478, "length": 3.963989019393921, "mode": "train", "epoch": 57}
{"loss": 0.04332255944609642, "acc": 0.9881542325019836, "length": 3.9469964504241943, "mode": "test", "epoch": 57}
{"loss": 0.05514877289533615, "acc": 0.9830326437950134, "length": 3.95354962348938, "mode": "train", "epoch": 58}
{"loss": 0.05309082940220833, "acc": 0.9853937029838562, "length": 3.971731424331665, "mode": "test", "epoch": 58}
{"loss": 0.04217752069234848, "acc": 0.9868914484977722, "length": 3.9696314334869385, "mode": "train", "epoch": 59}
{"loss": 0.07646500319242477, "acc": 0.9803861379623413, "length": 3.957597255706787, "mode": "test", "epoch": 59}
{"loss": 0.041470881551504135, "acc": 0.9868407845497131, "length": 3.955751657485962, "mode": "train", "epoch": 60}
{"loss": 0.07150726020336151, "acc": 0.9808940291404724, "length": 3.954063653945923, "mode": "test", "epoch": 60}
test accuracy: 0.8862853050231934
