# ["--attributes=3", "--values=16", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=64", "--learning_rate=0.001", "--hidden_size=256", "--temp_update=0.99", "--temperature=1"]
Creating train_ds and val_ds...

Creating test_ds...
{"loss": 0.7029812335968018, "acc": 0.5063501000404358, "length": 2.4481399059295654, "mode": "train", "epoch": 1}
{"loss": 0.6926414370536804, "acc": 0.5276978015899658, "length": 1.0, "mode": "test", "epoch": 1}
{"loss": 0.6520149111747742, "acc": 0.6161685585975647, "length": 2.1197471618652344, "mode": "train", "epoch": 2}
{"loss": 0.5619825720787048, "acc": 0.7486791610717773, "length": 2.920863389968872, "mode": "test", "epoch": 2}
{"loss": 0.5247471332550049, "acc": 0.7453016638755798, "length": 2.9508743286132812, "mode": "train", "epoch": 3}
{"loss": 0.4865961968898773, "acc": 0.8034632802009583, "length": 3.2338130474090576, "mode": "test", "epoch": 3}
{"loss": 0.4428739845752716, "acc": 0.8026444315910339, "length": 3.2994914054870605, "mode": "train", "epoch": 4}
{"loss": 0.44691070914268494, "acc": 0.8016713261604309, "length": 3.2553956508636475, "mode": "test", "epoch": 4}
{"loss": 0.4023001790046692, "acc": 0.8275729417800903, "length": 3.3199009895324707, "mode": "train", "epoch": 5}
{"loss": 0.4048624634742737, "acc": 0.837685763835907, "length": 3.2769784927368164, "mode": "test", "epoch": 5}
{"loss": 0.36628782749176025, "acc": 0.8496652245521545, "length": 3.4013216495513916, "mode": "train", "epoch": 6}
{"loss": 0.3622775673866272, "acc": 0.8526996374130249, "length": 3.341726541519165, "mode": "test", "epoch": 6}
{"loss": 0.33026307821273804, "acc": 0.8612684607505798, "length": 3.414118766784668, "mode": "train", "epoch": 7}
{"loss": 0.342863529920578, "acc": 0.8583291172981262, "length": 3.611510753631592, "mode": "test", "epoch": 7}
{"loss": 0.29151636362075806, "acc": 0.8858604431152344, "length": 3.5507445335388184, "mode": "train", "epoch": 8}
{"loss": 0.3046537935733795, "acc": 0.8737612366676331, "length": 3.535971164703369, "mode": "test", "epoch": 8}
{"loss": 0.26500385999679565, "acc": 0.896533727645874, "length": 3.6183390617370605, "mode": "train", "epoch": 9}
{"loss": 0.29868537187576294, "acc": 0.8877148032188416, "length": 3.589928150177002, "mode": "test", "epoch": 9}
{"loss": 0.24237549304962158, "acc": 0.9028195738792419, "length": 3.667466878890991, "mode": "train", "epoch": 10}
{"loss": 0.2747696340084076, "acc": 0.8938769102096558, "length": 3.611510753631592, "mode": "test", "epoch": 10}
{"loss": 0.23149359226226807, "acc": 0.9145783185958862, "length": 3.6825711727142334, "mode": "train", "epoch": 11}
{"loss": 0.26571235060691833, "acc": 0.9000962972640991, "length": 3.6438848972320557, "mode": "test", "epoch": 11}
{"loss": 0.20420537889003754, "acc": 0.9209457039833069, "length": 3.684983730316162, "mode": "train", "epoch": 12}
{"loss": 0.2345302402973175, "acc": 0.9164195656776428, "length": 3.546762704849243, "mode": "test", "epoch": 12}
{"loss": 0.18821103870868683, "acc": 0.9306153655052185, "length": 3.6717169284820557, "mode": "train", "epoch": 13}
{"loss": 0.22362299263477325, "acc": 0.9198950529098511, "length": 3.5827338695526123, "mode": "test", "epoch": 13}
{"loss": 0.182864710688591, "acc": 0.9293883442878723, "length": 3.6709353923797607, "mode": "train", "epoch": 14}
{"loss": 0.22369837760925293, "acc": 0.9119961857795715, "length": 3.5971221923828125, "mode": "test", "epoch": 14}
{"loss": 0.16984690725803375, "acc": 0.937881350517273, "length": 3.7290196418762207, "mode": "train", "epoch": 15}
{"loss": 0.19701936841011047, "acc": 0.9295130372047424, "length": 3.5935251712799072, "mode": "test", "epoch": 15}
{"loss": 0.1615397036075592, "acc": 0.9373610019683838, "length": 3.7186381816864014, "mode": "train", "epoch": 16}
{"loss": 0.1991215944290161, "acc": 0.9248366355895996, "length": 3.741007089614868, "mode": "test", "epoch": 16}
{"loss": 0.15411707758903503, "acc": 0.9398794770240784, "length": 3.7170610427856445, "mode": "train", "epoch": 17}
{"loss": 0.20512492954730988, "acc": 0.9284024834632874, "length": 3.615108013153076, "mode": "test", "epoch": 17}
{"loss": 0.14152251183986664, "acc": 0.9463233947753906, "length": 3.709869146347046, "mode": "train", "epoch": 18}
{"loss": 0.16484539210796356, "acc": 0.9380978345870972, "length": 3.579136610031128, "mode": "test", "epoch": 18}
{"loss": 0.14145846664905548, "acc": 0.947411298751831, "length": 3.677427053451538, "mode": "train", "epoch": 19}
{"loss": 0.1851346343755722, "acc": 0.9234594702720642, "length": 3.604316473007202, "mode": "test", "epoch": 19}
{"loss": 0.13846293091773987, "acc": 0.9464607238769531, "length": 3.6999335289001465, "mode": "train", "epoch": 20}
{"loss": 0.1657719761133194, "acc": 0.9379679560661316, "length": 3.8129496574401855, "mode": "test", "epoch": 20}
{"loss": 0.1273168921470642, "acc": 0.9512305855751038, "length": 3.7385737895965576, "mode": "train", "epoch": 21}
{"loss": 0.17228995263576508, "acc": 0.9301912784576416, "length": 3.6402878761291504, "mode": "test", "epoch": 21}
{"loss": 0.11688254773616791, "acc": 0.9558645486831665, "length": 3.7742161750793457, "mode": "train", "epoch": 22}
{"loss": 0.13567180931568146, "acc": 0.9499532580375671, "length": 3.737410068511963, "mode": "test", "epoch": 22}
{"loss": 0.11979120969772339, "acc": 0.9516271352767944, "length": 3.7261667251586914, "mode": "train", "epoch": 23}
{"loss": 0.14555826783180237, "acc": 0.9355055093765259, "length": 3.7230215072631836, "mode": "test", "epoch": 23}
{"loss": 0.11650536209344864, "acc": 0.9552687406539917, "length": 3.7416701316833496, "mode": "train", "epoch": 24}
{"loss": 0.12661422789096832, "acc": 0.9542631506919861, "length": 3.636690616607666, "mode": "test", "epoch": 24}
{"loss": 0.11642909795045853, "acc": 0.9555695056915283, "length": 3.739565849304199, "mode": "train", "epoch": 25}
{"loss": 0.14051233232021332, "acc": 0.9545280337333679, "length": 3.7230215072631836, "mode": "test", "epoch": 25}
{"loss": 0.11137288063764572, "acc": 0.9551302194595337, "length": 3.7229042053222656, "mode": "train", "epoch": 26}
{"loss": 0.12031270563602448, "acc": 0.9592347741127014, "length": 3.6654677391052246, "mode": "test", "epoch": 26}
{"loss": 0.09575402736663818, "acc": 0.9626985192298889, "length": 3.764547109603882, "mode": "train", "epoch": 27}
{"loss": 0.114592544734478, "acc": 0.9538671970367432, "length": 3.7230215072631836, "mode": "test", "epoch": 27}
{"loss": 0.09430091828107834, "acc": 0.964314341545105, "length": 3.7861807346343994, "mode": "train", "epoch": 28}
{"loss": 0.10905592888593674, "acc": 0.9610603451728821, "length": 3.726618766784668, "mode": "test", "epoch": 28}
{"loss": 0.09389904141426086, "acc": 0.9651287794113159, "length": 3.781592845916748, "mode": "train", "epoch": 29}
{"loss": 0.105008564889431, "acc": 0.9607817530632019, "length": 3.741007089614868, "mode": "test", "epoch": 29}
{"loss": 0.09253878146409988, "acc": 0.9644730687141418, "length": 3.782078742980957, "mode": "train", "epoch": 30}
{"loss": 0.1439783126115799, "acc": 0.9478852152824402, "length": 3.7230215072631836, "mode": "test", "epoch": 30}
{"loss": 0.0958750918507576, "acc": 0.9645384550094604, "length": 3.7457785606384277, "mode": "train", "epoch": 31}
{"loss": 0.09738867729902267, "acc": 0.9634287357330322, "length": 3.694244623184204, "mode": "test", "epoch": 31}
{"loss": 0.08477340638637543, "acc": 0.9663665294647217, "length": 3.77632737159729, "mode": "train", "epoch": 32}
{"loss": 0.1211295947432518, "acc": 0.9591984152793884, "length": 3.751798629760742, "mode": "test", "epoch": 32}
{"loss": 0.09113886952400208, "acc": 0.9662319421768188, "length": 3.8037266731262207, "mode": "train", "epoch": 33}
{"loss": 0.12912794947624207, "acc": 0.9555356502532959, "length": 3.7805755138397217, "mode": "test", "epoch": 33}
{"loss": 0.09251479059457779, "acc": 0.9657256007194519, "length": 3.8107807636260986, "mode": "train", "epoch": 34}
{"loss": 0.12776722013950348, "acc": 0.9526523351669312, "length": 3.751798629760742, "mode": "test", "epoch": 34}
{"loss": 0.07407823950052261, "acc": 0.9723021388053894, "length": 3.793020725250244, "mode": "train", "epoch": 35}
{"loss": 0.09393666684627533, "acc": 0.9662712812423706, "length": 3.741007089614868, "mode": "test", "epoch": 35}
{"loss": 0.07301117479801178, "acc": 0.9725257158279419, "length": 3.815324544906616, "mode": "train", "epoch": 36}
{"loss": 0.11081992834806442, "acc": 0.9605148434638977, "length": 3.83093523979187, "mode": "test", "epoch": 36}
{"loss": 0.0809544250369072, "acc": 0.9692373871803284, "length": 3.833737373352051, "mode": "train", "epoch": 37}
{"loss": 0.08607099205255508, "acc": 0.9662051796913147, "length": 3.8021583557128906, "mode": "test", "epoch": 37}
{"loss": 0.07890211045742035, "acc": 0.9703659415245056, "length": 3.810452699661255, "mode": "train", "epoch": 38}
{"loss": 0.09166213124990463, "acc": 0.9648035764694214, "length": 3.805755376815796, "mode": "test", "epoch": 38}
{"loss": 0.0706997662782669, "acc": 0.9728806018829346, "length": 3.8441903591156006, "mode": "train", "epoch": 39}
{"loss": 0.13082662224769592, "acc": 0.9554092288017273, "length": 3.8561151027679443, "mode": "test", "epoch": 39}
{"loss": 0.06705249100923538, "acc": 0.9730281829833984, "length": 3.8647031784057617, "mode": "train", "epoch": 40}
{"loss": 0.07648510485887527, "acc": 0.9716742038726807, "length": 3.852518081665039, "mode": "test", "epoch": 40}
{"loss": 0.0719297006726265, "acc": 0.972270131111145, "length": 3.846275568008423, "mode": "train", "epoch": 41}
{"loss": 0.08276907354593277, "acc": 0.9725602865219116, "length": 3.8381295204162598, "mode": "test", "epoch": 41}
{"loss": 0.06725146621465683, "acc": 0.9738765358924866, "length": 3.8235762119293213, "mode": "train", "epoch": 42}
{"loss": 0.07200386375188828, "acc": 0.9724763035774231, "length": 3.895683526992798, "mode": "test", "epoch": 42}
{"loss": 0.07171215862035751, "acc": 0.9721851944923401, "length": 3.857914924621582, "mode": "train", "epoch": 43}
{"loss": 0.08038756996393204, "acc": 0.9691043496131897, "length": 3.8669064044952393, "mode": "test", "epoch": 43}
{"loss": 0.06945642083883286, "acc": 0.971675455570221, "length": 3.854842185974121, "mode": "train", "epoch": 44}
{"loss": 0.08236944675445557, "acc": 0.9732358455657959, "length": 3.863309383392334, "mode": "test", "epoch": 44}
{"loss": 0.08257666230201721, "acc": 0.9717686176300049, "length": 3.835874080657959, "mode": "train", "epoch": 45}
{"loss": 0.10161644220352173, "acc": 0.9641054272651672, "length": 3.7985610961914062, "mode": "test", "epoch": 45}
{"loss": 0.09112413227558136, "acc": 0.9674441814422607, "length": 3.7979674339294434, "mode": "train", "epoch": 46}
{"loss": 0.09305126965045929, "acc": 0.9666503071784973, "length": 3.8597121238708496, "mode": "test", "epoch": 46}
{"loss": 0.07635265588760376, "acc": 0.9719390869140625, "length": 3.8349313735961914, "mode": "train", "epoch": 47}
{"loss": 0.08420692384243011, "acc": 0.9705552458763123, "length": 3.9244604110717773, "mode": "test", "epoch": 47}
{"loss": 0.06942189484834671, "acc": 0.9727628231048584, "length": 3.8984456062316895, "mode": "train", "epoch": 48}
{"loss": 0.08844590187072754, "acc": 0.9664500951766968, "length": 3.942445993423462, "mode": "test", "epoch": 48}
{"loss": 0.07550378143787384, "acc": 0.9717463254928589, "length": 3.9024910926818848, "mode": "train", "epoch": 49}
{"loss": 0.15398596227169037, "acc": 0.9565330743789673, "length": 3.9352517127990723, "mode": "test", "epoch": 49}
{"loss": 0.08184172958135605, "acc": 0.9708061218261719, "length": 3.891695499420166, "mode": "train", "epoch": 50}
{"loss": 0.06898577511310577, "acc": 0.9738995432853699, "length": 3.9388489723205566, "mode": "test", "epoch": 50}
{"loss": 0.06712576001882553, "acc": 0.9749855399131775, "length": 3.8903133869171143, "mode": "train", "epoch": 51}
{"loss": 0.08123212307691574, "acc": 0.9740222692489624, "length": 3.9244604110717773, "mode": "test", "epoch": 51}
{"loss": 0.06667488068342209, "acc": 0.9753705263137817, "length": 3.8962924480438232, "mode": "train", "epoch": 52}
{"loss": 0.06900065392255783, "acc": 0.9740440249443054, "length": 3.9496402740478516, "mode": "test", "epoch": 52}
{"loss": 0.06898868829011917, "acc": 0.9745410084724426, "length": 3.9455506801605225, "mode": "train", "epoch": 53}
{"loss": 0.08399942517280579, "acc": 0.9695623517036438, "length": 3.967625856399536, "mode": "test", "epoch": 53}
{"loss": 0.060956645756959915, "acc": 0.9766972661018372, "length": 3.9449591636657715, "mode": "train", "epoch": 54}
{"loss": 0.09819017350673676, "acc": 0.9699374437332153, "length": 3.953237295150757, "mode": "test", "epoch": 54}
{"loss": 0.07185272127389908, "acc": 0.9719579219818115, "length": 3.932101249694824, "mode": "train", "epoch": 55}
{"loss": 0.10505954176187515, "acc": 0.9667444825172424, "length": 3.931654691696167, "mode": "test", "epoch": 55}
{"loss": 0.0631035715341568, "acc": 0.9764281511306763, "length": 3.9121479988098145, "mode": "train", "epoch": 56}
{"loss": 0.09118489176034927, "acc": 0.9685534834861755, "length": 3.978417158126831, "mode": "test", "epoch": 56}
{"loss": 0.05463347211480141, "acc": 0.9770826697349548, "length": 3.9600882530212402, "mode": "train", "epoch": 57}
{"loss": 0.086124949157238, "acc": 0.9687078595161438, "length": 3.9928057193756104, "mode": "test", "epoch": 57}
{"loss": 0.05686122551560402, "acc": 0.9811913371086121, "length": 3.9719159603118896, "mode": "train", "epoch": 58}
{"loss": 0.08950686454772949, "acc": 0.9701437950134277, "length": 3.9964029788970947, "mode": "test", "epoch": 58}
{"loss": 0.05715562775731087, "acc": 0.9775374531745911, "length": 3.9893383979797363, "mode": "train", "epoch": 59}
{"loss": 0.07030908018350601, "acc": 0.9735612273216248, "length": 4.0, "mode": "test", "epoch": 59}
{"loss": 0.054161377251148224, "acc": 0.9789435267448425, "length": 3.98462176322937, "mode": "train", "epoch": 60}
{"loss": 0.07345103472471237, "acc": 0.9751798510551453, "length": 4.0, "mode": "test", "epoch": 60}
test accuracy: 0.8686363697052002
