# ["--attributes=3", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=128", "--learning_rate=0.001", "--hidden_size=256", "--temp_update=0.97", "--temperature=1.5"]
Creating train_ds and val_ds...

Creating test_ds...
{"loss": 0.7265084385871887, "acc": 0.5003803968429565, "length": 3.3187015056610107, "mode": "train", "epoch": 1}
{"loss": 0.7044143080711365, "acc": 0.4987409710884094, "length": 1.0, "mode": "test", "epoch": 1}
{"loss": 0.6952487230300903, "acc": 0.5190743207931519, "length": 1.5296151638031006, "mode": "train", "epoch": 2}
{"loss": 0.6996836066246033, "acc": 0.5215827226638794, "length": 1.0, "mode": "test", "epoch": 2}
{"loss": 0.6921645998954773, "acc": 0.5316251516342163, "length": 1.018470048904419, "mode": "train", "epoch": 3}
{"loss": 0.695563554763794, "acc": 0.5467626452445984, "length": 1.0, "mode": "test", "epoch": 3}
{"loss": 0.6924111843109131, "acc": 0.5338120460510254, "length": 1.0075470209121704, "mode": "train", "epoch": 4}
{"loss": 0.7025537490844727, "acc": 0.5012590289115906, "length": 1.0, "mode": "test", "epoch": 4}
{"loss": 0.6891772747039795, "acc": 0.5250989198684692, "length": 1.014732003211975, "mode": "train", "epoch": 5}
{"loss": 0.6974822878837585, "acc": 0.5179855823516846, "length": 1.0, "mode": "test", "epoch": 5}
{"loss": 0.6820345520973206, "acc": 0.5547401905059814, "length": 1.2170897722244263, "mode": "train", "epoch": 6}
{"loss": 0.6557122468948364, "acc": 0.6149757504463196, "length": 2.3129496574401855, "mode": "test", "epoch": 6}
{"loss": 0.6342182159423828, "acc": 0.661250114440918, "length": 2.143507242202759, "mode": "train", "epoch": 7}
{"loss": 0.5990468859672546, "acc": 0.6835973858833313, "length": 2.6187050342559814, "mode": "test", "epoch": 7}
{"loss": 0.5824360251426697, "acc": 0.6979882717132568, "length": 2.5382003784179688, "mode": "train", "epoch": 8}
{"loss": 0.5909696817398071, "acc": 0.695577085018158, "length": 2.6079137325286865, "mode": "test", "epoch": 8}
{"loss": 0.5829020738601685, "acc": 0.7158485651016235, "length": 2.5979113578796387, "mode": "train", "epoch": 9}
{"loss": 0.5955345630645752, "acc": 0.7003593444824219, "length": 2.726618766784668, "mode": "test", "epoch": 9}
{"loss": 0.5713258981704712, "acc": 0.7161124348640442, "length": 2.6323838233947754, "mode": "train", "epoch": 10}
{"loss": 0.5776108503341675, "acc": 0.702687680721283, "length": 2.748201370239258, "mode": "test", "epoch": 10}
{"loss": 0.5660581588745117, "acc": 0.7149112224578857, "length": 2.591684579849243, "mode": "train", "epoch": 11}
{"loss": 0.584593653678894, "acc": 0.7043741345405579, "length": 2.748201370239258, "mode": "test", "epoch": 11}
{"loss": 0.5550526976585388, "acc": 0.7250968217849731, "length": 2.6886391639709473, "mode": "train", "epoch": 12}
{"loss": 0.563369631767273, "acc": 0.7118150591850281, "length": 2.8129496574401855, "mode": "test", "epoch": 12}
{"loss": 0.5409702658653259, "acc": 0.7358645796775818, "length": 2.82949161529541, "mode": "train", "epoch": 13}
{"loss": 0.5517300963401794, "acc": 0.7217772603034973, "length": 2.9856114387512207, "mode": "test", "epoch": 13}
{"loss": 0.5273675322532654, "acc": 0.7539190053939819, "length": 2.876574993133545, "mode": "train", "epoch": 14}
{"loss": 0.5278576612472534, "acc": 0.7531543374061584, "length": 2.942445993423462, "mode": "test", "epoch": 14}
{"loss": 0.4930015504360199, "acc": 0.7810927033424377, "length": 2.9253413677215576, "mode": "train", "epoch": 15}
{"loss": 0.48724886775016785, "acc": 0.7768614888191223, "length": 2.9964029788970947, "mode": "test", "epoch": 15}
{"loss": 0.45711731910705566, "acc": 0.8015183210372925, "length": 2.8946080207824707, "mode": "train", "epoch": 16}
{"loss": 0.4595831632614136, "acc": 0.7960159182548523, "length": 3.0287768840789795, "mode": "test", "epoch": 16}
{"loss": 0.4249592125415802, "acc": 0.8126872181892395, "length": 2.938673257827759, "mode": "train", "epoch": 17}
{"loss": 0.43655702471733093, "acc": 0.8048732280731201, "length": 3.0827338695526123, "mode": "test", "epoch": 17}
{"loss": 0.4046373665332794, "acc": 0.8139156103134155, "length": 3.0115103721618652, "mode": "train", "epoch": 18}
{"loss": 0.42420339584350586, "acc": 0.8050052523612976, "length": 3.0719423294067383, "mode": "test", "epoch": 18}
{"loss": 0.38485753536224365, "acc": 0.8232412338256836, "length": 3.0216920375823975, "mode": "train", "epoch": 19}
{"loss": 0.4017946720123291, "acc": 0.8151946663856506, "length": 3.125899314880371, "mode": "test", "epoch": 19}
{"loss": 0.3643985688686371, "acc": 0.8349875211715698, "length": 3.0086710453033447, "mode": "train", "epoch": 20}
{"loss": 0.41433489322662354, "acc": 0.8057965636253357, "length": 3.179856061935425, "mode": "test", "epoch": 20}
{"loss": 0.3565829396247864, "acc": 0.8372890949249268, "length": 3.0589869022369385, "mode": "train", "epoch": 21}
{"loss": 0.3751882016658783, "acc": 0.8271166682243347, "length": 3.2877697944641113, "mode": "test", "epoch": 21}
{"loss": 0.3505512475967407, "acc": 0.8430289030075073, "length": 3.2473161220550537, "mode": "train", "epoch": 22}
{"loss": 0.35076603293418884, "acc": 0.8395528793334961, "length": 3.2446043491363525, "mode": "test", "epoch": 22}
{"loss": 0.3278549909591675, "acc": 0.8520385026931763, "length": 3.265206813812256, "mode": "train", "epoch": 23}
{"loss": 0.3537808656692505, "acc": 0.8422019481658936, "length": 3.4712231159210205, "mode": "test", "epoch": 23}
{"loss": 0.3194035291671753, "acc": 0.8618239760398865, "length": 3.2682621479034424, "mode": "train", "epoch": 24}
{"loss": 0.3385394215583801, "acc": 0.8584379553794861, "length": 3.5143885612487793, "mode": "test", "epoch": 24}
{"loss": 0.3113691806793213, "acc": 0.8624101877212524, "length": 3.390899181365967, "mode": "train", "epoch": 25}
{"loss": 0.32072627544403076, "acc": 0.8590017557144165, "length": 3.611510753631592, "mode": "test", "epoch": 25}
{"loss": 0.3022843897342682, "acc": 0.8688452243804932, "length": 3.384721040725708, "mode": "train", "epoch": 26}
{"loss": 0.3114122152328491, "acc": 0.8675032258033752, "length": 3.4388489723205566, "mode": "test", "epoch": 26}
{"loss": 0.298758327960968, "acc": 0.8695088028907776, "length": 3.396284818649292, "mode": "train", "epoch": 27}
{"loss": 0.3082338273525238, "acc": 0.8738532662391663, "length": 3.4820144176483154, "mode": "test", "epoch": 27}
{"loss": 0.28978073596954346, "acc": 0.874204695224762, "length": 3.385986089706421, "mode": "train", "epoch": 28}
{"loss": 0.31288543343544006, "acc": 0.8696326613426208, "length": 3.525179862976074, "mode": "test", "epoch": 28}
{"loss": 0.2841857075691223, "acc": 0.8791934251785278, "length": 3.353147029876709, "mode": "train", "epoch": 29}
{"loss": 0.30324840545654297, "acc": 0.8698949217796326, "length": 3.5035970211029053, "mode": "test", "epoch": 29}
{"loss": 0.2836316227912903, "acc": 0.8803246021270752, "length": 3.38828182220459, "mode": "train", "epoch": 30}
{"loss": 0.2992139458656311, "acc": 0.8788087964057922, "length": 3.557554006576538, "mode": "test", "epoch": 30}
{"loss": 0.2795862555503845, "acc": 0.8824092149734497, "length": 3.444957971572876, "mode": "train", "epoch": 31}
{"loss": 0.2915682792663574, "acc": 0.879499614238739, "length": 3.546762704849243, "mode": "test", "epoch": 31}
{"loss": 0.26854440569877625, "acc": 0.8841390013694763, "length": 3.568209409713745, "mode": "train", "epoch": 32}
{"loss": 0.280333012342453, "acc": 0.8832533359527588, "length": 3.7302157878875732, "mode": "test", "epoch": 32}
{"loss": 0.2635537385940552, "acc": 0.885329008102417, "length": 3.6503424644470215, "mode": "train", "epoch": 33}
{"loss": 0.25685667991638184, "acc": 0.8886070847511292, "length": 3.8812949657440186, "mode": "test", "epoch": 33}
{"loss": 0.25786107778549194, "acc": 0.8901984095573425, "length": 3.8092055320739746, "mode": "train", "epoch": 34}
{"loss": 0.268246054649353, "acc": 0.8836134672164917, "length": 3.967625856399536, "mode": "test", "epoch": 34}
{"loss": 0.24754256010055542, "acc": 0.897954523563385, "length": 3.8834519386291504, "mode": "train", "epoch": 35}
{"loss": 0.23755410313606262, "acc": 0.8999128937721252, "length": 3.989208698272705, "mode": "test", "epoch": 35}
{"loss": 0.23707906901836395, "acc": 0.8971086740493774, "length": 3.9245805740356445, "mode": "train", "epoch": 36}
{"loss": 0.24266380071640015, "acc": 0.9023830890655518, "length": 3.9604315757751465, "mode": "test", "epoch": 36}
{"loss": 0.22736069560050964, "acc": 0.9020261168479919, "length": 3.8823888301849365, "mode": "train", "epoch": 37}
{"loss": 0.23423421382904053, "acc": 0.9040316343307495, "length": 3.956834554672241, "mode": "test", "epoch": 37}
{"loss": 0.22161860764026642, "acc": 0.9076181650161743, "length": 3.8997957706451416, "mode": "train", "epoch": 38}
{"loss": 0.21146509051322937, "acc": 0.9080880880355835, "length": 3.989208698272705, "mode": "test", "epoch": 38}
{"loss": 0.2185087352991104, "acc": 0.9003593921661377, "length": 3.912198066711426, "mode": "train", "epoch": 39}
{"loss": 0.21937164664268494, "acc": 0.9088547229766846, "length": 3.964028835296631, "mode": "test", "epoch": 39}
{"loss": 0.21679002046585083, "acc": 0.9087039232254028, "length": 3.9063668251037598, "mode": "train", "epoch": 40}
{"loss": 0.2286805361509323, "acc": 0.90691739320755, "length": 3.964028835296631, "mode": "test", "epoch": 40}
{"loss": 0.2208128720521927, "acc": 0.9044084548950195, "length": 3.904355049133301, "mode": "train", "epoch": 41}
{"loss": 0.22313646972179413, "acc": 0.9069905281066895, "length": 3.974820137023926, "mode": "test", "epoch": 41}
{"loss": 0.1988433301448822, "acc": 0.9122347235679626, "length": 3.925511360168457, "mode": "train", "epoch": 42}
{"loss": 0.22901785373687744, "acc": 0.9097601175308228, "length": 3.9964029788970947, "mode": "test", "epoch": 42}
{"loss": 0.19551722705364227, "acc": 0.9148455262184143, "length": 3.9593722820281982, "mode": "train", "epoch": 43}
{"loss": 0.20274576544761658, "acc": 0.9129496812820435, "length": 4.0, "mode": "test", "epoch": 43}
{"loss": 0.19183965027332306, "acc": 0.9194491505622864, "length": 3.9831995964050293, "mode": "train", "epoch": 44}
{"loss": 0.1973562240600586, "acc": 0.9190647602081299, "length": 4.0, "mode": "test", "epoch": 44}
{"loss": 0.1924976408481598, "acc": 0.9164480566978455, "length": 3.9824564456939697, "mode": "train", "epoch": 45}
{"loss": 0.2239573895931244, "acc": 0.9107913374900818, "length": 4.0, "mode": "test", "epoch": 45}
{"loss": 0.19341415166854858, "acc": 0.9211063981056213, "length": 3.9889376163482666, "mode": "train", "epoch": 46}
{"loss": 0.2070363461971283, "acc": 0.9181655049324036, "length": 4.0, "mode": "test", "epoch": 46}
{"loss": 0.18227586150169373, "acc": 0.9231501221656799, "length": 3.990389108657837, "mode": "train", "epoch": 47}
{"loss": 0.18923801183700562, "acc": 0.9160072803497314, "length": 4.0, "mode": "test", "epoch": 47}
{"loss": 0.18566571176052094, "acc": 0.9219922423362732, "length": 3.9907236099243164, "mode": "train", "epoch": 48}
{"loss": 0.1842229962348938, "acc": 0.9215827584266663, "length": 4.0, "mode": "test", "epoch": 48}
{"loss": 0.17289073765277863, "acc": 0.9249895811080933, "length": 3.9939961433410645, "mode": "train", "epoch": 49}
{"loss": 0.19320780038833618, "acc": 0.9149278402328491, "length": 4.0, "mode": "test", "epoch": 49}
{"loss": 0.17080457508563995, "acc": 0.9281225204467773, "length": 3.9959921836853027, "mode": "train", "epoch": 50}
{"loss": 0.18362686038017273, "acc": 0.9187051057815552, "length": 4.0, "mode": "test", "epoch": 50}
{"loss": 0.17069487273693085, "acc": 0.9241896271705627, "length": 3.991269826889038, "mode": "train", "epoch": 51}
{"loss": 0.18323096632957458, "acc": 0.9185250401496887, "length": 4.0, "mode": "test", "epoch": 51}
{"loss": 0.17768731713294983, "acc": 0.9242345094680786, "length": 3.9921834468841553, "mode": "train", "epoch": 52}
{"loss": 0.20312157273292542, "acc": 0.9178056716918945, "length": 4.0, "mode": "test", "epoch": 52}
{"loss": 0.17566750943660736, "acc": 0.9248656034469604, "length": 3.9995038509368896, "mode": "train", "epoch": 53}
{"loss": 0.17363373935222626, "acc": 0.9206832647323608, "length": 4.0, "mode": "test", "epoch": 53}
{"loss": 0.1892043948173523, "acc": 0.9217795729637146, "length": 3.9982922077178955, "mode": "train", "epoch": 54}
{"loss": 0.23090875148773193, "acc": 0.9181655645370483, "length": 4.0, "mode": "test", "epoch": 54}
{"loss": 0.18272404372692108, "acc": 0.9222458600997925, "length": 3.995802879333496, "mode": "train", "epoch": 55}
{"loss": 0.2005298137664795, "acc": 0.9133092761039734, "length": 4.0, "mode": "test", "epoch": 55}
{"loss": 0.17280760407447815, "acc": 0.9238173365592957, "length": 3.9964709281921387, "mode": "train", "epoch": 56}
{"loss": 0.1819300353527069, "acc": 0.9215827584266663, "length": 4.0, "mode": "test", "epoch": 56}
{"loss": 0.16135983169078827, "acc": 0.9293924570083618, "length": 3.9977831840515137, "mode": "train", "epoch": 57}
{"loss": 0.18597257137298584, "acc": 0.9214028716087341, "length": 4.0, "mode": "test", "epoch": 57}
{"loss": 0.1600525677204132, "acc": 0.9295186996459961, "length": 3.9979498386383057, "mode": "train", "epoch": 58}
{"loss": 0.17564690113067627, "acc": 0.9217627048492432, "length": 4.0, "mode": "test", "epoch": 58}
{"loss": 0.15956266224384308, "acc": 0.9337295889854431, "length": 3.9985172748565674, "mode": "train", "epoch": 59}
{"loss": 0.19034144282341003, "acc": 0.9196043610572815, "length": 4.0, "mode": "test", "epoch": 59}
{"loss": 0.16294220089912415, "acc": 0.9352729320526123, "length": 3.9998934268951416, "mode": "train", "epoch": 60}
{"loss": 0.1751200556755066, "acc": 0.9230216145515442, "length": 4.0, "mode": "test", "epoch": 60}
test accuracy: 0.8524242043495178
